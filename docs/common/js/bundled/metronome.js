(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){
var Tone = require('tone')

class Metronome {
    constructor (bpm, pattern, rhythm) {
        this.bpm = bpm || 120;
        this.pattern = pattern || [1,0,0,0];
        this.rhythm = rhythm || [1,1,1,1];
        
        this.playing = false;
        
        this.audio = new Tone.Sampler({
          urls: {
            "C4": "assets/gock block.mp3",
          },
          release: 1,
          onload: () => {
            let beat = 0;
            Tone.Transport.scheduleRepeat((time) => {
              
              // console.log(beat);
              this.audio.triggerAttackRelease(['C4', 'E4'][this.pattern[beat]], "4n", time);
              // for (let n = 1; n < this.pattern.length; n++) {
              //   this.audio.triggerAttackRelease("C4", "4n", time + (n * 0.5));

              // }
              beat = (beat + 1) % this.pattern.length;
              
            }, "4n")
          },
        }).toDestination();

        // this.loop = new Tone.Loop(time => {
        //   this.audio.triggerAttackRelease("C4", "8n", time);
        // }, "4n").start();

        Tone.Transport.bpm.value = this.bpm;

    }

    async play() {
      await Tone.start();
        this.playing = true;
        this.offsetTime = 0;
        await Tone.start();

        // this.loop.start(0);
        Tone.Transport.start();
        // this.playBeat(0);



        // while (this.playing) {
        //     this.playBeat(0)
        //     let start = new Date().getTime();
        //     let result = await this.waitBeat(1);
        //     let end = new Date().getTime();
        //     console.log(end - start)
        //     console.log(this.getBeatMilliseconds(1));
        //     this.offsetTime = Math.max(0, (end - start) - this.getBeatMilliseconds(1));
        //     console.log(this.offsetTime)
            // console.log(result);

            // let dif = new Date().getTime() - startTime;
            // let duration = this.getBeatMilliseconds(1)

            // if ((duration / dif) >= 1) {
            //   console.log('playing');
            //   startTime += duration * Math.floor(duration / dif);
            //   this.playBeat(0)
            // }
        // }
    }

    getBeatMilliseconds(duration, bpm) {
      duration = duration || 1;
      bpm = bpm || this.bpm;
      
      return (((60 / bpm) * (duration * 1000)))
    }

    waitBeat(beat) {
        return new Promise(resolve => {
            setTimeout(() => {
                resolve('resolved')
            }, ((beat * (60 / this.bpm)) * 1000) - this.offsetTime)
        })
    }

    stop() {
        this.playing = false;
        // this.loop.stop();
        Tone.Transport.stop();
    }

    playBeat(pitch) {
        this.audio.triggerAttackRelease("C4", 1);;
        // audio.currentTime = 0;
        // audio.play();

        // audio.start();
    }

    setBpm(bpm) {
      this.bpm = bpm || 120;
      Tone.Transport.bpm.value = this.bpm;
    }
}

// code by Andrew Willems https://stackoverflow.com/a/37623959/17129659

function onRangeChange(rangeInputElmt, listener) {

    var inputEvtHasNeverFired = true;
  
    var rangeValue = {current: undefined, mostRecent: undefined};
    
    rangeInputElmt.addEventListener("input", function(evt) {
      inputEvtHasNeverFired = false;
      rangeValue.current = evt.target.value;
      if (rangeValue.current !== rangeValue.mostRecent) {
        listener(evt);
      }
      rangeValue.mostRecent = rangeValue.current;
    });
  
    rangeInputElmt.addEventListener("change", function(evt) {
      if (inputEvtHasNeverFired) {
        listener(evt);
      }
    }); 
  
}


met = new Metronome();

let tempoDiv = document.querySelector('.tempo');

// var tempoSliderChange = (e) => {
//     let input = document.querySelector('#tempo-input')
//     console.log(input)
//     input.setAttribute('value', e.target.value)
// }

// onRangeChange(tempoSlider.querySelector('#tempo-slider'), tempoSliderChange)

let tempoSlider = tempoDiv.querySelector('#tempo-slider');
tempoSlider.addEventListener('input', e => {
    let input = document.querySelector('#tempo-input');
    input.value = tempoSlider.value;
    met.setBpm(parseInt(tempoSlider.value));
})

var tempoInput = tempoDiv.querySelector('#tempo-input')

tempoInput.addEventListener('change', e => {
    let slider = document.querySelector('#tempo-slider');
    slider.value = tempoInput.value;
    met.setBpm(parseInt(tempoInput.value));
})

const buttons = document.querySelectorAll(".play-button");

buttons.forEach((button) => {
  button.addEventListener("click", () => {
    const currentState = button.getAttribute("data-state");

    if (!currentState || currentState === "stopped") {
      button.setAttribute("data-state", "playing");
      met.play();
    } else {
      button.setAttribute("data-state", "stopped");
      met.stop();
    }
  });
});

},{"tone":2}],2:[function(require,module,exports){
!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.Tone=e():t.Tone=e()}("undefined"!=typeof self?self:this,(function(){return function(t){var e={};function s(n){if(e[n])return e[n].exports;var i=e[n]={i:n,l:!1,exports:{}};return t[n].call(i.exports,i,i.exports,s),i.l=!0,i.exports}return s.m=t,s.c=e,s.d=function(t,e,n){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},s.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)s.d(n,i,function(e){return t[e]}.bind(null,i));return n},s.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="",s(s.s=9)}([function(t,e,s){!function(t,e,s,n){"use strict";function i(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var o=i(e),r=i(s),a=i(n),c=function(t,e,s){return{endTime:e,insertTime:s,type:"exponentialRampToValue",value:t}},h=function(t,e,s){return{endTime:e,insertTime:s,type:"linearRampToValue",value:t}},u=function(t,e){return{startTime:e,type:"setValue",value:t}},l=function(t,e,s){return{duration:s,startTime:e,type:"setValueCurve",values:t}},p=function(t,e,s){var n=s.startTime,i=s.target,o=s.timeConstant;return i+(e-i)*Math.exp((n-t)/o)},d=function(t){return"exponentialRampToValue"===t.type},f=function(t){return"linearRampToValue"===t.type},_=function(t){return d(t)||f(t)},m=function(t){return"setValue"===t.type},g=function(t){return"setValueCurve"===t.type},v=function t(e,s,n,i){var o=e[s];return void 0===o?i:_(o)||m(o)?o.value:g(o)?o.values[o.values.length-1]:p(n,t(e,s-1,o.startTime,i),o)},y=function(t,e,s,n,i){return void 0===s?[n.insertTime,i]:_(s)?[s.endTime,s.value]:m(s)?[s.startTime,s.value]:g(s)?[s.startTime+s.duration,s.values[s.values.length-1]]:[s.startTime,v(t,e-1,s.startTime,i)]},x=function(t){return"cancelAndHold"===t.type},w=function(t){return"cancelScheduledValues"===t.type},b=function(t){return x(t)||w(t)?t.cancelTime:d(t)||f(t)?t.endTime:t.startTime},T=function(t,e,s,n){var i=n.endTime,o=n.value;return s===o?o:0<s&&0<o||s<0&&o<0?s*Math.pow(o/s,(t-e)/(i-e)):0},S=function(t,e,s,n){return s+(t-e)/(n.endTime-e)*(n.value-s)},k=function(t,e){var s=e.duration,n=e.startTime,i=e.values;return function(t,e){var s=Math.floor(e),n=Math.ceil(e);return s===n?t[s]:(1-(e-s))*t[s]+(1-(n-e))*t[n]}(i,(t-n)/s*(i.length-1))},C=function(t){return"setTarget"===t.type},A=function(){function t(e){r.default(this,t),this._automationEvents=[],this._currenTime=0,this._defaultValue=e}return a.default(t,[{key:Symbol.iterator,value:function(){return this._automationEvents[Symbol.iterator]()}},{key:"add",value:function(t){var e=b(t);if(x(t)||w(t)){var s=this._automationEvents.findIndex((function(s){return w(t)&&g(s)?s.startTime+s.duration>=e:b(s)>=e})),n=this._automationEvents[s];if(-1!==s&&(this._automationEvents=this._automationEvents.slice(0,s)),x(t)){var i=this._automationEvents[this._automationEvents.length-1];if(void 0!==n&&_(n)){if(C(i))throw new Error("The internal list is malformed.");var o=g(i)?i.startTime+i.duration:b(i),r=g(i)?i.values[i.values.length-1]:i.value,a=d(n)?T(e,o,r,n):S(e,o,r,n),p=d(n)?c(a,e,this._currenTime):h(a,e,this._currenTime);this._automationEvents.push(p)}void 0!==i&&C(i)&&this._automationEvents.push(u(this.getValue(e),e)),void 0!==i&&g(i)&&i.startTime+i.duration>e&&(this._automationEvents[this._automationEvents.length-1]=l(new Float32Array([6,7]),i.startTime,e-i.startTime))}}else{var m=this._automationEvents.findIndex((function(t){return b(t)>e})),v=-1===m?this._automationEvents[this._automationEvents.length-1]:this._automationEvents[m-1];if(void 0!==v&&g(v)&&b(v)+v.duration>e)return!1;var y=d(t)?c(t.value,t.endTime,this._currenTime):f(t)?h(t.value,e,this._currenTime):t;if(-1===m)this._automationEvents.push(y);else{if(g(t)&&e+t.duration>b(this._automationEvents[m]))return!1;this._automationEvents.splice(m,0,y)}}return!0}},{key:"flush",value:function(t){var e=this._automationEvents.findIndex((function(e){return b(e)>t}));if(e>1){var s=this._automationEvents.slice(e-1),n=s[0];C(n)&&s.unshift(u(v(this._automationEvents,e-2,n.startTime,this._defaultValue),n.startTime)),this._automationEvents=s}}},{key:"getValue",value:function(t){if(0===this._automationEvents.length)return this._defaultValue;var e=this._automationEvents[this._automationEvents.length-1],s=this._automationEvents.findIndex((function(e){return b(e)>t})),n=this._automationEvents[s],i=b(e)<=t?e:this._automationEvents[s-1];if(void 0!==i&&C(i)&&(void 0===n||!_(n)||n.insertTime>t))return p(t,v(this._automationEvents,s-2,i.startTime,this._defaultValue),i);if(void 0!==i&&m(i)&&(void 0===n||!_(n)))return i.value;if(void 0!==i&&g(i)&&(void 0===n||!_(n)||i.startTime+i.duration>t))return t<i.startTime+i.duration?k(t,i):i.values[i.values.length-1];if(void 0!==i&&_(i)&&(void 0===n||!_(n)))return i.value;if(void 0!==n&&d(n)){var r=y(this._automationEvents,s-1,i,n,this._defaultValue),a=o.default(r,2),c=a[0],h=a[1];return T(t,c,h,n)}if(void 0!==n&&f(n)){var u=y(this._automationEvents,s-1,i,n,this._defaultValue),l=o.default(u,2),x=l[0],w=l[1];return S(t,x,w,n)}return this._defaultValue}}]),t}();t.AutomationEventList=A,t.createCancelAndHoldAutomationEvent=function(t){return{cancelTime:t,type:"cancelAndHold"}},t.createCancelScheduledValuesAutomationEvent=function(t){return{cancelTime:t,type:"cancelScheduledValues"}},t.createExponentialRampToValueAutomationEvent=function(t,e){return{endTime:e,type:"exponentialRampToValue",value:t}},t.createLinearRampToValueAutomationEvent=function(t,e){return{endTime:e,type:"linearRampToValue",value:t}},t.createSetTargetAutomationEvent=function(t,e,s){return{startTime:e,target:t,timeConstant:s,type:"setTarget"}},t.createSetValueAutomationEvent=u,t.createSetValueCurveAutomationEvent=l,Object.defineProperty(t,"__esModule",{value:!0})}(e,s(1),s(7),s(8))},function(t,e,s){var n=s(2),i=s(3),o=s(4),r=s(6);t.exports=function(t,e){return n(t)||i(t,e)||o(t,e)||r()}},function(t,e){t.exports=function(t){if(Array.isArray(t))return t}},function(t,e){t.exports=function(t,e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t)){var s=[],n=!0,i=!1,o=void 0;try{for(var r,a=t[Symbol.iterator]();!(n=(r=a.next()).done)&&(s.push(r.value),!e||s.length!==e);n=!0);}catch(t){i=!0,o=t}finally{try{n||null==a.return||a.return()}finally{if(i)throw o}}return s}}},function(t,e,s){var n=s(5);t.exports=function(t,e){if(t){if("string"==typeof t)return n(t,e);var s=Object.prototype.toString.call(t).slice(8,-1);return"Object"===s&&t.constructor&&(s=t.constructor.name),"Map"===s||"Set"===s?Array.from(t):"Arguments"===s||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s)?n(t,e):void 0}}},function(t,e){t.exports=function(t,e){(null==e||e>t.length)&&(e=t.length);for(var s=0,n=new Array(e);s<e;s++)n[s]=t[s];return n}},function(t,e){t.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}},function(t,e){t.exports=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}},function(t,e){function s(t,e){for(var s=0;s<e.length;s++){var n=e[s];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}t.exports=function(t,e,n){return e&&s(t.prototype,e),n&&s(t,n),t}},function(t,e,s){"use strict";s.r(e),s.d(e,"getContext",(function(){return Ji})),s.d(e,"setContext",(function(){return Ki})),s.d(e,"Clock",(function(){return qo})),s.d(e,"Context",(function(){return Gi})),s.d(e,"BaseContext",(function(){return Wi})),s.d(e,"Delay",(function(){return Fo})),s.d(e,"Gain",(function(){return ko})),s.d(e,"Offline",(function(){return Io})),s.d(e,"OfflineContext",(function(){return Yi})),s.d(e,"Param",(function(){return xo})),s.d(e,"ToneAudioBuffer",(function(){return Xi})),s.d(e,"ToneAudioBuffers",(function(){return Vo})),s.d(e,"ToneAudioNode",(function(){return wo})),s.d(e,"connectSeries",(function(){return bo})),s.d(e,"connect",(function(){return To})),s.d(e,"disconnect",(function(){return So})),s.d(e,"FrequencyClass",(function(){return lo})),s.d(e,"Frequency",(function(){return _o})),s.d(e,"MidiClass",(function(){return No})),s.d(e,"Midi",(function(){return Po})),s.d(e,"TimeClass",(function(){return ho})),s.d(e,"Time",(function(){return uo})),s.d(e,"TicksClass",(function(){return jo})),s.d(e,"Ticks",(function(){return Lo})),s.d(e,"TransportTimeClass",(function(){return mo})),s.d(e,"TransportTime",(function(){return go})),s.d(e,"Emitter",(function(){return Bi})),s.d(e,"IntervalTimeline",(function(){return Bo})),s.d(e,"StateTimeline",(function(){return yo})),s.d(e,"Timeline",(function(){return Ni})),s.d(e,"isUndef",(function(){return ai})),s.d(e,"isDefined",(function(){return ci})),s.d(e,"isFunction",(function(){return hi})),s.d(e,"isNumber",(function(){return ui})),s.d(e,"isObject",(function(){return li})),s.d(e,"isBoolean",(function(){return pi})),s.d(e,"isArray",(function(){return di})),s.d(e,"isString",(function(){return fi})),s.d(e,"isNote",(function(){return _i})),s.d(e,"dbToGain",(function(){return eo})),s.d(e,"gainToDb",(function(){return so})),s.d(e,"intervalToFrequencyRatio",(function(){return no})),s.d(e,"ftom",(function(){return oo})),s.d(e,"mtof",(function(){return ao})),s.d(e,"optionsFromArguments",(function(){return Di})),s.d(e,"defaultArg",(function(){return Oi})),s.d(e,"Unit",(function(){return i})),s.d(e,"debug",(function(){return n})),s.d(e,"Noise",(function(){return Jo})),s.d(e,"UserMedia",(function(){return er})),s.d(e,"Oscillator",(function(){return ir})),s.d(e,"AMOscillator",(function(){return hr})),s.d(e,"FMOscillator",(function(){return ur})),s.d(e,"PulseOscillator",(function(){return lr})),s.d(e,"FatOscillator",(function(){return pr})),s.d(e,"PWMOscillator",(function(){return dr})),s.d(e,"OmniOscillator",(function(){return _r})),s.d(e,"ToneOscillatorNode",(function(){return nr})),s.d(e,"LFO",(function(){return yr})),s.d(e,"ToneBufferSource",(function(){return $o})),s.d(e,"Player",(function(){return br})),s.d(e,"Players",(function(){return Tr})),s.d(e,"GrainPlayer",(function(){return Sr})),s.d(e,"Add",(function(){return mr})),s.d(e,"Abs",(function(){return kr})),s.d(e,"AudioToGain",(function(){return ar})),s.d(e,"GainToAudio",(function(){return Cr})),s.d(e,"GreaterThan",(function(){return Mr})),s.d(e,"GreaterThanZero",(function(){return Or})),s.d(e,"Multiply",(function(){return cr})),s.d(e,"Negate",(function(){return Ar})),s.d(e,"Pow",(function(){return Er})),s.d(e,"Signal",(function(){return Do})),s.d(e,"connectSignal",(function(){return Oo})),s.d(e,"Scale",(function(){return gr})),s.d(e,"ScaleExp",(function(){return Rr})),s.d(e,"Subtract",(function(){return Dr})),s.d(e,"SyncedSignal",(function(){return qr})),s.d(e,"WaveShaper",(function(){return rr})),s.d(e,"Zero",(function(){return vr})),s.d(e,"AMSynth",(function(){return zr})),s.d(e,"DuoSynth",(function(){return Qr})),s.d(e,"FMSynth",(function(){return Zr})),s.d(e,"MetalSynth",(function(){return Yr})),s.d(e,"MembraneSynth",(function(){return Hr})),s.d(e,"MonoSynth",(function(){return Ur})),s.d(e,"NoiseSynth",(function(){return $r})),s.d(e,"PluckSynth",(function(){return oa})),s.d(e,"PolySynth",(function(){return ra})),s.d(e,"Sampler",(function(){return aa})),s.d(e,"Synth",(function(){return jr})),s.d(e,"Loop",(function(){return ha})),s.d(e,"Part",(function(){return ua})),s.d(e,"Pattern",(function(){return xa})),s.d(e,"Sequence",(function(){return wa})),s.d(e,"ToneEvent",(function(){return ca})),s.d(e,"AutoFilter",(function(){return ka})),s.d(e,"AutoPanner",(function(){return Aa})),s.d(e,"AutoWah",(function(){return Oa})),s.d(e,"BitCrusher",(function(){return Ma})),s.d(e,"Chebyshev",(function(){return Ra})),s.d(e,"Chorus",(function(){return Na})),s.d(e,"Distortion",(function(){return Pa})),s.d(e,"FeedbackDelay",(function(){return La})),s.d(e,"FrequencyShifter",(function(){return Ba})),s.d(e,"Freeverb",(function(){return Ua})),s.d(e,"JCReverb",(function(){return Ya})),s.d(e,"PingPongDelay",(function(){return $a})),s.d(e,"PitchShift",(function(){return Ja})),s.d(e,"Phaser",(function(){return Ka})),s.d(e,"Reverb",(function(){return tc})),s.d(e,"StereoWidener",(function(){return ic})),s.d(e,"Tremolo",(function(){return oc})),s.d(e,"Vibrato",(function(){return rc})),s.d(e,"Analyser",(function(){return ac})),s.d(e,"Meter",(function(){return hc})),s.d(e,"FFT",(function(){return uc})),s.d(e,"DCMeter",(function(){return lc})),s.d(e,"Waveform",(function(){return pc})),s.d(e,"Follower",(function(){return Da})),s.d(e,"Channel",(function(){return _c})),s.d(e,"CrossFade",(function(){return ba})),s.d(e,"Merge",(function(){return Fa})),s.d(e,"MidSideMerge",(function(){return sc})),s.d(e,"MidSideSplit",(function(){return ec})),s.d(e,"Mono",(function(){return mc})),s.d(e,"MultibandSplit",(function(){return gc})),s.d(e,"Panner",(function(){return Ca})),s.d(e,"Panner3D",(function(){return yc})),s.d(e,"PanVol",(function(){return fc})),s.d(e,"Recorder",(function(){return xc})),s.d(e,"Solo",(function(){return dc})),s.d(e,"Split",(function(){return qa})),s.d(e,"Volume",(function(){return Go})),s.d(e,"Compressor",(function(){return wc})),s.d(e,"Gate",(function(){return bc})),s.d(e,"Limiter",(function(){return Tc})),s.d(e,"MidSideCompressor",(function(){return Sc})),s.d(e,"MultibandCompressor",(function(){return kc})),s.d(e,"AmplitudeEnvelope",(function(){return Pr})),s.d(e,"Envelope",(function(){return Fr})),s.d(e,"FrequencyEnvelope",(function(){return Gr})),s.d(e,"EQ3",(function(){return Cc})),s.d(e,"Filter",(function(){return Wr})),s.d(e,"OnePoleFilter",(function(){return na})),s.d(e,"FeedbackCombFilter",(function(){return sa})),s.d(e,"LowpassCombFilter",(function(){return ia})),s.d(e,"Convolver",(function(){return Ac})),s.d(e,"BiquadFilter",(function(){return Br})),s.d(e,"version",(function(){return o})),s.d(e,"start",(function(){return to})),s.d(e,"supported",(function(){return Kn})),s.d(e,"now",(function(){return Dc})),s.d(e,"immediate",(function(){return Oc})),s.d(e,"Transport",(function(){return Mc})),s.d(e,"getTransport",(function(){return Ec})),s.d(e,"Destination",(function(){return Rc})),s.d(e,"Master",(function(){return qc})),s.d(e,"getDestination",(function(){return Fc})),s.d(e,"Listener",(function(){return Ic})),s.d(e,"getListener",(function(){return Vc})),s.d(e,"Draw",(function(){return Nc})),s.d(e,"getDraw",(function(){return Pc})),s.d(e,"context",(function(){return jc})),s.d(e,"loaded",(function(){return Lc})),s.d(e,"Buffer",(function(){return zc})),s.d(e,"Buffers",(function(){return Bc})),s.d(e,"BufferSource",(function(){return Wc}));var n={};s.r(n),s.d(n,"assert",(function(){return ti})),s.d(n,"assertRange",(function(){return ei})),s.d(n,"assertContextRunning",(function(){return si})),s.d(n,"setLogger",(function(){return ii})),s.d(n,"log",(function(){return oi})),s.d(n,"warn",(function(){return ri}));var i={};s.r(i);const o="14.7.77";var r=s(0);const a=new WeakSet,c=new WeakMap,h=new WeakMap,u=new WeakMap,l=new WeakMap,p=new WeakMap,d=new WeakMap,f=new WeakMap,_=new WeakMap,m=new WeakMap,g={construct:()=>g},v=/^import(?:(?:[\s]+[\w]+|(?:[\s]+[\w]+[\s]*,)?[\s]*\{[\s]*[\w]+(?:[\s]+as[\s]+[\w]+)?(?:[\s]*,[\s]*[\w]+(?:[\s]+as[\s]+[\w]+)?)*[\s]*}|(?:[\s]+[\w]+[\s]*,)?[\s]*\*[\s]+as[\s]+[\w]+)[\s]+from)?(?:[\s]*)("([^"\\]|\\.)+"|'([^'\\]|\\.)+')(?:[\s]*);?/,y=(t,e)=>{const s=[];let n=t.replace(/^[\s]+/,""),i=n.match(v);for(;null!==i;){const t=i[1].slice(1,-1),o=i[0].replace(/([\s]+)?;?$/,"").replace(t,new URL(t,e).toString());s.push(o),n=n.slice(i[0].length).replace(/^[\s]+/,""),i=n.match(v)}return[s.join(";"),n]},x=t=>{if(void 0!==t&&!Array.isArray(t))throw new TypeError("The parameterDescriptors property of given value for processorCtor is not an array.")},w=t=>{if(!(t=>{try{new new Proxy(t,g)}catch{return!1}return!0})(t))throw new TypeError("The given value for processorCtor should be a constructor.");if(null===t.prototype||"object"!=typeof t.prototype)throw new TypeError("The given value for processorCtor should have a prototype.")},b=(t,e)=>{const s=t.get(e);if(void 0===s)throw new Error("A value with the given key could not be found.");return s},T=(t,e)=>{const s=Array.from(t).filter(e);if(s.length>1)throw Error("More than one element was found.");if(0===s.length)throw Error("No element was found.");const[n]=s;return t.delete(n),n},S=(t,e,s,n)=>{const i=b(t,e),o=T(i,t=>t[0]===s&&t[1]===n);return 0===i.size&&t.delete(e),o},k=t=>b(d,t),C=t=>{if(a.has(t))throw new Error("The AudioNode is already stored.");a.add(t),k(t).forEach(t=>t(!0))},A=t=>"port"in t,D=t=>{if(!a.has(t))throw new Error("The AudioNode is not stored.");a.delete(t),k(t).forEach(t=>t(!1))},O=(t,e)=>{!A(t)&&e.every(t=>0===t.size)&&D(t)},M={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",fftSize:2048,maxDecibels:-30,minDecibels:-100,smoothingTimeConstant:.8},E=(t,e)=>t.context===e,R=t=>{try{t.copyToChannel(new Float32Array(1),0,-1)}catch{return!1}return!0},q=()=>new DOMException("","IndexSizeError"),F=t=>{var e;t.getChannelData=(e=t.getChannelData,s=>{try{return e.call(t,s)}catch(t){if(12===t.code)throw q();throw t}})},I={numberOfChannels:1},V=-34028234663852886e22,N=-V,P=t=>a.has(t),j={buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1},L=t=>b(c,t),z=t=>b(u,t),B=(t,e)=>{const{activeInputs:s}=L(t);s.forEach(s=>s.forEach(([s])=>{e.includes(t)||B(s,[...e,t])}));const n=(t=>"playbackRate"in t)(t)?[t.playbackRate]:A(t)?Array.from(t.parameters.values()):(t=>"frequency"in t&&"gain"in t)(t)?[t.Q,t.detune,t.frequency,t.gain]:(t=>"offset"in t)(t)?[t.offset]:(t=>!("frequency"in t)&&"gain"in t)(t)?[t.gain]:(t=>"detune"in t&&"frequency"in t)(t)?[t.detune,t.frequency]:(t=>"pan"in t)(t)?[t.pan]:[];for(const t of n){const s=z(t);void 0!==s&&s.activeInputs.forEach(([t])=>B(t,e))}P(t)&&D(t)},W=t=>{B(t.destination,[])},G=t=>void 0===t||"number"==typeof t||"string"==typeof t&&("balanced"===t||"interactive"===t||"playback"===t),U=t=>"context"in t,Q=t=>U(t[0]),Z=(t,e,s,n)=>{for(const e of t)if(s(e)){if(n)return!1;throw Error("The set contains at least one similar element.")}return t.add(e),!0},X=(t,e,[s,n],i)=>{Z(t,[e,s,n],t=>t[0]===e&&t[1]===s,i)},Y=(t,[e,s,n],i)=>{const o=t.get(e);void 0===o?t.set(e,new Set([[s,n]])):Z(o,[s,n],t=>t[0]===s,i)},H=t=>"inputs"in t,$=(t,e,s,n)=>{if(H(e)){const i=e.inputs[n];return t.connect(i,s,0),[i,s,0]}return t.connect(e,s,n),[e,s,n]},J=(t,e,s)=>{for(const n of t)if(n[0]===e&&n[1]===s)return t.delete(n),n;return null},K=(t,e)=>{if(!k(t).delete(e))throw new Error("Missing the expected event listener.")},tt=(t,e,s)=>{const n=b(t,e),i=T(n,t=>t[0]===s);return 0===n.size&&t.delete(e),i},et=(t,e,s,n)=>{H(e)?t.disconnect(e.inputs[n],s,0):t.disconnect(e,s,n)},st=t=>b(h,t),nt=t=>b(l,t),it=t=>f.has(t),ot=t=>!a.has(t),rt=t=>new Promise(e=>{const s=t.createScriptProcessor(256,1,1),n=t.createGain(),i=t.createBuffer(1,2,44100),o=i.getChannelData(0);o[0]=1,o[1]=1;const r=t.createBufferSource();r.buffer=i,r.loop=!0,r.connect(s).connect(t.destination),r.connect(n),r.disconnect(n),s.onaudioprocess=n=>{const i=n.inputBuffer.getChannelData(0);Array.prototype.some.call(i,t=>1===t)?e(!0):e(!1),r.stop(),s.onaudioprocess=null,r.disconnect(s),s.disconnect(t.destination)},r.start()}),at=(t,e)=>{const s=new Map;for(const e of t)for(const t of e){const e=s.get(t);s.set(t,void 0===e?1:e+1)}s.forEach((t,s)=>e(s,t))},ct=t=>"context"in t,ht=(t,e,s,n)=>{const{activeInputs:i,passiveInputs:o}=z(e),{outputs:r}=L(t),a=k(t),c=r=>{const a=st(t),c=nt(e);if(r){const e=tt(o,t,s);X(i,t,e,!1),n||it(t)||a.connect(c,s)}else{const e=((t,e,s)=>T(t,t=>t[0]===e&&t[1]===s))(i,t,s);Y(o,e,!1),n||it(t)||a.disconnect(c,s)}};return!!Z(r,[e,s],t=>t[0]===e&&t[1]===s,!0)&&(a.add(c),P(t)?X(i,t,[s,c],!0):Y(o,[t,s,c],!0),!0)},ut=(t,e,s,n,i)=>{const[o,r]=((t,e,s,n)=>{const{activeInputs:i,passiveInputs:o}=L(e),r=J(i[n],t,s);if(null===r){return[S(o,t,s,n)[2],!1]}return[r[2],!0]})(t,s,n,i);if(null!==o&&(K(t,o),!r||e||it(t)||et(st(t),st(s),n,i)),P(s)){const{activeInputs:t}=L(s);O(s,t)}},lt=(t,e,s,n)=>{const[i,o]=((t,e,s)=>{const{activeInputs:n,passiveInputs:i}=z(e),o=J(n,t,s);if(null===o){return[tt(i,t,s)[1],!1]}return[o[2],!0]})(t,s,n);null!==i&&(K(t,i),!o||e||it(t)||st(t).disconnect(nt(s),n))};class pt{constructor(t){this._map=new Map(t)}get size(){return this._map.size}entries(){return this._map.entries()}forEach(t,e=null){return this._map.forEach((s,n)=>t.call(e,s,n,this))}get(t){return this._map.get(t)}has(t){return this._map.has(t)}keys(){return this._map.keys()}values(){return this._map.values()}}const dt={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:1,numberOfOutputs:1,parameterData:{},processorOptions:{}};function ft(t,e,s,n,i){if("function"==typeof t.copyFromChannel)0===e[s].byteLength&&(e[s]=new Float32Array(128)),t.copyFromChannel(e[s],n,i);else{const o=t.getChannelData(n);if(0===e[s].byteLength)e[s]=o.slice(i,i+128);else{const t=new Float32Array(o.buffer,i*Float32Array.BYTES_PER_ELEMENT,128);e[s].set(t)}}}const _t=(t,e,s,n,i)=>{"function"==typeof t.copyToChannel?0!==e[s].byteLength&&t.copyToChannel(e[s],n,i):0!==e[s].byteLength&&t.getChannelData(n).set(e[s],i)},mt=(t,e)=>{const s=[];for(let n=0;n<t;n+=1){const t=[],i="number"==typeof e?e:e[n];for(let e=0;e<i;e+=1)t.push(new Float32Array(128));s.push(t)}return s},gt=async(t,e,s,n,i,o,r)=>{const a=null===e?128*Math.ceil(t.context.length/128):e.length,c=n.channelCount*n.numberOfInputs,h=i.reduce((t,e)=>t+e,0),u=0===h?null:s.createBuffer(h,a,s.sampleRate);if(void 0===o)throw new Error("Missing the processor constructor.");const l=L(t),p=await((t,e)=>{const s=b(m,t),n=st(e);return b(s,n)})(s,t),d=mt(n.numberOfInputs,n.channelCount),f=mt(n.numberOfOutputs,i),_=Array.from(t.parameters.keys()).reduce((t,e)=>({...t,[e]:new Float32Array(128)}),{});for(let h=0;h<a;h+=128){if(n.numberOfInputs>0&&null!==e)for(let t=0;t<n.numberOfInputs;t+=1)for(let s=0;s<n.channelCount;s+=1)ft(e,d[t],s,s,h);void 0!==o.parameterDescriptors&&null!==e&&o.parameterDescriptors.forEach(({name:t},s)=>{ft(e,_,t,c+s,h)});for(let t=0;t<n.numberOfInputs;t+=1)for(let e=0;e<i[t];e+=1)0===f[t][e].byteLength&&(f[t][e]=new Float32Array(128));try{const t=d.map((t,e)=>0===l.activeInputs[e].size?[]:t),e=r(h/s.sampleRate,s.sampleRate,()=>p.process(t,f,_));if(null!==u)for(let t=0,e=0;t<n.numberOfOutputs;t+=1){for(let s=0;s<i[t];s+=1)_t(u,f[t],s,e+s,h);e+=i[t]}if(!e)break}catch(e){t.dispatchEvent(new ErrorEvent("processorerror",{colno:e.colno,filename:e.filename,lineno:e.lineno,message:e.message}));break}}return u},vt={Q:1,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",detune:0,frequency:350,gain:0,type:"lowpass"},yt={channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:6},xt={channelCount:6,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:6},wt={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",offset:1},bt={buffer:null,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",disableNormalization:!1},Tt={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",delayTime:0,maxDelayTime:1},St=(t,e,s)=>{const n=e[s];if(void 0===n)throw t();return n},kt={attack:.003,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",knee:30,ratio:12,release:.25,threshold:-24},Ct={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",gain:1},At=()=>new DOMException("","InvalidStateError"),Dt=()=>new DOMException("","InvalidAccessError"),Ot={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers"},Mt=(t,e,s,n,i,o,r,a,c,h,u)=>{const l=h.length;let p=a;for(let a=0;a<l;a+=1){let l=s[0]*h[a];for(let e=1;e<i;e+=1){const n=p-e&c-1;l+=s[e]*o[n],l-=t[e]*r[n]}for(let t=i;t<n;t+=1)l+=s[t]*o[p-t&c-1];for(let s=i;s<e;s+=1)l-=t[s]*r[p-s&c-1];o[p]=h[a],r[p]=l,p=p+1&c-1,u[a]=l}return p},Et={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers"},Rt=t=>{const e=new Uint32Array([1179011410,40,1163280727,544501094,16,131073,44100,176400,1048580,1635017060,4,0]);try{const s=t.decodeAudioData(e.buffer,()=>{});return void 0!==s&&(s.catch(()=>{}),!0)}catch{}return!1},qt={numberOfChannels:1},Ft=(t,e,s)=>{const n=e[s];void 0!==n&&n!==t[s]&&(t[s]=n)},It=(t,e)=>{Ft(t,e,"channelCount"),Ft(t,e,"channelCountMode"),Ft(t,e,"channelInterpretation")},Vt=t=>"function"==typeof t.getFloatTimeDomainData,Nt=(t,e,s)=>{const n=e[s];void 0!==n&&n!==t[s].value&&(t[s].value=n)},Pt=t=>{var e;t.start=(e=t.start,(s=0,n=0,i)=>{if("number"==typeof i&&i<0||n<0||s<0)throw new RangeError("The parameters can't be negative.");e.call(t,s,n,i)})},jt=t=>{var e;t.stop=(e=t.stop,(s=0)=>{if(s<0)throw new RangeError("The parameter can't be negative.");e.call(t,s)})},Lt=(t,e)=>null===t?512:Math.max(512,Math.min(16384,Math.pow(2,Math.round(Math.log2(t*e))))),zt=async(t,e)=>new t(await(t=>new Promise((e,s)=>{const{port1:n,port2:i}=new MessageChannel;n.onmessage=({data:t})=>{n.close(),i.close(),e(t)},n.onmessageerror=({data:t})=>{n.close(),i.close(),s(t)},i.postMessage(t)}))(e)),Bt=(t,e)=>{const s=t.createBiquadFilter();return It(s,e),Nt(s,e,"Q"),Nt(s,e,"detune"),Nt(s,e,"frequency"),Nt(s,e,"gain"),Ft(s,e,"type"),s},Wt=(t,e)=>{const s=t.createChannelSplitter(e.numberOfOutputs);return It(s,e),(t=>{const e=t.numberOfOutputs;Object.defineProperty(t,"channelCount",{get:()=>e,set:t=>{if(t!==e)throw At()}}),Object.defineProperty(t,"channelCountMode",{get:()=>"explicit",set:t=>{if("explicit"!==t)throw At()}}),Object.defineProperty(t,"channelInterpretation",{get:()=>"discrete",set:t=>{if("discrete"!==t)throw At()}})})(s),s},Gt=(t,e)=>(t.connect=e.connect.bind(e),t.disconnect=e.disconnect.bind(e),t),Ut=(t,e)=>{const s=t.createDelay(e.maxDelayTime);return It(s,e),Nt(s,e,"delayTime"),s},Qt=(t,e)=>{const s=t.createGain();return It(s,e),Nt(s,e,"gain"),s};function Zt(t,e){const s=e[0]*e[0]+e[1]*e[1];return[(t[0]*e[0]+t[1]*e[1])/s,(t[1]*e[0]-t[0]*e[1])/s]}function Xt(t,e){let s=[0,0];for(let o=t.length-1;o>=0;o-=1)i=e,s=[(n=s)[0]*i[0]-n[1]*i[1],n[0]*i[1]+n[1]*i[0]],s[0]+=t[o];var n,i;return s}const Yt=(t,e,s,n)=>t.createScriptProcessor(e,s,n),Ht=()=>new DOMException("","NotSupportedError"),$t={numberOfChannels:1},Jt={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",detune:0,frequency:440,periodicWave:void 0,type:"sine"},Kt={channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",coneInnerAngle:360,coneOuterAngle:360,coneOuterGain:0,distanceModel:"inverse",maxDistance:1e4,orientationX:1,orientationY:0,orientationZ:0,panningModel:"equalpower",positionX:0,positionY:0,positionZ:0,refDistance:1,rolloffFactor:1},te={disableNormalization:!1},ee={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers",pan:0},se=()=>new DOMException("","UnknownError"),ne={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",curve:null,oversample:"none"},ie=t=>{if(null===t)return!1;const e=t.length;return e%2!=0?0!==t[Math.floor(e/2)]:t[e/2-1]+t[e/2]!==0},oe=(t,e,s,n)=>{let i=Object.getPrototypeOf(t);for(;!i.hasOwnProperty(e);)i=Object.getPrototypeOf(i);const{get:o,set:r}=Object.getOwnPropertyDescriptor(i,e);Object.defineProperty(t,e,{get:s(o),set:n(r)})},re=(t,e,s)=>{try{t.setValueAtTime(e,s)}catch(n){if(9!==n.code)throw n;re(t,e,s+1e-7)}},ae=t=>{const e=t.createOscillator();try{e.start(-1)}catch(t){return t instanceof RangeError}return!1},ce=t=>{const e=t.createBuffer(1,1,44100),s=t.createBufferSource();s.buffer=e,s.start(),s.stop();try{return s.stop(),!0}catch{return!1}},he=t=>{const e=t.createOscillator();try{e.stop(-1)}catch(t){return t instanceof RangeError}return!1},ue=()=>{try{new DOMException}catch{return!1}return!0},le=()=>new Promise(t=>{const e=new ArrayBuffer(0),{port1:s,port2:n}=new MessageChannel;s.onmessage=({data:e})=>t(null!==e),n.postMessage(e,[e])}),pe=(t,e)=>{const s=e.createGain();t.connect(s);const n=(i=t.disconnect,()=>{i.call(t,s),t.removeEventListener("ended",n)});var i;t.addEventListener("ended",n),Gt(t,s),t.stop=(e=>{let n=!1;return(i=0)=>{if(n)try{e.call(t,i)}catch{s.gain.setValueAtTime(0,i)}else e.call(t,i),n=!0}})(t.stop)},de=(t,e)=>s=>{const n={value:t};return Object.defineProperties(s,{currentTarget:n,target:n}),"function"==typeof e?e.call(t,s):e.handleEvent.call(t,s)},fe=(_e=Z,(t,e,[s,n,i],o)=>{_e(t[n],[e,s,i],t=>t[0]===e&&t[1]===s,o)});var _e;const me=(t=>(e,s,[n,i,o],r)=>{const a=e.get(n);void 0===a?e.set(n,new Set([[i,s,o]])):t(a,[i,s,o],t=>t[0]===i&&t[1]===s,r)})(Z),ge=(t=>(e,s,n,i)=>t(e[i],t=>t[0]===s&&t[1]===n))(T),ve=new WeakMap,ye=(t=>e=>{var s;return null!==(s=t.get(e))&&void 0!==s?s:0})(ve),xe=(we=new Map,be=new WeakMap,(t,e)=>{const s=be.get(t);if(void 0!==s)return s;const n=we.get(t);if(void 0!==n)return n;try{const s=e();return s instanceof Promise?(we.set(t,s),s.catch(()=>!1).then(e=>(we.delete(t),be.set(t,e),e))):(be.set(t,s),s)}catch{return be.set(t,!1),!1}});var we,be;const Te="undefined"==typeof window?null:window,Se=(ke=xe,Ce=q,(t,e)=>{const s=t.createAnalyser();if(It(s,e),!(e.maxDecibels>e.minDecibels))throw Ce();return Ft(s,e,"fftSize"),Ft(s,e,"maxDecibels"),Ft(s,e,"minDecibels"),Ft(s,e,"smoothingTimeConstant"),ke(Vt,()=>Vt(s))||(t=>{t.getFloatTimeDomainData=e=>{const s=new Uint8Array(e.length);t.getByteTimeDomainData(s);const n=Math.max(s.length,t.fftSize);for(let t=0;t<n;t+=1)e[t]=.0078125*(s[t]-128);return e}})(s),s});var ke,Ce;const Ae=(De=L,t=>{const e=De(t);if(null===e.renderer)throw new Error("Missing the renderer of the given AudioNode in the audio graph.");return e.renderer});var De;const Oe=((t,e,s)=>async(n,i,o,r)=>{const a=t(n),c=[...r,n];await Promise.all(a.activeInputs.map((t,r)=>Array.from(t).filter(([t])=>!c.includes(t)).map(async([t,a])=>{const h=e(t),u=await h.render(t,i,c),l=n.context.destination;s(t)||n===l&&s(n)||u.connect(o,a,r)})).reduce((t,e)=>[...t,...e],[]))})(L,Ae,it),Me=(Ee=Se,Re=st,qe=Oe,()=>{const t=new WeakMap;return{render(e,s,n){const i=t.get(s);return void 0!==i?Promise.resolve(i):(async(e,s,n)=>{let i=Re(e);if(!E(i,s)){const t={channelCount:i.channelCount,channelCountMode:i.channelCountMode,channelInterpretation:i.channelInterpretation,fftSize:i.fftSize,maxDecibels:i.maxDecibels,minDecibels:i.minDecibels,smoothingTimeConstant:i.smoothingTimeConstant};i=Ee(s,t)}return t.set(s,i),await qe(e,s,i,n),i})(e,s,n)}}});var Ee,Re,qe;const Fe=(Ie=p,t=>{const e=Ie.get(t);if(void 0===e)throw At();return e});var Ie;const Ve=(t=>null===t?null:t.hasOwnProperty("OfflineAudioContext")?t.OfflineAudioContext:t.hasOwnProperty("webkitOfflineAudioContext")?t.webkitOfflineAudioContext:null)(Te),Ne=(Pe=Ve,t=>null!==Pe&&t instanceof Pe);var Pe;const je=new WeakMap,Le=(ze=de,class{constructor(t){this._nativeEventTarget=t,this._listeners=new WeakMap}addEventListener(t,e,s){if(null!==e){let n=this._listeners.get(e);void 0===n&&(n=ze(this,e),"function"==typeof e&&this._listeners.set(e,n)),this._nativeEventTarget.addEventListener(t,n,s)}}dispatchEvent(t){return this._nativeEventTarget.dispatchEvent(t)}removeEventListener(t,e,s){const n=null===e?void 0:this._listeners.get(e);this._nativeEventTarget.removeEventListener(t,void 0===n?null:n,s)}});var ze;const Be=(t=>null===t?null:t.hasOwnProperty("AudioContext")?t.AudioContext:t.hasOwnProperty("webkitAudioContext")?t.webkitAudioContext:null)(Te),We=(Ge=Be,t=>null!==Ge&&t instanceof Ge);var Ge;const Ue=(t=>e=>null!==t&&"function"==typeof t.AudioNode&&e instanceof t.AudioNode)(Te),Qe=(t=>e=>null!==t&&"function"==typeof t.AudioParam&&e instanceof t.AudioParam)(Te),Ze=((t,e,s,n,i,o,r,a,c,u,l,p,f,_,m)=>class extends u{constructor(e,n,i,o){super(i),this._context=e,this._nativeAudioNode=i;const r=l(e);p(r)&&!0!==s(rt,()=>rt(r))&&(t=>{const e=new Map;var s,n;t.connect=(s=t.connect.bind(t),(t,n=0,i=0)=>{const o=ct(t)?s(t,n,i):s(t,n),r=e.get(t);return void 0===r?e.set(t,[{input:i,output:n}]):r.every(t=>t.input!==i||t.output!==n)&&r.push({input:i,output:n}),o}),t.disconnect=(n=t.disconnect,(s,i,o)=>{if(n.apply(t),void 0===s)e.clear();else if("number"==typeof s)for(const[t,n]of e){const i=n.filter(t=>t.output!==s);0===i.length?e.delete(t):e.set(t,i)}else if(e.has(s))if(void 0===i)e.delete(s);else{const t=e.get(s);if(void 0!==t){const n=t.filter(t=>t.output!==i&&(t.input!==o||void 0===o));0===n.length?e.delete(s):e.set(s,n)}}for(const[s,n]of e)n.forEach(e=>{ct(s)?t.connect(s,e.output,e.input):t.connect(s,e.output)})})})(i),h.set(this,i),d.set(this,new Set),"closed"!==e.state&&n&&C(this),t(this,o,i)}get channelCount(){return this._nativeAudioNode.channelCount}set channelCount(t){this._nativeAudioNode.channelCount=t}get channelCountMode(){return this._nativeAudioNode.channelCountMode}set channelCountMode(t){this._nativeAudioNode.channelCountMode=t}get channelInterpretation(){return this._nativeAudioNode.channelInterpretation}set channelInterpretation(t){this._nativeAudioNode.channelInterpretation=t}get context(){return this._context}get numberOfInputs(){return this._nativeAudioNode.numberOfInputs}get numberOfOutputs(){return this._nativeAudioNode.numberOfOutputs}connect(t,s=0,a=0){if(s<0||s>=this._nativeAudioNode.numberOfOutputs)throw i();const h=l(this._context),u=m(h);if(f(t)||_(t))throw o();if(U(t)){const i=st(t);try{const e=$(this._nativeAudioNode,i,s,a),n=ot(this);(u||n)&&this._nativeAudioNode.disconnect(...e),"closed"!==this.context.state&&!n&&ot(t)&&C(t)}catch(t){if(12===t.code)throw o();throw t}if(e(this,t,s,a,u)){const e=c([this],t);at(e,n(u))}return t}const p=nt(t);if("playbackRate"===p.name)throw r();try{this._nativeAudioNode.connect(p,s),(u||ot(this))&&this._nativeAudioNode.disconnect(p,s)}catch(t){if(12===t.code)throw o();throw t}if(ht(this,t,s,u)){const e=c([this],t);at(e,n(u))}}disconnect(t,e,s){let n;const r=l(this._context),h=m(r);if(void 0===t)n=((t,e)=>{const s=L(t),n=[];for(const i of s.outputs)Q(i)?ut(t,e,...i):lt(t,e,...i),n.push(i[0]);return s.outputs.clear(),n})(this,h);else if("number"==typeof t){if(t<0||t>=this.numberOfOutputs)throw i();n=((t,e,s)=>{const n=L(t),i=[];for(const o of n.outputs)o[1]===s&&(Q(o)?ut(t,e,...o):lt(t,e,...o),i.push(o[0]),n.outputs.delete(o));return i})(this,h,t)}else{if(void 0!==e&&(e<0||e>=this.numberOfOutputs))throw i();if(U(t)&&void 0!==s&&(s<0||s>=t.numberOfInputs))throw i();if(n=((t,e,s,n,i)=>{const o=L(t);return Array.from(o.outputs).filter(t=>!(t[0]!==s||void 0!==n&&t[1]!==n||void 0!==i&&t[2]!==i)).map(s=>(Q(s)?ut(t,e,...s):lt(t,e,...s),o.outputs.delete(s),s[0]))})(this,h,t,e,s),0===n.length)throw o()}for(const t of n){const e=c([this],t);at(e,a)}}})((Xe=c,(t,e,s)=>{const n=[];for(let t=0;t<s.numberOfInputs;t+=1)n.push(new Set);Xe.set(t,{activeInputs:n,outputs:new Set,passiveInputs:new WeakMap,renderer:e})}),((t,e,s,n,i,o,r,a,c,h,u,l,p)=>(d,f,_,m,g)=>{const{activeInputs:v,passiveInputs:y}=o(f),{outputs:x}=o(d),w=a(d),b=o=>{const a=c(f),h=c(d);if(o){const e=S(y,d,_,m);t(v,d,e,!1),g||l(d)||s(h,a,_,m),p(f)&&C(f)}else{const t=n(v,d,_,m);e(y,m,t,!1),g||l(d)||i(h,a,_,m);const s=r(f);0===s?u(f)&&O(f,v):setTimeout(()=>{u(f)&&O(f,v)},1e3*s)}};return!!h(x,[f,_,m],t=>t[0]===f&&t[1]===_&&t[2]===m,!0)&&(w.add(b),u(d)?t(v,d,[_,m,b],!0):e(y,m,[d,_,b],!0),!0)})(fe,me,$,ge,et,L,ye,k,st,Z,P,it,ot),xe,((t,e,s,n,i,o)=>r=>(a,c)=>{const h=t.get(a);if(void 0===h){if(!r&&o(a)){const t=n(a),{outputs:o}=s(a);for(const s of o)if(Q(s)){const i=n(s[0]);e(t,i,s[1],s[2])}else{const e=i(s[0]);t.disconnect(e,s[1])}}t.set(a,c)}else t.set(a,h+c)})(f,et,L,st,nt,P),q,Dt,Ht,((t,e,s,n,i,o,r,a)=>(c,h)=>{const u=e.get(c);if(void 0===u)throw new Error("Missing the expected cycle count.");const l=o(c.context),p=a(l);if(u===h){if(e.delete(c),!p&&r(c)){const e=n(c),{outputs:o}=s(c);for(const s of o)if(Q(s)){const i=n(s[0]);t(e,i,s[1],s[2])}else{const t=i(s[0]);e.connect(t,s[1])}}}else e.set(c,u-h)})($,f,L,st,nt,Fe,P,Ne),((t,e,s)=>function n(i,o){const r=U(o)?o:s(t,o);if((t=>"delayTime"in t)(r))return[];if(i[0]===r)return[i];if(i.includes(r))return[];const{outputs:a}=e(r);return Array.from(a).map(t=>n([...i,r],t[0])).reduce((t,e)=>t.concat(e),[])})(je,L,b),Le,Fe,We,Ue,Qe,Ne);var Xe;const Ye=((t,e,s,n,i,o)=>class extends t{constructor(t,s){const r=i(t),a={...M,...s},c=n(r,a);super(t,!1,c,o(r)?e():null),this._nativeAnalyserNode=c}get fftSize(){return this._nativeAnalyserNode.fftSize}set fftSize(t){this._nativeAnalyserNode.fftSize=t}get frequencyBinCount(){return this._nativeAnalyserNode.frequencyBinCount}get maxDecibels(){return this._nativeAnalyserNode.maxDecibels}set maxDecibels(t){const e=this._nativeAnalyserNode.maxDecibels;if(this._nativeAnalyserNode.maxDecibels=t,!(t>this._nativeAnalyserNode.minDecibels))throw this._nativeAnalyserNode.maxDecibels=e,s()}get minDecibels(){return this._nativeAnalyserNode.minDecibels}set minDecibels(t){const e=this._nativeAnalyserNode.minDecibels;if(this._nativeAnalyserNode.minDecibels=t,!(this._nativeAnalyserNode.maxDecibels>t))throw this._nativeAnalyserNode.minDecibels=e,s()}get smoothingTimeConstant(){return this._nativeAnalyserNode.smoothingTimeConstant}set smoothingTimeConstant(t){this._nativeAnalyserNode.smoothingTimeConstant=t}getByteFrequencyData(t){this._nativeAnalyserNode.getByteFrequencyData(t)}getByteTimeDomainData(t){this._nativeAnalyserNode.getByteTimeDomainData(t)}getFloatFrequencyData(t){this._nativeAnalyserNode.getFloatFrequencyData(t)}getFloatTimeDomainData(t){this._nativeAnalyserNode.getFloatTimeDomainData(t)}})(Ze,Me,q,Se,Fe,Ne),He=new WeakSet,$e=(t=>null===t?null:t.hasOwnProperty("AudioBuffer")?t.AudioBuffer:null)(Te),Je=(Ke=new Uint32Array(1),t=>(Ke[0]=t,Ke[0]));var Ke;const ts=((t,e)=>s=>{s.copyFromChannel=(n,i,o=0)=>{const r=t(o),a=t(i);if(a>=s.numberOfChannels)throw e();const c=s.length,h=s.getChannelData(a),u=n.length;for(let t=r<0?-r:0;t+r<c&&t<u;t+=1)n[t]=h[t+r]},s.copyToChannel=(n,i,o=0)=>{const r=t(o),a=t(i);if(a>=s.numberOfChannels)throw e();const c=s.length,h=s.getChannelData(a),u=n.length;for(let t=r<0?-r:0;t+r<c&&t<u;t+=1)h[t+r]=n[t]}})(Je,q),es=(t=>e=>{e.copyFromChannel=(s=>(n,i,o=0)=>{const r=t(o),a=t(i);if(r<e.length)return s.call(e,n,a,r)})(e.copyFromChannel),e.copyToChannel=(s=>(n,i,o=0)=>{const r=t(o),a=t(i);if(r<e.length)return s.call(e,n,a,r)})(e.copyToChannel)})(Je),ss=((t,e,s,n,i,o,r,a)=>{let c=null;return class h{constructor(h){if(null===i)throw new Error("Missing the native OfflineAudioContext constructor.");const{length:u,numberOfChannels:l,sampleRate:p}={...I,...h};null===c&&(c=new i(1,1,44100));const d=null!==n&&e(o,o)?new n({length:u,numberOfChannels:l,sampleRate:p}):c.createBuffer(l,u,p);if(0===d.numberOfChannels)throw s();return"function"!=typeof d.copyFromChannel?(r(d),F(d)):e(R,()=>R(d))||a(d),t.add(d),d}static[Symbol.hasInstance](e){return null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===h.prototype||t.has(e)}}})(He,xe,Ht,$e,Ve,(ns=$e,()=>{if(null===ns)return!1;try{new ns({length:1,sampleRate:44100})}catch{return!1}return!0}),ts,es);var ns;const is=(os=Qt,(t,e)=>{const s=os(t,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});e.connect(s).connect(t.destination);const n=()=>{e.removeEventListener("ended",n),e.disconnect(s),s.disconnect()};e.addEventListener("ended",n)});var os;const rs=((t,e,s)=>async(n,i,o,r)=>{const a=e(n);await Promise.all(Array.from(a.activeInputs).map(async([e,n])=>{const a=t(e),c=await a.render(e,i,r);s(e)||c.connect(o,n)}))})(Ae,z,it),as=(t=>(e,s,n,i)=>t(s,e,n,i))(rs),cs=((t,e,s,n,i,o,r,a,c,h,u)=>(l,p)=>{const d=l.createBufferSource();return It(d,p),Nt(d,p,"playbackRate"),Ft(d,p,"buffer"),Ft(d,p,"loop"),Ft(d,p,"loopEnd"),Ft(d,p,"loopStart"),e(s,()=>s(l))||(t=>{t.start=(e=>{let s=!1;return(n=0,i=0,o)=>{if(s)throw At();e.call(t,n,i,o),s=!0}})(t.start)})(d),e(n,()=>n(l))||c(d),e(i,()=>i(l))||h(d,l),e(o,()=>o(l))||Pt(d),e(r,()=>r(l))||u(d,l),e(a,()=>a(l))||jt(d),t(l,d),d})(is,xe,t=>{const e=t.createBufferSource();e.start();try{e.start()}catch{return!0}return!1},t=>{const e=t.createBufferSource(),s=t.createBuffer(1,1,44100);e.buffer=s;try{e.start(0,1)}catch{return!1}return!0},t=>{const e=t.createBufferSource();e.start();try{e.stop()}catch{return!1}return!0},ae,ce,he,t=>{var e;t.start=(e=t.start,(s=0,n=0,i)=>{const o=t.buffer,r=null===o?n:Math.min(o.duration,n);null!==o&&r>o.duration-.5/t.context.sampleRate?e.call(t,s,0,0):e.call(t,s,r,i)})},(hs=oe,(t,e)=>{const s=e.createBuffer(1,1,44100);null===t.buffer&&(t.buffer=s),hs(t,"buffer",e=>()=>{const n=e.call(t);return n===s?null:n},e=>n=>e.call(t,null===n?s:n))}),pe);var hs;const us=((t,e)=>(s,n,i,o)=>(t(n).replay(i),e(n,s,i,o)))((t=>e=>{const s=t(e);if(null===s.renderer)throw new Error("Missing the renderer of the given AudioParam in the audio graph.");return s.renderer})(z),rs),ls=((t,e,s,n,i)=>()=>{const o=new WeakMap;let r=null,a=null;return{set start(t){r=t},set stop(t){a=t},render(c,h,u){const l=o.get(h);return void 0!==l?Promise.resolve(l):(async(c,h,u)=>{let l=s(c);const p=E(l,h);if(!p){const t={buffer:l.buffer,channelCount:l.channelCount,channelCountMode:l.channelCountMode,channelInterpretation:l.channelInterpretation,loop:l.loop,loopEnd:l.loopEnd,loopStart:l.loopStart,playbackRate:l.playbackRate.value};l=e(h,t),null!==r&&l.start(...r),null!==a&&l.stop(a)}return o.set(h,l),p?await t(h,c.playbackRate,l.playbackRate,u):await n(h,c.playbackRate,l.playbackRate,u),await i(c,h,l,u),l})(c,h,u)}}})(as,cs,st,us,Oe),ps=((t,e,s,n,i,o,a,c,h,u,l,p,d)=>(f,_,m,g=null,v=null)=>{const y=new r.AutomationEventList(m.defaultValue),x=_?n(y):null,w={get defaultValue(){return m.defaultValue},get maxValue(){return null===g?m.maxValue:g},get minValue(){return null===v?m.minValue:v},get value(){return m.value},set value(t){m.value=t,w.setValueAtTime(t,f.context.currentTime)},cancelAndHoldAtTime(t){if("function"==typeof m.cancelAndHoldAtTime)null===x&&y.flush(f.context.currentTime),y.add(i(t)),m.cancelAndHoldAtTime(t);else{const e=Array.from(y).pop();null===x&&y.flush(f.context.currentTime),y.add(i(t));const s=Array.from(y).pop();m.cancelScheduledValues(t),e!==s&&void 0!==s&&("exponentialRampToValue"===s.type?m.exponentialRampToValueAtTime(s.value,s.endTime):"linearRampToValue"===s.type?m.linearRampToValueAtTime(s.value,s.endTime):"setValue"===s.type?m.setValueAtTime(s.value,s.startTime):"setValueCurve"===s.type&&m.setValueCurveAtTime(s.values,s.startTime,s.duration))}return w},cancelScheduledValues:t=>(null===x&&y.flush(f.context.currentTime),y.add(o(t)),m.cancelScheduledValues(t),w),exponentialRampToValueAtTime(t,e){if(0===t)throw new RangeError;if(!Number.isFinite(e)||e<0)throw new RangeError;return null===x&&y.flush(f.context.currentTime),y.add(a(t,e)),m.exponentialRampToValueAtTime(t,e),w},linearRampToValueAtTime:(t,e)=>(null===x&&y.flush(f.context.currentTime),y.add(c(t,e)),m.linearRampToValueAtTime(t,e),w),setTargetAtTime:(t,e,s)=>(null===x&&y.flush(f.context.currentTime),y.add(h(t,e,s)),m.setTargetAtTime(t,e,s),w),setValueAtTime:(t,e)=>(null===x&&y.flush(f.context.currentTime),y.add(u(t,e)),m.setValueAtTime(t,e),w),setValueCurveAtTime(t,e,s){const n=t instanceof Float32Array?t:new Float32Array(t);if(null!==p&&"webkitAudioContext"===p.name){const t=e+s,i=f.context.sampleRate,o=Math.ceil(e*i),r=Math.floor(t*i),a=r-o,c=new Float32Array(a);for(let t=0;t<a;t+=1){const r=(n.length-1)/s*((o+t)/i-e),a=Math.floor(r),h=Math.ceil(r);c[t]=a===h?n[a]:(1-(r-a))*n[a]+(1-(h-r))*n[h]}null===x&&y.flush(f.context.currentTime),y.add(l(c,e,s)),m.setValueCurveAtTime(c,e,s);const h=r/i;h<t&&d(w,c[c.length-1],h),d(w,n[n.length-1],t)}else null===x&&y.flush(f.context.currentTime),y.add(l(n,e,s)),m.setValueCurveAtTime(n,e,s);return w}};return s.set(w,m),e.set(w,f),t(w,x),w})((ds=u,(t,e)=>{ds.set(t,{activeInputs:new Set,passiveInputs:new WeakMap,renderer:e})}),je,l,t=>({replay(e){for(const s of t)if("exponentialRampToValue"===s.type){const{endTime:t,value:n}=s;e.exponentialRampToValueAtTime(n,t)}else if("linearRampToValue"===s.type){const{endTime:t,value:n}=s;e.linearRampToValueAtTime(n,t)}else if("setTarget"===s.type){const{startTime:t,target:n,timeConstant:i}=s;e.setTargetAtTime(n,t,i)}else if("setValue"===s.type){const{startTime:t,value:n}=s;e.setValueAtTime(n,t)}else{if("setValueCurve"!==s.type)throw new Error("Can't apply an unknown automation.");{const{duration:t,startTime:n,values:i}=s;e.setValueCurveAtTime(i,n,t)}}}}),r.createCancelAndHoldAutomationEvent,r.createCancelScheduledValuesAutomationEvent,r.createExponentialRampToValueAutomationEvent,r.createLinearRampToValueAutomationEvent,r.createSetTargetAutomationEvent,r.createSetValueAutomationEvent,r.createSetValueCurveAutomationEvent,Be,re);var ds;const fs=((t,e,s,n,i,o,r,a)=>class extends t{constructor(t,n){const a=o(t),c={...j,...n},h=i(a,c),u=r(a),l=u?e():null;super(t,!1,h,l),this._audioBufferSourceNodeRenderer=l,this._isBufferNullified=!1,this._isBufferSet=null!==c.buffer,this._nativeAudioBufferSourceNode=h,this._onended=null,this._playbackRate=s(this,u,h.playbackRate,N,V)}get buffer(){return this._isBufferNullified?null:this._nativeAudioBufferSourceNode.buffer}set buffer(t){if(this._nativeAudioBufferSourceNode.buffer=t,null!==t){if(this._isBufferSet)throw n();this._isBufferSet=!0}}get loop(){return this._nativeAudioBufferSourceNode.loop}set loop(t){this._nativeAudioBufferSourceNode.loop=t}get loopEnd(){return this._nativeAudioBufferSourceNode.loopEnd}set loopEnd(t){this._nativeAudioBufferSourceNode.loopEnd=t}get loopStart(){return this._nativeAudioBufferSourceNode.loopStart}set loopStart(t){this._nativeAudioBufferSourceNode.loopStart=t}get onended(){return this._onended}set onended(t){const e="function"==typeof t?a(this,t):null;this._nativeAudioBufferSourceNode.onended=e;const s=this._nativeAudioBufferSourceNode.onended;this._onended=null!==s&&s===e?t:s}get playbackRate(){return this._playbackRate}start(t=0,e=0,s){if(this._nativeAudioBufferSourceNode.start(t,e,s),null!==this._audioBufferSourceNodeRenderer&&(this._audioBufferSourceNodeRenderer.start=void 0===s?[t,e]:[t,e,s]),"closed"!==this.context.state){C(this);const t=()=>{this._nativeAudioBufferSourceNode.removeEventListener("ended",t),P(this)&&D(this)};this._nativeAudioBufferSourceNode.addEventListener("ended",t)}}stop(t=0){this._nativeAudioBufferSourceNode.stop(t),null!==this._audioBufferSourceNodeRenderer&&(this._audioBufferSourceNodeRenderer.stop=t)}})(Ze,ls,ps,At,cs,Fe,Ne,de),_s=((t,e,s,n,i,o,r,a)=>class extends t{constructor(t,s){const n=o(t),c=r(n),h=i(n,s,c);super(t,!1,h,c?e(a):null),this._isNodeOfNativeOfflineAudioContext=c,this._nativeAudioDestinationNode=h}get channelCount(){return this._nativeAudioDestinationNode.channelCount}set channelCount(t){if(this._isNodeOfNativeOfflineAudioContext)throw n();if(t>this._nativeAudioDestinationNode.maxChannelCount)throw s();this._nativeAudioDestinationNode.channelCount=t}get channelCountMode(){return this._nativeAudioDestinationNode.channelCountMode}set channelCountMode(t){if(this._isNodeOfNativeOfflineAudioContext)throw n();this._nativeAudioDestinationNode.channelCountMode=t}get maxChannelCount(){return this._nativeAudioDestinationNode.maxChannelCount}})(Ze,t=>{let e=null;return{render:(s,n,i)=>(null===e&&(e=(async(e,s,n)=>{const i=s.destination;return await t(e,s,i,n),i})(s,n,i)),e)}},q,At,((t,e)=>(s,n,i)=>{const o=s.destination;if(o.channelCount!==n)try{o.channelCount=n}catch{}i&&"explicit"!==o.channelCountMode&&(o.channelCountMode="explicit"),0===o.maxChannelCount&&Object.defineProperty(o,"maxChannelCount",{value:n});const r=t(s,{channelCount:n,channelCountMode:o.channelCountMode,channelInterpretation:o.channelInterpretation,gain:1});return e(r,"channelCount",t=>()=>t.call(r),t=>e=>{t.call(r,e);try{o.channelCount=e}catch(t){if(e>o.maxChannelCount)throw t}}),e(r,"channelCountMode",t=>()=>t.call(r),t=>e=>{t.call(r,e),o.channelCountMode=e}),e(r,"channelInterpretation",t=>()=>t.call(r),t=>e=>{t.call(r,e),o.channelInterpretation=e}),Object.defineProperty(r,"maxChannelCount",{get:()=>o.maxChannelCount}),r.connect(o),r})(Qt,oe),Fe,Ne,Oe),ms=((t,e,s,n,i)=>()=>{const o=new WeakMap;return{render(r,a,c){const h=o.get(a);return void 0!==h?Promise.resolve(h):(async(r,a,c)=>{let h=s(r);const u=E(h,a);if(!u){const t={Q:h.Q.value,channelCount:h.channelCount,channelCountMode:h.channelCountMode,channelInterpretation:h.channelInterpretation,detune:h.detune.value,frequency:h.frequency.value,gain:h.gain.value,type:h.type};h=e(a,t)}return o.set(a,h),u?(await t(a,r.Q,h.Q,c),await t(a,r.detune,h.detune,c),await t(a,r.frequency,h.frequency,c),await t(a,r.gain,h.gain,c)):(await n(a,r.Q,h.Q,c),await n(a,r.detune,h.detune,c),await n(a,r.frequency,h.frequency,c),await n(a,r.gain,h.gain,c)),await i(r,a,h,c),h})(r,a,c)}}})(as,Bt,st,us,Oe),gs=(t=>(e,s)=>t.set(e,s))(ve),vs=(ys=Ze,xs=ps,ws=ms,bs=Dt,Ts=Bt,Ss=Fe,ks=Ne,Cs=gs,class extends ys{constructor(t,e){const s=Ss(t),n={...vt,...e},i=Ts(s,n),o=ks(s);super(t,!1,i,o?ws():null),this._Q=xs(this,o,i.Q,N,V),this._detune=xs(this,o,i.detune,1200*Math.log2(N),-1200*Math.log2(N)),this._frequency=xs(this,o,i.frequency,t.sampleRate/2,0),this._gain=xs(this,o,i.gain,40*Math.log10(N),V),this._nativeBiquadFilterNode=i,Cs(this,1)}get detune(){return this._detune}get frequency(){return this._frequency}get gain(){return this._gain}get Q(){return this._Q}get type(){return this._nativeBiquadFilterNode.type}set type(t){this._nativeBiquadFilterNode.type=t}getFrequencyResponse(t,e,s){try{this._nativeBiquadFilterNode.getFrequencyResponse(t,e,s)}catch(t){if(11===t.code)throw bs();throw t}if(t.length!==e.length||e.length!==s.length)throw bs()}});var ys,xs,ws,bs,Ts,Ss,ks,Cs;const As=((t,e)=>(s,n,i)=>{const o=new Set;var r,a;return s.connect=(r=s.connect,(i,a=0,c=0)=>{const h=0===o.size;if(e(i))return r.call(s,i,a,c),t(o,[i,a,c],t=>t[0]===i&&t[1]===a&&t[2]===c,!0),h&&n(),i;r.call(s,i,a),t(o,[i,a],t=>t[0]===i&&t[1]===a,!0),h&&n()}),s.disconnect=(a=s.disconnect,(t,n,r)=>{const c=o.size>0;if(void 0===t)a.apply(s),o.clear();else if("number"==typeof t){a.call(s,t);for(const e of o)e[1]===t&&o.delete(e)}else{e(t)?a.call(s,t,n,r):a.call(s,t,n);for(const e of o)e[0]!==t||void 0!==n&&e[1]!==n||void 0!==r&&e[2]!==r||o.delete(e)}const h=0===o.size;c&&h&&i()}),s})(Z,Ue),Ds=(Os=At,Ms=As,(t,e)=>{e.channelCount=1,e.channelCountMode="explicit",Object.defineProperty(e,"channelCount",{get:()=>1,set:()=>{throw Os()}}),Object.defineProperty(e,"channelCountMode",{get:()=>"explicit",set:()=>{throw Os()}});const s=t.createBufferSource();Ms(e,()=>{const t=e.numberOfInputs;for(let n=0;n<t;n+=1)s.connect(e,0,n)},()=>s.disconnect(e))});var Os,Ms;const Es=((t,e)=>(s,n)=>{const i=s.createChannelMerger(n.numberOfInputs);return null!==t&&"webkitAudioContext"===t.name&&e(s,i),It(i,n),i})(Be,Ds),Rs=((t,e,s,n,i)=>class extends t{constructor(t,o){const r=n(t),a={...yt,...o};super(t,!1,s(r,a),i(r)?e():null)}})(Ze,((t,e,s)=>()=>{const n=new WeakMap;return{render(i,o,r){const a=n.get(o);return void 0!==a?Promise.resolve(a):(async(i,o,r)=>{let a=e(i);if(!E(a,o)){const e={channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,numberOfInputs:a.numberOfInputs};a=t(o,e)}return n.set(o,a),await s(i,o,a,r),a})(i,o,r)}}})(Es,st,Oe),Es,Fe,Ne),qs=((t,e,s,n,i,o)=>class extends t{constructor(t,r){const a=n(t),c=o({...xt,...r});super(t,!1,s(a,c),i(a)?e():null)}})(Ze,((t,e,s)=>()=>{const n=new WeakMap;return{render(i,o,r){const a=n.get(o);return void 0!==a?Promise.resolve(a):(async(i,o,r)=>{let a=e(i);if(!E(a,o)){const e={channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,numberOfOutputs:a.numberOfOutputs};a=t(o,e)}return n.set(o,a),await s(i,o,a,r),a})(i,o,r)}}})(Wt,st,Oe),Wt,Fe,Ne,t=>({...t,channelCount:t.numberOfOutputs})),Fs=((t,e,s,n)=>(i,{offset:o,...r})=>{const a=i.createBuffer(1,2,44100),c=e(i,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),h=s(i,{...r,gain:o}),u=a.getChannelData(0);u[0]=1,u[1]=1,c.buffer=a,c.loop=!0;const l={get bufferSize(){},get channelCount(){return h.channelCount},set channelCount(t){h.channelCount=t},get channelCountMode(){return h.channelCountMode},set channelCountMode(t){h.channelCountMode=t},get channelInterpretation(){return h.channelInterpretation},set channelInterpretation(t){h.channelInterpretation=t},get context(){return h.context},get inputs(){return[]},get numberOfInputs(){return c.numberOfInputs},get numberOfOutputs(){return h.numberOfOutputs},get offset(){return h.gain},get onended(){return c.onended},set onended(t){c.onended=t},addEventListener:(...t)=>c.addEventListener(t[0],t[1],t[2]),dispatchEvent:(...t)=>c.dispatchEvent(t[0]),removeEventListener:(...t)=>c.removeEventListener(t[0],t[1],t[2]),start(t=0){c.start.call(c,t)},stop(t=0){c.stop.call(c,t)}};return t(i,c),n(Gt(l,h),()=>c.connect(h),()=>c.disconnect(h))})(is,cs,Qt,As),Is=((t,e,s,n,i)=>(o,r)=>{if(void 0===o.createConstantSource)return s(o,r);const a=o.createConstantSource();return It(a,r),Nt(a,r,"offset"),e(n,()=>n(o))||Pt(a),e(i,()=>i(o))||jt(a),t(o,a),a})(is,xe,Fs,ae,he),Vs=((t,e,s,n,i,o,r)=>class extends t{constructor(t,r){const a=i(t),c={...wt,...r},h=n(a,c),u=o(a),l=u?s():null;super(t,!1,h,l),this._constantSourceNodeRenderer=l,this._nativeConstantSourceNode=h,this._offset=e(this,u,h.offset,N,V),this._onended=null}get offset(){return this._offset}get onended(){return this._onended}set onended(t){const e="function"==typeof t?r(this,t):null;this._nativeConstantSourceNode.onended=e;const s=this._nativeConstantSourceNode.onended;this._onended=null!==s&&s===e?t:s}start(t=0){if(this._nativeConstantSourceNode.start(t),null!==this._constantSourceNodeRenderer&&(this._constantSourceNodeRenderer.start=t),"closed"!==this.context.state){C(this);const t=()=>{this._nativeConstantSourceNode.removeEventListener("ended",t),P(this)&&D(this)};this._nativeConstantSourceNode.addEventListener("ended",t)}}stop(t=0){this._nativeConstantSourceNode.stop(t),null!==this._constantSourceNodeRenderer&&(this._constantSourceNodeRenderer.stop=t)}})(Ze,ps,((t,e,s,n,i)=>()=>{const o=new WeakMap;let r=null,a=null;return{set start(t){r=t},set stop(t){a=t},render(c,h,u){const l=o.get(h);return void 0!==l?Promise.resolve(l):(async(c,h,u)=>{let l=s(c);const p=E(l,h);if(!p){const t={channelCount:l.channelCount,channelCountMode:l.channelCountMode,channelInterpretation:l.channelInterpretation,offset:l.offset.value};l=e(h,t),null!==r&&l.start(r),null!==a&&l.stop(a)}return o.set(h,l),p?await t(h,c.offset,l.offset,u):await n(h,c.offset,l.offset,u),await i(c,h,l,u),l})(c,h,u)}}})(as,Is,st,us,Oe),Is,Fe,Ne,de),Ns=((t,e)=>(s,n)=>{const i=s.createConvolver();if(It(i,n),n.disableNormalization===i.normalize&&(i.normalize=!n.disableNormalization),Ft(i,n,"buffer"),n.channelCount>2)throw t();if(e(i,"channelCount",t=>()=>t.call(i),e=>s=>{if(s>2)throw t();return e.call(i,s)}),"max"===n.channelCountMode)throw t();return e(i,"channelCountMode",t=>()=>t.call(i),e=>s=>{if("max"===s)throw t();return e.call(i,s)}),i})(Ht,oe),Ps=((t,e,s,n,i,o)=>class extends t{constructor(t,r){const a=n(t),c={...bt,...r},h=s(a,c);super(t,!1,h,i(a)?e():null),this._isBufferNullified=!1,this._nativeConvolverNode=h,null!==c.buffer&&o(this,c.buffer.duration)}get buffer(){return this._isBufferNullified?null:this._nativeConvolverNode.buffer}set buffer(t){if(this._nativeConvolverNode.buffer=t,null===t&&null!==this._nativeConvolverNode.buffer){const t=this._nativeConvolverNode.context;this._nativeConvolverNode.buffer=t.createBuffer(1,1,44100),this._isBufferNullified=!0,o(this,0)}else this._isBufferNullified=!1,o(this,null===this._nativeConvolverNode.buffer?0:this._nativeConvolverNode.buffer.duration)}get normalize(){return this._nativeConvolverNode.normalize}set normalize(t){this._nativeConvolverNode.normalize=t}})(Ze,((t,e,s)=>()=>{const n=new WeakMap;return{render(i,o,r){const a=n.get(o);return void 0!==a?Promise.resolve(a):(async(i,o,r)=>{let a=e(i);if(!E(a,o)){const e={buffer:a.buffer,channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,disableNormalization:!a.normalize};a=t(o,e)}return n.set(o,a),H(a)?await s(i,o,a.inputs[0],r):await s(i,o,a,r),a})(i,o,r)}}})(Ns,st,Oe),Ns,Fe,Ne,gs),js=((t,e,s,n,i,o,r)=>class extends t{constructor(t,a){const c=i(t),h={...Tt,...a},u=n(c,h),l=o(c);super(t,!1,u,l?s(h.maxDelayTime):null),this._delayTime=e(this,l,u.delayTime),r(this,h.maxDelayTime)}get delayTime(){return this._delayTime}})(Ze,ps,((t,e,s,n,i)=>o=>{const r=new WeakMap;return{render(a,c,h){const u=r.get(c);return void 0!==u?Promise.resolve(u):(async(a,c,h)=>{let u=s(a);const l=E(u,c);if(!l){const t={channelCount:u.channelCount,channelCountMode:u.channelCountMode,channelInterpretation:u.channelInterpretation,delayTime:u.delayTime.value,maxDelayTime:o};u=e(c,t)}return r.set(c,u),l?await t(c,a.delayTime,u.delayTime,h):await n(c,a.delayTime,u.delayTime,h),await i(a,c,u,h),u})(a,c,h)}}})(as,Ut,st,us,Oe),Ut,Fe,Ne,gs),Ls=(zs=Ht,(t,e)=>{const s=t.createDynamicsCompressor();if(It(s,e),e.channelCount>2)throw zs();if("max"===e.channelCountMode)throw zs();return Nt(s,e,"attack"),Nt(s,e,"knee"),Nt(s,e,"ratio"),Nt(s,e,"release"),Nt(s,e,"threshold"),s});var zs;const Bs=((t,e,s,n,i,o,r,a)=>class extends t{constructor(t,i){const c=o(t),h={...kt,...i},u=n(c,h),l=r(c);super(t,!1,u,l?s():null),this._attack=e(this,l,u.attack),this._knee=e(this,l,u.knee),this._nativeDynamicsCompressorNode=u,this._ratio=e(this,l,u.ratio),this._release=e(this,l,u.release),this._threshold=e(this,l,u.threshold),a(this,.006)}get attack(){return this._attack}get channelCount(){return this._nativeDynamicsCompressorNode.channelCount}set channelCount(t){const e=this._nativeDynamicsCompressorNode.channelCount;if(this._nativeDynamicsCompressorNode.channelCount=t,t>2)throw this._nativeDynamicsCompressorNode.channelCount=e,i()}get channelCountMode(){return this._nativeDynamicsCompressorNode.channelCountMode}set channelCountMode(t){const e=this._nativeDynamicsCompressorNode.channelCountMode;if(this._nativeDynamicsCompressorNode.channelCountMode=t,"max"===t)throw this._nativeDynamicsCompressorNode.channelCountMode=e,i()}get knee(){return this._knee}get ratio(){return this._ratio}get reduction(){return"number"==typeof this._nativeDynamicsCompressorNode.reduction.value?this._nativeDynamicsCompressorNode.reduction.value:this._nativeDynamicsCompressorNode.reduction}get release(){return this._release}get threshold(){return this._threshold}})(Ze,ps,((t,e,s,n,i)=>()=>{const o=new WeakMap;return{render(r,a,c){const h=o.get(a);return void 0!==h?Promise.resolve(h):(async(r,a,c)=>{let h=s(r);const u=E(h,a);if(!u){const t={attack:h.attack.value,channelCount:h.channelCount,channelCountMode:h.channelCountMode,channelInterpretation:h.channelInterpretation,knee:h.knee.value,ratio:h.ratio.value,release:h.release.value,threshold:h.threshold.value};h=e(a,t)}return o.set(a,h),u?(await t(a,r.attack,h.attack,c),await t(a,r.knee,h.knee,c),await t(a,r.ratio,h.ratio,c),await t(a,r.release,h.release,c),await t(a,r.threshold,h.threshold,c)):(await n(a,r.attack,h.attack,c),await n(a,r.knee,h.knee,c),await n(a,r.ratio,h.ratio,c),await n(a,r.release,h.release,c),await n(a,r.threshold,h.threshold,c)),await i(r,a,h,c),h})(r,a,c)}}})(as,Ls,st,us,Oe),Ls,Ht,Fe,Ne,gs),Ws=((t,e,s,n,i,o)=>class extends t{constructor(t,r){const a=i(t),c={...Ct,...r},h=n(a,c),u=o(a);super(t,!1,h,u?s():null),this._gain=e(this,u,h.gain,N,V)}get gain(){return this._gain}})(Ze,ps,((t,e,s,n,i)=>()=>{const o=new WeakMap;return{render(r,a,c){const h=o.get(a);return void 0!==h?Promise.resolve(h):(async(r,a,c)=>{let h=s(r);const u=E(h,a);if(!u){const t={channelCount:h.channelCount,channelCountMode:h.channelCountMode,channelInterpretation:h.channelInterpretation,gain:h.gain.value};h=e(a,t)}return o.set(a,h),u?await t(a,r.gain,h.gain,c):await n(a,r.gain,h.gain,c),await i(r,a,h,c),h})(r,a,c)}}})(as,Qt,st,us,Oe),Qt,Fe,Ne),Gs=((t,e,s,n)=>(i,o,{channelCount:r,channelCountMode:a,channelInterpretation:c,feedback:h,feedforward:u})=>{const l=Lt(o,i.sampleRate),p=h instanceof Float64Array?h:new Float64Array(h),d=u instanceof Float64Array?u:new Float64Array(u),f=p.length,_=d.length,m=Math.min(f,_);if(0===f||f>20)throw n();if(0===p[0])throw e();if(0===_||_>20)throw n();if(0===d[0])throw e();if(1!==p[0]){for(let t=0;t<_;t+=1)d[t]/=p[0];for(let t=1;t<f;t+=1)p[t]/=p[0]}const g=s(i,l,r,r);g.channelCount=r,g.channelCountMode=a,g.channelInterpretation=c;const v=[],y=[],x=[];for(let t=0;t<r;t+=1){v.push(0);const t=new Float32Array(32),e=new Float32Array(32);t.fill(0),e.fill(0),y.push(t),x.push(e)}g.onaudioprocess=t=>{const e=t.inputBuffer,s=t.outputBuffer,n=e.numberOfChannels;for(let t=0;t<n;t+=1){const n=e.getChannelData(t),i=s.getChannelData(t);v[t]=Mt(p,f,d,_,m,y[t],x[t],v[t],32,n,i)}};const w=i.sampleRate/2;return Gt({get bufferSize(){return l},get channelCount(){return g.channelCount},set channelCount(t){g.channelCount=t},get channelCountMode(){return g.channelCountMode},set channelCountMode(t){g.channelCountMode=t},get channelInterpretation(){return g.channelInterpretation},set channelInterpretation(t){g.channelInterpretation=t},get context(){return g.context},get inputs(){return[g]},get numberOfInputs(){return g.numberOfInputs},get numberOfOutputs(){return g.numberOfOutputs},addEventListener:(...t)=>g.addEventListener(t[0],t[1],t[2]),dispatchEvent:(...t)=>g.dispatchEvent(t[0]),getFrequencyResponse(e,s,n){if(e.length!==s.length||s.length!==n.length)throw t();const i=e.length;for(let t=0;t<i;t+=1){const i=-Math.PI*(e[t]/w),o=[Math.cos(i),Math.sin(i)],r=Zt(Xt(d,o),Xt(p,o));s[t]=Math.sqrt(r[0]*r[0]+r[1]*r[1]),n[t]=Math.atan2(r[1],r[0])}},removeEventListener:(...t)=>g.removeEventListener(t[0],t[1],t[2])},g)})(Dt,At,Yt,Ht),Us=((t,e,s,n)=>i=>t(Rt,()=>Rt(i))?Promise.resolve(t(n,n)).then(t=>{if(!t){const t=s(i,512,0,1);i.oncomplete=()=>{t.onaudioprocess=null,t.disconnect()},t.onaudioprocess=()=>i.currentTime,t.connect(i.destination)}return i.startRendering()}):new Promise(t=>{const s=e(i,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});i.oncomplete=e=>{s.disconnect(),t(e.renderedBuffer)},s.connect(i.destination),i.startRendering()}))(xe,Qt,Yt,((t,e)=>()=>{if(null===e)return Promise.resolve(!1);const s=new e(1,1,44100),n=t(s,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});return new Promise(t=>{s.oncomplete=()=>{n.disconnect(),t(0!==s.currentTime)},s.startRendering()})})(Qt,Ve)),Qs=((t,e,s,n,i)=>(o,r)=>{const a=new WeakMap;let c=null;const h=async(h,u,l)=>{let p=null,d=e(h);const f=E(d,u);if(void 0===u.createIIRFilter?p=t(u,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}):f||(d=u.createIIRFilter(r,o)),a.set(u,null===p?d:p),null!==p){if(null===c){if(null===s)throw new Error("Missing the native OfflineAudioContext constructor.");const t=new s(h.context.destination.channelCount,h.context.length,u.sampleRate);c=(async()=>{await n(h,t,t.destination,l);return((t,e,s,n)=>{const i=s instanceof Float64Array?s:new Float64Array(s),o=n instanceof Float64Array?n:new Float64Array(n),r=i.length,a=o.length,c=Math.min(r,a);if(1!==i[0]){for(let t=0;t<r;t+=1)o[t]/=i[0];for(let t=1;t<a;t+=1)i[t]/=i[0]}const h=new Float32Array(32),u=new Float32Array(32),l=e.createBuffer(t.numberOfChannels,t.length,t.sampleRate),p=t.numberOfChannels;for(let e=0;e<p;e+=1){const s=t.getChannelData(e),n=l.getChannelData(e);h.fill(0),u.fill(0),Mt(i,r,o,a,c,h,u,0,32,s,n)}return l})(await i(t),u,o,r)})()}const t=await c;return p.buffer=t,p.start(0),p}return await n(h,u,d,l),d};return{render(t,e,s){const n=a.get(e);return void 0!==n?Promise.resolve(n):h(t,e,s)}}})(cs,st,Ve,Oe,Us);var Zs;const Xs=((t,e,s,n,i,o)=>class extends t{constructor(t,r){const a=n(t),c=i(a),h={...Ot,...r},u=e(a,c?null:t.baseLatency,h);super(t,!1,u,c?s(h.feedback,h.feedforward):null),(t=>{var e;t.getFrequencyResponse=(e=t.getFrequencyResponse,(s,n,i)=>{if(s.length!==n.length||n.length!==i.length)throw Dt();return e.call(t,s,n,i)})})(u),this._nativeIIRFilterNode=u,o(this,1)}getFrequencyResponse(t,e,s){return this._nativeIIRFilterNode.getFrequencyResponse(t,e,s)}})(Ze,(Zs=Gs,(t,e,s)=>{if(void 0===t.createIIRFilter)return Zs(t,e,s);const n=t.createIIRFilter(s.feedforward,s.feedback);return It(n,s),n}),Qs,Fe,Ne,gs),Ys=((t,e,s,n,i)=>(o,r)=>{const a=r.listener,{forwardX:c,forwardY:h,forwardZ:u,positionX:l,positionY:p,positionZ:d,upX:f,upY:_,upZ:m}=void 0===a.forwardX?(()=>{const c=e(r,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:9}),h=i(r),u=n(r,256,9,0),l=(e,n)=>{const i=s(r,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:n});return i.connect(c,0,e),i.start(),Object.defineProperty(i.offset,"defaultValue",{get:()=>n}),t({context:o},h,i.offset,N,V)};let p=[0,0,-1,0,1,0],d=[0,0,0];return u.onaudioprocess=({inputBuffer:t})=>{const e=[t.getChannelData(0)[0],t.getChannelData(1)[0],t.getChannelData(2)[0],t.getChannelData(3)[0],t.getChannelData(4)[0],t.getChannelData(5)[0]];e.some((t,e)=>t!==p[e])&&(a.setOrientation(...e),p=e);const s=[t.getChannelData(6)[0],t.getChannelData(7)[0],t.getChannelData(8)[0]];s.some((t,e)=>t!==d[e])&&(a.setPosition(...s),d=s)},c.connect(u),{forwardX:l(0,0),forwardY:l(1,0),forwardZ:l(2,-1),positionX:l(6,0),positionY:l(7,0),positionZ:l(8,0),upX:l(3,0),upY:l(4,1),upZ:l(5,0)}})():a;return{get forwardX(){return c},get forwardY(){return h},get forwardZ(){return u},get positionX(){return l},get positionY(){return p},get positionZ(){return d},get upX(){return f},get upY(){return _},get upZ(){return m}}})(ps,Es,Is,Yt,Ne),Hs=new WeakMap,$s=((t,e,s,n,i,o)=>class extends s{constructor(s,o){super(s),this._nativeContext=s,p.set(this,s),n(s)&&i.set(s,new Set),this._destination=new t(this,o),this._listener=e(this,s),this._onstatechange=null}get currentTime(){return this._nativeContext.currentTime}get destination(){return this._destination}get listener(){return this._listener}get onstatechange(){return this._onstatechange}set onstatechange(t){const e="function"==typeof t?o(this,t):null;this._nativeContext.onstatechange=e;const s=this._nativeContext.onstatechange;this._onstatechange=null!==s&&s===e?t:s}get sampleRate(){return this._nativeContext.sampleRate}get state(){return this._nativeContext.state}})(_s,Ys,Le,Ne,Hs,de),Js=((t,e,s,n,i,o)=>(r,a)=>{const c=r.createOscillator();return It(c,a),Nt(c,a,"detune"),Nt(c,a,"frequency"),void 0!==a.periodicWave?c.setPeriodicWave(a.periodicWave):Ft(c,a,"type"),e(s,()=>s(r))||Pt(c),e(n,()=>n(r))||o(c,r),e(i,()=>i(r))||jt(c),t(r,c),c})(is,xe,ae,ce,he,pe),Ks=((t,e,s,n,i,o,r)=>class extends t{constructor(t,r){const a=i(t),c={...Jt,...r},h=s(a,c),u=o(a),l=u?n():null,p=t.sampleRate/2;super(t,!1,h,l),this._detune=e(this,u,h.detune,153600,-153600),this._frequency=e(this,u,h.frequency,p,-p),this._nativeOscillatorNode=h,this._onended=null,this._oscillatorNodeRenderer=l,null!==this._oscillatorNodeRenderer&&void 0!==c.periodicWave&&(this._oscillatorNodeRenderer.periodicWave=c.periodicWave)}get detune(){return this._detune}get frequency(){return this._frequency}get onended(){return this._onended}set onended(t){const e="function"==typeof t?r(this,t):null;this._nativeOscillatorNode.onended=e;const s=this._nativeOscillatorNode.onended;this._onended=null!==s&&s===e?t:s}get type(){return this._nativeOscillatorNode.type}set type(t){this._nativeOscillatorNode.type=t,null!==this._oscillatorNodeRenderer&&(this._oscillatorNodeRenderer.periodicWave=null)}setPeriodicWave(t){this._nativeOscillatorNode.setPeriodicWave(t),null!==this._oscillatorNodeRenderer&&(this._oscillatorNodeRenderer.periodicWave=t)}start(t=0){if(this._nativeOscillatorNode.start(t),null!==this._oscillatorNodeRenderer&&(this._oscillatorNodeRenderer.start=t),"closed"!==this.context.state){C(this);const t=()=>{this._nativeOscillatorNode.removeEventListener("ended",t),P(this)&&D(this)};this._nativeOscillatorNode.addEventListener("ended",t)}}stop(t=0){this._nativeOscillatorNode.stop(t),null!==this._oscillatorNodeRenderer&&(this._oscillatorNodeRenderer.stop=t)}})(Ze,ps,Js,((t,e,s,n,i)=>()=>{const o=new WeakMap;let r=null,a=null,c=null;return{set periodicWave(t){r=t},set start(t){a=t},set stop(t){c=t},render(h,u,l){const p=o.get(u);return void 0!==p?Promise.resolve(p):(async(h,u,l)=>{let p=s(h);const d=E(p,u);if(!d){const t={channelCount:p.channelCount,channelCountMode:p.channelCountMode,channelInterpretation:p.channelInterpretation,detune:p.detune.value,frequency:p.frequency.value,periodicWave:null===r?void 0:r,type:p.type};p=e(u,t),null!==a&&p.start(a),null!==c&&p.stop(c)}return o.set(u,p),d?(await t(u,h.detune,p.detune,l),await t(u,h.frequency,p.frequency,l)):(await n(u,h.detune,p.detune,l),await n(u,h.frequency,p.frequency,l)),await i(h,u,p,l),p})(h,u,l)}}})(as,Js,st,us,Oe),Fe,Ne,de),tn=(en=cs,(t,e)=>{const s=en(t,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),n=t.createBuffer(1,2,44100);return s.buffer=n,s.loop=!0,s.connect(e),s.start(),()=>{s.stop(),s.disconnect(e)}});var en;const sn=((t,e,s,n,i)=>(o,{curve:r,oversample:a,...c})=>{const h=o.createWaveShaper(),u=o.createWaveShaper();It(h,c),It(u,c);const l=s(o,{...c,gain:1}),p=s(o,{...c,gain:-1}),d=s(o,{...c,gain:1}),f=s(o,{...c,gain:-1});let _=null,m=!1,g=null;const v={get bufferSize(){},get channelCount(){return h.channelCount},set channelCount(t){l.channelCount=t,p.channelCount=t,h.channelCount=t,d.channelCount=t,u.channelCount=t,f.channelCount=t},get channelCountMode(){return h.channelCountMode},set channelCountMode(t){l.channelCountMode=t,p.channelCountMode=t,h.channelCountMode=t,d.channelCountMode=t,u.channelCountMode=t,f.channelCountMode=t},get channelInterpretation(){return h.channelInterpretation},set channelInterpretation(t){l.channelInterpretation=t,p.channelInterpretation=t,h.channelInterpretation=t,d.channelInterpretation=t,u.channelInterpretation=t,f.channelInterpretation=t},get context(){return h.context},get curve(){return g},set curve(s){if(null!==s&&s.length<2)throw e();if(null===s)h.curve=s,u.curve=s;else{const t=s.length,e=new Float32Array(t+2-t%2),n=new Float32Array(t+2-t%2);e[0]=s[0],n[0]=-s[t-1];const i=Math.ceil((t+1)/2),o=(t+1)/2-1;for(let r=1;r<i;r+=1){const a=r/i*o,c=Math.floor(a),h=Math.ceil(a);e[r]=c===h?s[c]:(1-(a-c))*s[c]+(1-(h-a))*s[h],n[r]=c===h?-s[t-1-c]:-(1-(a-c))*s[t-1-c]-(1-(h-a))*s[t-1-h]}e[i]=t%2==1?s[i-1]:(s[i-2]+s[i-1])/2,h.curve=e,u.curve=n}g=s,m&&(n(g)&&null===_?_=t(o,l):null!==_&&(_(),_=null))},get inputs(){return[l]},get numberOfInputs(){return h.numberOfInputs},get numberOfOutputs(){return h.numberOfOutputs},get oversample(){return h.oversample},set oversample(t){h.oversample=t,u.oversample=t},addEventListener:(...t)=>l.addEventListener(t[0],t[1],t[2]),dispatchEvent:(...t)=>l.dispatchEvent(t[0]),removeEventListener:(...t)=>l.removeEventListener(t[0],t[1],t[2])};null!==r&&(v.curve=r instanceof Float32Array?r:new Float32Array(r)),a!==v.oversample&&(v.oversample=a);return i(Gt(v,d),()=>{l.connect(h).connect(d),l.connect(p).connect(u).connect(f).connect(d),m=!0,n(g)&&(_=t(o,l))},()=>{l.disconnect(h),h.disconnect(d),l.disconnect(p),p.disconnect(u),u.disconnect(f),f.disconnect(d),m=!1,null!==_&&(_(),_=null)})})(tn,At,Qt,ie,As),nn=((t,e,s,n,i,o,r)=>(a,c)=>{const h=a.createWaveShaper();if(null!==o&&"webkitAudioContext"===o.name&&void 0===a.createGain().gain.automationRate)return s(a,c);It(h,c);const u=null===c.curve||c.curve instanceof Float32Array?c.curve:new Float32Array(c.curve);if(null!==u&&u.length<2)throw e();Ft(h,{curve:u},"curve"),Ft(h,c,"oversample");let l=null,p=!1;r(h,"curve",t=>()=>t.call(h),e=>s=>(e.call(h,s),p&&(n(s)&&null===l?l=t(a,h):n(s)||null===l||(l(),l=null)),s));return i(h,()=>{p=!0,n(h.curve)&&(l=t(a,h))},()=>{p=!1,null!==l&&(l(),l=null)})})(tn,At,sn,ie,As,Be,oe),on=((t,e,s,n,i,o,r,a,c)=>(h,{coneInnerAngle:u,coneOuterAngle:l,coneOuterGain:p,distanceModel:d,maxDistance:f,orientationX:_,orientationY:m,orientationZ:g,panningModel:v,positionX:y,positionY:x,positionZ:w,refDistance:b,rolloffFactor:T,...S})=>{const k=h.createPanner();if(S.channelCount>2)throw r();if("max"===S.channelCountMode)throw r();It(k,S);const C={channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete"},A=s(h,{...C,channelInterpretation:"speakers",numberOfInputs:6}),D=n(h,{...S,gain:1}),O=n(h,{...C,gain:1}),M=n(h,{...C,gain:0}),E=n(h,{...C,gain:0}),R=n(h,{...C,gain:0}),q=n(h,{...C,gain:0}),F=n(h,{...C,gain:0}),I=i(h,256,6,1),V=o(h,{...C,curve:new Float32Array([1,1]),oversample:"none"});let N=[_,m,g],P=[y,x,w];I.onaudioprocess=({inputBuffer:t})=>{const e=[t.getChannelData(0)[0],t.getChannelData(1)[0],t.getChannelData(2)[0]];e.some((t,e)=>t!==N[e])&&(k.setOrientation(...e),N=e);const s=[t.getChannelData(3)[0],t.getChannelData(4)[0],t.getChannelData(5)[0]];s.some((t,e)=>t!==P[e])&&(k.setPosition(...s),P=s)},Object.defineProperty(M.gain,"defaultValue",{get:()=>0}),Object.defineProperty(E.gain,"defaultValue",{get:()=>0}),Object.defineProperty(R.gain,"defaultValue",{get:()=>0}),Object.defineProperty(q.gain,"defaultValue",{get:()=>0}),Object.defineProperty(F.gain,"defaultValue",{get:()=>0});const j={get bufferSize(){},get channelCount(){return k.channelCount},set channelCount(t){if(t>2)throw r();D.channelCount=t,k.channelCount=t},get channelCountMode(){return k.channelCountMode},set channelCountMode(t){if("max"===t)throw r();D.channelCountMode=t,k.channelCountMode=t},get channelInterpretation(){return k.channelInterpretation},set channelInterpretation(t){D.channelInterpretation=t,k.channelInterpretation=t},get coneInnerAngle(){return k.coneInnerAngle},set coneInnerAngle(t){k.coneInnerAngle=t},get coneOuterAngle(){return k.coneOuterAngle},set coneOuterAngle(t){k.coneOuterAngle=t},get coneOuterGain(){return k.coneOuterGain},set coneOuterGain(t){if(t<0||t>1)throw e();k.coneOuterGain=t},get context(){return k.context},get distanceModel(){return k.distanceModel},set distanceModel(t){k.distanceModel=t},get inputs(){return[D]},get maxDistance(){return k.maxDistance},set maxDistance(t){if(t<0)throw new RangeError;k.maxDistance=t},get numberOfInputs(){return k.numberOfInputs},get numberOfOutputs(){return k.numberOfOutputs},get orientationX(){return O.gain},get orientationY(){return M.gain},get orientationZ(){return E.gain},get panningModel(){return k.panningModel},set panningModel(t){k.panningModel=t},get positionX(){return R.gain},get positionY(){return q.gain},get positionZ(){return F.gain},get refDistance(){return k.refDistance},set refDistance(t){if(t<0)throw new RangeError;k.refDistance=t},get rolloffFactor(){return k.rolloffFactor},set rolloffFactor(t){if(t<0)throw new RangeError;k.rolloffFactor=t},addEventListener:(...t)=>D.addEventListener(t[0],t[1],t[2]),dispatchEvent:(...t)=>D.dispatchEvent(t[0]),removeEventListener:(...t)=>D.removeEventListener(t[0],t[1],t[2])};u!==j.coneInnerAngle&&(j.coneInnerAngle=u),l!==j.coneOuterAngle&&(j.coneOuterAngle=l),p!==j.coneOuterGain&&(j.coneOuterGain=p),d!==j.distanceModel&&(j.distanceModel=d),f!==j.maxDistance&&(j.maxDistance=f),_!==j.orientationX.value&&(j.orientationX.value=_),m!==j.orientationY.value&&(j.orientationY.value=m),g!==j.orientationZ.value&&(j.orientationZ.value=g),v!==j.panningModel&&(j.panningModel=v),y!==j.positionX.value&&(j.positionX.value=y),x!==j.positionY.value&&(j.positionY.value=x),w!==j.positionZ.value&&(j.positionZ.value=w),b!==j.refDistance&&(j.refDistance=b),T!==j.rolloffFactor&&(j.rolloffFactor=T),1===N[0]&&0===N[1]&&0===N[2]||k.setOrientation(...N),0===P[0]&&0===P[1]&&0===P[2]||k.setPosition(...P);return c(Gt(j,k),()=>{D.connect(k),t(D,V,0,0),V.connect(O).connect(A,0,0),V.connect(M).connect(A,0,1),V.connect(E).connect(A,0,2),V.connect(R).connect(A,0,3),V.connect(q).connect(A,0,4),V.connect(F).connect(A,0,5),A.connect(I).connect(h.destination)},()=>{D.disconnect(k),a(D,V,0,0),V.disconnect(O),O.disconnect(A),V.disconnect(M),M.disconnect(A),V.disconnect(E),E.disconnect(A),V.disconnect(R),R.disconnect(A),V.disconnect(q),q.disconnect(A),V.disconnect(F),F.disconnect(A),A.disconnect(I),I.disconnect(h.destination)})})($,At,Es,Qt,Yt,nn,Ht,et,As),rn=(an=on,(t,e)=>{const s=t.createPanner();return void 0===s.orientationX?an(t,e):(It(s,e),Nt(s,e,"orientationX"),Nt(s,e,"orientationY"),Nt(s,e,"orientationZ"),Nt(s,e,"positionX"),Nt(s,e,"positionY"),Nt(s,e,"positionZ"),Ft(s,e,"coneInnerAngle"),Ft(s,e,"coneOuterAngle"),Ft(s,e,"coneOuterGain"),Ft(s,e,"distanceModel"),Ft(s,e,"maxDistance"),Ft(s,e,"panningModel"),Ft(s,e,"refDistance"),Ft(s,e,"rolloffFactor"),s)});var an;const cn=((t,e,s,n,i,o,r)=>class extends t{constructor(t,a){const c=i(t),h={...Kt,...a},u=s(c,h),l=o(c);super(t,!1,u,l?n():null),this._nativePannerNode=u,this._orientationX=e(this,l,u.orientationX,N,V),this._orientationY=e(this,l,u.orientationY,N,V),this._orientationZ=e(this,l,u.orientationZ,N,V),this._positionX=e(this,l,u.positionX,N,V),this._positionY=e(this,l,u.positionY,N,V),this._positionZ=e(this,l,u.positionZ,N,V),r(this,1)}get coneInnerAngle(){return this._nativePannerNode.coneInnerAngle}set coneInnerAngle(t){this._nativePannerNode.coneInnerAngle=t}get coneOuterAngle(){return this._nativePannerNode.coneOuterAngle}set coneOuterAngle(t){this._nativePannerNode.coneOuterAngle=t}get coneOuterGain(){return this._nativePannerNode.coneOuterGain}set coneOuterGain(t){this._nativePannerNode.coneOuterGain=t}get distanceModel(){return this._nativePannerNode.distanceModel}set distanceModel(t){this._nativePannerNode.distanceModel=t}get maxDistance(){return this._nativePannerNode.maxDistance}set maxDistance(t){this._nativePannerNode.maxDistance=t}get orientationX(){return this._orientationX}get orientationY(){return this._orientationY}get orientationZ(){return this._orientationZ}get panningModel(){return this._nativePannerNode.panningModel}set panningModel(t){this._nativePannerNode.panningModel=t}get positionX(){return this._positionX}get positionY(){return this._positionY}get positionZ(){return this._positionZ}get refDistance(){return this._nativePannerNode.refDistance}set refDistance(t){this._nativePannerNode.refDistance=t}get rolloffFactor(){return this._nativePannerNode.rolloffFactor}set rolloffFactor(t){this._nativePannerNode.rolloffFactor=t}})(Ze,ps,rn,((t,e,s,n,i,o,r,a,c,h)=>()=>{const u=new WeakMap;let l=null;return{render(p,d,f){const _=u.get(d);return void 0!==_?Promise.resolve(_):(async(p,d,f)=>{let _=null,m=o(p);const g={channelCount:m.channelCount,channelCountMode:m.channelCountMode,channelInterpretation:m.channelInterpretation},v={...g,coneInnerAngle:m.coneInnerAngle,coneOuterAngle:m.coneOuterAngle,coneOuterGain:m.coneOuterGain,distanceModel:m.distanceModel,maxDistance:m.maxDistance,panningModel:m.panningModel,refDistance:m.refDistance,rolloffFactor:m.rolloffFactor},y=E(m,d);if("bufferSize"in m)_=n(d,{...g,gain:1});else if(!y){const t={...v,orientationX:m.orientationX.value,orientationY:m.orientationY.value,orientationZ:m.orientationZ.value,positionX:m.positionX.value,positionY:m.positionY.value,positionZ:m.positionZ.value};m=i(d,t)}if(u.set(d,null===_?m:_),null!==_){if(null===l){if(null===r)throw new Error("Missing the native OfflineAudioContext constructor.");const t=new r(6,p.context.length,d.sampleRate),n=e(t,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:6});n.connect(t.destination),l=(async()=>{const e=await Promise.all([p.orientationX,p.orientationY,p.orientationZ,p.positionX,p.positionY,p.positionZ].map(async(e,n)=>{const i=s(t,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:0===n?1:0});return await a(t,e,i.offset,f),i}));for(let t=0;t<6;t+=1)e[t].connect(n,0,t),e[t].start(0);return h(t)})()}const t=await l,o=n(d,{...g,gain:1});await c(p,d,o,f);const u=[];for(let e=0;e<t.numberOfChannels;e+=1)u.push(t.getChannelData(e));let m=[u[0][0],u[1][0],u[2][0]],y=[u[3][0],u[4][0],u[5][0]],x=n(d,{...g,gain:1}),w=i(d,{...v,orientationX:m[0],orientationY:m[1],orientationZ:m[2],positionX:y[0],positionY:y[1],positionZ:y[2]});o.connect(x).connect(w.inputs[0]),w.connect(_);for(let e=128;e<t.length;e+=128){const t=[u[0][e],u[1][e],u[2][e]],s=[u[3][e],u[4][e],u[5][e]];if(t.some((t,e)=>t!==m[e])||s.some((t,e)=>t!==y[e])){m=t,y=s;const r=e/d.sampleRate;x.gain.setValueAtTime(0,r),x=n(d,{...g,gain:0}),w=i(d,{...v,orientationX:m[0],orientationY:m[1],orientationZ:m[2],positionX:y[0],positionY:y[1],positionZ:y[2]}),x.gain.setValueAtTime(1,r),o.connect(x).connect(w.inputs[0]),w.connect(_)}}return _}return y?(await t(d,p.orientationX,m.orientationX,f),await t(d,p.orientationY,m.orientationY,f),await t(d,p.orientationZ,m.orientationZ,f),await t(d,p.positionX,m.positionX,f),await t(d,p.positionY,m.positionY,f),await t(d,p.positionZ,m.positionZ,f)):(await a(d,p.orientationX,m.orientationX,f),await a(d,p.orientationY,m.orientationY,f),await a(d,p.orientationZ,m.orientationZ,f),await a(d,p.positionX,m.positionX,f),await a(d,p.positionY,m.positionY,f),await a(d,p.positionZ,m.positionZ,f)),H(m)?await c(p,d,m.inputs[0],f):await c(p,d,m,f),m})(p,d,f)}}})(as,Es,Is,Qt,rn,st,Ve,us,Oe,Us),Fe,Ne,gs),hn=((t,e,s,n)=>class i{constructor(i,o){const r=e(i),a=n({...te,...o}),c=t(r,a);return s.add(c),c}static[Symbol.hasInstance](t){return null!==t&&"object"==typeof t&&Object.getPrototypeOf(t)===i.prototype||s.has(t)}})((t=>(e,{disableNormalization:s,imag:n,real:i})=>{const o=n instanceof Float32Array?n:new Float32Array(n),r=i instanceof Float32Array?i:new Float32Array(i),a=e.createPeriodicWave(r,o,{disableNormalization:s});if(Array.from(n).length<2)throw t();return a})(q),Fe,new WeakSet,t=>{const{imag:e,real:s}=t;return void 0===e?void 0===s?{...t,imag:[0,0],real:[0,0]}:{...t,imag:Array.from(s,()=>0),real:s}:void 0===s?{...t,imag:e,real:Array.from(e,()=>0)}:{...t,imag:e,real:s}}),un=((t,e)=>(s,n)=>{const i=n.channelCountMode;if("clamped-max"===i)throw e();if(void 0===s.createStereoPanner)return t(s,n);const o=s.createStereoPanner();return It(o,n),Nt(o,n,"pan"),Object.defineProperty(o,"channelCountMode",{get:()=>i,set:t=>{if(t!==i)throw e()}}),o})(((t,e,s,n,i,o)=>{const r=new Float32Array([1,1]),a=Math.PI/2,c={channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete"},h={...c,oversample:"none"},u=(t,o,u,l,p)=>{if(1===o)return((t,e,i,o)=>{const u=new Float32Array(16385),l=new Float32Array(16385);for(let t=0;t<16385;t+=1){const e=t/16384*a;u[t]=Math.cos(e),l[t]=Math.sin(e)}const p=s(t,{...c,gain:0}),d=n(t,{...h,curve:u}),f=n(t,{...h,curve:r}),_=s(t,{...c,gain:0}),m=n(t,{...h,curve:l});return{connectGraph(){e.connect(p),e.connect(void 0===f.inputs?f:f.inputs[0]),e.connect(_),f.connect(i),i.connect(void 0===d.inputs?d:d.inputs[0]),i.connect(void 0===m.inputs?m:m.inputs[0]),d.connect(p.gain),m.connect(_.gain),p.connect(o,0,0),_.connect(o,0,1)},disconnectGraph(){e.disconnect(p),e.disconnect(void 0===f.inputs?f:f.inputs[0]),e.disconnect(_),f.disconnect(i),i.disconnect(void 0===d.inputs?d:d.inputs[0]),i.disconnect(void 0===m.inputs?m:m.inputs[0]),d.disconnect(p.gain),m.disconnect(_.gain),p.disconnect(o,0,0),_.disconnect(o,0,1)}}})(t,u,l,p);if(2===o)return((t,i,o,u)=>{const l=new Float32Array(16385),p=new Float32Array(16385),d=new Float32Array(16385),f=new Float32Array(16385),_=Math.floor(8192.5);for(let t=0;t<16385;t+=1)if(t>_){const e=(t-_)/(16384-_)*a;l[t]=Math.cos(e),p[t]=Math.sin(e),d[t]=0,f[t]=1}else{const e=t/(16384-_)*a;l[t]=1,p[t]=0,d[t]=Math.cos(e),f[t]=Math.sin(e)}const m=e(t,{channelCount:2,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:2}),g=s(t,{...c,gain:0}),v=n(t,{...h,curve:l}),y=s(t,{...c,gain:0}),x=n(t,{...h,curve:p}),w=n(t,{...h,curve:r}),b=s(t,{...c,gain:0}),T=n(t,{...h,curve:d}),S=s(t,{...c,gain:0}),k=n(t,{...h,curve:f});return{connectGraph(){i.connect(m),i.connect(void 0===w.inputs?w:w.inputs[0]),m.connect(g,0),m.connect(y,0),m.connect(b,1),m.connect(S,1),w.connect(o),o.connect(void 0===v.inputs?v:v.inputs[0]),o.connect(void 0===x.inputs?x:x.inputs[0]),o.connect(void 0===T.inputs?T:T.inputs[0]),o.connect(void 0===k.inputs?k:k.inputs[0]),v.connect(g.gain),x.connect(y.gain),T.connect(b.gain),k.connect(S.gain),g.connect(u,0,0),b.connect(u,0,0),y.connect(u,0,1),S.connect(u,0,1)},disconnectGraph(){i.disconnect(m),i.disconnect(void 0===w.inputs?w:w.inputs[0]),m.disconnect(g,0),m.disconnect(y,0),m.disconnect(b,1),m.disconnect(S,1),w.disconnect(o),o.disconnect(void 0===v.inputs?v:v.inputs[0]),o.disconnect(void 0===x.inputs?x:x.inputs[0]),o.disconnect(void 0===T.inputs?T:T.inputs[0]),o.disconnect(void 0===k.inputs?k:k.inputs[0]),v.disconnect(g.gain),x.disconnect(y.gain),T.disconnect(b.gain),k.disconnect(S.gain),g.disconnect(u,0,0),b.disconnect(u,0,0),y.disconnect(u,0,1),S.disconnect(u,0,1)}}})(t,u,l,p);throw i()};return(e,{channelCount:n,channelCountMode:r,pan:a,...c})=>{if("max"===r)throw i();const h=t(e,{...c,channelCount:1,channelCountMode:r,numberOfInputs:2}),l=s(e,{...c,channelCount:n,channelCountMode:r,gain:1}),p=s(e,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:a});let{connectGraph:d,disconnectGraph:f}=u(e,n,l,p,h);Object.defineProperty(p.gain,"defaultValue",{get:()=>0}),Object.defineProperty(p.gain,"maxValue",{get:()=>1}),Object.defineProperty(p.gain,"minValue",{get:()=>-1});const _={get bufferSize(){},get channelCount(){return l.channelCount},set channelCount(t){l.channelCount!==t&&(m&&f(),({connectGraph:d,disconnectGraph:f}=u(e,t,l,p,h)),m&&d()),l.channelCount=t},get channelCountMode(){return l.channelCountMode},set channelCountMode(t){if("clamped-max"===t||"max"===t)throw i();l.channelCountMode=t},get channelInterpretation(){return l.channelInterpretation},set channelInterpretation(t){l.channelInterpretation=t},get context(){return l.context},get inputs(){return[l]},get numberOfInputs(){return l.numberOfInputs},get numberOfOutputs(){return l.numberOfOutputs},get pan(){return p.gain},addEventListener:(...t)=>l.addEventListener(t[0],t[1],t[2]),dispatchEvent:(...t)=>l.dispatchEvent(t[0]),removeEventListener:(...t)=>l.removeEventListener(t[0],t[1],t[2])};let m=!1;return o(Gt(_,h),()=>{d(),m=!0},()=>{f(),m=!1})}})(Es,Wt,Qt,nn,Ht,As),Ht),ln=((t,e,s,n,i,o)=>class extends t{constructor(t,r){const a=i(t),c={...ee,...r},h=s(a,c),u=o(a);super(t,!1,h,u?n():null),this._pan=e(this,u,h.pan)}get pan(){return this._pan}})(Ze,ps,un,((t,e,s,n,i)=>()=>{const o=new WeakMap;return{render(r,a,c){const h=o.get(a);return void 0!==h?Promise.resolve(h):(async(r,a,c)=>{let h=s(r);const u=E(h,a);if(!u){const t={channelCount:h.channelCount,channelCountMode:h.channelCountMode,channelInterpretation:h.channelInterpretation,pan:h.pan.value};h=e(a,t)}return o.set(a,h),u?await t(a,r.pan,h.pan,c):await n(a,r.pan,h.pan,c),H(h)?await i(r,a,h.inputs[0],c):await i(r,a,h,c),h})(r,a,c)}}})(as,un,st,us,Oe),Fe,Ne),pn=((t,e,s)=>()=>{const n=new WeakMap;return{render(i,o,r){const a=n.get(o);return void 0!==a?Promise.resolve(a):(async(i,o,r)=>{let a=e(i);if(!E(a,o)){const e={channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,curve:a.curve,oversample:a.oversample};a=t(o,e)}return n.set(o,a),H(a)?await s(i,o,a.inputs[0],r):await s(i,o,a,r),a})(i,o,r)}}})(nn,st,Oe),dn=((t,e,s,n,i,o,r)=>class extends t{constructor(t,e){const a=i(t),c={...ne,...e},h=s(a,c);super(t,!0,h,o(a)?n():null),this._isCurveNullified=!1,this._nativeWaveShaperNode=h,r(this,1)}get curve(){return this._isCurveNullified?null:this._nativeWaveShaperNode.curve}set curve(t){if(null===t)this._isCurveNullified=!0,this._nativeWaveShaperNode.curve=new Float32Array([0,0]);else{if(t.length<2)throw e();this._isCurveNullified=!1,this._nativeWaveShaperNode.curve=t}}get oversample(){return this._nativeWaveShaperNode.oversample}set oversample(t){this._nativeWaveShaperNode.oversample=t}})(Ze,At,nn,pn,Fe,Ne,gs),fn=(t=>null!==t&&t.isSecureContext)(Te),_n=(t=>(e,s,n)=>{Object.defineProperties(t,{currentFrame:{configurable:!0,get:()=>Math.round(e*s)},currentTime:{configurable:!0,get:()=>e}});try{return n()}finally{null!==t&&(delete t.currentFrame,delete t.currentTime)}})(Te),mn=new WeakMap,gn=((t,e)=>s=>{let n=t.get(s);if(void 0!==n)return n;if(null===e)throw new Error("Missing the native OfflineAudioContext constructor.");return n=new e(1,1,8e3),t.set(s,n),n})(mn,Ve),vn=(t=>null===t?null:t.hasOwnProperty("AudioWorkletNode")?t.AudioWorkletNode:null)(Te),yn=fn?((t,e,s,n,i,o,r,a,c,h,u,l)=>(p,d,f={credentials:"omit"})=>{const m=o(p);if(void 0!==m.audioWorklet)return Promise.all([i(d),Promise.resolve(t(u,u))]).then(([[t,e],s])=>{const[n,i]=y(t,e),o=s?i:i.replace(/\s+extends\s+AudioWorkletProcessor\s*{/," extends (class extends AudioWorkletProcessor {__b=new WeakSet();constructor(){super();(p=>p.postMessage=(q=>(m,t)=>q.call(p,m,t?t.filter(u=>!this.__b.has(u)):t))(p.postMessage))(this.port)}}){"),c=new Blob([`${n};(registerProcessor=>{${o}\n})((n,p)=>registerProcessor(n,class extends p{${s?"":"__c = (a) => a.forEach(e=>this.__b.add(e.buffer));"}process(i,o,p){${s?"":"i.forEach(this.__c);o.forEach(this.__c);this.__c(Object.values(p));"}return super.process(i.map(j=>j.some(k=>k.length===0)?[]:j),o,p)}}))`],{type:"application/javascript; charset=utf-8"}),h=URL.createObjectURL(c);return m.audioWorklet.addModule(h,f).then(()=>{if(a(m))return;return r(m).audioWorklet.addModule(h,f)}).finally(()=>URL.revokeObjectURL(h))});const g=h.get(p);if(void 0!==g&&g.has(d))return Promise.resolve();const v=c.get(p);if(void 0!==v){const t=v.get(d);if(void 0!==t)return t}const b=i(d).then(([t,e])=>{const[n,i]=y(t,e);return s(`${n};((a,b)=>{(a[b]=a[b]||[]).push((AudioWorkletProcessor,global,registerProcessor,sampleRate,self,window)=>{${i}\n})})(window,'_AWGS')`)}).then(()=>{const t=l._AWGS.pop();if(void 0===t)throw new SyntaxError;n(m.currentTime,m.sampleRate,()=>t(class{},void 0,(t,s)=>{if(""===t.trim())throw e();const n=_.get(m);if(void 0!==n){if(n.has(t))throw e();w(s),x(s.parameterDescriptors),n.set(t,s)}else w(s),x(s.parameterDescriptors),_.set(m,new Map([[t,s]]))},m.sampleRate,void 0,void 0))});return void 0===v?c.set(p,new Map([[d,b]])):v.set(d,b),b.then(()=>{const t=h.get(p);void 0===t?h.set(p,new Set([d])):t.add(d)}).finally(()=>{const t=c.get(p);void 0!==t&&t.delete(d)}),b})(xe,Ht,(t=>e=>new Promise((s,n)=>{if(null===t)return void n(new SyntaxError);const i=t.document.head;if(null===i)n(new SyntaxError);else{const o=t.document.createElement("script"),r=new Blob([e],{type:"application/javascript"}),a=URL.createObjectURL(r),c=t.onerror,h=()=>{t.onerror=c,URL.revokeObjectURL(a)};t.onerror=(e,s,i,o,r)=>s===a||s===t.location.href&&1===i&&1===o?(h(),n(r),!1):null!==c?c(e,s,i,o,r):void 0,o.onerror=()=>{h(),n(new SyntaxError)},o.onload=()=>{h(),s()},o.src=a,o.type="module",i.appendChild(o)}}))(Te),_n,(t=>async e=>{try{const t=await fetch(e);if(t.ok)return[await t.text(),t.url]}catch{}throw t()})(()=>new DOMException("","AbortError")),Fe,gn,Ne,new WeakMap,new WeakMap,((t,e)=>async()=>{if(null===t)return!0;if(null===e)return!1;const s=new Blob(['class A extends AudioWorkletProcessor{process(i){this.port.postMessage(i,[i[0][0].buffer])}}registerProcessor("a",A)'],{type:"application/javascript; charset=utf-8"}),n=new e(1,128,8e3),i=URL.createObjectURL(s);let o=!1,r=!1;try{await n.audioWorklet.addModule(i);const e=new t(n,"a",{numberOfOutputs:0}),s=n.createOscillator();e.port.onmessage=()=>o=!0,e.onprocessorerror=()=>r=!0,s.connect(e),await n.startRendering()}catch{}finally{URL.revokeObjectURL(i)}return o&&!r})(vn,Ve),Te):void 0,xn=((t,e)=>s=>t(s)||e(s))(We,Ne),wn=((t,e,s,n,i,o,r,a,c,h,u,l,p,d,f,_,m,g,v,y)=>class extends f{constructor(e,s){super(e,s),this._nativeContext=e,this._audioWorklet=void 0===t?void 0:{addModule:(e,s)=>t(this,e,s)}}get audioWorklet(){return this._audioWorklet}createAnalyser(){return new e(this)}createBiquadFilter(){return new i(this)}createBuffer(t,e,n){return new s({length:e,numberOfChannels:t,sampleRate:n})}createBufferSource(){return new n(this)}createChannelMerger(t=6){return new o(this,{numberOfInputs:t})}createChannelSplitter(t=6){return new r(this,{numberOfOutputs:t})}createConstantSource(){return new a(this)}createConvolver(){return new c(this)}createDelay(t=1){return new u(this,{maxDelayTime:t})}createDynamicsCompressor(){return new l(this)}createGain(){return new p(this)}createIIRFilter(t,e){return new d(this,{feedback:e,feedforward:t})}createOscillator(){return new _(this)}createPanner(){return new m(this)}createPeriodicWave(t,e,s={disableNormalization:!1}){return new g(this,{...s,imag:e,real:t})}createStereoPanner(){return new v(this)}createWaveShaper(){return new y(this)}decodeAudioData(t,e,s){return h(this._nativeContext,t).then(t=>("function"==typeof e&&e(t),t)).catch(t=>{throw"function"==typeof s&&s(t),t})}})(yn,Ye,ss,fs,vs,Rs,qs,Vs,Ps,((t,e,s,n,i,o,r,a,c,h,u)=>(l,p)=>{const d=r(l)?l:o(l);if(i.has(p)){const t=s();return Promise.reject(t)}try{i.add(p)}catch{}return e(c,()=>c(d))?d.decodeAudioData(p).then(s=>(e(a,()=>a(s))||u(s),t.add(s),s)):new Promise((e,s)=>{const i=()=>{try{(t=>{const{port1:e}=new MessageChannel;e.postMessage(t,[t])})(p)}catch{}},o=t=>{s(t),i()};try{d.decodeAudioData(p,s=>{"function"!=typeof s.copyFromChannel&&(h(s),F(s)),t.add(s),i(),e(s)},t=>{o(null===t?n():t)})}catch(t){o(t)}})})(He,xe,()=>new DOMException("","DataCloneError"),()=>new DOMException("","EncodingError"),new WeakSet,Fe,xn,R,Rt,ts,es),js,Bs,Ws,Xs,$s,Ks,cn,hn,ln,dn),bn=((t,e,s,n)=>class extends t{constructor(t,i){const o=s(t),r=e(o,i);if(n(o))throw TypeError();super(t,!0,r,null),this._nativeMediaElementAudioSourceNode=r}get mediaElement(){return this._nativeMediaElementAudioSourceNode.mediaElement}})(Ze,(t,e)=>t.createMediaElementSource(e.mediaElement),Fe,Ne),Tn=((t,e,s,n)=>class extends t{constructor(t,i){const o=s(t);if(n(o))throw new TypeError;const r={...Et,...i},a=e(o,r);super(t,!1,a,null),this._nativeMediaStreamAudioDestinationNode=a}get stream(){return this._nativeMediaStreamAudioDestinationNode.stream}})(Ze,(t,e)=>{const s=t.createMediaStreamDestination();return It(s,e),1===s.numberOfOutputs&&Object.defineProperty(s,"numberOfOutputs",{get:()=>0}),s},Fe,Ne),Sn=((t,e,s,n)=>class extends t{constructor(t,i){const o=s(t),r=e(o,i);if(n(o))throw new TypeError;super(t,!0,r,null),this._nativeMediaStreamAudioSourceNode=r}get mediaStream(){return this._nativeMediaStreamAudioSourceNode.mediaStream}})(Ze,(t,{mediaStream:e})=>{const s=e.getAudioTracks();s.sort((t,e)=>t.id<e.id?-1:t.id>e.id?1:0);const n=s.slice(0,1),i=t.createMediaStreamSource(new MediaStream(n));return Object.defineProperty(i,"mediaStream",{value:e}),i},Fe,Ne),kn=((t,e,s)=>class extends t{constructor(t,n){const i=s(t);super(t,!0,e(i,n),null)}})(Ze,((t,e)=>(s,{mediaStreamTrack:n})=>{if("function"==typeof s.createMediaStreamTrackSource)return s.createMediaStreamTrackSource(n);const i=new MediaStream([n]),o=s.createMediaStreamSource(i);if("audio"!==n.kind)throw t();if(e(s))throw new TypeError;return o})(At,Ne),Fe),Cn=((t,e,s,n,i,o,r,a,c)=>class extends t{constructor(t={}){if(null===c)throw new Error("Missing the native AudioContext constructor.");const e=new c(t);if(null===e)throw n();if(!G(t.latencyHint))throw new TypeError(`The provided value '${t.latencyHint}' is not a valid enum value of type AudioContextLatencyCategory.`);if(void 0!==t.sampleRate&&e.sampleRate!==t.sampleRate)throw s();super(e,2);const{latencyHint:i}=t,{sampleRate:o}=e;if(this._baseLatency="number"==typeof e.baseLatency?e.baseLatency:"balanced"===i?512/o:"interactive"===i||void 0===i?256/o:"playback"===i?1024/o:128*Math.max(2,Math.min(128,Math.round(i*o/128)))/o,this._nativeAudioContext=e,"webkitAudioContext"===c.name?(this._nativeGainNode=e.createGain(),this._nativeOscillatorNode=e.createOscillator(),this._nativeGainNode.gain.value=1e-37,this._nativeOscillatorNode.connect(this._nativeGainNode).connect(e.destination),this._nativeOscillatorNode.start()):(this._nativeGainNode=null,this._nativeOscillatorNode=null),this._state=null,"running"===e.state){this._state="suspended";const t=()=>{"suspended"===this._state&&(this._state=null),e.removeEventListener("statechange",t)};e.addEventListener("statechange",t)}}get baseLatency(){return this._baseLatency}get state(){return null!==this._state?this._state:this._nativeAudioContext.state}close(){return"closed"===this.state?this._nativeAudioContext.close().then(()=>{throw e()}):("suspended"===this._state&&(this._state=null),this._nativeAudioContext.close().then(()=>{null!==this._nativeGainNode&&null!==this._nativeOscillatorNode&&(this._nativeOscillatorNode.stop(),this._nativeGainNode.disconnect(),this._nativeOscillatorNode.disconnect()),W(this)}))}createMediaElementSource(t){return new i(this,{mediaElement:t})}createMediaStreamDestination(){return new o(this)}createMediaStreamSource(t){return new r(this,{mediaStream:t})}createMediaStreamTrackSource(t){return new a(this,{mediaStreamTrack:t})}resume(){return"suspended"===this._state?new Promise((t,e)=>{const s=()=>{this._nativeAudioContext.removeEventListener("statechange",s),"running"===this._nativeAudioContext.state?t():this.resume().then(t,e)};this._nativeAudioContext.addEventListener("statechange",s)}):this._nativeAudioContext.resume().catch(t=>{if(void 0===t||15===t.code)throw e();throw t})}suspend(){return this._nativeAudioContext.suspend().catch(t=>{if(void 0===t)throw e();throw t})}})(wn,At,Ht,se,bn,Tn,Sn,kn,Be),An=(Dn=Hs,t=>{const e=Dn.get(t);if(void 0===e)throw new Error("The context has no set of AudioWorkletNodes.");return e});var Dn;const On=(Mn=An,(t,e)=>{Mn(t).add(e)});var Mn;const En=(t=>(e,s,n=0,i=0)=>{const o=e[n];if(void 0===o)throw t();return ct(s)?o.connect(s,0,i):o.connect(s,0)})(q),Rn=(t=>(e,s)=>{t(e).delete(s)})(An),qn=(t=>(e,s,n,i=0)=>void 0===s?e.forEach(t=>t.disconnect()):"number"==typeof s?St(t,e,s).disconnect():ct(s)?void 0===n?e.forEach(t=>t.disconnect(s)):void 0===i?St(t,e,n).disconnect(s,0):St(t,e,n).disconnect(s,0,i):void 0===n?e.forEach(t=>t.disconnect(s)):St(t,e,n).disconnect(s,0))(q),Fn=new WeakMap,In=((t,e)=>s=>e(t,s))(Fn,b),Vn=((t,e,s,n,i,o,r,a,c,h,u,l,p)=>(d,f,_,g)=>{if(0===g.numberOfInputs&&0===g.numberOfOutputs)throw c();const v=Array.isArray(g.outputChannelCount)?g.outputChannelCount:Array.from(g.outputChannelCount);if(v.some(t=>t<1))throw c();if(v.length!==g.numberOfOutputs)throw e();if("explicit"!==g.channelCountMode)throw c();const y=g.channelCount*g.numberOfInputs,x=v.reduce((t,e)=>t+e,0),w=void 0===_.parameterDescriptors?0:_.parameterDescriptors.length;if(y+w>6||x>6)throw c();const b=new MessageChannel,T=[],S=[];for(let t=0;t<g.numberOfInputs;t+=1)T.push(r(d,{channelCount:g.channelCount,channelCountMode:g.channelCountMode,channelInterpretation:g.channelInterpretation,gain:1})),S.push(i(d,{channelCount:g.channelCount,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:g.channelCount}));const k=[];if(void 0!==_.parameterDescriptors)for(const{defaultValue:t,maxValue:e,minValue:s,name:n}of _.parameterDescriptors){const i=o(d,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:void 0!==g.parameterData[n]?g.parameterData[n]:void 0===t?0:t});Object.defineProperties(i.offset,{defaultValue:{get:()=>void 0===t?0:t},maxValue:{get:()=>void 0===e?N:e},minValue:{get:()=>void 0===s?V:s}}),k.push(i)}const C=n(d,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:Math.max(1,y+w)}),A=Lt(f,d.sampleRate),D=a(d,A,y+w,Math.max(1,x)),O=i(d,{channelCount:Math.max(1,x),channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:Math.max(1,x)}),M=[];for(let t=0;t<g.numberOfOutputs;t+=1)M.push(n(d,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:v[t]}));for(let t=0;t<g.numberOfInputs;t+=1){T[t].connect(S[t]);for(let e=0;e<g.channelCount;e+=1)S[t].connect(C,e,t*g.channelCount+e)}const E=new pt(void 0===_.parameterDescriptors?[]:_.parameterDescriptors.map(({name:t},e)=>{const s=k[e];return s.connect(C,0,y+e),s.start(0),[t,s.offset]}));C.connect(D);let R=g.channelInterpretation,q=null;const F=0===g.numberOfOutputs?[D]:M,I={get bufferSize(){return A},get channelCount(){return g.channelCount},set channelCount(t){throw s()},get channelCountMode(){return g.channelCountMode},set channelCountMode(t){throw s()},get channelInterpretation(){return R},set channelInterpretation(t){for(const e of T)e.channelInterpretation=t;R=t},get context(){return D.context},get inputs(){return T},get numberOfInputs(){return g.numberOfInputs},get numberOfOutputs(){return g.numberOfOutputs},get onprocessorerror(){return q},set onprocessorerror(t){"function"==typeof q&&I.removeEventListener("processorerror",q),q="function"==typeof t?t:null,"function"==typeof q&&I.addEventListener("processorerror",q)},get parameters(){return E},get port(){return b.port2},addEventListener:(...t)=>D.addEventListener(t[0],t[1],t[2]),connect:t.bind(null,F),disconnect:h.bind(null,F),dispatchEvent:(...t)=>D.dispatchEvent(t[0]),removeEventListener:(...t)=>D.removeEventListener(t[0],t[1],t[2])},P=new Map;var j,L;b.port1.addEventListener=(j=b.port1.addEventListener,(...t)=>{if("message"===t[0]){const e="function"==typeof t[1]?t[1]:"object"==typeof t[1]&&null!==t[1]&&"function"==typeof t[1].handleEvent?t[1].handleEvent:null;if(null!==e){const s=P.get(t[1]);void 0!==s?t[1]=s:(t[1]=t=>{u(d.currentTime,d.sampleRate,()=>e(t))},P.set(e,t[1]))}}return j.call(b.port1,t[0],t[1],t[2])}),b.port1.removeEventListener=(L=b.port1.removeEventListener,(...t)=>{if("message"===t[0]){const e=P.get(t[1]);void 0!==e&&(P.delete(t[1]),t[1]=e)}return L.call(b.port1,t[0],t[1],t[2])});let z=null;Object.defineProperty(b.port1,"onmessage",{get:()=>z,set:t=>{"function"==typeof z&&b.port1.removeEventListener("message",z),z="function"==typeof t?t:null,"function"==typeof z&&(b.port1.addEventListener("message",z),b.port1.start())}}),_.prototype.port=b.port1;let B=null;((t,e,s,n)=>{let i=m.get(t);void 0===i&&(i=new WeakMap,m.set(t,i));const o=zt(s,n);return i.set(e,o),o})(d,I,_,g).then(t=>B=t);const W=mt(g.numberOfInputs,g.channelCount),G=mt(g.numberOfOutputs,v),U=void 0===_.parameterDescriptors?[]:_.parameterDescriptors.reduce((t,{name:e})=>({...t,[e]:new Float32Array(128)}),{});let Q=!0;const Z=()=>{g.numberOfOutputs>0&&D.disconnect(O);for(let t=0,e=0;t<g.numberOfOutputs;t+=1){const s=M[t];for(let n=0;n<v[t];n+=1)O.disconnect(s,e+n,n);e+=v[t]}},X=new Map;D.onaudioprocess=({inputBuffer:t,outputBuffer:e})=>{if(null!==B){const s=l(I);for(let n=0;n<A;n+=128){for(let e=0;e<g.numberOfInputs;e+=1)for(let s=0;s<g.channelCount;s+=1)ft(t,W[e],s,s,n);void 0!==_.parameterDescriptors&&_.parameterDescriptors.forEach(({name:e},s)=>{ft(t,U,e,y+s,n)});for(let t=0;t<g.numberOfInputs;t+=1)for(let e=0;e<v[t];e+=1)0===G[t][e].byteLength&&(G[t][e]=new Float32Array(128));try{const t=W.map((t,e)=>{if(s[e].size>0)return X.set(e,A/128),t;const n=X.get(e);return void 0===n?[]:(t.every(t=>t.every(t=>0===t))&&(1===n?X.delete(e):X.set(e,n-1)),t)}),i=u(d.currentTime+n/d.sampleRate,d.sampleRate,()=>B.process(t,G,U));Q=i;for(let t=0,s=0;t<g.numberOfOutputs;t+=1){for(let i=0;i<v[t];i+=1)_t(e,G[t],i,s+i,n);s+=v[t]}}catch(t){Q=!1,I.dispatchEvent(new ErrorEvent("processorerror",{colno:t.colno,filename:t.filename,lineno:t.lineno,message:t.message}))}if(!Q){for(let t=0;t<g.numberOfInputs;t+=1){T[t].disconnect(S[t]);for(let e=0;e<g.channelCount;e+=1)S[n].disconnect(C,e,t*g.channelCount+e)}if(void 0!==_.parameterDescriptors){const t=_.parameterDescriptors.length;for(let e=0;e<t;e+=1){const t=k[e];t.disconnect(C,0,y+e),t.stop()}}C.disconnect(D),D.onaudioprocess=null,Y?Z():J();break}}}};let Y=!1;const H=r(d,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0}),$=()=>D.connect(H).connect(d.destination),J=()=>{D.disconnect(H),H.disconnect()};return $(),p(I,()=>{if(Q){J(),g.numberOfOutputs>0&&D.connect(O);for(let t=0,e=0;t<g.numberOfOutputs;t+=1){const s=M[t];for(let n=0;n<v[t];n+=1)O.connect(s,e+n,n);e+=v[t]}}Y=!0},()=>{Q&&($(),Z()),Y=!1})})(En,q,At,Es,Wt,Is,Qt,Yt,Ht,qn,_n,In,As),Nn=((t,e,s,n,i)=>(o,r,a,c,h,u)=>{if(null!==a)try{const e=new a(o,c,u),n=new Map;let r=null;if(Object.defineProperties(e,{channelCount:{get:()=>u.channelCount,set:()=>{throw t()}},channelCountMode:{get:()=>"explicit",set:()=>{throw t()}},onprocessorerror:{get:()=>r,set:t=>{"function"==typeof r&&e.removeEventListener("processorerror",r),r="function"==typeof t?t:null,"function"==typeof r&&e.addEventListener("processorerror",r)}}}),e.addEventListener=(p=e.addEventListener,(...t)=>{if("processorerror"===t[0]){const e="function"==typeof t[1]?t[1]:"object"==typeof t[1]&&null!==t[1]&&"function"==typeof t[1].handleEvent?t[1].handleEvent:null;if(null!==e){const s=n.get(t[1]);void 0!==s?t[1]=s:(t[1]=s=>{"error"===s.type?(Object.defineProperties(s,{type:{value:"processorerror"}}),e(s)):e(new ErrorEvent(t[0],{...s}))},n.set(e,t[1]))}}return p.call(e,"error",t[1],t[2]),p.call(e,...t)}),e.removeEventListener=(l=e.removeEventListener,(...t)=>{if("processorerror"===t[0]){const e=n.get(t[1]);void 0!==e&&(n.delete(t[1]),t[1]=e)}return l.call(e,"error",t[1],t[2]),l.call(e,t[0],t[1],t[2])}),0!==u.numberOfOutputs){const t=s(o,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});e.connect(t).connect(o.destination);return i(e,()=>t.disconnect(),()=>t.connect(o.destination))}return e}catch(t){if(11===t.code)throw n();throw t}var l,p;if(void 0===h)throw n();return(t=>{const{port1:e}=new MessageChannel;try{e.postMessage(t)}finally{e.close()}})(u),e(o,r,h,u)})(At,Vn,Qt,Ht,As),Pn=((t,e,s,n,i,o,r,a,c,h,u,l,p,d,f,_)=>(m,g,v)=>{const y=new WeakMap;let x=null;return{render(w,b,T){a(b,w);const S=y.get(b);return void 0!==S?Promise.resolve(S):(async(a,w,b)=>{let T=u(a),S=null;const k=E(T,w),C=Array.isArray(g.outputChannelCount)?g.outputChannelCount:Array.from(g.outputChannelCount);if(null===l){const t=C.reduce((t,e)=>t+e,0),s=i(w,{channelCount:Math.max(1,t),channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:Math.max(1,t)}),o=[];for(let t=0;t<a.numberOfOutputs;t+=1)o.push(n(w,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:C[t]}));const h=r(w,{channelCount:g.channelCount,channelCountMode:g.channelCountMode,channelInterpretation:g.channelInterpretation,gain:1});h.connect=e.bind(null,o),h.disconnect=c.bind(null,o),S=[s,o,h]}else k||(T=new l(w,m));if(y.set(w,null===S?T:S[2]),null!==S){if(null===x){if(void 0===v)throw new Error("Missing the processor constructor.");if(null===p)throw new Error("Missing the native OfflineAudioContext constructor.");const t=a.channelCount*a.numberOfInputs,e=void 0===v.parameterDescriptors?0:v.parameterDescriptors.length,s=t+e,c=async()=>{const c=new p(s,128*Math.ceil(a.context.length/128),w.sampleRate),h=[],u=[];for(let t=0;t<g.numberOfInputs;t+=1)h.push(r(c,{channelCount:g.channelCount,channelCountMode:g.channelCountMode,channelInterpretation:g.channelInterpretation,gain:1})),u.push(i(c,{channelCount:g.channelCount,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:g.channelCount}));const l=await Promise.all(Array.from(a.parameters.values()).map(async t=>{const e=o(c,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:t.value});return await d(c,t,e.offset,b),e})),m=n(c,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:Math.max(1,t+e)});for(let t=0;t<g.numberOfInputs;t+=1){h[t].connect(u[t]);for(let e=0;e<g.channelCount;e+=1)u[t].connect(m,e,t*g.channelCount+e)}for(const[e,s]of l.entries())s.connect(m,0,t+e),s.start(0);return m.connect(c.destination),await Promise.all(h.map(t=>f(a,c,t,b))),_(c)};x=gt(a,0===s?null:await c(),w,g,C,v,h)}const t=await x,e=s(w,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),[c,u,l]=S;null!==t&&(e.buffer=t,e.start(0)),e.connect(c);for(let t=0,e=0;t<a.numberOfOutputs;t+=1){const s=u[t];for(let n=0;n<C[t];n+=1)c.connect(s,e+n,n);e+=C[t]}return l}if(k)for(const[e,s]of a.parameters.entries())await t(w,s,T.parameters.get(e),b);else for(const[t,e]of a.parameters.entries())await d(w,e,T.parameters.get(t),b);return await f(a,w,T,b),T})(w,b,T)}}})(as,En,cs,Es,Wt,Is,Qt,Rn,qn,_n,st,vn,Ve,us,Oe,Us),jn=(t=>e=>t.get(e))(mn),Ln=(t=>(e,s)=>{t.set(e,s)})(Fn),zn=fn?((t,e,s,n,i,o,r,a,c,h,u,l,p)=>class extends e{constructor(e,p,d){var f;const m=a(e),g=c(m),v=u({...dt,...d}),y=_.get(m),x=null==y?void 0:y.get(p),w=g||"closed"!==m.state?m:null!==(f=r(m))&&void 0!==f?f:m,b=i(w,g?null:e.baseLatency,h,p,x,v);super(e,!0,b,g?n(p,v,x):null);const T=[];b.parameters.forEach((t,e)=>{const n=s(this,g,t);T.push([e,n])}),this._nativeAudioWorkletNode=b,this._onprocessorerror=null,this._parameters=new pt(T),g&&t(m,this);const{activeInputs:S}=o(this);l(b,S)}get onprocessorerror(){return this._onprocessorerror}set onprocessorerror(t){const e="function"==typeof t?p(this,t):null;this._nativeAudioWorkletNode.onprocessorerror=e;const s=this._nativeAudioWorkletNode.onprocessorerror;this._onprocessorerror=null!==s&&s===e?t:s}get parameters(){return null===this._parameters?this._nativeAudioWorkletNode.parameters:this._parameters}get port(){return this._nativeAudioWorkletNode.port}})(On,Ze,ps,Pn,Nn,L,jn,Fe,Ne,vn,t=>({...t,outputChannelCount:void 0!==t.outputChannelCount?t.outputChannelCount:1===t.numberOfInputs&&1===t.numberOfOutputs?[t.channelCount]:Array.from({length:t.numberOfOutputs},()=>1)}),Ln,de):void 0,Bn=(((t,e,s,n,i)=>{})(At,Ht,se,$s,Be),((t,e)=>(s,n,i)=>{if(null===e)throw new Error("Missing the native OfflineAudioContext constructor.");try{return new e(s,n,i)}catch(e){if("SyntaxError"===e.name)throw t();throw e}})(Ht,Ve)),Wn=((t,e,s,n,i,o,r,a)=>{const c=[];return(h,u)=>s(h).render(h,u,c).then(()=>Promise.all(Array.from(n(u)).map(t=>s(t).render(t,u,c)))).then(()=>i(u)).then(s=>("function"!=typeof s.copyFromChannel?(r(s),F(s)):e(o,()=>o(s))||a(s),t.add(s),s))})(He,xe,Ae,An,Us,R,ts,es),Gn=(((t,e,s,n,i)=>{})(xe,At,Bn,$s,Wn),((t,e,s,n,i)=>class extends t{constructor(t,s,i){let o;if("number"==typeof t&&void 0!==s&&void 0!==i)o={length:s,numberOfChannels:t,sampleRate:i};else{if("object"!=typeof t)throw new Error("The given parameters are not valid.");o=t}const{length:r,numberOfChannels:a,sampleRate:c}={...$t,...o},h=n(a,r,c);e(Rt,()=>Rt(h))||h.addEventListener("statechange",(()=>{let t=0;const e=s=>{"running"===this._state&&(t>0?(h.removeEventListener("statechange",e),s.stopImmediatePropagation(),this._waitForThePromiseToSettle(s)):t+=1)};return e})()),super(h,a),this._length=r,this._nativeOfflineAudioContext=h,this._state=null}get length(){return void 0===this._nativeOfflineAudioContext.length?this._length:this._nativeOfflineAudioContext.length}get state(){return null===this._state?this._nativeOfflineAudioContext.state:this._state}startRendering(){return"running"===this._state?Promise.reject(s()):(this._state="running",i(this.destination,this._nativeOfflineAudioContext).finally(()=>{this._state=null,W(this)}))}_waitForThePromiseToSettle(t){null===this._state?this._nativeOfflineAudioContext.dispatchEvent(t):setTimeout(()=>this._waitForThePromiseToSettle(t))}})(wn,xe,At,Bn,Wn)),Un=((t,e)=>s=>{const n=t.get(s);return e(n)||e(s)})(p,We),Qn=(Zn=h,Xn=Ue,t=>Zn.has(t)||Xn(t));var Zn,Xn;const Yn=(Hn=l,$n=Qe,t=>Hn.has(t)||$n(t));var Hn,$n;const Jn=((t,e)=>s=>{const n=t.get(s);return e(n)||e(s)})(p,Ne),Kn=()=>(async(t,e,s,n,i,o,r,a,c,h,u,l,p,d,f,_)=>{if(t(e,e)&&t(s,s)&&t(i,i)&&t(o,o)&&t(a,a)&&t(c,c)&&t(h,h)&&t(u,u)&&t(l,l)&&t(p,p)&&t(d,d)){return(await Promise.all([t(n,n),t(r,r),t(f,f),t(_,_)])).every(t=>t)}return!1})(xe,(t=>()=>{if(null===t)return!1;const e=new t(1,1,44100).createBuffer(1,1,44100);if(void 0===e.copyToChannel)return!0;const s=new Float32Array(2);try{e.copyFromChannel(s,0,0)}catch{return!1}return!0})(Ve),(t=>()=>{if(null===t)return!1;if(void 0!==t.prototype&&void 0!==t.prototype.close)return!0;const e=new t,s=void 0!==e.close;try{e.close()}catch{}return s})(Be),(t=>()=>{if(null===t)return Promise.resolve(!1);const e=new t(1,1,44100);return new Promise(t=>{let s=!0;const n=n=>{s&&(s=!1,e.startRendering(),t(n instanceof TypeError))};let i;try{i=e.decodeAudioData(null,()=>{},n)}catch(t){n(t)}void 0!==i&&i.catch(n)})})(Ve),(t=>()=>{if(null===t)return!1;let e;try{e=new t({latencyHint:"balanced"})}catch{return!1}return e.close(),!0})(Be),(t=>()=>{if(null===t)return!1;const e=new t(1,1,44100).createGain(),s=e.connect(e)===e;return e.disconnect(e),s})(Ve),((t,e)=>async()=>{if(null===t)return!0;if(null===e)return!1;const s=new Blob(['class A extends AudioWorkletProcessor{process(){this.port.postMessage(0)}}registerProcessor("a",A)'],{type:"application/javascript; charset=utf-8"}),n=new e(1,128,8e3),i=URL.createObjectURL(s);let o=!1;try{await n.audioWorklet.addModule(i);const e=new t(n,"a",{numberOfOutputs:0}),s=n.createOscillator();e.port.onmessage=()=>o=!0,s.connect(e),s.start(0),await n.startRendering(),o||await new Promise(t=>setTimeout(t,5))}catch{}finally{URL.revokeObjectURL(i)}return o})(vn,Ve),(t=>()=>{if(null===t)return!1;const e=new t(1,1,44100).createChannelMerger();if("max"===e.channelCountMode)return!0;try{e.channelCount=2}catch{return!0}return!1})(Ve),(t=>()=>{if(null===t)return!1;const e=new t(1,1,44100);if(void 0===e.createConstantSource)return!0;return e.createConstantSource().offset.maxValue!==Number.POSITIVE_INFINITY})(Ve),(t=>()=>{if(null===t)return!1;const e=new t(1,1,44100),s=e.createConvolver();s.buffer=e.createBuffer(1,1,e.sampleRate);try{s.buffer=e.createBuffer(1,1,e.sampleRate)}catch{return!1}return!0})(Ve),(t=>()=>{if(null===t)return!1;const e=new t(1,1,44100).createConvolver();try{e.channelCount=1}catch{return!1}return!0})(Ve),ue,(t=>()=>null!==t&&t.hasOwnProperty("isSecureContext"))(Te),(t=>()=>{if(null===t)return!1;const e=new t;try{return e.createMediaStreamSource(new MediaStream),!1}catch(t){return!0}})(Be),(t=>()=>{if(null===t)return Promise.resolve(!1);const e=new t(1,1,44100);if(void 0===e.createStereoPanner)return Promise.resolve(!0);if(void 0===e.createConstantSource)return Promise.resolve(!0);const s=e.createConstantSource(),n=e.createStereoPanner();return s.channelCount=1,s.offset.value=1,n.channelCount=1,s.start(),s.connect(n).connect(e.destination),e.startRendering().then(t=>1!==t.getChannelData(0)[0])})(Ve),le);function ti(t,e){if(!t)throw new Error(e)}function ei(t,e,s=1/0){if(!(e<=t&&t<=s))throw new RangeError(`Value must be within [${e}, ${s}], got: ${t}`)}function si(t){t.isOffline||"running"===t.state||ri('The AudioContext is "suspended". Invoke Tone.start() from a user action to start the audio.')}let ni=console;function ii(t){ni=t}function oi(...t){ni.log(...t)}function ri(...t){ni.warn(...t)}function ai(t){return void 0===t}function ci(t){return!ai(t)}function hi(t){return"function"==typeof t}function ui(t){return"number"==typeof t}function li(t){return"[object Object]"===Object.prototype.toString.call(t)&&t.constructor===Object}function pi(t){return"boolean"==typeof t}function di(t){return Array.isArray(t)}function fi(t){return"string"==typeof t}function _i(t){return fi(t)&&/^([a-g]{1}(?:b|#|x|bb)?)(-?[0-9]+)/i.test(t)}const mi="object"==typeof self?self:null,gi=mi&&(mi.hasOwnProperty("AudioContext")||mi.hasOwnProperty("webkitAudioContext"));function vi(t,e,s,n){var i,o=arguments.length,r=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,s):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,s,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(r=(o<3?i(r):o>3?i(e,s,r):i(e,s))||r);return o>3&&r&&Object.defineProperty(e,s,r),r}function yi(t,e,s,n){return new(s||(s=Promise))((function(i,o){function r(t){try{c(n.next(t))}catch(t){o(t)}}function a(t){try{c(n.throw(t))}catch(t){o(t)}}function c(t){var e;t.done?i(t.value):(e=t.value,e instanceof s?e:new s((function(t){t(e)}))).then(r,a)}c((n=n.apply(t,e||[])).next())}))}Object.create;Object.create;class xi{constructor(t,e,s){this._callback=t,this._type=e,this._updateInterval=s,this._createClock()}_createWorker(){const t=new Blob([`\n\t\t\t// the initial timeout time\n\t\t\tlet timeoutTime =  ${(1e3*this._updateInterval).toFixed(1)};\n\t\t\t// onmessage callback\n\t\t\tself.onmessage = function(msg){\n\t\t\t\ttimeoutTime = parseInt(msg.data);\n\t\t\t};\n\t\t\t// the tick function which posts a message\n\t\t\t// and schedules a new tick\n\t\t\tfunction tick(){\n\t\t\t\tsetTimeout(tick, timeoutTime);\n\t\t\t\tself.postMessage('tick');\n\t\t\t}\n\t\t\t// call tick initially\n\t\t\ttick();\n\t\t\t`],{type:"text/javascript"}),e=URL.createObjectURL(t),s=new Worker(e);s.onmessage=this._callback.bind(this),this._worker=s}_createTimeout(){this._timeout=setTimeout(()=>{this._createTimeout(),this._callback()},1e3*this._updateInterval)}_createClock(){if("worker"===this._type)try{this._createWorker()}catch(t){this._type="timeout",this._createClock()}else"timeout"===this._type&&this._createTimeout()}_disposeClock(){this._timeout&&(clearTimeout(this._timeout),this._timeout=0),this._worker&&(this._worker.terminate(),this._worker.onmessage=null)}get updateInterval(){return this._updateInterval}set updateInterval(t){this._updateInterval=Math.max(t,128/44100),"worker"===this._type&&this._worker.postMessage(Math.max(1e3*t,1))}get type(){return this._type}set type(t){this._disposeClock(),this._type=t,this._createClock()}dispose(){this._disposeClock()}}function wi(t){return Yn(t)}function bi(t){return Qn(t)}function Ti(t){return Jn(t)}function Si(t){return Un(t)}function ki(t){return t instanceof AudioBuffer}function Ci(t,e){return"value"===t||wi(e)||bi(e)||ki(e)}function Ai(t,...e){if(!e.length)return t;const s=e.shift();if(li(t)&&li(s))for(const e in s)Ci(e,s[e])?t[e]=s[e]:li(s[e])?(t[e]||Object.assign(t,{[e]:{}}),Ai(t[e],s[e])):Object.assign(t,{[e]:s[e]});return Ai(t,...e)}function Di(t,e,s=[],n){const i={},o=Array.from(e);if(li(o[0])&&n&&!Reflect.has(o[0],n)){Object.keys(o[0]).some(e=>Reflect.has(t,e))||(Ai(i,{[n]:o[0]}),s.splice(s.indexOf(n),1),o.shift())}if(1===o.length&&li(o[0]))Ai(i,o[0]);else for(let t=0;t<s.length;t++)ci(o[t])&&(i[s[t]]=o[t]);return Ai(t,i)}function Oi(t,e){return ai(t)?e:t}function Mi(t,e){return e.forEach(e=>{Reflect.has(t,e)&&delete t[e]}),t}
/**
 * Tone.js
 * @author Yotam Mann
 * @license http://opensource.org/licenses/MIT MIT License
 * @copyright 2014-2019 Yotam Mann
 */class Ei{constructor(){this.debug=!1,this._wasDisposed=!1}static getDefaults(){return{}}log(...t){(this.debug||mi&&this.toString()===mi.TONE_DEBUG_CLASS)&&oi(this,...t)}dispose(){return this._wasDisposed=!0,this}get disposed(){return this._wasDisposed}toString(){return this.name}}Ei.version=o;function Ri(t,e){return t>e+1e-6}function qi(t,e){return Ri(t,e)||Ii(t,e)}function Fi(t,e){return t+1e-6<e}function Ii(t,e){return Math.abs(t-e)<1e-6}function Vi(t,e,s){return Math.max(Math.min(t,s),e)}class Ni extends Ei{constructor(){super(),this.name="Timeline",this._timeline=[];const t=Di(Ni.getDefaults(),arguments,["memory"]);this.memory=t.memory,this.increasing=t.increasing}static getDefaults(){return{memory:1/0,increasing:!1}}get length(){return this._timeline.length}add(t){if(ti(Reflect.has(t,"time"),"Timeline: events must have a time attribute"),t.time=t.time.valueOf(),this.increasing&&this.length){const e=this._timeline[this.length-1];ti(qi(t.time,e.time),"The time must be greater than or equal to the last scheduled time"),this._timeline.push(t)}else{const e=this._search(t.time);this._timeline.splice(e+1,0,t)}if(this.length>this.memory){const t=this.length-this.memory;this._timeline.splice(0,t)}return this}remove(t){const e=this._timeline.indexOf(t);return-1!==e&&this._timeline.splice(e,1),this}get(t,e="time"){const s=this._search(t,e);return-1!==s?this._timeline[s]:null}peek(){return this._timeline[0]}shift(){return this._timeline.shift()}getAfter(t,e="time"){const s=this._search(t,e);return s+1<this._timeline.length?this._timeline[s+1]:null}getBefore(t){const e=this._timeline.length;if(e>0&&this._timeline[e-1].time<t)return this._timeline[e-1];const s=this._search(t);return s-1>=0?this._timeline[s-1]:null}cancel(t){if(this._timeline.length>1){let e=this._search(t);if(e>=0)if(Ii(this._timeline[e].time,t)){for(let s=e;s>=0&&Ii(this._timeline[s].time,t);s--)e=s;this._timeline=this._timeline.slice(0,e)}else this._timeline=this._timeline.slice(0,e+1);else this._timeline=[]}else 1===this._timeline.length&&qi(this._timeline[0].time,t)&&(this._timeline=[]);return this}cancelBefore(t){const e=this._search(t);return e>=0&&(this._timeline=this._timeline.slice(e+1)),this}previousEvent(t){const e=this._timeline.indexOf(t);return e>0?this._timeline[e-1]:null}_search(t,e="time"){if(0===this._timeline.length)return-1;let s=0;const n=this._timeline.length;let i=n;if(n>0&&this._timeline[n-1][e]<=t)return n-1;for(;s<i;){let n=Math.floor(s+(i-s)/2);const o=this._timeline[n],r=this._timeline[n+1];if(Ii(o[e],t)){for(let s=n;s<this._timeline.length;s++){if(!Ii(this._timeline[s][e],t))break;n=s}return n}if(Fi(o[e],t)&&Ri(r[e],t))return n;Ri(o[e],t)?i=n:s=n+1}return-1}_iterate(t,e=0,s=this._timeline.length-1){this._timeline.slice(e,s+1).forEach(t)}forEach(t){return this._iterate(t),this}forEachBefore(t,e){const s=this._search(t);return-1!==s&&this._iterate(e,0,s),this}forEachAfter(t,e){const s=this._search(t);return this._iterate(e,s+1),this}forEachBetween(t,e,s){let n=this._search(t),i=this._search(e);return-1!==n&&-1!==i?(this._timeline[n].time!==t&&(n+=1),this._timeline[i].time===e&&(i-=1),this._iterate(s,n,i)):-1===n&&this._iterate(s,0,i),this}forEachFrom(t,e){let s=this._search(t);for(;s>=0&&this._timeline[s].time>=t;)s--;return this._iterate(e,s+1),this}forEachAtTime(t,e){const s=this._search(t);if(-1!==s&&Ii(this._timeline[s].time,t)){let n=s;for(let e=s;e>=0&&Ii(this._timeline[e].time,t);e--)n=e;this._iterate(t=>{e(t)},n,s)}return this}dispose(){return super.dispose(),this._timeline=[],this}}const Pi=[];function ji(t){Pi.push(t)}const Li=[];function zi(t){Li.push(t)}class Bi extends Ei{constructor(){super(...arguments),this.name="Emitter"}on(t,e){return t.split(/\W+/).forEach(t=>{ai(this._events)&&(this._events={}),this._events.hasOwnProperty(t)||(this._events[t]=[]),this._events[t].push(e)}),this}once(t,e){const s=(...n)=>{e(...n),this.off(t,s)};return this.on(t,s),this}off(t,e){return t.split(/\W+/).forEach(s=>{if(ai(this._events)&&(this._events={}),this._events.hasOwnProperty(t))if(ai(e))this._events[t]=[];else{const s=this._events[t];for(let t=s.length-1;t>=0;t--)s[t]===e&&s.splice(t,1)}}),this}emit(t,...e){if(this._events&&this._events.hasOwnProperty(t)){const s=this._events[t].slice(0);for(let t=0,n=s.length;t<n;t++)s[t].apply(this,e)}return this}static mixin(t){["on","once","off","emit"].forEach(e=>{const s=Object.getOwnPropertyDescriptor(Bi.prototype,e);Object.defineProperty(t.prototype,e,s)})}dispose(){return super.dispose(),this._events=void 0,this}}class Wi extends Bi{constructor(){super(...arguments),this.isOffline=!1}toJSON(){return{}}}class Gi extends Wi{constructor(){super(),this.name="Context",this._constants=new Map,this._timeouts=new Ni,this._timeoutIds=0,this._initialized=!1,this.isOffline=!1,this._workletModules=new Map;const t=Di(Gi.getDefaults(),arguments,["context"]);t.context?this._context=t.context:this._context=function(t){return new Cn(t)}({latencyHint:t.latencyHint}),this._ticker=new xi(this.emit.bind(this,"tick"),t.clockSource,t.updateInterval),this.on("tick",this._timeoutLoop.bind(this)),this._context.onstatechange=()=>{this.emit("statechange",this.state)},this._setLatencyHint(t.latencyHint),this.lookAhead=t.lookAhead}static getDefaults(){return{clockSource:"worker",latencyHint:"interactive",lookAhead:.1,updateInterval:.05}}initialize(){var t;return this._initialized||(t=this,Pi.forEach(e=>e(t)),this._initialized=!0),this}createAnalyser(){return this._context.createAnalyser()}createOscillator(){return this._context.createOscillator()}createBufferSource(){return this._context.createBufferSource()}createBiquadFilter(){return this._context.createBiquadFilter()}createBuffer(t,e,s){return this._context.createBuffer(t,e,s)}createChannelMerger(t){return this._context.createChannelMerger(t)}createChannelSplitter(t){return this._context.createChannelSplitter(t)}createConstantSource(){return this._context.createConstantSource()}createConvolver(){return this._context.createConvolver()}createDelay(t){return this._context.createDelay(t)}createDynamicsCompressor(){return this._context.createDynamicsCompressor()}createGain(){return this._context.createGain()}createIIRFilter(t,e){return this._context.createIIRFilter(t,e)}createPanner(){return this._context.createPanner()}createPeriodicWave(t,e,s){return this._context.createPeriodicWave(t,e,s)}createStereoPanner(){return this._context.createStereoPanner()}createWaveShaper(){return this._context.createWaveShaper()}createMediaStreamSource(t){ti(Si(this._context),"Not available if OfflineAudioContext");return this._context.createMediaStreamSource(t)}createMediaElementSource(t){ti(Si(this._context),"Not available if OfflineAudioContext");return this._context.createMediaElementSource(t)}createMediaStreamDestination(){ti(Si(this._context),"Not available if OfflineAudioContext");return this._context.createMediaStreamDestination()}decodeAudioData(t){return this._context.decodeAudioData(t)}get currentTime(){return this._context.currentTime}get state(){return this._context.state}get sampleRate(){return this._context.sampleRate}get listener(){return this.initialize(),this._listener}set listener(t){ti(!this._initialized,"The listener cannot be set after initialization."),this._listener=t}get transport(){return this.initialize(),this._transport}set transport(t){ti(!this._initialized,"The transport cannot be set after initialization."),this._transport=t}get draw(){return this.initialize(),this._draw}set draw(t){ti(!this._initialized,"Draw cannot be set after initialization."),this._draw=t}get destination(){return this.initialize(),this._destination}set destination(t){ti(!this._initialized,"The destination cannot be set after initialization."),this._destination=t}createAudioWorkletNode(t,e){return function(t,e,s){return ti(ci(zn),"This node only works in a secure context (https or localhost)"),new zn(t,e,s)}
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */(this.rawContext,t,e)}addAudioWorkletModule(t,e){return yi(this,void 0,void 0,(function*(){ti(ci(this.rawContext.audioWorklet),"AudioWorkletNode is only available in a secure context (https or localhost)"),this._workletModules.has(e)||this._workletModules.set(e,this.rawContext.audioWorklet.addModule(t)),yield this._workletModules.get(e)}))}workletsAreReady(){return yi(this,void 0,void 0,(function*(){const t=[];this._workletModules.forEach(e=>t.push(e)),yield Promise.all(t)}))}get updateInterval(){return this._ticker.updateInterval}set updateInterval(t){this._ticker.updateInterval=t}get clockSource(){return this._ticker.type}set clockSource(t){this._ticker.type=t}get latencyHint(){return this._latencyHint}_setLatencyHint(t){let e=0;if(this._latencyHint=t,fi(t))switch(t){case"interactive":e=.1;break;case"playback":e=.5;break;case"balanced":e=.25}this.lookAhead=e,this.updateInterval=e/2}get rawContext(){return this._context}now(){return this._context.currentTime+this.lookAhead}immediate(){return this._context.currentTime}resume(){return Si(this._context)?this._context.resume():Promise.resolve()}close(){return yi(this,void 0,void 0,(function*(){var t;Si(this._context)&&(yield this._context.close()),this._initialized&&(t=this,Li.forEach(e=>e(t)))}))}getConstant(t){if(this._constants.has(t))return this._constants.get(t);{const e=this._context.createBuffer(1,128,this._context.sampleRate),s=e.getChannelData(0);for(let e=0;e<s.length;e++)s[e]=t;const n=this._context.createBufferSource();return n.channelCount=1,n.channelCountMode="explicit",n.buffer=e,n.loop=!0,n.start(0),this._constants.set(t,n),n}}dispose(){return super.dispose(),this._ticker.dispose(),this._timeouts.dispose(),Object.keys(this._constants).map(t=>this._constants[t].disconnect()),this}_timeoutLoop(){const t=this.now();let e=this._timeouts.peek();for(;this._timeouts.length&&e&&e.time<=t;)e.callback(),this._timeouts.shift(),e=this._timeouts.peek()}setTimeout(t,e){this._timeoutIds++;const s=this.now();return this._timeouts.add({callback:t,id:this._timeoutIds,time:s+e}),this._timeoutIds}clearTimeout(t){return this._timeouts.forEach(e=>{e.id===t&&this._timeouts.remove(e)}),this}clearInterval(t){return this.clearTimeout(t)}setInterval(t,e){const s=++this._timeoutIds,n=()=>{const i=this.now();this._timeouts.add({callback:()=>{t(),n()},id:s,time:i+e})};return n(),s}}function Ui(t,e){di(e)?e.forEach(e=>Ui(t,e)):Object.defineProperty(t,e,{enumerable:!0,writable:!1})}function Qi(t,e){di(e)?e.forEach(e=>Qi(t,e)):Object.defineProperty(t,e,{writable:!0})}const Zi=()=>{};class Xi extends Ei{constructor(){super(),this.name="ToneAudioBuffer",this.onload=Zi;const t=Di(Xi.getDefaults(),arguments,["url","onload","onerror"]);this.reverse=t.reverse,this.onload=t.onload,t.url&&ki(t.url)||t.url instanceof Xi?this.set(t.url):fi(t.url)&&this.load(t.url).catch(t.onerror)}static getDefaults(){return{onerror:Zi,onload:Zi,reverse:!1}}get sampleRate(){return this._buffer?this._buffer.sampleRate:Ji().sampleRate}set(t){return t instanceof Xi?t.loaded?this._buffer=t.get():t.onload=()=>{this.set(t),this.onload(this)}:this._buffer=t,this._reversed&&this._reverse(),this}get(){return this._buffer}load(t){return yi(this,void 0,void 0,(function*(){const e=Xi.load(t).then(t=>{this.set(t),this.onload(this)});Xi.downloads.push(e);try{yield e}finally{const t=Xi.downloads.indexOf(e);Xi.downloads.splice(t,1)}return this}))}dispose(){return super.dispose(),this._buffer=void 0,this}fromArray(t){const e=di(t)&&t[0].length>0,s=e?t.length:1,n=e?t[0].length:t.length,i=Ji(),o=i.createBuffer(s,n,i.sampleRate),r=e||1!==s?t:[t];for(let t=0;t<s;t++)o.copyToChannel(r[t],t);return this._buffer=o,this}toMono(t){if(ui(t))this.fromArray(this.toArray(t));else{let t=new Float32Array(this.length);const e=this.numberOfChannels;for(let s=0;s<e;s++){const e=this.toArray(s);for(let s=0;s<e.length;s++)t[s]+=e[s]}t=t.map(t=>t/e),this.fromArray(t)}return this}toArray(t){if(ui(t))return this.getChannelData(t);if(1===this.numberOfChannels)return this.toArray(0);{const t=[];for(let e=0;e<this.numberOfChannels;e++)t[e]=this.getChannelData(e);return t}}getChannelData(t){return this._buffer?this._buffer.getChannelData(t):new Float32Array(0)}slice(t,e=this.duration){const s=Math.floor(t*this.sampleRate),n=Math.floor(e*this.sampleRate);ti(s<n,"The start time must be less than the end time");const i=n-s,o=Ji().createBuffer(this.numberOfChannels,i,this.sampleRate);for(let t=0;t<this.numberOfChannels;t++)o.copyToChannel(this.getChannelData(t).subarray(s,n),t);return new Xi(o)}_reverse(){if(this.loaded)for(let t=0;t<this.numberOfChannels;t++)this.getChannelData(t).reverse();return this}get loaded(){return this.length>0}get duration(){return this._buffer?this._buffer.duration:0}get length(){return this._buffer?this._buffer.length:0}get numberOfChannels(){return this._buffer?this._buffer.numberOfChannels:0}get reverse(){return this._reversed}set reverse(t){this._reversed!==t&&(this._reversed=t,this._reverse())}static fromArray(t){return(new Xi).fromArray(t)}static fromUrl(t){return yi(this,void 0,void 0,(function*(){const e=new Xi;return yield e.load(t)}))}static load(t){return yi(this,void 0,void 0,(function*(){const e=t.match(/\[([^\]\[]+\|.+)\]$/);if(e){const s=e[1].split("|");let n=s[0];for(const t of s)if(Xi.supportsType(t)){n=t;break}t=t.replace(e[0],n)}const s=""===Xi.baseUrl||Xi.baseUrl.endsWith("/")?Xi.baseUrl:Xi.baseUrl+"/",n=yield fetch(s+t);if(!n.ok)throw new Error("could not load url: "+t);const i=yield n.arrayBuffer();return yield Ji().decodeAudioData(i)}))}static supportsType(t){const e=t.split("."),s=e[e.length-1];return""!==document.createElement("audio").canPlayType("audio/"+s)}static loaded(){return yi(this,void 0,void 0,(function*(){for(yield Promise.resolve();Xi.downloads.length;)yield Xi.downloads[0]}))}}Xi.baseUrl="",Xi.downloads=[];class Yi extends Gi{constructor(){var t,e,s;super({clockSource:"offline",context:Ti(arguments[0])?arguments[0]:(t=arguments[0],e=arguments[1]*arguments[2],s=arguments[2],new Gn(t,e,s)),lookAhead:0,updateInterval:Ti(arguments[0])?128/arguments[0].sampleRate:128/arguments[2]}),this.name="OfflineContext",this._currentTime=0,this.isOffline=!0,this._duration=Ti(arguments[0])?arguments[0].length/arguments[0].sampleRate:arguments[1]}now(){return this._currentTime}get currentTime(){return this._currentTime}_renderClock(t){return yi(this,void 0,void 0,(function*(){let e=0;for(;this._duration-this._currentTime>=0;){this.emit("tick"),this._currentTime+=128/this.sampleRate,e++;const s=Math.floor(this.sampleRate/128);t&&e%s==0&&(yield new Promise(t=>setTimeout(t,1)))}}))}render(t=!0){return yi(this,void 0,void 0,(function*(){yield this.workletsAreReady(),yield this._renderClock(t);const e=yield this._context.startRendering();return new Xi(e)}))}close(){return Promise.resolve()}}const Hi=new class extends Wi{constructor(){super(...arguments),this.lookAhead=0,this.latencyHint=0,this.isOffline=!1}createAnalyser(){return{}}createOscillator(){return{}}createBufferSource(){return{}}createBiquadFilter(){return{}}createBuffer(t,e,s){return{}}createChannelMerger(t){return{}}createChannelSplitter(t){return{}}createConstantSource(){return{}}createConvolver(){return{}}createDelay(t){return{}}createDynamicsCompressor(){return{}}createGain(){return{}}createIIRFilter(t,e){return{}}createPanner(){return{}}createPeriodicWave(t,e,s){return{}}createStereoPanner(){return{}}createWaveShaper(){return{}}createMediaStreamSource(t){return{}}createMediaElementSource(t){return{}}createMediaStreamDestination(){return{}}decodeAudioData(t){return Promise.resolve({})}createAudioWorkletNode(t,e){return{}}get rawContext(){return{}}addAudioWorkletModule(t,e){return yi(this,void 0,void 0,(function*(){return Promise.resolve()}))}resume(){return Promise.resolve()}setTimeout(t,e){return 0}clearTimeout(t){return this}setInterval(t,e){return 0}clearInterval(t){return this}getConstant(t){return{}}get currentTime(){return 0}get state(){return{}}get sampleRate(){return 0}get listener(){return{}}get transport(){return{}}get draw(){return{}}set draw(t){}get destination(){return{}}set destination(t){}now(){return 0}immediate(){return 0}};let $i=Hi;function Ji(){return $i===Hi&&gi&&Ki(new Gi),$i}function Ki(t){$i=Si(t)?new Gi(t):Ti(t)?new Yi(t):t}function to(){return $i.resume()}if(mi&&!mi.TONE_SILENCE_LOGGING){let t="v";"dev"===o&&(t="");const e=` * Tone.js ${t}${o} * `;console.log("%c"+e,"background: #000; color: #fff")}function eo(t){return Math.pow(10,t/20)}function so(t){return Math.log(t)/Math.LN10*20}function no(t){return Math.pow(2,t/12)}let io=440;function oo(t){return Math.round(ro(t))}function ro(t){return 69+12*Math.log2(t/io)}function ao(t){return io*Math.pow(2,(t-69)/12)}class co extends Ei{constructor(t,e,s){super(),this.defaultUnits="s",this._val=e,this._units=s,this.context=t,this._expressions=this._getExpressions()}_getExpressions(){return{hz:{method:t=>this._frequencyToUnits(parseFloat(t)),regexp:/^(\d+(?:\.\d+)?)hz$/i},i:{method:t=>this._ticksToUnits(parseInt(t,10)),regexp:/^(\d+)i$/i},m:{method:t=>this._beatsToUnits(parseInt(t,10)*this._getTimeSignature()),regexp:/^(\d+)m$/i},n:{method:(t,e)=>{const s=parseInt(t,10),n="."===e?1.5:1;return 1===s?this._beatsToUnits(this._getTimeSignature())*n:this._beatsToUnits(4/s)*n},regexp:/^(\d+)n(\.?)$/i},number:{method:t=>this._expressions[this.defaultUnits].method.call(this,t),regexp:/^(\d+(?:\.\d+)?)$/},s:{method:t=>this._secondsToUnits(parseFloat(t)),regexp:/^(\d+(?:\.\d+)?)s$/},samples:{method:t=>parseInt(t,10)/this.context.sampleRate,regexp:/^(\d+)samples$/},t:{method:t=>{const e=parseInt(t,10);return this._beatsToUnits(8/(3*Math.floor(e)))},regexp:/^(\d+)t$/i},tr:{method:(t,e,s)=>{let n=0;return t&&"0"!==t&&(n+=this._beatsToUnits(this._getTimeSignature()*parseFloat(t))),e&&"0"!==e&&(n+=this._beatsToUnits(parseFloat(e))),s&&"0"!==s&&(n+=this._beatsToUnits(parseFloat(s)/4)),n},regexp:/^(\d+(?:\.\d+)?):(\d+(?:\.\d+)?):?(\d+(?:\.\d+)?)?$/}}}valueOf(){if(this._val instanceof co&&this.fromType(this._val),ai(this._val))return this._noArg();if(fi(this._val)&&ai(this._units)){for(const t in this._expressions)if(this._expressions[t].regexp.test(this._val.trim())){this._units=t;break}}else if(li(this._val)){let t=0;for(const e in this._val)if(ci(this._val[e])){const s=this._val[e];t+=new this.constructor(this.context,e).valueOf()*s}return t}if(ci(this._units)){const t=this._expressions[this._units],e=this._val.toString().trim().match(t.regexp);return e?t.method.apply(this,e.slice(1)):t.method.call(this,this._val)}return fi(this._val)?parseFloat(this._val):this._val}_frequencyToUnits(t){return 1/t}_beatsToUnits(t){return 60/this._getBpm()*t}_secondsToUnits(t){return t}_ticksToUnits(t){return t*this._beatsToUnits(1)/this._getPPQ()}_noArg(){return this._now()}_getBpm(){return this.context.transport.bpm.value}_getTimeSignature(){return this.context.transport.timeSignature}_getPPQ(){return this.context.transport.PPQ}fromType(t){switch(this._units=void 0,this.defaultUnits){case"s":this._val=t.toSeconds();break;case"i":this._val=t.toTicks();break;case"hz":this._val=t.toFrequency();break;case"midi":this._val=t.toMidi()}return this}toFrequency(){return 1/this.toSeconds()}toSamples(){return this.toSeconds()*this.context.sampleRate}toMilliseconds(){return 1e3*this.toSeconds()}}class ho extends co{constructor(){super(...arguments),this.name="TimeClass"}_getExpressions(){return Object.assign(super._getExpressions(),{now:{method:t=>this._now()+new this.constructor(this.context,t).valueOf(),regexp:/^\+(.+)/},quantize:{method:t=>{const e=new ho(this.context,t).valueOf();return this._secondsToUnits(this.context.transport.nextSubdivision(e))},regexp:/^@(.+)/}})}quantize(t,e=1){const s=new this.constructor(this.context,t).valueOf(),n=this.valueOf();return n+(Math.round(n/s)*s-n)*e}toNotation(){const t=this.toSeconds(),e=["1m"];for(let t=1;t<9;t++){const s=Math.pow(2,t);e.push(s+"n."),e.push(s+"n"),e.push(s+"t")}e.push("0");let s=e[0],n=new ho(this.context,e[0]).toSeconds();return e.forEach(e=>{const i=new ho(this.context,e).toSeconds();Math.abs(i-t)<Math.abs(n-t)&&(s=e,n=i)}),s}toBarsBeatsSixteenths(){const t=this._beatsToUnits(1);let e=this.valueOf()/t;e=parseFloat(e.toFixed(4));const s=Math.floor(e/this._getTimeSignature());let n=e%1*4;e=Math.floor(e)%this._getTimeSignature();const i=n.toString();i.length>3&&(n=parseFloat(parseFloat(i).toFixed(3)));return[s,e,n].join(":")}toTicks(){const t=this._beatsToUnits(1),e=this.valueOf()/t;return Math.round(e*this._getPPQ())}toSeconds(){return this.valueOf()}toMidi(){return oo(this.toFrequency())}_now(){return this.context.now()}}function uo(t,e){return new ho(Ji(),t,e)}class lo extends ho{constructor(){super(...arguments),this.name="Frequency",this.defaultUnits="hz"}static get A4(){return io}static set A4(t){!function(t){io=t}(t)}_getExpressions(){return Object.assign({},super._getExpressions(),{midi:{regexp:/^(\d+(?:\.\d+)?midi)/,method(t){return"midi"===this.defaultUnits?t:lo.mtof(t)}},note:{regexp:/^([a-g]{1}(?:b|#|x|bb)?)(-?[0-9]+)/i,method(t,e){const s=po[t.toLowerCase()]+12*(parseInt(e,10)+1);return"midi"===this.defaultUnits?s:lo.mtof(s)}},tr:{regexp:/^(\d+(?:\.\d+)?):(\d+(?:\.\d+)?):?(\d+(?:\.\d+)?)?/,method(t,e,s){let n=1;return t&&"0"!==t&&(n*=this._beatsToUnits(this._getTimeSignature()*parseFloat(t))),e&&"0"!==e&&(n*=this._beatsToUnits(parseFloat(e))),s&&"0"!==s&&(n*=this._beatsToUnits(parseFloat(s)/4)),n}}})}transpose(t){return new lo(this.context,this.valueOf()*no(t))}harmonize(t){return t.map(t=>this.transpose(t))}toMidi(){return oo(this.valueOf())}toNote(){const t=this.toFrequency(),e=Math.log2(t/lo.A4);let s=Math.round(12*e)+57;const n=Math.floor(s/12);n<0&&(s+=-12*n);return fo[s%12]+n.toString()}toSeconds(){return 1/super.toSeconds()}toTicks(){const t=this._beatsToUnits(1),e=this.valueOf()/t;return Math.floor(e*this._getPPQ())}_noArg(){return 0}_frequencyToUnits(t){return t}_ticksToUnits(t){return 1/(60*t/(this._getBpm()*this._getPPQ()))}_beatsToUnits(t){return 1/super._beatsToUnits(t)}_secondsToUnits(t){return 1/t}static mtof(t){return ao(t)}static ftom(t){return oo(t)}}const po={cbb:-2,cb:-1,c:0,"c#":1,cx:2,dbb:0,db:1,d:2,"d#":3,dx:4,ebb:2,eb:3,e:4,"e#":5,ex:6,fbb:3,fb:4,f:5,"f#":6,fx:7,gbb:5,gb:6,g:7,"g#":8,gx:9,abb:7,ab:8,a:9,"a#":10,ax:11,bbb:9,bb:10,b:11,"b#":12,bx:13},fo=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"];function _o(t,e){return new lo(Ji(),t,e)}class mo extends ho{constructor(){super(...arguments),this.name="TransportTime"}_now(){return this.context.transport.seconds}}function go(t,e){return new mo(Ji(),t,e)}class vo extends Ei{constructor(){super();const t=Di(vo.getDefaults(),arguments,["context"]);this.defaultContext?this.context=this.defaultContext:this.context=t.context}static getDefaults(){return{context:Ji()}}now(){return this.context.currentTime+this.context.lookAhead}immediate(){return this.context.currentTime}get sampleTime(){return 1/this.context.sampleRate}get blockTime(){return 128/this.context.sampleRate}toSeconds(t){return new ho(this.context,t).toSeconds()}toFrequency(t){return new lo(this.context,t).toFrequency()}toTicks(t){return new mo(this.context,t).toTicks()}_getPartialProperties(t){const e=this.get();return Object.keys(e).forEach(s=>{ai(t[s])&&delete e[s]}),e}get(){const t=this.constructor.getDefaults();return Object.keys(t).forEach(e=>{if(Reflect.has(this,e)){const s=this[e];ci(s)&&ci(s.value)&&ci(s.setValueAtTime)?t[e]=s.value:s instanceof vo?t[e]=s._getPartialProperties(t[e]):di(s)||ui(s)||fi(s)||pi(s)?t[e]=s:delete t[e]}}),t}set(t){return Object.keys(t).forEach(e=>{Reflect.has(this,e)&&ci(this[e])&&(this[e]&&ci(this[e].value)&&ci(this[e].setValueAtTime)?this[e].value!==t[e]&&(this[e].value=t[e]):this[e]instanceof vo?this[e].set(t[e]):this[e]=t[e])}),this}}class yo extends Ni{constructor(t="stopped"){super(),this.name="StateTimeline",this._initial=t,this.setStateAtTime(this._initial,0)}getValueAtTime(t){const e=this.get(t);return null!==e?e.state:this._initial}setStateAtTime(t,e,s){return ei(e,0),this.add(Object.assign({},s,{state:t,time:e})),this}getLastState(t,e){for(let s=this._search(e);s>=0;s--){const e=this._timeline[s];if(e.state===t)return e}}getNextState(t,e){const s=this._search(e);if(-1!==s)for(let e=s;e<this._timeline.length;e++){const s=this._timeline[e];if(s.state===t)return s}}}class xo extends vo{constructor(){super(Di(xo.getDefaults(),arguments,["param","units","convert"])),this.name="Param",this.overridden=!1,this._minOutput=1e-7;const t=Di(xo.getDefaults(),arguments,["param","units","convert"]);for(ti(ci(t.param)&&(wi(t.param)||t.param instanceof xo),"param must be an AudioParam");!wi(t.param);)t.param=t.param._param;this._swappable=!!ci(t.swappable)&&t.swappable,this._swappable?(this.input=this.context.createGain(),this._param=t.param,this.input.connect(this._param)):this._param=this.input=t.param,this._events=new Ni(1e3),this._initialValue=this._param.defaultValue,this.units=t.units,this.convert=t.convert,this._minValue=t.minValue,this._maxValue=t.maxValue,ci(t.value)&&t.value!==this._toType(this._initialValue)&&this.setValueAtTime(t.value,0)}static getDefaults(){return Object.assign(vo.getDefaults(),{convert:!0,units:"number"})}get value(){const t=this.now();return this.getValueAtTime(t)}set value(t){this.cancelScheduledValues(this.now()),this.setValueAtTime(t,this.now())}get minValue(){return ci(this._minValue)?this._minValue:"time"===this.units||"frequency"===this.units||"normalRange"===this.units||"positive"===this.units||"transportTime"===this.units||"ticks"===this.units||"bpm"===this.units||"hertz"===this.units||"samples"===this.units?0:"audioRange"===this.units?-1:"decibels"===this.units?-1/0:this._param.minValue}get maxValue(){return ci(this._maxValue)?this._maxValue:"normalRange"===this.units||"audioRange"===this.units?1:this._param.maxValue}_is(t,e){return this.units===e}_assertRange(t){return ci(this.maxValue)&&ci(this.minValue)&&ei(t,this._fromType(this.minValue),this._fromType(this.maxValue)),t}_fromType(t){return this.convert&&!this.overridden?this._is(t,"time")?this.toSeconds(t):this._is(t,"decibels")?eo(t):this._is(t,"frequency")?this.toFrequency(t):t:this.overridden?0:t}_toType(t){return this.convert&&"decibels"===this.units?so(t):t}setValueAtTime(t,e){const s=this.toSeconds(e),n=this._fromType(t);return ti(isFinite(n)&&isFinite(s),`Invalid argument(s) to setValueAtTime: ${JSON.stringify(t)}, ${JSON.stringify(e)}`),this._assertRange(n),this.log(this.units,"setValueAtTime",t,s),this._events.add({time:s,type:"setValueAtTime",value:n}),this._param.setValueAtTime(n,s),this}getValueAtTime(t){const e=Math.max(this.toSeconds(t),0),s=this._events.getAfter(e),n=this._events.get(e);let i=this._initialValue;if(null===n)i=this._initialValue;else if("setTargetAtTime"!==n.type||null!==s&&"setValueAtTime"!==s.type)if(null===s)i=n.value;else if("linearRampToValueAtTime"===s.type||"exponentialRampToValueAtTime"===s.type){let t=n.value;if("setTargetAtTime"===n.type){const e=this._events.getBefore(n.time);t=null===e?this._initialValue:e.value}i="linearRampToValueAtTime"===s.type?this._linearInterpolate(n.time,t,s.time,s.value,e):this._exponentialInterpolate(n.time,t,s.time,s.value,e)}else i=n.value;else{const t=this._events.getBefore(n.time);let s;s=null===t?this._initialValue:t.value,"setTargetAtTime"===n.type&&(i=this._exponentialApproach(n.time,s,n.value,n.constant,e))}return this._toType(i)}setRampPoint(t){t=this.toSeconds(t);let e=this.getValueAtTime(t);return this.cancelAndHoldAtTime(t),0===this._fromType(e)&&(e=this._toType(this._minOutput)),this.setValueAtTime(e,t),this}linearRampToValueAtTime(t,e){const s=this._fromType(t),n=this.toSeconds(e);return ti(isFinite(s)&&isFinite(n),`Invalid argument(s) to linearRampToValueAtTime: ${JSON.stringify(t)}, ${JSON.stringify(e)}`),this._assertRange(s),this._events.add({time:n,type:"linearRampToValueAtTime",value:s}),this.log(this.units,"linearRampToValueAtTime",t,n),this._param.linearRampToValueAtTime(s,n),this}exponentialRampToValueAtTime(t,e){let s=this._fromType(t);s=Ii(s,0)?this._minOutput:s,this._assertRange(s);const n=this.toSeconds(e);return ti(isFinite(s)&&isFinite(n),`Invalid argument(s) to exponentialRampToValueAtTime: ${JSON.stringify(t)}, ${JSON.stringify(e)}`),this._events.add({time:n,type:"exponentialRampToValueAtTime",value:s}),this.log(this.units,"exponentialRampToValueAtTime",t,n),this._param.exponentialRampToValueAtTime(s,n),this}exponentialRampTo(t,e,s){return s=this.toSeconds(s),this.setRampPoint(s),this.exponentialRampToValueAtTime(t,s+this.toSeconds(e)),this}linearRampTo(t,e,s){return s=this.toSeconds(s),this.setRampPoint(s),this.linearRampToValueAtTime(t,s+this.toSeconds(e)),this}targetRampTo(t,e,s){return s=this.toSeconds(s),this.setRampPoint(s),this.exponentialApproachValueAtTime(t,s,e),this}exponentialApproachValueAtTime(t,e,s){e=this.toSeconds(e),s=this.toSeconds(s);const n=Math.log(s+1)/Math.log(200);return this.setTargetAtTime(t,e,n),this.cancelAndHoldAtTime(e+.9*s),this.linearRampToValueAtTime(t,e+s),this}setTargetAtTime(t,e,s){const n=this._fromType(t);ti(isFinite(s)&&s>0,"timeConstant must be a number greater than 0");const i=this.toSeconds(e);return this._assertRange(n),ti(isFinite(n)&&isFinite(i),`Invalid argument(s) to setTargetAtTime: ${JSON.stringify(t)}, ${JSON.stringify(e)}`),this._events.add({constant:s,time:i,type:"setTargetAtTime",value:n}),this.log(this.units,"setTargetAtTime",t,i,s),this._param.setTargetAtTime(n,i,s),this}setValueCurveAtTime(t,e,s,n=1){s=this.toSeconds(s),e=this.toSeconds(e);const i=this._fromType(t[0])*n;this.setValueAtTime(this._toType(i),e);const o=s/(t.length-1);for(let s=1;s<t.length;s++){const i=this._fromType(t[s])*n;this.linearRampToValueAtTime(this._toType(i),e+s*o)}return this}cancelScheduledValues(t){const e=this.toSeconds(t);return ti(isFinite(e),"Invalid argument to cancelScheduledValues: "+JSON.stringify(t)),this._events.cancel(e),this._param.cancelScheduledValues(e),this.log(this.units,"cancelScheduledValues",e),this}cancelAndHoldAtTime(t){const e=this.toSeconds(t),s=this._fromType(this.getValueAtTime(e));ti(isFinite(e),"Invalid argument to cancelAndHoldAtTime: "+JSON.stringify(t)),this.log(this.units,"cancelAndHoldAtTime",e,"value="+s);const n=this._events.get(e),i=this._events.getAfter(e);return n&&Ii(n.time,e)?i?(this._param.cancelScheduledValues(i.time),this._events.cancel(i.time)):(this._param.cancelAndHoldAtTime(e),this._events.cancel(e+this.sampleTime)):i&&(this._param.cancelScheduledValues(i.time),this._events.cancel(i.time),"linearRampToValueAtTime"===i.type?this.linearRampToValueAtTime(this._toType(s),e):"exponentialRampToValueAtTime"===i.type&&this.exponentialRampToValueAtTime(this._toType(s),e)),this._events.add({time:e,type:"setValueAtTime",value:s}),this._param.setValueAtTime(s,e),this}rampTo(t,e=.1,s){return"frequency"===this.units||"bpm"===this.units||"decibels"===this.units?this.exponentialRampTo(t,e,s):this.linearRampTo(t,e,s),this}apply(t){const e=this.context.currentTime;t.setValueAtTime(this.getValueAtTime(e),e);const s=this._events.get(e);if(s&&"setTargetAtTime"===s.type){const n=this._events.getAfter(s.time),i=n?n.time:e+2,o=(i-e)/10;for(let s=e;s<i;s+=o)t.linearRampToValueAtTime(this.getValueAtTime(s),s)}return this._events.forEachAfter(this.context.currentTime,e=>{"cancelScheduledValues"===e.type?t.cancelScheduledValues(e.time):"setTargetAtTime"===e.type?t.setTargetAtTime(e.value,e.time,e.constant):t[e.type](e.value,e.time)}),this}setParam(t){ti(this._swappable,"The Param must be assigned as 'swappable' in the constructor");const e=this.input;return e.disconnect(this._param),this.apply(t),this._param=t,e.connect(this._param),this}dispose(){return super.dispose(),this._events.dispose(),this}get defaultValue(){return this._toType(this._param.defaultValue)}_exponentialApproach(t,e,s,n,i){return s+(e-s)*Math.exp(-(i-t)/n)}_linearInterpolate(t,e,s,n,i){return e+(i-t)/(s-t)*(n-e)}_exponentialInterpolate(t,e,s,n,i){return e*Math.pow(n/e,(i-t)/(s-t))}}class wo extends vo{constructor(){super(...arguments),this.name="ToneAudioNode",this._internalChannels=[]}get numberOfInputs(){return ci(this.input)?wi(this.input)||this.input instanceof xo?1:this.input.numberOfInputs:0}get numberOfOutputs(){return ci(this.output)?this.output.numberOfOutputs:0}_isAudioNode(t){return ci(t)&&(t instanceof wo||bi(t))}_getInternalNodes(){const t=this._internalChannels.slice(0);return this._isAudioNode(this.input)&&t.push(this.input),this._isAudioNode(this.output)&&this.input!==this.output&&t.push(this.output),t}_setChannelProperties(t){this._getInternalNodes().forEach(e=>{e.channelCount=t.channelCount,e.channelCountMode=t.channelCountMode,e.channelInterpretation=t.channelInterpretation})}_getChannelProperties(){const t=this._getInternalNodes();ti(t.length>0,"ToneAudioNode does not have any internal nodes");const e=t[0];return{channelCount:e.channelCount,channelCountMode:e.channelCountMode,channelInterpretation:e.channelInterpretation}}get channelCount(){return this._getChannelProperties().channelCount}set channelCount(t){const e=this._getChannelProperties();this._setChannelProperties(Object.assign(e,{channelCount:t}))}get channelCountMode(){return this._getChannelProperties().channelCountMode}set channelCountMode(t){const e=this._getChannelProperties();this._setChannelProperties(Object.assign(e,{channelCountMode:t}))}get channelInterpretation(){return this._getChannelProperties().channelInterpretation}set channelInterpretation(t){const e=this._getChannelProperties();this._setChannelProperties(Object.assign(e,{channelInterpretation:t}))}connect(t,e=0,s=0){return To(this,t,e,s),this}toDestination(){return this.connect(this.context.destination),this}toMaster(){return ri("toMaster() has been renamed toDestination()"),this.toDestination()}disconnect(t,e=0,s=0){return So(this,t,e,s),this}chain(...t){return bo(this,...t),this}fan(...t){return t.forEach(t=>this.connect(t)),this}dispose(){return super.dispose(),ci(this.input)&&(this.input instanceof wo?this.input.dispose():bi(this.input)&&this.input.disconnect()),ci(this.output)&&(this.output instanceof wo?this.output.dispose():bi(this.output)&&this.output.disconnect()),this._internalChannels=[],this}}function bo(...t){const e=t.shift();t.reduce((t,e)=>(t instanceof wo?t.connect(e):bi(t)&&To(t,e),e),e)}function To(t,e,s=0,n=0){for(ti(ci(t),"Cannot connect from undefined node"),ti(ci(e),"Cannot connect to undefined node"),(e instanceof wo||bi(e))&&ti(e.numberOfInputs>0,"Cannot connect to node with no inputs"),ti(t.numberOfOutputs>0,"Cannot connect from node with no outputs");e instanceof wo||e instanceof xo;)ci(e.input)&&(e=e.input);for(;t instanceof wo;)ci(t.output)&&(t=t.output);wi(e)?t.connect(e,s):t.connect(e,s,n)}function So(t,e,s=0,n=0){if(ci(e))for(;e instanceof wo;)e=e.input;for(;!bi(t);)ci(t.output)&&(t=t.output);wi(e)?t.disconnect(e,s):bi(e)?t.disconnect(e,s,n):t.disconnect()}class ko extends wo{constructor(){super(Di(ko.getDefaults(),arguments,["gain","units"])),this.name="Gain",this._gainNode=this.context.createGain(),this.input=this._gainNode,this.output=this._gainNode;const t=Di(ko.getDefaults(),arguments,["gain","units"]);this.gain=new xo({context:this.context,convert:t.convert,param:this._gainNode.gain,units:t.units,value:t.gain,minValue:t.minValue,maxValue:t.maxValue}),Ui(this,"gain")}static getDefaults(){return Object.assign(wo.getDefaults(),{convert:!0,gain:1,units:"gain"})}dispose(){return super.dispose(),this._gainNode.disconnect(),this.gain.dispose(),this}}class Co extends wo{constructor(t){super(t),this.onended=Zi,this._startTime=-1,this._stopTime=-1,this._timeout=-1,this.output=new ko({context:this.context,gain:0}),this._gainNode=this.output,this.getStateAtTime=function(t){const e=this.toSeconds(t);return-1!==this._startTime&&e>=this._startTime&&(-1===this._stopTime||e<=this._stopTime)?"started":"stopped"},this._fadeIn=t.fadeIn,this._fadeOut=t.fadeOut,this._curve=t.curve,this.onended=t.onended}static getDefaults(){return Object.assign(wo.getDefaults(),{curve:"linear",fadeIn:0,fadeOut:0,onended:Zi})}_startGain(t,e=1){ti(-1===this._startTime,"Source cannot be started more than once");const s=this.toSeconds(this._fadeIn);return this._startTime=t+s,this._startTime=Math.max(this._startTime,this.context.currentTime),s>0?(this._gainNode.gain.setValueAtTime(0,t),"linear"===this._curve?this._gainNode.gain.linearRampToValueAtTime(e,t+s):this._gainNode.gain.exponentialApproachValueAtTime(e,t,s)):this._gainNode.gain.setValueAtTime(e,t),this}stop(t){return this.log("stop",t),this._stopGain(this.toSeconds(t)),this}_stopGain(t){ti(-1!==this._startTime,"'start' must be called before 'stop'"),this.cancelStop();const e=this.toSeconds(this._fadeOut);return this._stopTime=this.toSeconds(t)+e,this._stopTime=Math.max(this._stopTime,this.context.currentTime),e>0?"linear"===this._curve?this._gainNode.gain.linearRampTo(0,e,t):this._gainNode.gain.targetRampTo(0,e,t):(this._gainNode.gain.cancelAndHoldAtTime(t),this._gainNode.gain.setValueAtTime(0,t)),this.context.clearTimeout(this._timeout),this._timeout=this.context.setTimeout(()=>{const t="exponential"===this._curve?2*e:0;this._stopSource(this.now()+t),this._onended()},this._stopTime-this.context.currentTime),this}_onended(){if(this.onended!==Zi&&(this.onended(this),this.onended=Zi,!this.context.isOffline)){const t=()=>this.dispose();void 0!==window.requestIdleCallback?window.requestIdleCallback(t):setTimeout(t,1e3)}}get state(){return this.getStateAtTime(this.now())}cancelStop(){return this.log("cancelStop"),ti(-1!==this._startTime,"Source is not started"),this._gainNode.gain.cancelScheduledValues(this._startTime+this.sampleTime),this.context.clearTimeout(this._timeout),this._stopTime=-1,this}dispose(){return super.dispose(),this._gainNode.disconnect(),this}}class Ao extends Co{constructor(){super(Di(Ao.getDefaults(),arguments,["offset"])),this.name="ToneConstantSource",this._source=this.context.createConstantSource();const t=Di(Ao.getDefaults(),arguments,["offset"]);To(this._source,this._gainNode),this.offset=new xo({context:this.context,convert:t.convert,param:this._source.offset,units:t.units,value:t.offset,minValue:t.minValue,maxValue:t.maxValue})}static getDefaults(){return Object.assign(Co.getDefaults(),{convert:!0,offset:1,units:"number"})}start(t){const e=this.toSeconds(t);return this.log("start",e),this._startGain(e),this._source.start(e),this}_stopSource(t){this._source.stop(t)}dispose(){return super.dispose(),"started"===this.state&&this.stop(),this._source.disconnect(),this.offset.dispose(),this}}class Do extends wo{constructor(){super(Di(Do.getDefaults(),arguments,["value","units"])),this.name="Signal",this.override=!0;const t=Di(Do.getDefaults(),arguments,["value","units"]);this.output=this._constantSource=new Ao({context:this.context,convert:t.convert,offset:t.value,units:t.units,minValue:t.minValue,maxValue:t.maxValue}),this._constantSource.start(0),this.input=this._param=this._constantSource.offset}static getDefaults(){return Object.assign(wo.getDefaults(),{convert:!0,units:"number",value:0})}connect(t,e=0,s=0){return Oo(this,t,e,s),this}dispose(){return super.dispose(),this._param.dispose(),this._constantSource.dispose(),this}setValueAtTime(t,e){return this._param.setValueAtTime(t,e),this}getValueAtTime(t){return this._param.getValueAtTime(t)}setRampPoint(t){return this._param.setRampPoint(t),this}linearRampToValueAtTime(t,e){return this._param.linearRampToValueAtTime(t,e),this}exponentialRampToValueAtTime(t,e){return this._param.exponentialRampToValueAtTime(t,e),this}exponentialRampTo(t,e,s){return this._param.exponentialRampTo(t,e,s),this}linearRampTo(t,e,s){return this._param.linearRampTo(t,e,s),this}targetRampTo(t,e,s){return this._param.targetRampTo(t,e,s),this}exponentialApproachValueAtTime(t,e,s){return this._param.exponentialApproachValueAtTime(t,e,s),this}setTargetAtTime(t,e,s){return this._param.setTargetAtTime(t,e,s),this}setValueCurveAtTime(t,e,s,n){return this._param.setValueCurveAtTime(t,e,s,n),this}cancelScheduledValues(t){return this._param.cancelScheduledValues(t),this}cancelAndHoldAtTime(t){return this._param.cancelAndHoldAtTime(t),this}rampTo(t,e,s){return this._param.rampTo(t,e,s),this}get value(){return this._param.value}set value(t){this._param.value=t}get convert(){return this._param.convert}set convert(t){this._param.convert=t}get units(){return this._param.units}get overridden(){return this._param.overridden}set overridden(t){this._param.overridden=t}get maxValue(){return this._param.maxValue}get minValue(){return this._param.minValue}apply(t){return this._param.apply(t),this}}function Oo(t,e,s,n){(e instanceof xo||wi(e)||e instanceof Do&&e.override)&&(e.cancelScheduledValues(0),e.setValueAtTime(0,0),e instanceof Do&&(e.overridden=!0)),To(t,e,s,n)}class Mo extends xo{constructor(){super(Di(Mo.getDefaults(),arguments,["value"])),this.name="TickParam",this._events=new Ni(1/0),this._multiplier=1;const t=Di(Mo.getDefaults(),arguments,["value"]);this._multiplier=t.multiplier,this._events.cancel(0),this._events.add({ticks:0,time:0,type:"setValueAtTime",value:this._fromType(t.value)}),this.setValueAtTime(t.value,0)}static getDefaults(){return Object.assign(xo.getDefaults(),{multiplier:1,units:"hertz",value:1})}setTargetAtTime(t,e,s){e=this.toSeconds(e),this.setRampPoint(e);const n=this._fromType(t),i=this._events.get(e),o=Math.round(Math.max(1/s,1));for(let t=0;t<=o;t++){const o=s*t+e,r=this._exponentialApproach(i.time,i.value,n,s,o);this.linearRampToValueAtTime(this._toType(r),o)}return this}setValueAtTime(t,e){const s=this.toSeconds(e);super.setValueAtTime(t,e);const n=this._events.get(s),i=this._events.previousEvent(n),o=this._getTicksUntilEvent(i,s);return n.ticks=Math.max(o,0),this}linearRampToValueAtTime(t,e){const s=this.toSeconds(e);super.linearRampToValueAtTime(t,e);const n=this._events.get(s),i=this._events.previousEvent(n),o=this._getTicksUntilEvent(i,s);return n.ticks=Math.max(o,0),this}exponentialRampToValueAtTime(t,e){e=this.toSeconds(e);const s=this._fromType(t),n=this._events.get(e),i=Math.round(Math.max(10*(e-n.time),1)),o=(e-n.time)/i;for(let t=0;t<=i;t++){const i=o*t+n.time,r=this._exponentialInterpolate(n.time,n.value,e,s,i);this.linearRampToValueAtTime(this._toType(r),i)}return this}_getTicksUntilEvent(t,e){if(null===t)t={ticks:0,time:0,type:"setValueAtTime",value:0};else if(ai(t.ticks)){const e=this._events.previousEvent(t);t.ticks=this._getTicksUntilEvent(e,t.time)}const s=this._fromType(this.getValueAtTime(t.time));let n=this._fromType(this.getValueAtTime(e));const i=this._events.get(e);return i&&i.time===e&&"setValueAtTime"===i.type&&(n=this._fromType(this.getValueAtTime(e-this.sampleTime))),.5*(e-t.time)*(s+n)+t.ticks}getTicksAtTime(t){const e=this.toSeconds(t),s=this._events.get(e);return Math.max(this._getTicksUntilEvent(s,e),0)}getDurationOfTicks(t,e){const s=this.toSeconds(e),n=this.getTicksAtTime(e);return this.getTimeOfTick(n+t)-s}getTimeOfTick(t){const e=this._events.get(t,"ticks"),s=this._events.getAfter(t,"ticks");if(e&&e.ticks===t)return e.time;if(e&&s&&"linearRampToValueAtTime"===s.type&&e.value!==s.value){const n=this._fromType(this.getValueAtTime(e.time)),i=(this._fromType(this.getValueAtTime(s.time))-n)/(s.time-e.time),o=Math.sqrt(Math.pow(n,2)-2*i*(e.ticks-t)),r=(-n+o)/i,a=(-n-o)/i;return(r>0?r:a)+e.time}return e?0===e.value?1/0:e.time+(t-e.ticks)/e.value:t/this._initialValue}ticksToTime(t,e){return this.getDurationOfTicks(t,e)}timeToTicks(t,e){const s=this.toSeconds(e),n=this.toSeconds(t),i=this.getTicksAtTime(s);return this.getTicksAtTime(s+n)-i}_fromType(t){return"bpm"===this.units&&this.multiplier?1/(60/t/this.multiplier):super._fromType(t)}_toType(t){return"bpm"===this.units&&this.multiplier?t/this.multiplier*60:super._toType(t)}get multiplier(){return this._multiplier}set multiplier(t){const e=this.value;this._multiplier=t,this.cancelScheduledValues(0),this.setValueAtTime(e,0)}}class Eo extends Do{constructor(){super(Di(Eo.getDefaults(),arguments,["value"])),this.name="TickSignal";const t=Di(Eo.getDefaults(),arguments,["value"]);this.input=this._param=new Mo({context:this.context,convert:t.convert,multiplier:t.multiplier,param:this._constantSource.offset,units:t.units,value:t.value})}static getDefaults(){return Object.assign(Do.getDefaults(),{multiplier:1,units:"hertz",value:1})}ticksToTime(t,e){return this._param.ticksToTime(t,e)}timeToTicks(t,e){return this._param.timeToTicks(t,e)}getTimeOfTick(t){return this._param.getTimeOfTick(t)}getDurationOfTicks(t,e){return this._param.getDurationOfTicks(t,e)}getTicksAtTime(t){return this._param.getTicksAtTime(t)}get multiplier(){return this._param.multiplier}set multiplier(t){this._param.multiplier=t}dispose(){return super.dispose(),this._param.dispose(),this}}class Ro extends vo{constructor(){super(Di(Ro.getDefaults(),arguments,["frequency"])),this.name="TickSource",this._state=new yo,this._tickOffset=new Ni;const t=Di(Ro.getDefaults(),arguments,["frequency"]);this.frequency=new Eo({context:this.context,units:t.units,value:t.frequency}),Ui(this,"frequency"),this._state.setStateAtTime("stopped",0),this.setTicksAtTime(0,0)}static getDefaults(){return Object.assign({frequency:1,units:"hertz"},vo.getDefaults())}get state(){return this.getStateAtTime(this.now())}start(t,e){const s=this.toSeconds(t);return"started"!==this._state.getValueAtTime(s)&&(this._state.setStateAtTime("started",s),ci(e)&&this.setTicksAtTime(e,s)),this}stop(t){const e=this.toSeconds(t);if("stopped"===this._state.getValueAtTime(e)){const t=this._state.get(e);t&&t.time>0&&(this._tickOffset.cancel(t.time),this._state.cancel(t.time))}return this._state.cancel(e),this._state.setStateAtTime("stopped",e),this.setTicksAtTime(0,e),this}pause(t){const e=this.toSeconds(t);return"started"===this._state.getValueAtTime(e)&&this._state.setStateAtTime("paused",e),this}cancel(t){return t=this.toSeconds(t),this._state.cancel(t),this._tickOffset.cancel(t),this}getTicksAtTime(t){const e=this.toSeconds(t),s=this._state.getLastState("stopped",e),n={state:"paused",time:e};this._state.add(n);let i=s,o=0;return this._state.forEachBetween(s.time,e+this.sampleTime,t=>{let e=i.time;const s=this._tickOffset.get(t.time);s&&s.time>=i.time&&(o=s.ticks,e=s.time),"started"===i.state&&"started"!==t.state&&(o+=this.frequency.getTicksAtTime(t.time)-this.frequency.getTicksAtTime(e)),i=t}),this._state.remove(n),o}get ticks(){return this.getTicksAtTime(this.now())}set ticks(t){this.setTicksAtTime(t,this.now())}get seconds(){return this.getSecondsAtTime(this.now())}set seconds(t){const e=this.now(),s=this.frequency.timeToTicks(t,e);this.setTicksAtTime(s,e)}getSecondsAtTime(t){t=this.toSeconds(t);const e=this._state.getLastState("stopped",t),s={state:"paused",time:t};this._state.add(s);let n=e,i=0;return this._state.forEachBetween(e.time,t+this.sampleTime,t=>{let e=n.time;const s=this._tickOffset.get(t.time);s&&s.time>=n.time&&(i=s.seconds,e=s.time),"started"===n.state&&"started"!==t.state&&(i+=t.time-e),n=t}),this._state.remove(s),i}setTicksAtTime(t,e){return e=this.toSeconds(e),this._tickOffset.cancel(e),this._tickOffset.add({seconds:this.frequency.getDurationOfTicks(t,e),ticks:t,time:e}),this}getStateAtTime(t){return t=this.toSeconds(t),this._state.getValueAtTime(t)}getTimeOfTick(t,e=this.now()){const s=this._tickOffset.get(e),n=this._state.get(e),i=Math.max(s.time,n.time),o=this.frequency.getTicksAtTime(i)+t-s.ticks;return this.frequency.getTimeOfTick(o)}forEachTickBetween(t,e,s){let n=this._state.get(t);this._state.forEachBetween(t,e,e=>{n&&"started"===n.state&&"started"!==e.state&&this.forEachTickBetween(Math.max(n.time,t),e.time-this.sampleTime,s),n=e});let i=null;if(n&&"started"===n.state){const o=Math.max(n.time,t),r=this.frequency.getTicksAtTime(o),a=r-this.frequency.getTicksAtTime(n.time);let c=Math.ceil(a)-a;c=Ii(c,1)?0:c;let h=this.frequency.getTimeOfTick(r+c);for(;h<e;){try{s(h,Math.round(this.getTicksAtTime(h)))}catch(t){i=t;break}h+=this.frequency.getDurationOfTicks(1,h)}}if(i)throw i;return this}dispose(){return super.dispose(),this._state.dispose(),this._tickOffset.dispose(),this.frequency.dispose(),this}}class qo extends vo{constructor(){super(Di(qo.getDefaults(),arguments,["callback","frequency"])),this.name="Clock",this.callback=Zi,this._lastUpdate=0,this._state=new yo("stopped"),this._boundLoop=this._loop.bind(this);const t=Di(qo.getDefaults(),arguments,["callback","frequency"]);this.callback=t.callback,this._tickSource=new Ro({context:this.context,frequency:t.frequency,units:t.units}),this._lastUpdate=0,this.frequency=this._tickSource.frequency,Ui(this,"frequency"),this._state.setStateAtTime("stopped",0),this.context.on("tick",this._boundLoop)}static getDefaults(){return Object.assign(vo.getDefaults(),{callback:Zi,frequency:1,units:"hertz"})}get state(){return this._state.getValueAtTime(this.now())}start(t,e){si(this.context);const s=this.toSeconds(t);return this.log("start",s),"started"!==this._state.getValueAtTime(s)&&(this._state.setStateAtTime("started",s),this._tickSource.start(s,e),s<this._lastUpdate&&this.emit("start",s,e)),this}stop(t){const e=this.toSeconds(t);return this.log("stop",e),this._state.cancel(e),this._state.setStateAtTime("stopped",e),this._tickSource.stop(e),e<this._lastUpdate&&this.emit("stop",e),this}pause(t){const e=this.toSeconds(t);return"started"===this._state.getValueAtTime(e)&&(this._state.setStateAtTime("paused",e),this._tickSource.pause(e),e<this._lastUpdate&&this.emit("pause",e)),this}get ticks(){return Math.ceil(this.getTicksAtTime(this.now()))}set ticks(t){this._tickSource.ticks=t}get seconds(){return this._tickSource.seconds}set seconds(t){this._tickSource.seconds=t}getSecondsAtTime(t){return this._tickSource.getSecondsAtTime(t)}setTicksAtTime(t,e){return this._tickSource.setTicksAtTime(t,e),this}getTimeOfTick(t,e=this.now()){return this._tickSource.getTimeOfTick(t,e)}getTicksAtTime(t){return this._tickSource.getTicksAtTime(t)}nextTickTime(t,e){const s=this.toSeconds(e),n=this.getTicksAtTime(s);return this._tickSource.getTimeOfTick(n+t,s)}_loop(){const t=this._lastUpdate,e=this.now();this._lastUpdate=e,this.log("loop",t,e),t!==e&&(this._state.forEachBetween(t,e,t=>{switch(t.state){case"started":const e=this._tickSource.getTicksAtTime(t.time);this.emit("start",t.time,e);break;case"stopped":0!==t.time&&this.emit("stop",t.time);break;case"paused":this.emit("pause",t.time)}}),this._tickSource.forEachTickBetween(t,e,(t,e)=>{this.callback(t,e)}))}getStateAtTime(t){const e=this.toSeconds(t);return this._state.getValueAtTime(e)}dispose(){return super.dispose(),this.context.off("tick",this._boundLoop),this._tickSource.dispose(),this._state.dispose(),this}}Bi.mixin(qo);class Fo extends wo{constructor(){super(Di(Fo.getDefaults(),arguments,["delayTime","maxDelay"])),this.name="Delay";const t=Di(Fo.getDefaults(),arguments,["delayTime","maxDelay"]),e=this.toSeconds(t.maxDelay);this._maxDelay=Math.max(e,this.toSeconds(t.delayTime)),this._delayNode=this.input=this.output=this.context.createDelay(e),this.delayTime=new xo({context:this.context,param:this._delayNode.delayTime,units:"time",value:t.delayTime,minValue:0,maxValue:this.maxDelay}),Ui(this,"delayTime")}static getDefaults(){return Object.assign(wo.getDefaults(),{delayTime:0,maxDelay:1})}get maxDelay(){return this._maxDelay}dispose(){return super.dispose(),this._delayNode.disconnect(),this.delayTime.dispose(),this}}function Io(t,e,s=2,n=Ji().sampleRate){return yi(this,void 0,void 0,(function*(){const i=Ji(),o=new Yi(s,e,n);Ki(o),yield t(o);const r=o.render();Ki(i);const a=yield r;return new Xi(a)}))}class Vo extends Ei{constructor(){super(),this.name="ToneAudioBuffers",this._buffers=new Map,this._loadingCount=0;const t=Di(Vo.getDefaults(),arguments,["urls","onload","baseUrl"],"urls");this.baseUrl=t.baseUrl,Object.keys(t.urls).forEach(e=>{this._loadingCount++;const s=t.urls[e];this.add(e,s,this._bufferLoaded.bind(this,t.onload),t.onerror)})}static getDefaults(){return{baseUrl:"",onerror:Zi,onload:Zi,urls:{}}}has(t){return this._buffers.has(t.toString())}get(t){return ti(this.has(t),"ToneAudioBuffers has no buffer named: "+t),this._buffers.get(t.toString())}_bufferLoaded(t){this._loadingCount--,0===this._loadingCount&&t&&t()}get loaded(){return Array.from(this._buffers).every(([t,e])=>e.loaded)}add(t,e,s=Zi,n=Zi){return fi(e)?this._buffers.set(t.toString(),new Xi(this.baseUrl+e,s,n)):this._buffers.set(t.toString(),new Xi(e,s,n)),this}dispose(){return super.dispose(),this._buffers.forEach(t=>t.dispose()),this._buffers.clear(),this}}class No extends lo{constructor(){super(...arguments),this.name="MidiClass",this.defaultUnits="midi"}_frequencyToUnits(t){return oo(super._frequencyToUnits(t))}_ticksToUnits(t){return oo(super._ticksToUnits(t))}_beatsToUnits(t){return oo(super._beatsToUnits(t))}_secondsToUnits(t){return oo(super._secondsToUnits(t))}toMidi(){return this.valueOf()}toFrequency(){return ao(this.toMidi())}transpose(t){return new No(this.context,this.toMidi()+t)}}function Po(t,e){return new No(Ji(),t,e)}class jo extends mo{constructor(){super(...arguments),this.name="Ticks",this.defaultUnits="i"}_now(){return this.context.transport.ticks}_beatsToUnits(t){return this._getPPQ()*t}_secondsToUnits(t){return Math.floor(t/(60/this._getBpm())*this._getPPQ())}_ticksToUnits(t){return t}toTicks(){return this.valueOf()}toSeconds(){return this.valueOf()/this._getPPQ()*(60/this._getBpm())}}function Lo(t,e){return new jo(Ji(),t,e)}class zo extends vo{constructor(){super(...arguments),this.name="Draw",this.expiration=.25,this.anticipation=.008,this._events=new Ni,this._boundDrawLoop=this._drawLoop.bind(this),this._animationFrame=-1}schedule(t,e){return this._events.add({callback:t,time:this.toSeconds(e)}),1===this._events.length&&(this._animationFrame=requestAnimationFrame(this._boundDrawLoop)),this}cancel(t){return this._events.cancel(this.toSeconds(t)),this}_drawLoop(){const t=this.context.currentTime;for(;this._events.length&&this._events.peek().time-this.anticipation<=t;){const e=this._events.shift();e&&t-e.time<=this.expiration&&e.callback()}this._events.length>0&&(this._animationFrame=requestAnimationFrame(this._boundDrawLoop))}dispose(){return super.dispose(),this._events.dispose(),cancelAnimationFrame(this._animationFrame),this}}ji(t=>{t.draw=new zo({context:t})}),zi(t=>{t.draw.dispose()});class Bo extends Ei{constructor(){super(...arguments),this.name="IntervalTimeline",this._root=null,this._length=0}add(t){ti(ci(t.time),"Events must have a time property"),ti(ci(t.duration),"Events must have a duration parameter"),t.time=t.time.valueOf();let e=new Wo(t.time,t.time+t.duration,t);for(null===this._root?this._root=e:this._root.insert(e),this._length++;null!==e;)e.updateHeight(),e.updateMax(),this._rebalance(e),e=e.parent;return this}remove(t){if(null!==this._root){const e=[];this._root.search(t.time,e);for(const s of e)if(s.event===t){this._removeNode(s),this._length--;break}}return this}get length(){return this._length}cancel(t){return this.forEachFrom(t,t=>this.remove(t)),this}_setRoot(t){this._root=t,null!==this._root&&(this._root.parent=null)}_replaceNodeInParent(t,e){null!==t.parent?(t.isLeftChild()?t.parent.left=e:t.parent.right=e,this._rebalance(t.parent)):this._setRoot(e)}_removeNode(t){if(null===t.left&&null===t.right)this._replaceNodeInParent(t,null);else if(null===t.right)this._replaceNodeInParent(t,t.left);else if(null===t.left)this._replaceNodeInParent(t,t.right);else{let e,s=null;if(t.getBalance()>0)if(null===t.left.right)e=t.left,e.right=t.right,s=e;else{for(e=t.left.right;null!==e.right;)e=e.right;e.parent&&(e.parent.right=e.left,s=e.parent,e.left=t.left,e.right=t.right)}else if(null===t.right.left)e=t.right,e.left=t.left,s=e;else{for(e=t.right.left;null!==e.left;)e=e.left;e.parent&&(e.parent.left=e.right,s=e.parent,e.left=t.left,e.right=t.right)}null!==t.parent?t.isLeftChild()?t.parent.left=e:t.parent.right=e:this._setRoot(e),s&&this._rebalance(s)}t.dispose()}_rotateLeft(t){const e=t.parent,s=t.isLeftChild(),n=t.right;n&&(t.right=n.left,n.left=t),null!==e?s?e.left=n:e.right=n:this._setRoot(n)}_rotateRight(t){const e=t.parent,s=t.isLeftChild(),n=t.left;n&&(t.left=n.right,n.right=t),null!==e?s?e.left=n:e.right=n:this._setRoot(n)}_rebalance(t){const e=t.getBalance();e>1&&t.left?t.left.getBalance()<0?this._rotateLeft(t.left):this._rotateRight(t):e<-1&&t.right&&(t.right.getBalance()>0?this._rotateRight(t.right):this._rotateLeft(t))}get(t){if(null!==this._root){const e=[];if(this._root.search(t,e),e.length>0){let t=e[0];for(let s=1;s<e.length;s++)e[s].low>t.low&&(t=e[s]);return t.event}}return null}forEach(t){if(null!==this._root){const e=[];this._root.traverse(t=>e.push(t)),e.forEach(e=>{e.event&&t(e.event)})}return this}forEachAtTime(t,e){if(null!==this._root){const s=[];this._root.search(t,s),s.forEach(t=>{t.event&&e(t.event)})}return this}forEachFrom(t,e){if(null!==this._root){const s=[];this._root.searchAfter(t,s),s.forEach(t=>{t.event&&e(t.event)})}return this}dispose(){return super.dispose(),null!==this._root&&this._root.traverse(t=>t.dispose()),this._root=null,this}}class Wo{constructor(t,e,s){this._left=null,this._right=null,this.parent=null,this.height=0,this.event=s,this.low=t,this.high=e,this.max=this.high}insert(t){t.low<=this.low?null===this.left?this.left=t:this.left.insert(t):null===this.right?this.right=t:this.right.insert(t)}search(t,e){t>this.max||(null!==this.left&&this.left.search(t,e),this.low<=t&&this.high>t&&e.push(this),this.low>t||null!==this.right&&this.right.search(t,e))}searchAfter(t,e){this.low>=t&&(e.push(this),null!==this.left&&this.left.searchAfter(t,e)),null!==this.right&&this.right.searchAfter(t,e)}traverse(t){t(this),null!==this.left&&this.left.traverse(t),null!==this.right&&this.right.traverse(t)}updateHeight(){null!==this.left&&null!==this.right?this.height=Math.max(this.left.height,this.right.height)+1:null!==this.right?this.height=this.right.height+1:null!==this.left?this.height=this.left.height+1:this.height=0}updateMax(){this.max=this.high,null!==this.left&&(this.max=Math.max(this.max,this.left.max)),null!==this.right&&(this.max=Math.max(this.max,this.right.max))}getBalance(){let t=0;return null!==this.left&&null!==this.right?t=this.left.height-this.right.height:null!==this.left?t=this.left.height+1:null!==this.right&&(t=-(this.right.height+1)),t}isLeftChild(){return null!==this.parent&&this.parent.left===this}get left(){return this._left}set left(t){this._left=t,null!==t&&(t.parent=this),this.updateHeight(),this.updateMax()}get right(){return this._right}set right(t){this._right=t,null!==t&&(t.parent=this),this.updateHeight(),this.updateMax()}dispose(){this.parent=null,this._left=null,this._right=null,this.event=null}}class Go extends wo{constructor(){super(Di(Go.getDefaults(),arguments,["volume"])),this.name="Volume";const t=Di(Go.getDefaults(),arguments,["volume"]);this.input=this.output=new ko({context:this.context,gain:t.volume,units:"decibels"}),this.volume=this.output.gain,Ui(this,"volume"),this._unmutedVolume=t.volume,this.mute=t.mute}static getDefaults(){return Object.assign(wo.getDefaults(),{mute:!1,volume:0})}get mute(){return this.volume.value===-1/0}set mute(t){!this.mute&&t?(this._unmutedVolume=this.volume.value,this.volume.value=-1/0):this.mute&&!t&&(this.volume.value=this._unmutedVolume)}dispose(){return super.dispose(),this.input.dispose(),this.volume.dispose(),this}}class Uo extends wo{constructor(){super(Di(Uo.getDefaults(),arguments)),this.name="Destination",this.input=new Go({context:this.context}),this.output=new ko({context:this.context}),this.volume=this.input.volume;const t=Di(Uo.getDefaults(),arguments);bo(this.input,this.output,this.context.rawContext.destination),this.mute=t.mute,this._internalChannels=[this.input,this.context.rawContext.destination,this.output]}static getDefaults(){return Object.assign(wo.getDefaults(),{mute:!1,volume:0})}get mute(){return this.input.mute}set mute(t){this.input.mute=t}chain(...t){return this.input.disconnect(),t.unshift(this.input),t.push(this.output),bo(...t),this}get maxChannelCount(){return this.context.rawContext.destination.maxChannelCount}dispose(){return super.dispose(),this.volume.dispose(),this}}ji(t=>{t.destination=new Uo({context:t})}),zi(t=>{t.destination.dispose()});class Qo extends Ei{constructor(t){super(),this.name="TimelineValue",this._timeline=new Ni({memory:10}),this._initialValue=t}set(t,e){return this._timeline.add({value:t,time:e}),this}get(t){const e=this._timeline.get(t);return e?e.value:this._initialValue}}class Zo{constructor(t,e){this.id=Zo._eventId++;const s=Object.assign(Zo.getDefaults(),e);this.transport=t,this.callback=s.callback,this._once=s.once,this.time=s.time}static getDefaults(){return{callback:Zi,once:!1,time:0}}invoke(t){this.callback&&(this.callback(t),this._once&&this.transport.clear(this.id))}dispose(){return this.callback=void 0,this}}Zo._eventId=0;class Xo extends Zo{constructor(t,e){super(t,e),this._currentId=-1,this._nextId=-1,this._nextTick=this.time,this._boundRestart=this._restart.bind(this);const s=Object.assign(Xo.getDefaults(),e);this.duration=new jo(t.context,s.duration).valueOf(),this._interval=new jo(t.context,s.interval).valueOf(),this._nextTick=s.time,this.transport.on("start",this._boundRestart),this.transport.on("loopStart",this._boundRestart),this.context=this.transport.context,this._restart()}static getDefaults(){return Object.assign({},Zo.getDefaults(),{duration:1/0,interval:1,once:!1})}invoke(t){this._createEvents(t),super.invoke(t)}_createEvents(t){const e=this.transport.getTicksAtTime(t);e>=this.time&&e>=this._nextTick&&this._nextTick+this._interval<this.time+this.duration&&(this._nextTick+=this._interval,this._currentId=this._nextId,this._nextId=this.transport.scheduleOnce(this.invoke.bind(this),new jo(this.context,this._nextTick).toSeconds()))}_restart(t){this.transport.clear(this._currentId),this.transport.clear(this._nextId),this._nextTick=this.time;const e=this.transport.getTicksAtTime(t);e>this.time&&(this._nextTick=this.time+Math.ceil((e-this.time)/this._interval)*this._interval),this._currentId=this.transport.scheduleOnce(this.invoke.bind(this),new jo(this.context,this._nextTick).toSeconds()),this._nextTick+=this._interval,this._nextId=this.transport.scheduleOnce(this.invoke.bind(this),new jo(this.context,this._nextTick).toSeconds())}dispose(){return super.dispose(),this.transport.clear(this._currentId),this.transport.clear(this._nextId),this.transport.off("start",this._boundRestart),this.transport.off("loopStart",this._boundRestart),this}}class Yo extends vo{constructor(){super(Di(Yo.getDefaults(),arguments)),this.name="Transport",this._loop=new Qo(!1),this._loopStart=0,this._loopEnd=0,this._scheduledEvents={},this._timeline=new Ni,this._repeatedEvents=new Bo,this._syncedSignals=[],this._swingAmount=0;const t=Di(Yo.getDefaults(),arguments);this._ppq=t.ppq,this._clock=new qo({callback:this._processTick.bind(this),context:this.context,frequency:0,units:"bpm"}),this._bindClockEvents(),this.bpm=this._clock.frequency,this._clock.frequency.multiplier=t.ppq,this.bpm.setValueAtTime(t.bpm,0),Ui(this,"bpm"),this._timeSignature=t.timeSignature,this._swingTicks=t.ppq/2}static getDefaults(){return Object.assign(vo.getDefaults(),{bpm:120,loopEnd:"4m",loopStart:0,ppq:192,swing:0,swingSubdivision:"8n",timeSignature:4})}_processTick(t,e){if(this._loop.get(t)&&e>=this._loopEnd&&(this.emit("loopEnd",t),this._clock.setTicksAtTime(this._loopStart,t),e=this._loopStart,this.emit("loopStart",t,this._clock.getSecondsAtTime(t)),this.emit("loop",t)),this._swingAmount>0&&e%this._ppq!=0&&e%(2*this._swingTicks)!=0){const s=e%(2*this._swingTicks)/(2*this._swingTicks),n=Math.sin(s*Math.PI)*this._swingAmount;t+=new jo(this.context,2*this._swingTicks/3).toSeconds()*n}this._timeline.forEachAtTime(e,e=>e.invoke(t))}schedule(t,e){const s=new Zo(this,{callback:t,time:new mo(this.context,e).toTicks()});return this._addEvent(s,this._timeline)}scheduleRepeat(t,e,s,n=1/0){const i=new Xo(this,{callback:t,duration:new ho(this.context,n).toTicks(),interval:new ho(this.context,e).toTicks(),time:new mo(this.context,s).toTicks()});return this._addEvent(i,this._repeatedEvents)}scheduleOnce(t,e){const s=new Zo(this,{callback:t,once:!0,time:new mo(this.context,e).toTicks()});return this._addEvent(s,this._timeline)}clear(t){if(this._scheduledEvents.hasOwnProperty(t)){const e=this._scheduledEvents[t.toString()];e.timeline.remove(e.event),e.event.dispose(),delete this._scheduledEvents[t.toString()]}return this}_addEvent(t,e){return this._scheduledEvents[t.id.toString()]={event:t,timeline:e},e.add(t),t.id}cancel(t=0){const e=this.toTicks(t);return this._timeline.forEachFrom(e,t=>this.clear(t.id)),this._repeatedEvents.forEachFrom(e,t=>this.clear(t.id)),this}_bindClockEvents(){this._clock.on("start",(t,e)=>{e=new jo(this.context,e).toSeconds(),this.emit("start",t,e)}),this._clock.on("stop",t=>{this.emit("stop",t)}),this._clock.on("pause",t=>{this.emit("pause",t)})}get state(){return this._clock.getStateAtTime(this.now())}start(t,e){let s;return ci(e)&&(s=this.toTicks(e)),this._clock.start(t,s),this}stop(t){return this._clock.stop(t),this}pause(t){return this._clock.pause(t),this}toggle(t){return t=this.toSeconds(t),"started"!==this._clock.getStateAtTime(t)?this.start(t):this.stop(t),this}get timeSignature(){return this._timeSignature}set timeSignature(t){di(t)&&(t=t[0]/t[1]*4),this._timeSignature=t}get loopStart(){return new ho(this.context,this._loopStart,"i").toSeconds()}set loopStart(t){this._loopStart=this.toTicks(t)}get loopEnd(){return new ho(this.context,this._loopEnd,"i").toSeconds()}set loopEnd(t){this._loopEnd=this.toTicks(t)}get loop(){return this._loop.get(this.now())}set loop(t){this._loop.set(t,this.now())}setLoopPoints(t,e){return this.loopStart=t,this.loopEnd=e,this}get swing(){return this._swingAmount}set swing(t){this._swingAmount=t}get swingSubdivision(){return new jo(this.context,this._swingTicks).toNotation()}set swingSubdivision(t){this._swingTicks=this.toTicks(t)}get position(){const t=this.now(),e=this._clock.getTicksAtTime(t);return new jo(this.context,e).toBarsBeatsSixteenths()}set position(t){const e=this.toTicks(t);this.ticks=e}get seconds(){return this._clock.seconds}set seconds(t){const e=this.now(),s=this._clock.frequency.timeToTicks(t,e);this.ticks=s}get progress(){if(this.loop){const t=this.now();return(this._clock.getTicksAtTime(t)-this._loopStart)/(this._loopEnd-this._loopStart)}return 0}get ticks(){return this._clock.ticks}set ticks(t){if(this._clock.ticks!==t){const e=this.now();if("started"===this.state){const s=this._clock.getTicksAtTime(e),n=e+this._clock.frequency.getDurationOfTicks(Math.ceil(s)-s,e);this.emit("stop",n),this._clock.setTicksAtTime(t,n),this.emit("start",n,this._clock.getSecondsAtTime(n))}else this._clock.setTicksAtTime(t,e)}}getTicksAtTime(t){return Math.round(this._clock.getTicksAtTime(t))}getSecondsAtTime(t){return this._clock.getSecondsAtTime(t)}get PPQ(){return this._clock.frequency.multiplier}set PPQ(t){this._clock.frequency.multiplier=t}nextSubdivision(t){if(t=this.toTicks(t),"started"!==this.state)return 0;{const e=this.now(),s=t-this.getTicksAtTime(e)%t;return this._clock.nextTickTime(s,e)}}syncSignal(t,e){if(!e){const s=this.now();if(0!==t.getValueAtTime(s)){const n=1/(60/this.bpm.getValueAtTime(s)/this.PPQ);e=t.getValueAtTime(s)/n}else e=0}const s=new ko(e);return this.bpm.connect(s),s.connect(t._param),this._syncedSignals.push({initial:t.value,ratio:s,signal:t}),t.value=0,this}unsyncSignal(t){for(let e=this._syncedSignals.length-1;e>=0;e--){const s=this._syncedSignals[e];s.signal===t&&(s.ratio.dispose(),s.signal.value=s.initial,this._syncedSignals.splice(e,1))}return this}dispose(){return super.dispose(),this._clock.dispose(),Qi(this,"bpm"),this._timeline.dispose(),this._repeatedEvents.dispose(),this}}Bi.mixin(Yo),ji(t=>{t.transport=new Yo({context:t})}),zi(t=>{t.transport.dispose()});class Ho extends wo{constructor(t){super(t),this.input=void 0,this._state=new yo("stopped"),this._synced=!1,this._scheduled=[],this._syncedStart=Zi,this._syncedStop=Zi,this._state.memory=100,this._state.increasing=!0,this._volume=this.output=new Go({context:this.context,mute:t.mute,volume:t.volume}),this.volume=this._volume.volume,Ui(this,"volume"),this.onstop=t.onstop}static getDefaults(){return Object.assign(wo.getDefaults(),{mute:!1,onstop:Zi,volume:0})}get state(){return this._synced?"started"===this.context.transport.state?this._state.getValueAtTime(this.context.transport.seconds):"stopped":this._state.getValueAtTime(this.now())}get mute(){return this._volume.mute}set mute(t){this._volume.mute=t}_clampToCurrentTime(t){return this._synced?t:Math.max(t,this.context.currentTime)}start(t,e,s){let n=ai(t)&&this._synced?this.context.transport.seconds:this.toSeconds(t);if(n=this._clampToCurrentTime(n),this._synced||"started"!==this._state.getValueAtTime(n))if(this.log("start",n),this._state.setStateAtTime("started",n),this._synced){const t=this._state.get(n);t&&(t.offset=this.toSeconds(Oi(e,0)),t.duration=s?this.toSeconds(s):void 0);const i=this.context.transport.schedule(t=>{this._start(t,e,s)},n);this._scheduled.push(i),"started"===this.context.transport.state&&this.context.transport.getSecondsAtTime(this.immediate())>n&&this._syncedStart(this.now(),this.context.transport.seconds)}else si(this.context),this._start(n,e,s);else ti(Ri(n,this._state.get(n).time),"Start time must be strictly greater than previous start time"),this._state.cancel(n),this._state.setStateAtTime("started",n),this.log("restart",n),this.restart(n,e,s);return this}stop(t){let e=ai(t)&&this._synced?this.context.transport.seconds:this.toSeconds(t);if(e=this._clampToCurrentTime(e),"started"===this._state.getValueAtTime(e)||ci(this._state.getNextState("started",e))){if(this.log("stop",e),this._synced){const t=this.context.transport.schedule(this._stop.bind(this),e);this._scheduled.push(t)}else this._stop(e);this._state.cancel(e),this._state.setStateAtTime("stopped",e)}return this}restart(t,e,s){return t=this.toSeconds(t),"started"===this._state.getValueAtTime(t)&&(this._state.cancel(t),this._restart(t,e,s)),this}sync(){return this._synced||(this._synced=!0,this._syncedStart=(t,e)=>{if(e>0){const s=this._state.get(e);if(s&&"started"===s.state&&s.time!==e){const n=e-this.toSeconds(s.time);let i;s.duration&&(i=this.toSeconds(s.duration)-n),this._start(t,this.toSeconds(s.offset)+n,i)}}},this._syncedStop=t=>{const e=this.context.transport.getSecondsAtTime(Math.max(t-this.sampleTime,0));"started"===this._state.getValueAtTime(e)&&this._stop(t)},this.context.transport.on("start",this._syncedStart),this.context.transport.on("loopStart",this._syncedStart),this.context.transport.on("stop",this._syncedStop),this.context.transport.on("pause",this._syncedStop),this.context.transport.on("loopEnd",this._syncedStop)),this}unsync(){return this._synced&&(this.context.transport.off("stop",this._syncedStop),this.context.transport.off("pause",this._syncedStop),this.context.transport.off("loopEnd",this._syncedStop),this.context.transport.off("start",this._syncedStart),this.context.transport.off("loopStart",this._syncedStart)),this._synced=!1,this._scheduled.forEach(t=>this.context.transport.clear(t)),this._scheduled=[],this._state.cancel(0),this._stop(0),this}dispose(){return super.dispose(),this.onstop=Zi,this.unsync(),this._volume.dispose(),this._state.dispose(),this}}class $o extends Co{constructor(){super(Di($o.getDefaults(),arguments,["url","onload"])),this.name="ToneBufferSource",this._source=this.context.createBufferSource(),this._internalChannels=[this._source],this._sourceStarted=!1,this._sourceStopped=!1;const t=Di($o.getDefaults(),arguments,["url","onload"]);To(this._source,this._gainNode),this._source.onended=()=>this._stopSource(),this.playbackRate=new xo({context:this.context,param:this._source.playbackRate,units:"positive",value:t.playbackRate}),this.loop=t.loop,this.loopStart=t.loopStart,this.loopEnd=t.loopEnd,this._buffer=new Xi(t.url,t.onload,t.onerror),this._internalChannels.push(this._source)}static getDefaults(){return Object.assign(Co.getDefaults(),{url:new Xi,loop:!1,loopEnd:0,loopStart:0,onload:Zi,onerror:Zi,playbackRate:1})}get fadeIn(){return this._fadeIn}set fadeIn(t){this._fadeIn=t}get fadeOut(){return this._fadeOut}set fadeOut(t){this._fadeOut=t}get curve(){return this._curve}set curve(t){this._curve=t}start(t,e,s,n=1){ti(this.buffer.loaded,"buffer is either not set or not loaded");const i=this.toSeconds(t);this._startGain(i,n),e=this.loop?Oi(e,this.loopStart):Oi(e,0);let o=Math.max(this.toSeconds(e),0);if(this.loop){const t=this.toSeconds(this.loopEnd)||this.buffer.duration,e=this.toSeconds(this.loopStart),s=t-e;qi(o,t)&&(o=(o-e)%s+e),Ii(o,this.buffer.duration)&&(o=0)}if(this._source.buffer=this.buffer.get(),this._source.loopEnd=this.toSeconds(this.loopEnd)||this.buffer.duration,Fi(o,this.buffer.duration)&&(this._sourceStarted=!0,this._source.start(i,o)),ci(s)){let t=this.toSeconds(s);t=Math.max(t,0),this.stop(i+t)}return this}_stopSource(t){!this._sourceStopped&&this._sourceStarted&&(this._sourceStopped=!0,this._source.stop(this.toSeconds(t)),this._onended())}get loopStart(){return this._source.loopStart}set loopStart(t){this._source.loopStart=this.toSeconds(t)}get loopEnd(){return this._source.loopEnd}set loopEnd(t){this._source.loopEnd=this.toSeconds(t)}get buffer(){return this._buffer}set buffer(t){this._buffer.set(t)}get loop(){return this._source.loop}set loop(t){this._source.loop=t,this._sourceStarted&&this.cancelStop()}dispose(){return super.dispose(),this._source.onended=null,this._source.disconnect(),this._buffer.dispose(),this.playbackRate.dispose(),this}}class Jo extends Ho{constructor(){super(Di(Jo.getDefaults(),arguments,["type"])),this.name="Noise",this._source=null;const t=Di(Jo.getDefaults(),arguments,["type"]);this._playbackRate=t.playbackRate,this.type=t.type,this._fadeIn=t.fadeIn,this._fadeOut=t.fadeOut}static getDefaults(){return Object.assign(Ho.getDefaults(),{fadeIn:0,fadeOut:0,playbackRate:1,type:"white"})}get type(){return this._type}set type(t){if(ti(t in tr,"Noise: invalid type: "+t),this._type!==t&&(this._type=t,"started"===this.state)){const t=this.now();this._stop(t),this._start(t)}}get playbackRate(){return this._playbackRate}set playbackRate(t){this._playbackRate=t,this._source&&(this._source.playbackRate.value=t)}_start(t){const e=tr[this._type];this._source=new $o({url:e,context:this.context,fadeIn:this._fadeIn,fadeOut:this._fadeOut,loop:!0,onended:()=>this.onstop(this),playbackRate:this._playbackRate}).connect(this.output),this._source.start(this.toSeconds(t),Math.random()*(e.duration-.001))}_stop(t){this._source&&(this._source.stop(this.toSeconds(t)),this._source=null)}get fadeIn(){return this._fadeIn}set fadeIn(t){this._fadeIn=t,this._source&&(this._source.fadeIn=this._fadeIn)}get fadeOut(){return this._fadeOut}set fadeOut(t){this._fadeOut=t,this._source&&(this._source.fadeOut=this._fadeOut)}_restart(t){this._stop(t),this._start(t)}dispose(){return super.dispose(),this._source&&this._source.disconnect(),this}}const Ko={brown:null,pink:null,white:null},tr={get brown(){if(!Ko.brown){const t=[];for(let e=0;e<2;e++){const s=new Float32Array(220500);t[e]=s;let n=0;for(let t=0;t<220500;t++){const e=2*Math.random()-1;s[t]=(n+.02*e)/1.02,n=s[t],s[t]*=3.5}}Ko.brown=(new Xi).fromArray(t)}return Ko.brown},get pink(){if(!Ko.pink){const t=[];for(let e=0;e<2;e++){const s=new Float32Array(220500);let n,i,o,r,a,c,h;t[e]=s,n=i=o=r=a=c=h=0;for(let t=0;t<220500;t++){const e=2*Math.random()-1;n=.99886*n+.0555179*e,i=.99332*i+.0750759*e,o=.969*o+.153852*e,r=.8665*r+.3104856*e,a=.55*a+.5329522*e,c=-.7616*c-.016898*e,s[t]=n+i+o+r+a+c+h+.5362*e,s[t]*=.11,h=.115926*e}}Ko.pink=(new Xi).fromArray(t)}return Ko.pink},get white(){if(!Ko.white){const t=[];for(let e=0;e<2;e++){const s=new Float32Array(220500);t[e]=s;for(let t=0;t<220500;t++)s[t]=2*Math.random()-1}Ko.white=(new Xi).fromArray(t)}return Ko.white}};class er extends wo{constructor(){super(Di(er.getDefaults(),arguments,["volume"])),this.name="UserMedia";const t=Di(er.getDefaults(),arguments,["volume"]);this._volume=this.output=new Go({context:this.context,volume:t.volume}),this.volume=this._volume.volume,Ui(this,"volume"),this.mute=t.mute}static getDefaults(){return Object.assign(wo.getDefaults(),{mute:!1,volume:0})}open(t){return yi(this,void 0,void 0,(function*(){ti(er.supported,"UserMedia is not supported"),"started"===this.state&&this.close();const e=yield er.enumerateDevices();ui(t)?this._device=e[t]:(this._device=e.find(e=>e.label===t||e.deviceId===t),!this._device&&e.length>0&&(this._device=e[0]),ti(ci(this._device),"No matching device "+t));const s={audio:{echoCancellation:!1,sampleRate:this.context.sampleRate,noiseSuppression:!1,mozNoiseSuppression:!1}};this._device&&(s.audio.deviceId=this._device.deviceId);const n=yield navigator.mediaDevices.getUserMedia(s);if(!this._stream){this._stream=n;const t=this.context.createMediaStreamSource(n);To(t,this.output),this._mediaStream=t}return this}))}close(){return this._stream&&this._mediaStream&&(this._stream.getAudioTracks().forEach(t=>{t.stop()}),this._stream=void 0,this._mediaStream.disconnect(),this._mediaStream=void 0),this._device=void 0,this}static enumerateDevices(){return yi(this,void 0,void 0,(function*(){return(yield navigator.mediaDevices.enumerateDevices()).filter(t=>"audioinput"===t.kind)}))}get state(){return this._stream&&this._stream.active?"started":"stopped"}get deviceId(){return this._device?this._device.deviceId:void 0}get groupId(){return this._device?this._device.groupId:void 0}get label(){return this._device?this._device.label:void 0}get mute(){return this._volume.mute}set mute(t){this._volume.mute=t}dispose(){return super.dispose(),this.close(),this._volume.dispose(),this.volume.dispose(),this}static get supported(){return ci(navigator.mediaDevices)&&ci(navigator.mediaDevices.getUserMedia)}}function sr(t,e){return yi(this,void 0,void 0,(function*(){const s=e/t.context.sampleRate,n=new Yi(1,s,t.context.sampleRate);new t.constructor(Object.assign(t.get(),{frequency:2/s,detune:0,context:n})).toDestination().start(0);return(yield n.render()).getChannelData(0)}))}class nr extends Co{constructor(){super(Di(nr.getDefaults(),arguments,["frequency","type"])),this.name="ToneOscillatorNode",this._oscillator=this.context.createOscillator(),this._internalChannels=[this._oscillator];const t=Di(nr.getDefaults(),arguments,["frequency","type"]);To(this._oscillator,this._gainNode),this.type=t.type,this.frequency=new xo({context:this.context,param:this._oscillator.frequency,units:"frequency",value:t.frequency}),this.detune=new xo({context:this.context,param:this._oscillator.detune,units:"cents",value:t.detune}),Ui(this,["frequency","detune"])}static getDefaults(){return Object.assign(Co.getDefaults(),{detune:0,frequency:440,type:"sine"})}start(t){const e=this.toSeconds(t);return this.log("start",e),this._startGain(e),this._oscillator.start(e),this}_stopSource(t){this._oscillator.stop(t)}setPeriodicWave(t){return this._oscillator.setPeriodicWave(t),this}get type(){return this._oscillator.type}set type(t){this._oscillator.type=t}dispose(){return super.dispose(),"started"===this.state&&this.stop(),this._oscillator.disconnect(),this.frequency.dispose(),this.detune.dispose(),this}}class ir extends Ho{constructor(){super(Di(ir.getDefaults(),arguments,["frequency","type"])),this.name="Oscillator",this._oscillator=null;const t=Di(ir.getDefaults(),arguments,["frequency","type"]);this.frequency=new Do({context:this.context,units:"frequency",value:t.frequency}),Ui(this,"frequency"),this.detune=new Do({context:this.context,units:"cents",value:t.detune}),Ui(this,"detune"),this._partials=t.partials,this._partialCount=t.partialCount,this._type=t.type,t.partialCount&&"custom"!==t.type&&(this._type=this.baseType+t.partialCount.toString()),this.phase=t.phase}static getDefaults(){return Object.assign(Ho.getDefaults(),{detune:0,frequency:440,partialCount:0,partials:[],phase:0,type:"sine"})}_start(t){const e=this.toSeconds(t),s=new nr({context:this.context,onended:()=>this.onstop(this)});this._oscillator=s,this._wave?this._oscillator.setPeriodicWave(this._wave):this._oscillator.type=this._type,this._oscillator.connect(this.output),this.frequency.connect(this._oscillator.frequency),this.detune.connect(this._oscillator.detune),this._oscillator.start(e)}_stop(t){const e=this.toSeconds(t);this._oscillator&&this._oscillator.stop(e)}_restart(t){const e=this.toSeconds(t);return this.log("restart",e),this._oscillator&&this._oscillator.cancelStop(),this._state.cancel(e),this}syncFrequency(){return this.context.transport.syncSignal(this.frequency),this}unsyncFrequency(){return this.context.transport.unsyncSignal(this.frequency),this}_getCachedPeriodicWave(){if("custom"===this._type){return ir._periodicWaveCache.find(t=>{return t.phase===this._phase&&(e=t.partials,s=this._partials,e.length===s.length&&e.every((t,e)=>s[e]===t));var e,s})}{const t=ir._periodicWaveCache.find(t=>t.type===this._type&&t.phase===this._phase);return this._partialCount=t?t.partialCount:this._partialCount,t}}get type(){return this._type}set type(t){this._type=t;const e=-1!==["sine","square","sawtooth","triangle"].indexOf(t);if(0===this._phase&&e)this._wave=void 0,this._partialCount=0,null!==this._oscillator&&(this._oscillator.type=t);else{const e=this._getCachedPeriodicWave();if(ci(e)){const{partials:t,wave:s}=e;this._wave=s,this._partials=t,null!==this._oscillator&&this._oscillator.setPeriodicWave(this._wave)}else{const[e,s]=this._getRealImaginary(t,this._phase),n=this.context.createPeriodicWave(e,s);this._wave=n,null!==this._oscillator&&this._oscillator.setPeriodicWave(this._wave),ir._periodicWaveCache.push({imag:s,partialCount:this._partialCount,partials:this._partials,phase:this._phase,real:e,type:this._type,wave:this._wave}),ir._periodicWaveCache.length>100&&ir._periodicWaveCache.shift()}}}get baseType(){return this._type.replace(this.partialCount.toString(),"")}set baseType(t){this.partialCount&&"custom"!==this._type&&"custom"!==t?this.type=t+this.partialCount:this.type=t}get partialCount(){return this._partialCount}set partialCount(t){ei(t,0);let e=this._type;const s=/^(sine|triangle|square|sawtooth)(\d+)$/.exec(this._type);if(s&&(e=s[1]),"custom"!==this._type)this.type=0===t?e:e+t.toString();else{const e=new Float32Array(t);this._partials.forEach((t,s)=>e[s]=t),this._partials=Array.from(e),this.type=this._type}}_getRealImaginary(t,e){let s=2048;const n=new Float32Array(s),i=new Float32Array(s);let o=1;if("custom"===t){if(o=this._partials.length+1,this._partialCount=this._partials.length,s=o,0===this._partials.length)return[n,i]}else{const e=/^(sine|triangle|square|sawtooth)(\d+)$/.exec(t);e?(o=parseInt(e[2],10)+1,this._partialCount=parseInt(e[2],10),t=e[1],o=Math.max(o,2),s=o):this._partialCount=0,this._partials=[]}for(let r=1;r<s;++r){const s=2/(r*Math.PI);let a;switch(t){case"sine":a=r<=o?1:0,this._partials[r-1]=a;break;case"square":a=1&r?2*s:0,this._partials[r-1]=a;break;case"sawtooth":a=s*(1&r?1:-1),this._partials[r-1]=a;break;case"triangle":a=1&r?s*s*2*(r-1>>1&1?-1:1):0,this._partials[r-1]=a;break;case"custom":a=this._partials[r-1];break;default:throw new TypeError("Oscillator: invalid type: "+t)}0!==a?(n[r]=-a*Math.sin(e*r),i[r]=a*Math.cos(e*r)):(n[r]=0,i[r]=0)}return[n,i]}_inverseFFT(t,e,s){let n=0;const i=t.length;for(let o=0;o<i;o++)n+=t[o]*Math.cos(o*s)+e[o]*Math.sin(o*s);return n}getInitialValue(){const[t,e]=this._getRealImaginary(this._type,0);let s=0;const n=2*Math.PI;for(let i=0;i<32;i++)s=Math.max(this._inverseFFT(t,e,i/32*n),s);return Vi(-this._inverseFFT(t,e,this._phase)/s,-1,1)}get partials(){return this._partials.slice(0,this.partialCount)}set partials(t){this._partials=t,this._partialCount=this._partials.length,t.length&&(this.type="custom")}get phase(){return this._phase*(180/Math.PI)}set phase(t){this._phase=t*Math.PI/180,this.type=this._type}asArray(t=1024){return yi(this,void 0,void 0,(function*(){return sr(this,t)}))}dispose(){return super.dispose(),null!==this._oscillator&&this._oscillator.dispose(),this._wave=void 0,this.frequency.dispose(),this.detune.dispose(),this}}ir._periodicWaveCache=[];class or extends wo{constructor(){super(Object.assign(Di(or.getDefaults(),arguments,["context"])))}connect(t,e=0,s=0){return Oo(this,t,e,s),this}}class rr extends or{constructor(){super(Object.assign(Di(rr.getDefaults(),arguments,["mapping","length"]))),this.name="WaveShaper",this._shaper=this.context.createWaveShaper(),this.input=this._shaper,this.output=this._shaper;const t=Di(rr.getDefaults(),arguments,["mapping","length"]);di(t.mapping)||t.mapping instanceof Float32Array?this.curve=Float32Array.from(t.mapping):hi(t.mapping)&&this.setMap(t.mapping,t.length)}static getDefaults(){return Object.assign(Do.getDefaults(),{length:1024})}setMap(t,e=1024){const s=new Float32Array(e);for(let n=0,i=e;n<i;n++){const e=n/(i-1)*2-1;s[n]=t(e,n)}return this.curve=s,this}get curve(){return this._shaper.curve}set curve(t){this._shaper.curve=t}get oversample(){return this._shaper.oversample}set oversample(t){ti(["none","2x","4x"].some(e=>e.includes(t)),"oversampling must be either 'none', '2x', or '4x'"),this._shaper.oversample=t}dispose(){return super.dispose(),this._shaper.disconnect(),this}}class ar extends or{constructor(){super(...arguments),this.name="AudioToGain",this._norm=new rr({context:this.context,mapping:t=>(t+1)/2}),this.input=this._norm,this.output=this._norm}dispose(){return super.dispose(),this._norm.dispose(),this}}class cr extends Do{constructor(){super(Object.assign(Di(cr.getDefaults(),arguments,["value"]))),this.name="Multiply",this.override=!1;const t=Di(cr.getDefaults(),arguments,["value"]);this._mult=this.input=this.output=new ko({context:this.context,minValue:t.minValue,maxValue:t.maxValue}),this.factor=this._param=this._mult.gain,this.factor.setValueAtTime(t.value,0)}static getDefaults(){return Object.assign(Do.getDefaults(),{value:0})}dispose(){return super.dispose(),this._mult.dispose(),this}}class hr extends Ho{constructor(){super(Di(hr.getDefaults(),arguments,["frequency","type","modulationType"])),this.name="AMOscillator",this._modulationScale=new ar({context:this.context}),this._modulationNode=new ko({context:this.context});const t=Di(hr.getDefaults(),arguments,["frequency","type","modulationType"]);this._carrier=new ir({context:this.context,detune:t.detune,frequency:t.frequency,onstop:()=>this.onstop(this),phase:t.phase,type:t.type}),this.frequency=this._carrier.frequency,this.detune=this._carrier.detune,this._modulator=new ir({context:this.context,phase:t.phase,type:t.modulationType}),this.harmonicity=new cr({context:this.context,units:"positive",value:t.harmonicity}),this.frequency.chain(this.harmonicity,this._modulator.frequency),this._modulator.chain(this._modulationScale,this._modulationNode.gain),this._carrier.chain(this._modulationNode,this.output),Ui(this,["frequency","detune","harmonicity"])}static getDefaults(){return Object.assign(ir.getDefaults(),{harmonicity:1,modulationType:"square"})}_start(t){this._modulator.start(t),this._carrier.start(t)}_stop(t){this._modulator.stop(t),this._carrier.stop(t)}_restart(t){this._modulator.restart(t),this._carrier.restart(t)}get type(){return this._carrier.type}set type(t){this._carrier.type=t}get baseType(){return this._carrier.baseType}set baseType(t){this._carrier.baseType=t}get partialCount(){return this._carrier.partialCount}set partialCount(t){this._carrier.partialCount=t}get modulationType(){return this._modulator.type}set modulationType(t){this._modulator.type=t}get phase(){return this._carrier.phase}set phase(t){this._carrier.phase=t,this._modulator.phase=t}get partials(){return this._carrier.partials}set partials(t){this._carrier.partials=t}asArray(t=1024){return yi(this,void 0,void 0,(function*(){return sr(this,t)}))}dispose(){return super.dispose(),this.frequency.dispose(),this.detune.dispose(),this.harmonicity.dispose(),this._carrier.dispose(),this._modulator.dispose(),this._modulationNode.dispose(),this._modulationScale.dispose(),this}}class ur extends Ho{constructor(){super(Di(ur.getDefaults(),arguments,["frequency","type","modulationType"])),this.name="FMOscillator",this._modulationNode=new ko({context:this.context,gain:0});const t=Di(ur.getDefaults(),arguments,["frequency","type","modulationType"]);this._carrier=new ir({context:this.context,detune:t.detune,frequency:0,onstop:()=>this.onstop(this),phase:t.phase,type:t.type}),this.detune=this._carrier.detune,this.frequency=new Do({context:this.context,units:"frequency",value:t.frequency}),this._modulator=new ir({context:this.context,phase:t.phase,type:t.modulationType}),this.harmonicity=new cr({context:this.context,units:"positive",value:t.harmonicity}),this.modulationIndex=new cr({context:this.context,units:"positive",value:t.modulationIndex}),this.frequency.connect(this._carrier.frequency),this.frequency.chain(this.harmonicity,this._modulator.frequency),this.frequency.chain(this.modulationIndex,this._modulationNode),this._modulator.connect(this._modulationNode.gain),this._modulationNode.connect(this._carrier.frequency),this._carrier.connect(this.output),this.detune.connect(this._modulator.detune),Ui(this,["modulationIndex","frequency","detune","harmonicity"])}static getDefaults(){return Object.assign(ir.getDefaults(),{harmonicity:1,modulationIndex:2,modulationType:"square"})}_start(t){this._modulator.start(t),this._carrier.start(t)}_stop(t){this._modulator.stop(t),this._carrier.stop(t)}_restart(t){return this._modulator.restart(t),this._carrier.restart(t),this}get type(){return this._carrier.type}set type(t){this._carrier.type=t}get baseType(){return this._carrier.baseType}set baseType(t){this._carrier.baseType=t}get partialCount(){return this._carrier.partialCount}set partialCount(t){this._carrier.partialCount=t}get modulationType(){return this._modulator.type}set modulationType(t){this._modulator.type=t}get phase(){return this._carrier.phase}set phase(t){this._carrier.phase=t,this._modulator.phase=t}get partials(){return this._carrier.partials}set partials(t){this._carrier.partials=t}asArray(t=1024){return yi(this,void 0,void 0,(function*(){return sr(this,t)}))}dispose(){return super.dispose(),this.frequency.dispose(),this.harmonicity.dispose(),this._carrier.dispose(),this._modulator.dispose(),this._modulationNode.dispose(),this.modulationIndex.dispose(),this}}class lr extends Ho{constructor(){super(Di(lr.getDefaults(),arguments,["frequency","width"])),this.name="PulseOscillator",this._widthGate=new ko({context:this.context,gain:0}),this._thresh=new rr({context:this.context,mapping:t=>t<=0?-1:1});const t=Di(lr.getDefaults(),arguments,["frequency","width"]);this.width=new Do({context:this.context,units:"audioRange",value:t.width}),this._triangle=new ir({context:this.context,detune:t.detune,frequency:t.frequency,onstop:()=>this.onstop(this),phase:t.phase,type:"triangle"}),this.frequency=this._triangle.frequency,this.detune=this._triangle.detune,this._triangle.chain(this._thresh,this.output),this.width.chain(this._widthGate,this._thresh),Ui(this,["width","frequency","detune"])}static getDefaults(){return Object.assign(Ho.getDefaults(),{detune:0,frequency:440,phase:0,type:"pulse",width:.2})}_start(t){t=this.toSeconds(t),this._triangle.start(t),this._widthGate.gain.setValueAtTime(1,t)}_stop(t){t=this.toSeconds(t),this._triangle.stop(t),this._widthGate.gain.cancelScheduledValues(t),this._widthGate.gain.setValueAtTime(0,t)}_restart(t){this._triangle.restart(t),this._widthGate.gain.cancelScheduledValues(t),this._widthGate.gain.setValueAtTime(1,t)}get phase(){return this._triangle.phase}set phase(t){this._triangle.phase=t}get type(){return"pulse"}get baseType(){return"pulse"}get partials(){return[]}get partialCount(){return 0}set carrierType(t){this._triangle.type=t}asArray(t=1024){return yi(this,void 0,void 0,(function*(){return sr(this,t)}))}dispose(){return super.dispose(),this._triangle.dispose(),this.width.dispose(),this._widthGate.dispose(),this._thresh.dispose(),this}}class pr extends Ho{constructor(){super(Di(pr.getDefaults(),arguments,["frequency","type","spread"])),this.name="FatOscillator",this._oscillators=[];const t=Di(pr.getDefaults(),arguments,["frequency","type","spread"]);this.frequency=new Do({context:this.context,units:"frequency",value:t.frequency}),this.detune=new Do({context:this.context,units:"cents",value:t.detune}),this._spread=t.spread,this._type=t.type,this._phase=t.phase,this._partials=t.partials,this._partialCount=t.partialCount,this.count=t.count,Ui(this,["frequency","detune"])}static getDefaults(){return Object.assign(ir.getDefaults(),{count:3,spread:20,type:"sawtooth"})}_start(t){t=this.toSeconds(t),this._forEach(e=>e.start(t))}_stop(t){t=this.toSeconds(t),this._forEach(e=>e.stop(t))}_restart(t){this._forEach(e=>e.restart(t))}_forEach(t){for(let e=0;e<this._oscillators.length;e++)t(this._oscillators[e],e)}get type(){return this._type}set type(t){this._type=t,this._forEach(e=>e.type=t)}get spread(){return this._spread}set spread(t){if(this._spread=t,this._oscillators.length>1){const e=-t/2,s=t/(this._oscillators.length-1);this._forEach((t,n)=>t.detune.value=e+s*n)}}get count(){return this._oscillators.length}set count(t){if(ei(t,1),this._oscillators.length!==t){this._forEach(t=>t.dispose()),this._oscillators=[];for(let e=0;e<t;e++){const s=new ir({context:this.context,volume:-6-1.1*t,type:this._type,phase:this._phase+e/t*360,partialCount:this._partialCount,onstop:0===e?()=>this.onstop(this):Zi});"custom"===this.type&&(s.partials=this._partials),this.frequency.connect(s.frequency),this.detune.connect(s.detune),s.detune.overridden=!1,s.connect(this.output),this._oscillators[e]=s}this.spread=this._spread,"started"===this.state&&this._forEach(t=>t.start())}}get phase(){return this._phase}set phase(t){this._phase=t,this._forEach((t,e)=>t.phase=this._phase+e/this.count*360)}get baseType(){return this._oscillators[0].baseType}set baseType(t){this._forEach(e=>e.baseType=t),this._type=this._oscillators[0].type}get partials(){return this._oscillators[0].partials}set partials(t){this._partials=t,this._partialCount=this._partials.length,t.length&&(this._type="custom",this._forEach(e=>e.partials=t))}get partialCount(){return this._oscillators[0].partialCount}set partialCount(t){this._partialCount=t,this._forEach(e=>e.partialCount=t),this._type=this._oscillators[0].type}asArray(t=1024){return yi(this,void 0,void 0,(function*(){return sr(this,t)}))}dispose(){return super.dispose(),this.frequency.dispose(),this.detune.dispose(),this._forEach(t=>t.dispose()),this}}class dr extends Ho{constructor(){super(Di(dr.getDefaults(),arguments,["frequency","modulationFrequency"])),this.name="PWMOscillator",this.sourceType="pwm",this._scale=new cr({context:this.context,value:2});const t=Di(dr.getDefaults(),arguments,["frequency","modulationFrequency"]);this._pulse=new lr({context:this.context,frequency:t.modulationFrequency}),this._pulse.carrierType="sine",this.modulationFrequency=this._pulse.frequency,this._modulator=new ir({context:this.context,detune:t.detune,frequency:t.frequency,onstop:()=>this.onstop(this),phase:t.phase}),this.frequency=this._modulator.frequency,this.detune=this._modulator.detune,this._modulator.chain(this._scale,this._pulse.width),this._pulse.connect(this.output),Ui(this,["modulationFrequency","frequency","detune"])}static getDefaults(){return Object.assign(Ho.getDefaults(),{detune:0,frequency:440,modulationFrequency:.4,phase:0,type:"pwm"})}_start(t){t=this.toSeconds(t),this._modulator.start(t),this._pulse.start(t)}_stop(t){t=this.toSeconds(t),this._modulator.stop(t),this._pulse.stop(t)}_restart(t){this._modulator.restart(t),this._pulse.restart(t)}get type(){return"pwm"}get baseType(){return"pwm"}get partials(){return[]}get partialCount(){return 0}get phase(){return this._modulator.phase}set phase(t){this._modulator.phase=t}asArray(t=1024){return yi(this,void 0,void 0,(function*(){return sr(this,t)}))}dispose(){return super.dispose(),this._pulse.dispose(),this._scale.dispose(),this._modulator.dispose(),this}}const fr={am:hr,fat:pr,fm:ur,oscillator:ir,pulse:lr,pwm:dr};class _r extends Ho{constructor(){super(Di(_r.getDefaults(),arguments,["frequency","type"])),this.name="OmniOscillator";const t=Di(_r.getDefaults(),arguments,["frequency","type"]);this.frequency=new Do({context:this.context,units:"frequency",value:t.frequency}),this.detune=new Do({context:this.context,units:"cents",value:t.detune}),Ui(this,["frequency","detune"]),this.set(t)}static getDefaults(){return Object.assign(ir.getDefaults(),ur.getDefaults(),hr.getDefaults(),pr.getDefaults(),lr.getDefaults(),dr.getDefaults())}_start(t){this._oscillator.start(t)}_stop(t){this._oscillator.stop(t)}_restart(t){return this._oscillator.restart(t),this}get type(){let t="";return["am","fm","fat"].some(t=>this._sourceType===t)&&(t=this._sourceType),t+this._oscillator.type}set type(t){"fm"===t.substr(0,2)?(this._createNewOscillator("fm"),this._oscillator=this._oscillator,this._oscillator.type=t.substr(2)):"am"===t.substr(0,2)?(this._createNewOscillator("am"),this._oscillator=this._oscillator,this._oscillator.type=t.substr(2)):"fat"===t.substr(0,3)?(this._createNewOscillator("fat"),this._oscillator=this._oscillator,this._oscillator.type=t.substr(3)):"pwm"===t?(this._createNewOscillator("pwm"),this._oscillator=this._oscillator):"pulse"===t?this._createNewOscillator("pulse"):(this._createNewOscillator("oscillator"),this._oscillator=this._oscillator,this._oscillator.type=t)}get partials(){return this._oscillator.partials}set partials(t){this._getOscType(this._oscillator,"pulse")||this._getOscType(this._oscillator,"pwm")||(this._oscillator.partials=t)}get partialCount(){return this._oscillator.partialCount}set partialCount(t){this._getOscType(this._oscillator,"pulse")||this._getOscType(this._oscillator,"pwm")||(this._oscillator.partialCount=t)}set(t){return Reflect.has(t,"type")&&t.type&&(this.type=t.type),super.set(t),this}_createNewOscillator(t){if(t!==this._sourceType){this._sourceType=t;const e=fr[t],s=this.now();if(this._oscillator){const t=this._oscillator;t.stop(s),this.context.setTimeout(()=>t.dispose(),this.blockTime)}this._oscillator=new e({context:this.context}),this.frequency.connect(this._oscillator.frequency),this.detune.connect(this._oscillator.detune),this._oscillator.connect(this.output),this._oscillator.onstop=()=>this.onstop(this),"started"===this.state&&this._oscillator.start(s)}}get phase(){return this._oscillator.phase}set phase(t){this._oscillator.phase=t}get sourceType(){return this._sourceType}set sourceType(t){let e="sine";"pwm"!==this._oscillator.type&&"pulse"!==this._oscillator.type&&(e=this._oscillator.type),"fm"===t?this.type="fm"+e:"am"===t?this.type="am"+e:"fat"===t?this.type="fat"+e:"oscillator"===t?this.type=e:"pulse"===t?this.type="pulse":"pwm"===t&&(this.type="pwm")}_getOscType(t,e){return t instanceof fr[e]}get baseType(){return this._oscillator.baseType}set baseType(t){this._getOscType(this._oscillator,"pulse")||this._getOscType(this._oscillator,"pwm")||"pulse"===t||"pwm"===t||(this._oscillator.baseType=t)}get width(){return this._getOscType(this._oscillator,"pulse")?this._oscillator.width:void 0}get count(){return this._getOscType(this._oscillator,"fat")?this._oscillator.count:void 0}set count(t){this._getOscType(this._oscillator,"fat")&&ui(t)&&(this._oscillator.count=t)}get spread(){return this._getOscType(this._oscillator,"fat")?this._oscillator.spread:void 0}set spread(t){this._getOscType(this._oscillator,"fat")&&ui(t)&&(this._oscillator.spread=t)}get modulationType(){return this._getOscType(this._oscillator,"fm")||this._getOscType(this._oscillator,"am")?this._oscillator.modulationType:void 0}set modulationType(t){(this._getOscType(this._oscillator,"fm")||this._getOscType(this._oscillator,"am"))&&fi(t)&&(this._oscillator.modulationType=t)}get modulationIndex(){return this._getOscType(this._oscillator,"fm")?this._oscillator.modulationIndex:void 0}get harmonicity(){return this._getOscType(this._oscillator,"fm")||this._getOscType(this._oscillator,"am")?this._oscillator.harmonicity:void 0}get modulationFrequency(){return this._getOscType(this._oscillator,"pwm")?this._oscillator.modulationFrequency:void 0}asArray(t=1024){return yi(this,void 0,void 0,(function*(){return sr(this,t)}))}dispose(){return super.dispose(),this.detune.dispose(),this.frequency.dispose(),this._oscillator.dispose(),this}}class mr extends Do{constructor(){super(Object.assign(Di(mr.getDefaults(),arguments,["value"]))),this.override=!1,this.name="Add",this._sum=new ko({context:this.context}),this.input=this._sum,this.output=this._sum,this.addend=this._param,bo(this._constantSource,this._sum)}static getDefaults(){return Object.assign(Do.getDefaults(),{value:0})}dispose(){return super.dispose(),this._sum.dispose(),this}}class gr extends or{constructor(){super(Object.assign(Di(gr.getDefaults(),arguments,["min","max"]))),this.name="Scale";const t=Di(gr.getDefaults(),arguments,["min","max"]);this._mult=this.input=new cr({context:this.context,value:t.max-t.min}),this._add=this.output=new mr({context:this.context,value:t.min}),this._min=t.min,this._max=t.max,this.input.connect(this.output)}static getDefaults(){return Object.assign(or.getDefaults(),{max:1,min:0})}get min(){return this._min}set min(t){this._min=t,this._setRange()}get max(){return this._max}set max(t){this._max=t,this._setRange()}_setRange(){this._add.value=this._min,this._mult.value=this._max-this._min}dispose(){return super.dispose(),this._add.dispose(),this._mult.dispose(),this}}class vr extends or{constructor(){super(Object.assign(Di(vr.getDefaults(),arguments))),this.name="Zero",this._gain=new ko({context:this.context}),this.output=this._gain,this.input=void 0,To(this.context.getConstant(0),this._gain)}dispose(){return super.dispose(),So(this.context.getConstant(0),this._gain),this}}class yr extends wo{constructor(){super(Di(yr.getDefaults(),arguments,["frequency","min","max"])),this.name="LFO",this._stoppedValue=0,this._units="number",this.convert=!0,this._fromType=xo.prototype._fromType,this._toType=xo.prototype._toType,this._is=xo.prototype._is,this._clampValue=xo.prototype._clampValue;const t=Di(yr.getDefaults(),arguments,["frequency","min","max"]);this._oscillator=new ir(t),this.frequency=this._oscillator.frequency,this._amplitudeGain=new ko({context:this.context,gain:t.amplitude,units:"normalRange"}),this.amplitude=this._amplitudeGain.gain,this._stoppedSignal=new Do({context:this.context,units:"audioRange",value:0}),this._zeros=new vr({context:this.context}),this._a2g=new ar({context:this.context}),this._scaler=this.output=new gr({context:this.context,max:t.max,min:t.min}),this.units=t.units,this.min=t.min,this.max=t.max,this._oscillator.chain(this._amplitudeGain,this._a2g,this._scaler),this._zeros.connect(this._a2g),this._stoppedSignal.connect(this._a2g),Ui(this,["amplitude","frequency"]),this.phase=t.phase}static getDefaults(){return Object.assign(ir.getDefaults(),{amplitude:1,frequency:"4n",max:1,min:0,type:"sine",units:"number"})}start(t){return t=this.toSeconds(t),this._stoppedSignal.setValueAtTime(0,t),this._oscillator.start(t),this}stop(t){return t=this.toSeconds(t),this._stoppedSignal.setValueAtTime(this._stoppedValue,t),this._oscillator.stop(t),this}sync(){return this._oscillator.sync(),this._oscillator.syncFrequency(),this}unsync(){return this._oscillator.unsync(),this._oscillator.unsyncFrequency(),this}_setStoppedValue(){this._stoppedValue=this._oscillator.getInitialValue(),this._stoppedSignal.value=this._stoppedValue}get min(){return this._toType(this._scaler.min)}set min(t){t=this._fromType(t),this._scaler.min=t}get max(){return this._toType(this._scaler.max)}set max(t){t=this._fromType(t),this._scaler.max=t}get type(){return this._oscillator.type}set type(t){this._oscillator.type=t,this._setStoppedValue()}get partials(){return this._oscillator.partials}set partials(t){this._oscillator.partials=t,this._setStoppedValue()}get phase(){return this._oscillator.phase}set phase(t){this._oscillator.phase=t,this._setStoppedValue()}get units(){return this._units}set units(t){const e=this.min,s=this.max;this._units=t,this.min=e,this.max=s}get state(){return this._oscillator.state}connect(t,e,s){return(t instanceof xo||t instanceof Do)&&(this.convert=t.convert,this.units=t.units),Oo(this,t,e,s),this}dispose(){return super.dispose(),this._oscillator.dispose(),this._stoppedSignal.dispose(),this._zeros.dispose(),this._scaler.dispose(),this._a2g.dispose(),this._amplitudeGain.dispose(),this.amplitude.dispose(),this}}function xr(t,e=1/0){const s=new WeakMap;return function(n,i){Reflect.defineProperty(n,i,{configurable:!0,enumerable:!0,get:function(){return s.get(this)},set:function(n){ei(n,t,e),s.set(this,n)}})}}function wr(t,e=1/0){const s=new WeakMap;return function(n,i){Reflect.defineProperty(n,i,{configurable:!0,enumerable:!0,get:function(){return s.get(this)},set:function(n){ei(this.toSeconds(n),t,e),s.set(this,n)}})}}class br extends Ho{constructor(){super(Di(br.getDefaults(),arguments,["url","onload"])),this.name="Player",this._activeSources=new Set;const t=Di(br.getDefaults(),arguments,["url","onload"]);this._buffer=new Xi({onload:this._onload.bind(this,t.onload),onerror:t.onerror,reverse:t.reverse,url:t.url}),this.autostart=t.autostart,this._loop=t.loop,this._loopStart=t.loopStart,this._loopEnd=t.loopEnd,this._playbackRate=t.playbackRate,this.fadeIn=t.fadeIn,this.fadeOut=t.fadeOut}static getDefaults(){return Object.assign(Ho.getDefaults(),{autostart:!1,fadeIn:0,fadeOut:0,loop:!1,loopEnd:0,loopStart:0,onload:Zi,onerror:Zi,playbackRate:1,reverse:!1})}load(t){return yi(this,void 0,void 0,(function*(){return yield this._buffer.load(t),this._onload(),this}))}_onload(t=Zi){t(),this.autostart&&this.start()}_onSourceEnd(t){this.onstop(this),this._activeSources.delete(t),0!==this._activeSources.size||this._synced||"started"!==this._state.getValueAtTime(this.now())||(this._state.cancel(this.now()),this._state.setStateAtTime("stopped",this.now()))}start(t,e,s){return super.start(t,e,s),this}_start(t,e,s){e=this._loop?Oi(e,this._loopStart):Oi(e,0);const n=this.toSeconds(e),i=s;s=Oi(s,Math.max(this._buffer.duration-n,0));let o=this.toSeconds(s);o/=this._playbackRate,t=this.toSeconds(t);const r=new $o({url:this._buffer,context:this.context,fadeIn:this.fadeIn,fadeOut:this.fadeOut,loop:this._loop,loopEnd:this._loopEnd,loopStart:this._loopStart,onended:this._onSourceEnd.bind(this),playbackRate:this._playbackRate}).connect(this.output);this._loop||this._synced||(this._state.cancel(t+o),this._state.setStateAtTime("stopped",t+o,{implicitEnd:!0})),this._activeSources.add(r),this._loop&&ai(i)?r.start(t,n):r.start(t,n,o-this.toSeconds(this.fadeOut))}_stop(t){const e=this.toSeconds(t);this._activeSources.forEach(t=>t.stop(e))}restart(t,e,s){return super.restart(t,e,s),this}_restart(t,e,s){this._stop(t),this._start(t,e,s)}seek(t,e){const s=this.toSeconds(e);if("started"===this._state.getValueAtTime(s)){const e=this.toSeconds(t);this._stop(s),this._start(s,e)}return this}setLoopPoints(t,e){return this.loopStart=t,this.loopEnd=e,this}get loopStart(){return this._loopStart}set loopStart(t){this._loopStart=t,this.buffer.loaded&&ei(this.toSeconds(t),0,this.buffer.duration),this._activeSources.forEach(e=>{e.loopStart=t})}get loopEnd(){return this._loopEnd}set loopEnd(t){this._loopEnd=t,this.buffer.loaded&&ei(this.toSeconds(t),0,this.buffer.duration),this._activeSources.forEach(e=>{e.loopEnd=t})}get buffer(){return this._buffer}set buffer(t){this._buffer.set(t)}get loop(){return this._loop}set loop(t){if(this._loop!==t&&(this._loop=t,this._activeSources.forEach(e=>{e.loop=t}),t)){const t=this._state.getNextState("stopped",this.now());t&&this._state.cancel(t.time)}}get playbackRate(){return this._playbackRate}set playbackRate(t){this._playbackRate=t;const e=this.now(),s=this._state.getNextState("stopped",e);s&&s.implicitEnd&&(this._state.cancel(s.time),this._activeSources.forEach(t=>t.cancelStop())),this._activeSources.forEach(s=>{s.playbackRate.setValueAtTime(t,e)})}get reverse(){return this._buffer.reverse}set reverse(t){this._buffer.reverse=t}get loaded(){return this._buffer.loaded}dispose(){return super.dispose(),this._activeSources.forEach(t=>t.dispose()),this._activeSources.clear(),this._buffer.dispose(),this}}vi([wr(0)],br.prototype,"fadeIn",void 0),vi([wr(0)],br.prototype,"fadeOut",void 0);class Tr extends wo{constructor(){super(Di(Tr.getDefaults(),arguments,["urls","onload"],"urls")),this.name="Players",this.input=void 0,this._players=new Map;const t=Di(Tr.getDefaults(),arguments,["urls","onload"],"urls");this._volume=this.output=new Go({context:this.context,volume:t.volume}),this.volume=this._volume.volume,Ui(this,"volume"),this._buffers=new Vo({urls:t.urls,onload:t.onload,baseUrl:t.baseUrl,onerror:t.onerror}),this.mute=t.mute,this._fadeIn=t.fadeIn,this._fadeOut=t.fadeOut}static getDefaults(){return Object.assign(Ho.getDefaults(),{baseUrl:"",fadeIn:0,fadeOut:0,mute:!1,onload:Zi,onerror:Zi,urls:{},volume:0})}get mute(){return this._volume.mute}set mute(t){this._volume.mute=t}get fadeIn(){return this._fadeIn}set fadeIn(t){this._fadeIn=t,this._players.forEach(e=>{e.fadeIn=t})}get fadeOut(){return this._fadeOut}set fadeOut(t){this._fadeOut=t,this._players.forEach(e=>{e.fadeOut=t})}get state(){return Array.from(this._players).some(([t,e])=>"started"===e.state)?"started":"stopped"}has(t){return this._buffers.has(t)}player(t){if(ti(this.has(t),`No Player with the name ${t} exists on this object`),!this._players.has(t)){const e=new br({context:this.context,fadeIn:this._fadeIn,fadeOut:this._fadeOut,url:this._buffers.get(t)}).connect(this.output);this._players.set(t,e)}return this._players.get(t)}get loaded(){return this._buffers.loaded}add(t,e,s){return ti(!this._buffers.has(t),"A buffer with that name already exists on this object"),this._buffers.add(t,e,s),this}stopAll(t){return this._players.forEach(e=>e.stop(t)),this}dispose(){return super.dispose(),this._volume.dispose(),this.volume.dispose(),this._players.forEach(t=>t.dispose()),this._buffers.dispose(),this}}class Sr extends Ho{constructor(){super(Di(Sr.getDefaults(),arguments,["url","onload"])),this.name="GrainPlayer",this._loopStart=0,this._loopEnd=0,this._activeSources=[];const t=Di(Sr.getDefaults(),arguments,["url","onload"]);this.buffer=new Xi({onload:t.onload,onerror:t.onerror,reverse:t.reverse,url:t.url}),this._clock=new qo({context:this.context,callback:this._tick.bind(this),frequency:1/t.grainSize}),this._playbackRate=t.playbackRate,this._grainSize=t.grainSize,this._overlap=t.overlap,this.detune=t.detune,this.overlap=t.overlap,this.loop=t.loop,this.playbackRate=t.playbackRate,this.grainSize=t.grainSize,this.loopStart=t.loopStart,this.loopEnd=t.loopEnd,this.reverse=t.reverse,this._clock.on("stop",this._onstop.bind(this))}static getDefaults(){return Object.assign(Ho.getDefaults(),{onload:Zi,onerror:Zi,overlap:.1,grainSize:.2,playbackRate:1,detune:0,loop:!1,loopStart:0,loopEnd:0,reverse:!1})}_start(t,e,s){e=Oi(e,0),e=this.toSeconds(e),t=this.toSeconds(t);const n=1/this._clock.frequency.getValueAtTime(t);this._clock.start(t,e/n),s&&this.stop(t+this.toSeconds(s))}restart(t,e,s){return super.restart(t,e,s),this}_restart(t,e,s){this._stop(t),this._start(t,e,s)}_stop(t){this._clock.stop(t)}_onstop(t){this._activeSources.forEach(e=>{e.fadeOut=0,e.stop(t)}),this.onstop(this)}_tick(t){const e=this._clock.getTicksAtTime(t),s=e*this._grainSize;if(this.log("offset",s),!this.loop&&s>this.buffer.duration)return void this.stop(t);const n=s<this._overlap?0:this._overlap,i=new $o({context:this.context,url:this.buffer,fadeIn:n,fadeOut:this._overlap,loop:this.loop,loopStart:this._loopStart,loopEnd:this._loopEnd,playbackRate:no(this.detune/100)}).connect(this.output);i.start(t,this._grainSize*e),i.stop(t+this._grainSize/this.playbackRate),this._activeSources.push(i),i.onended=()=>{const t=this._activeSources.indexOf(i);-1!==t&&this._activeSources.splice(t,1)}}get playbackRate(){return this._playbackRate}set playbackRate(t){ei(t,.001),this._playbackRate=t,this.grainSize=this._grainSize}get loopStart(){return this._loopStart}set loopStart(t){this.buffer.loaded&&ei(this.toSeconds(t),0,this.buffer.duration),this._loopStart=this.toSeconds(t)}get loopEnd(){return this._loopEnd}set loopEnd(t){this.buffer.loaded&&ei(this.toSeconds(t),0,this.buffer.duration),this._loopEnd=this.toSeconds(t)}get reverse(){return this.buffer.reverse}set reverse(t){this.buffer.reverse=t}get grainSize(){return this._grainSize}set grainSize(t){this._grainSize=this.toSeconds(t),this._clock.frequency.setValueAtTime(this._playbackRate/this._grainSize,this.now())}get overlap(){return this._overlap}set overlap(t){const e=this.toSeconds(t);ei(e,0),this._overlap=e}get loaded(){return this.buffer.loaded}dispose(){return super.dispose(),this.buffer.dispose(),this._clock.dispose(),this._activeSources.forEach(t=>t.dispose()),this}}class kr extends or{constructor(){super(...arguments),this.name="Abs",this._abs=new rr({context:this.context,mapping:t=>Math.abs(t)<.001?0:Math.abs(t)}),this.input=this._abs,this.output=this._abs}dispose(){return super.dispose(),this._abs.dispose(),this}}class Cr extends or{constructor(){super(...arguments),this.name="GainToAudio",this._norm=new rr({context:this.context,mapping:t=>2*Math.abs(t)-1}),this.input=this._norm,this.output=this._norm}dispose(){return super.dispose(),this._norm.dispose(),this}}class Ar extends or{constructor(){super(...arguments),this.name="Negate",this._multiply=new cr({context:this.context,value:-1}),this.input=this._multiply,this.output=this._multiply}dispose(){return super.dispose(),this._multiply.dispose(),this}}class Dr extends Do{constructor(){super(Object.assign(Di(Dr.getDefaults(),arguments,["value"]))),this.override=!1,this.name="Subtract",this._sum=new ko({context:this.context}),this.input=this._sum,this.output=this._sum,this._neg=new Ar({context:this.context}),this.subtrahend=this._param,bo(this._constantSource,this._neg,this._sum)}static getDefaults(){return Object.assign(Do.getDefaults(),{value:0})}dispose(){return super.dispose(),this._neg.dispose(),this._sum.dispose(),this}}class Or extends or{constructor(){super(Object.assign(Di(Or.getDefaults(),arguments))),this.name="GreaterThanZero",this._thresh=this.output=new rr({context:this.context,length:127,mapping:t=>t<=0?0:1}),this._scale=this.input=new cr({context:this.context,value:1e4}),this._scale.connect(this._thresh)}dispose(){return super.dispose(),this._scale.dispose(),this._thresh.dispose(),this}}class Mr extends Do{constructor(){super(Object.assign(Di(Mr.getDefaults(),arguments,["value"]))),this.name="GreaterThan",this.override=!1;const t=Di(Mr.getDefaults(),arguments,["value"]);this._subtract=this.input=new Dr({context:this.context,value:t.value}),this._gtz=this.output=new Or({context:this.context}),this.comparator=this._param=this._subtract.subtrahend,Ui(this,"comparator"),this._subtract.connect(this._gtz)}static getDefaults(){return Object.assign(Do.getDefaults(),{value:0})}dispose(){return super.dispose(),this._gtz.dispose(),this._subtract.dispose(),this.comparator.dispose(),this}}class Er extends or{constructor(){super(Object.assign(Di(Er.getDefaults(),arguments,["value"]))),this.name="Pow";const t=Di(Er.getDefaults(),arguments,["value"]);this._exponentScaler=this.input=this.output=new rr({context:this.context,mapping:this._expFunc(t.value),length:8192}),this._exponent=t.value}static getDefaults(){return Object.assign(or.getDefaults(),{value:1})}_expFunc(t){return e=>Math.pow(Math.abs(e),t)}get value(){return this._exponent}set value(t){this._exponent=t,this._exponentScaler.setMap(this._expFunc(this._exponent))}dispose(){return super.dispose(),this._exponentScaler.dispose(),this}}class Rr extends gr{constructor(){super(Object.assign(Di(Rr.getDefaults(),arguments,["min","max","exponent"]))),this.name="ScaleExp";const t=Di(Rr.getDefaults(),arguments,["min","max","exponent"]);this.input=this._exp=new Er({context:this.context,value:t.exponent}),this._exp.connect(this._mult)}static getDefaults(){return Object.assign(gr.getDefaults(),{exponent:1})}get exponent(){return this._exp.value}set exponent(t){this._exp.value=t}dispose(){return super.dispose(),this._exp.dispose(),this}}class qr extends Do{constructor(){super(Di(Do.getDefaults(),arguments,["value","units"])),this.name="SyncedSignal",this.override=!1;const t=Di(Do.getDefaults(),arguments,["value","units"]);this._lastVal=t.value,this._synced=this.context.transport.scheduleRepeat(this._onTick.bind(this),"1i"),this._syncedCallback=this._anchorValue.bind(this),this.context.transport.on("start",this._syncedCallback),this.context.transport.on("pause",this._syncedCallback),this.context.transport.on("stop",this._syncedCallback),this._constantSource.disconnect(),this._constantSource.stop(0),this._constantSource=this.output=new Ao({context:this.context,offset:t.value,units:t.units}).start(0),this.setValueAtTime(t.value,0)}_onTick(t){const e=super.getValueAtTime(this.context.transport.seconds);this._lastVal!==e&&(this._lastVal=e,this._constantSource.offset.setValueAtTime(e,t))}_anchorValue(t){const e=super.getValueAtTime(this.context.transport.seconds);this._lastVal=e,this._constantSource.offset.cancelAndHoldAtTime(t),this._constantSource.offset.setValueAtTime(e,t)}getValueAtTime(t){const e=new mo(this.context,t).toSeconds();return super.getValueAtTime(e)}setValueAtTime(t,e){const s=new mo(this.context,e).toSeconds();return super.setValueAtTime(t,s),this}linearRampToValueAtTime(t,e){const s=new mo(this.context,e).toSeconds();return super.linearRampToValueAtTime(t,s),this}exponentialRampToValueAtTime(t,e){const s=new mo(this.context,e).toSeconds();return super.exponentialRampToValueAtTime(t,s),this}setTargetAtTime(t,e,s){const n=new mo(this.context,e).toSeconds();return super.setTargetAtTime(t,n,s),this}cancelScheduledValues(t){const e=new mo(this.context,t).toSeconds();return super.cancelScheduledValues(e),this}setValueCurveAtTime(t,e,s,n){const i=new mo(this.context,e).toSeconds();return s=this.toSeconds(s),super.setValueCurveAtTime(t,i,s,n),this}cancelAndHoldAtTime(t){const e=new mo(this.context,t).toSeconds();return super.cancelAndHoldAtTime(e),this}setRampPoint(t){const e=new mo(this.context,t).toSeconds();return super.setRampPoint(e),this}exponentialRampTo(t,e,s){const n=new mo(this.context,s).toSeconds();return super.exponentialRampTo(t,e,n),this}linearRampTo(t,e,s){const n=new mo(this.context,s).toSeconds();return super.linearRampTo(t,e,n),this}targetRampTo(t,e,s){const n=new mo(this.context,s).toSeconds();return super.targetRampTo(t,e,n),this}dispose(){return super.dispose(),this.context.transport.clear(this._synced),this.context.transport.off("start",this._syncedCallback),this.context.transport.off("pause",this._syncedCallback),this.context.transport.off("stop",this._syncedCallback),this._constantSource.dispose(),this}}class Fr extends wo{constructor(){super(Di(Fr.getDefaults(),arguments,["attack","decay","sustain","release"])),this.name="Envelope",this._sig=new Do({context:this.context,value:0}),this.output=this._sig,this.input=void 0;const t=Di(Fr.getDefaults(),arguments,["attack","decay","sustain","release"]);this.attack=t.attack,this.decay=t.decay,this.sustain=t.sustain,this.release=t.release,this.attackCurve=t.attackCurve,this.releaseCurve=t.releaseCurve,this.decayCurve=t.decayCurve}static getDefaults(){return Object.assign(wo.getDefaults(),{attack:.01,attackCurve:"linear",decay:.1,decayCurve:"exponential",release:1,releaseCurve:"exponential",sustain:.5})}get value(){return this.getValueAtTime(this.now())}_getCurve(t,e){if(fi(t))return t;{let s;for(s in Ir)if(Ir[s][e]===t)return s;return t}}_setCurve(t,e,s){if(fi(s)&&Reflect.has(Ir,s)){const n=Ir[s];li(n)?"_decayCurve"!==t&&(this[t]=n[e]):this[t]=n}else{if(!di(s)||"_decayCurve"===t)throw new Error("Envelope: invalid curve: "+s);this[t]=s}}get attackCurve(){return this._getCurve(this._attackCurve,"In")}set attackCurve(t){this._setCurve("_attackCurve","In",t)}get releaseCurve(){return this._getCurve(this._releaseCurve,"Out")}set releaseCurve(t){this._setCurve("_releaseCurve","Out",t)}get decayCurve(){return this._decayCurve}set decayCurve(t){ti(["linear","exponential"].some(e=>e===t),"Invalid envelope curve: "+t),this._decayCurve=t}triggerAttack(t,e=1){this.log("triggerAttack",t,e),t=this.toSeconds(t);let s=this.toSeconds(this.attack);const n=this.toSeconds(this.decay),i=this.getValueAtTime(t);if(i>0){s=(1-i)/(1/s)}if(s<this.sampleTime)this._sig.cancelScheduledValues(t),this._sig.setValueAtTime(e,t);else if("linear"===this._attackCurve)this._sig.linearRampTo(e,s,t);else if("exponential"===this._attackCurve)this._sig.targetRampTo(e,s,t);else{this._sig.cancelAndHoldAtTime(t);let n=this._attackCurve;for(let t=1;t<n.length;t++)if(n[t-1]<=i&&i<=n[t]){n=this._attackCurve.slice(t),n[0]=i;break}this._sig.setValueCurveAtTime(n,t,s,e)}if(n&&this.sustain<1){const i=e*this.sustain,o=t+s;this.log("decay",o),"linear"===this._decayCurve?this._sig.linearRampToValueAtTime(i,n+o):this._sig.exponentialApproachValueAtTime(i,o,n)}return this}triggerRelease(t){this.log("triggerRelease",t),t=this.toSeconds(t);const e=this.getValueAtTime(t);if(e>0){const s=this.toSeconds(this.release);s<this.sampleTime?this._sig.setValueAtTime(0,t):"linear"===this._releaseCurve?this._sig.linearRampTo(0,s,t):"exponential"===this._releaseCurve?this._sig.targetRampTo(0,s,t):(ti(di(this._releaseCurve),"releaseCurve must be either 'linear', 'exponential' or an array"),this._sig.cancelAndHoldAtTime(t),this._sig.setValueCurveAtTime(this._releaseCurve,t,s,e))}return this}getValueAtTime(t){return this._sig.getValueAtTime(t)}triggerAttackRelease(t,e,s=1){return e=this.toSeconds(e),this.triggerAttack(e,s),this.triggerRelease(e+this.toSeconds(t)),this}cancel(t){return this._sig.cancelScheduledValues(this.toSeconds(t)),this}connect(t,e=0,s=0){return Oo(this,t,e,s),this}asArray(t=1024){return yi(this,void 0,void 0,(function*(){const e=t/this.context.sampleRate,s=new Yi(1,e,this.context.sampleRate),n=this.toSeconds(this.attack)+this.toSeconds(this.decay),i=n+this.toSeconds(this.release),o=.1*i,r=i+o,a=new this.constructor(Object.assign(this.get(),{attack:e*this.toSeconds(this.attack)/r,decay:e*this.toSeconds(this.decay)/r,release:e*this.toSeconds(this.release)/r,context:s}));a._sig.toDestination(),a.triggerAttackRelease(e*(n+o)/r,0);return(yield s.render()).getChannelData(0)}))}dispose(){return super.dispose(),this._sig.dispose(),this}}vi([wr(0)],Fr.prototype,"attack",void 0),vi([wr(0)],Fr.prototype,"decay",void 0),vi([xr(0,1)],Fr.prototype,"sustain",void 0),vi([wr(0)],Fr.prototype,"release",void 0);const Ir=(()=>{let t,e;const s=[];for(t=0;t<128;t++)s[t]=Math.sin(t/127*(Math.PI/2));const n=[];for(t=0;t<127;t++){e=t/127;const s=Math.sin(e*(2*Math.PI)*6.4-Math.PI/2)+1;n[t]=s/10+.83*e}n[127]=1;const i=[];for(t=0;t<128;t++)i[t]=Math.ceil(t/127*5)/5;const o=[];for(t=0;t<128;t++)e=t/127,o[t]=.5*(1-Math.cos(Math.PI*e));const r=[];for(t=0;t<128;t++){e=t/127;const s=4*Math.pow(e,3)+.2,n=Math.cos(s*Math.PI*2*e);r[t]=Math.abs(n*(1-e))}function a(t){const e=new Array(t.length);for(let s=0;s<t.length;s++)e[s]=1-t[s];return e}return{bounce:{In:a(r),Out:r},cosine:{In:s,Out:(c=s,c.slice(0).reverse())},exponential:"exponential",linear:"linear",ripple:{In:n,Out:a(n)},sine:{In:o,Out:a(o)},step:{In:i,Out:a(i)}};var c})();class Vr extends wo{constructor(){super(Di(Vr.getDefaults(),arguments)),this._scheduledEvents=[],this._synced=!1,this._original_triggerAttack=this.triggerAttack,this._original_triggerRelease=this.triggerRelease;const t=Di(Vr.getDefaults(),arguments);this._volume=this.output=new Go({context:this.context,volume:t.volume}),this.volume=this._volume.volume,Ui(this,"volume")}static getDefaults(){return Object.assign(wo.getDefaults(),{volume:0})}sync(){return this._syncState()&&(this._syncMethod("triggerAttack",1),this._syncMethod("triggerRelease",0)),this}_syncState(){let t=!1;return this._synced||(this._synced=!0,t=!0),t}_syncMethod(t,e){const s=this["_original_"+t]=this[t];this[t]=(...t)=>{const n=t[e],i=this.context.transport.schedule(n=>{t[e]=n,s.apply(this,t)},n);this._scheduledEvents.push(i)}}unsync(){return this._scheduledEvents.forEach(t=>this.context.transport.clear(t)),this._scheduledEvents=[],this._synced&&(this._synced=!1,this.triggerAttack=this._original_triggerAttack,this.triggerRelease=this._original_triggerRelease),this}triggerAttackRelease(t,e,s,n){const i=this.toSeconds(s),o=this.toSeconds(e);return this.triggerAttack(t,i,n),this.triggerRelease(i+o),this}dispose(){return super.dispose(),this._volume.dispose(),this.unsync(),this._scheduledEvents=[],this}}class Nr extends Vr{constructor(){super(Di(Nr.getDefaults(),arguments));const t=Di(Nr.getDefaults(),arguments);this.portamento=t.portamento,this.onsilence=t.onsilence}static getDefaults(){return Object.assign(Vr.getDefaults(),{detune:0,onsilence:Zi,portamento:0})}triggerAttack(t,e,s=1){this.log("triggerAttack",t,e,s);const n=this.toSeconds(e);return this._triggerEnvelopeAttack(n,s),this.setNote(t,n),this}triggerRelease(t){this.log("triggerRelease",t);const e=this.toSeconds(t);return this._triggerEnvelopeRelease(e),this}setNote(t,e){const s=this.toSeconds(e),n=t instanceof lo?t.toFrequency():t;if(this.portamento>0&&this.getLevelAtTime(s)>.05){const t=this.toSeconds(this.portamento);this.frequency.exponentialRampTo(n,t,s)}else this.frequency.setValueAtTime(n,s);return this}}vi([wr(0)],Nr.prototype,"portamento",void 0);class Pr extends Fr{constructor(){super(Di(Pr.getDefaults(),arguments,["attack","decay","sustain","release"])),this.name="AmplitudeEnvelope",this._gainNode=new ko({context:this.context,gain:0}),this.output=this._gainNode,this.input=this._gainNode,this._sig.connect(this._gainNode.gain),this.output=this._gainNode,this.input=this._gainNode}dispose(){return super.dispose(),this._gainNode.dispose(),this}}class jr extends Nr{constructor(){super(Di(jr.getDefaults(),arguments)),this.name="Synth";const t=Di(jr.getDefaults(),arguments);this.oscillator=new _r(Object.assign({context:this.context,detune:t.detune,onstop:()=>this.onsilence(this)},t.oscillator)),this.frequency=this.oscillator.frequency,this.detune=this.oscillator.detune,this.envelope=new Pr(Object.assign({context:this.context},t.envelope)),this.oscillator.chain(this.envelope,this.output),Ui(this,["oscillator","frequency","detune","envelope"])}static getDefaults(){return Object.assign(Nr.getDefaults(),{envelope:Object.assign(Mi(Fr.getDefaults(),Object.keys(wo.getDefaults())),{attack:.005,decay:.1,release:1,sustain:.3}),oscillator:Object.assign(Mi(_r.getDefaults(),[...Object.keys(Ho.getDefaults()),"frequency","detune"]),{type:"triangle"})})}_triggerEnvelopeAttack(t,e){if(this.envelope.triggerAttack(t,e),this.oscillator.start(t),0===this.envelope.sustain){const e=this.toSeconds(this.envelope.attack),s=this.toSeconds(this.envelope.decay);this.oscillator.stop(t+e+s)}}_triggerEnvelopeRelease(t){this.envelope.triggerRelease(t),this.oscillator.stop(t+this.toSeconds(this.envelope.release))}getLevelAtTime(t){return t=this.toSeconds(t),this.envelope.getValueAtTime(t)}dispose(){return super.dispose(),this.oscillator.dispose(),this.envelope.dispose(),this}}class Lr extends Nr{constructor(){super(Di(Lr.getDefaults(),arguments)),this.name="ModulationSynth";const t=Di(Lr.getDefaults(),arguments);this._carrier=new jr({context:this.context,oscillator:t.oscillator,envelope:t.envelope,onsilence:()=>this.onsilence(this),volume:-10}),this._modulator=new jr({context:this.context,oscillator:t.modulation,envelope:t.modulationEnvelope,volume:-10}),this.oscillator=this._carrier.oscillator,this.envelope=this._carrier.envelope,this.modulation=this._modulator.oscillator,this.modulationEnvelope=this._modulator.envelope,this.frequency=new Do({context:this.context,units:"frequency"}),this.detune=new Do({context:this.context,value:t.detune,units:"cents"}),this.harmonicity=new cr({context:this.context,value:t.harmonicity,minValue:0}),this._modulationNode=new ko({context:this.context,gain:0}),Ui(this,["frequency","harmonicity","oscillator","envelope","modulation","modulationEnvelope","detune"])}static getDefaults(){return Object.assign(Nr.getDefaults(),{harmonicity:3,oscillator:Object.assign(Mi(_r.getDefaults(),[...Object.keys(Ho.getDefaults()),"frequency","detune"]),{type:"sine"}),envelope:Object.assign(Mi(Fr.getDefaults(),Object.keys(wo.getDefaults())),{attack:.01,decay:.01,sustain:1,release:.5}),modulation:Object.assign(Mi(_r.getDefaults(),[...Object.keys(Ho.getDefaults()),"frequency","detune"]),{type:"square"}),modulationEnvelope:Object.assign(Mi(Fr.getDefaults(),Object.keys(wo.getDefaults())),{attack:.5,decay:0,sustain:1,release:.5})})}_triggerEnvelopeAttack(t,e){this._carrier._triggerEnvelopeAttack(t,e),this._modulator._triggerEnvelopeAttack(t,e)}_triggerEnvelopeRelease(t){return this._carrier._triggerEnvelopeRelease(t),this._modulator._triggerEnvelopeRelease(t),this}getLevelAtTime(t){return t=this.toSeconds(t),this.envelope.getValueAtTime(t)}dispose(){return super.dispose(),this._carrier.dispose(),this._modulator.dispose(),this.frequency.dispose(),this.detune.dispose(),this.harmonicity.dispose(),this._modulationNode.dispose(),this}}class zr extends Lr{constructor(){super(Di(zr.getDefaults(),arguments)),this.name="AMSynth",this._modulationScale=new ar({context:this.context}),this.frequency.connect(this._carrier.frequency),this.frequency.chain(this.harmonicity,this._modulator.frequency),this.detune.fan(this._carrier.detune,this._modulator.detune),this._modulator.chain(this._modulationScale,this._modulationNode.gain),this._carrier.chain(this._modulationNode,this.output)}dispose(){return super.dispose(),this._modulationScale.dispose(),this}}class Br extends wo{constructor(){super(Di(Br.getDefaults(),arguments,["frequency","type"])),this.name="BiquadFilter";const t=Di(Br.getDefaults(),arguments,["frequency","type"]);this._filter=this.context.createBiquadFilter(),this.input=this.output=this._filter,this.Q=new xo({context:this.context,units:"number",value:t.Q,param:this._filter.Q}),this.frequency=new xo({context:this.context,units:"frequency",value:t.frequency,param:this._filter.frequency}),this.detune=new xo({context:this.context,units:"cents",value:t.detune,param:this._filter.detune}),this.gain=new xo({context:this.context,units:"decibels",convert:!1,value:t.gain,param:this._filter.gain}),this.type=t.type}static getDefaults(){return Object.assign(wo.getDefaults(),{Q:1,type:"lowpass",frequency:350,detune:0,gain:0})}get type(){return this._filter.type}set type(t){ti(-1!==["lowpass","highpass","bandpass","lowshelf","highshelf","notch","allpass","peaking"].indexOf(t),"Invalid filter type: "+t),this._filter.type=t}getFrequencyResponse(t=128){const e=new Float32Array(t);for(let s=0;s<t;s++){const n=19980*Math.pow(s/t,2)+20;e[s]=n}const s=new Float32Array(t),n=new Float32Array(t),i=this.context.createBiquadFilter();return i.type=this.type,i.Q.value=this.Q.value,i.frequency.value=this.frequency.value,i.gain.value=this.gain.value,i.getFrequencyResponse(e,s,n),s}dispose(){return super.dispose(),this._filter.disconnect(),this.Q.dispose(),this.frequency.dispose(),this.gain.dispose(),this.detune.dispose(),this}}class Wr extends wo{constructor(){super(Di(Wr.getDefaults(),arguments,["frequency","type","rolloff"])),this.name="Filter",this.input=new ko({context:this.context}),this.output=new ko({context:this.context}),this._filters=[];const t=Di(Wr.getDefaults(),arguments,["frequency","type","rolloff"]);this._filters=[],this.Q=new Do({context:this.context,units:"positive",value:t.Q}),this.frequency=new Do({context:this.context,units:"frequency",value:t.frequency}),this.detune=new Do({context:this.context,units:"cents",value:t.detune}),this.gain=new Do({context:this.context,units:"decibels",convert:!1,value:t.gain}),this._type=t.type,this.rolloff=t.rolloff,Ui(this,["detune","frequency","gain","Q"])}static getDefaults(){return Object.assign(wo.getDefaults(),{Q:1,detune:0,frequency:350,gain:0,rolloff:-12,type:"lowpass"})}get type(){return this._type}set type(t){ti(-1!==["lowpass","highpass","bandpass","lowshelf","highshelf","notch","allpass","peaking"].indexOf(t),"Invalid filter type: "+t),this._type=t,this._filters.forEach(e=>e.type=t)}get rolloff(){return this._rolloff}set rolloff(t){const e=ui(t)?t:parseInt(t,10),s=[-12,-24,-48,-96];let n=s.indexOf(e);ti(-1!==n,"rolloff can only be "+s.join(", ")),n+=1,this._rolloff=e,this.input.disconnect(),this._filters.forEach(t=>t.disconnect()),this._filters=new Array(n);for(let t=0;t<n;t++){const e=new Br({context:this.context});e.type=this._type,this.frequency.connect(e.frequency),this.detune.connect(e.detune),this.Q.connect(e.Q),this.gain.connect(e.gain),this._filters[t]=e}this._internalChannels=this._filters,bo(this.input,...this._internalChannels,this.output)}getFrequencyResponse(t=128){const e=new Br({frequency:this.frequency.value,gain:this.gain.value,Q:this.Q.value,type:this._type,detune:this.detune.value}),s=new Float32Array(t).map(()=>1);return this._filters.forEach(()=>{e.getFrequencyResponse(t).forEach((t,e)=>s[e]*=t)}),e.dispose(),s}dispose(){return super.dispose(),this._filters.forEach(t=>{t.dispose()}),Qi(this,["detune","frequency","gain","Q"]),this.frequency.dispose(),this.Q.dispose(),this.detune.dispose(),this.gain.dispose(),this}}class Gr extends Fr{constructor(){super(Di(Gr.getDefaults(),arguments,["attack","decay","sustain","release"])),this.name="FrequencyEnvelope";const t=Di(Gr.getDefaults(),arguments,["attack","decay","sustain","release"]);this._octaves=t.octaves,this._baseFrequency=this.toFrequency(t.baseFrequency),this._exponent=this.input=new Er({context:this.context,value:t.exponent}),this._scale=this.output=new gr({context:this.context,min:this._baseFrequency,max:this._baseFrequency*Math.pow(2,this._octaves)}),this._sig.chain(this._exponent,this._scale)}static getDefaults(){return Object.assign(Fr.getDefaults(),{baseFrequency:200,exponent:1,octaves:4})}get baseFrequency(){return this._baseFrequency}set baseFrequency(t){const e=this.toFrequency(t);ei(e,0),this._baseFrequency=e,this._scale.min=this._baseFrequency,this.octaves=this._octaves}get octaves(){return this._octaves}set octaves(t){this._octaves=t,this._scale.max=this._baseFrequency*Math.pow(2,t)}get exponent(){return this._exponent.value}set exponent(t){this._exponent.value=t}dispose(){return super.dispose(),this._exponent.dispose(),this._scale.dispose(),this}}class Ur extends Nr{constructor(){super(Di(Ur.getDefaults(),arguments)),this.name="MonoSynth";const t=Di(Ur.getDefaults(),arguments);this.oscillator=new _r(Object.assign(t.oscillator,{context:this.context,detune:t.detune,onstop:()=>this.onsilence(this)})),this.frequency=this.oscillator.frequency,this.detune=this.oscillator.detune,this.filter=new Wr(Object.assign(t.filter,{context:this.context})),this.filterEnvelope=new Gr(Object.assign(t.filterEnvelope,{context:this.context})),this.envelope=new Pr(Object.assign(t.envelope,{context:this.context})),this.oscillator.chain(this.filter,this.envelope,this.output),this.filterEnvelope.connect(this.filter.frequency),Ui(this,["oscillator","frequency","detune","filter","filterEnvelope","envelope"])}static getDefaults(){return Object.assign(Nr.getDefaults(),{envelope:Object.assign(Mi(Fr.getDefaults(),Object.keys(wo.getDefaults())),{attack:.005,decay:.1,release:1,sustain:.9}),filter:Object.assign(Mi(Wr.getDefaults(),Object.keys(wo.getDefaults())),{Q:1,rolloff:-12,type:"lowpass"}),filterEnvelope:Object.assign(Mi(Gr.getDefaults(),Object.keys(wo.getDefaults())),{attack:.6,baseFrequency:200,decay:.2,exponent:2,octaves:3,release:2,sustain:.5}),oscillator:Object.assign(Mi(_r.getDefaults(),Object.keys(Ho.getDefaults())),{type:"sawtooth"})})}_triggerEnvelopeAttack(t,e=1){if(this.envelope.triggerAttack(t,e),this.filterEnvelope.triggerAttack(t),this.oscillator.start(t),0===this.envelope.sustain){const e=this.toSeconds(this.envelope.attack),s=this.toSeconds(this.envelope.decay);this.oscillator.stop(t+e+s)}}_triggerEnvelopeRelease(t){this.envelope.triggerRelease(t),this.filterEnvelope.triggerRelease(t),this.oscillator.stop(t+this.toSeconds(this.envelope.release))}getLevelAtTime(t){return t=this.toSeconds(t),this.envelope.getValueAtTime(t)}dispose(){return super.dispose(),this.oscillator.dispose(),this.envelope.dispose(),this.filterEnvelope.dispose(),this.filter.dispose(),this}}class Qr extends Nr{constructor(){super(Di(Qr.getDefaults(),arguments)),this.name="DuoSynth";const t=Di(Qr.getDefaults(),arguments);this.voice0=new Ur(Object.assign(t.voice0,{context:this.context,onsilence:()=>this.onsilence(this)})),this.voice1=new Ur(Object.assign(t.voice1,{context:this.context})),this.harmonicity=new cr({context:this.context,units:"positive",value:t.harmonicity}),this._vibrato=new yr({frequency:t.vibratoRate,context:this.context,min:-50,max:50}),this._vibrato.start(),this.vibratoRate=this._vibrato.frequency,this._vibratoGain=new ko({context:this.context,units:"normalRange",gain:t.vibratoAmount}),this.vibratoAmount=this._vibratoGain.gain,this.frequency=new Do({context:this.context,units:"frequency",value:440}),this.detune=new Do({context:this.context,units:"cents",value:t.detune}),this.frequency.connect(this.voice0.frequency),this.frequency.chain(this.harmonicity,this.voice1.frequency),this._vibrato.connect(this._vibratoGain),this._vibratoGain.fan(this.voice0.detune,this.voice1.detune),this.detune.fan(this.voice0.detune,this.voice1.detune),this.voice0.connect(this.output),this.voice1.connect(this.output),Ui(this,["voice0","voice1","frequency","vibratoAmount","vibratoRate"])}getLevelAtTime(t){return t=this.toSeconds(t),this.voice0.envelope.getValueAtTime(t)+this.voice1.envelope.getValueAtTime(t)}static getDefaults(){return Ai(Nr.getDefaults(),{vibratoAmount:.5,vibratoRate:5,harmonicity:1.5,voice0:Ai(Mi(Ur.getDefaults(),Object.keys(Nr.getDefaults())),{filterEnvelope:{attack:.01,decay:0,sustain:1,release:.5},envelope:{attack:.01,decay:0,sustain:1,release:.5}}),voice1:Ai(Mi(Ur.getDefaults(),Object.keys(Nr.getDefaults())),{filterEnvelope:{attack:.01,decay:0,sustain:1,release:.5},envelope:{attack:.01,decay:0,sustain:1,release:.5}})})}_triggerEnvelopeAttack(t,e){this.voice0._triggerEnvelopeAttack(t,e),this.voice1._triggerEnvelopeAttack(t,e)}_triggerEnvelopeRelease(t){return this.voice0._triggerEnvelopeRelease(t),this.voice1._triggerEnvelopeRelease(t),this}dispose(){return super.dispose(),this.voice0.dispose(),this.voice1.dispose(),this.frequency.dispose(),this.detune.dispose(),this._vibrato.dispose(),this.vibratoRate.dispose(),this._vibratoGain.dispose(),this.harmonicity.dispose(),this}}class Zr extends Lr{constructor(){super(Di(Zr.getDefaults(),arguments)),this.name="FMSynth";const t=Di(Zr.getDefaults(),arguments);this.modulationIndex=new cr({context:this.context,value:t.modulationIndex}),this.frequency.connect(this._carrier.frequency),this.frequency.chain(this.harmonicity,this._modulator.frequency),this.frequency.chain(this.modulationIndex,this._modulationNode),this.detune.fan(this._carrier.detune,this._modulator.detune),this._modulator.connect(this._modulationNode.gain),this._modulationNode.connect(this._carrier.frequency),this._carrier.connect(this.output)}static getDefaults(){return Object.assign(Lr.getDefaults(),{modulationIndex:10})}dispose(){return super.dispose(),this.modulationIndex.dispose(),this}}const Xr=[1,1.483,1.932,2.546,2.63,3.897];class Yr extends Nr{constructor(){super(Di(Yr.getDefaults(),arguments)),this.name="MetalSynth",this._oscillators=[],this._freqMultipliers=[];const t=Di(Yr.getDefaults(),arguments);this.detune=new Do({context:this.context,units:"cents",value:t.detune}),this.frequency=new Do({context:this.context,units:"frequency"}),this._amplitude=new ko({context:this.context,gain:0}).connect(this.output),this._highpass=new Wr({Q:0,context:this.context,type:"highpass"}).connect(this._amplitude);for(let e=0;e<Xr.length;e++){const s=new ur({context:this.context,harmonicity:t.harmonicity,modulationIndex:t.modulationIndex,modulationType:"square",onstop:0===e?()=>this.onsilence(this):Zi,type:"square"});s.connect(this._highpass),this._oscillators[e]=s;const n=new cr({context:this.context,value:Xr[e]});this._freqMultipliers[e]=n,this.frequency.chain(n,s.frequency),this.detune.connect(s.detune)}this._filterFreqScaler=new gr({context:this.context,max:7e3,min:this.toFrequency(t.resonance)}),this.envelope=new Fr({attack:t.envelope.attack,attackCurve:"linear",context:this.context,decay:t.envelope.decay,release:t.envelope.release,sustain:0}),this.envelope.chain(this._filterFreqScaler,this._highpass.frequency),this.envelope.connect(this._amplitude.gain),this._octaves=t.octaves,this.octaves=t.octaves}static getDefaults(){return Ai(Nr.getDefaults(),{envelope:Object.assign(Mi(Fr.getDefaults(),Object.keys(wo.getDefaults())),{attack:.001,decay:1.4,release:.2}),harmonicity:5.1,modulationIndex:32,octaves:1.5,resonance:4e3})}_triggerEnvelopeAttack(t,e=1){return this.envelope.triggerAttack(t,e),this._oscillators.forEach(e=>e.start(t)),0===this.envelope.sustain&&this._oscillators.forEach(e=>{e.stop(t+this.toSeconds(this.envelope.attack)+this.toSeconds(this.envelope.decay))}),this}_triggerEnvelopeRelease(t){return this.envelope.triggerRelease(t),this._oscillators.forEach(e=>e.stop(t+this.toSeconds(this.envelope.release))),this}getLevelAtTime(t){return t=this.toSeconds(t),this.envelope.getValueAtTime(t)}get modulationIndex(){return this._oscillators[0].modulationIndex.value}set modulationIndex(t){this._oscillators.forEach(e=>e.modulationIndex.value=t)}get harmonicity(){return this._oscillators[0].harmonicity.value}set harmonicity(t){this._oscillators.forEach(e=>e.harmonicity.value=t)}get resonance(){return this._filterFreqScaler.min}set resonance(t){this._filterFreqScaler.min=this.toFrequency(t),this.octaves=this._octaves}get octaves(){return this._octaves}set octaves(t){this._octaves=t,this._filterFreqScaler.max=this._filterFreqScaler.min*Math.pow(2,t)}dispose(){return super.dispose(),this._oscillators.forEach(t=>t.dispose()),this._freqMultipliers.forEach(t=>t.dispose()),this.frequency.dispose(),this.detune.dispose(),this._filterFreqScaler.dispose(),this._amplitude.dispose(),this.envelope.dispose(),this._highpass.dispose(),this}}class Hr extends jr{constructor(){super(Di(Hr.getDefaults(),arguments)),this.name="MembraneSynth",this.portamento=0;const t=Di(Hr.getDefaults(),arguments);this.pitchDecay=t.pitchDecay,this.octaves=t.octaves,Ui(this,["oscillator","envelope"])}static getDefaults(){return Ai(Nr.getDefaults(),jr.getDefaults(),{envelope:{attack:.001,attackCurve:"exponential",decay:.4,release:1.4,sustain:.01},octaves:10,oscillator:{type:"sine"},pitchDecay:.05})}setNote(t,e){const s=this.toSeconds(e),n=this.toFrequency(t instanceof lo?t.toFrequency():t),i=n*this.octaves;return this.oscillator.frequency.setValueAtTime(i,s),this.oscillator.frequency.exponentialRampToValueAtTime(n,s+this.toSeconds(this.pitchDecay)),this}dispose(){return super.dispose(),this}}vi([xr(0)],Hr.prototype,"octaves",void 0),vi([wr(0)],Hr.prototype,"pitchDecay",void 0);class $r extends Vr{constructor(){super(Di($r.getDefaults(),arguments)),this.name="NoiseSynth";const t=Di($r.getDefaults(),arguments);this.noise=new Jo(Object.assign({context:this.context},t.noise)),this.envelope=new Pr(Object.assign({context:this.context},t.envelope)),this.noise.chain(this.envelope,this.output)}static getDefaults(){return Object.assign(Vr.getDefaults(),{envelope:Object.assign(Mi(Fr.getDefaults(),Object.keys(wo.getDefaults())),{decay:.1,sustain:0}),noise:Object.assign(Mi(Jo.getDefaults(),Object.keys(Ho.getDefaults())),{type:"white"})})}triggerAttack(t,e=1){return t=this.toSeconds(t),this.envelope.triggerAttack(t,e),this.noise.start(t),0===this.envelope.sustain&&this.noise.stop(t+this.toSeconds(this.envelope.attack)+this.toSeconds(this.envelope.decay)),this}triggerRelease(t){return t=this.toSeconds(t),this.envelope.triggerRelease(t),this.noise.stop(t+this.toSeconds(this.envelope.release)),this}sync(){return this._syncState()&&(this._syncMethod("triggerAttack",0),this._syncMethod("triggerRelease",0)),this}triggerAttackRelease(t,e,s=1){return e=this.toSeconds(e),t=this.toSeconds(t),this.triggerAttack(e,s),this.triggerRelease(e+t),this}dispose(){return super.dispose(),this.noise.dispose(),this.envelope.dispose(),this}}const Jr=new Set;function Kr(t){Jr.add(t)}function ta(t,e){const s=`registerProcessor("${t}", ${e})`;Jr.add(s)}class ea extends wo{constructor(t){super(t),this.name="ToneAudioWorklet",this.workletOptions={},this.onprocessorerror=Zi;const e=URL.createObjectURL(new Blob([Array.from(Jr).join("\n")],{type:"text/javascript"})),s=this._audioWorkletName();this._dummyGain=this.context.createGain(),this._dummyParam=this._dummyGain.gain,this.context.addAudioWorkletModule(e,s).then(()=>{this.disposed||(this._worklet=this.context.createAudioWorkletNode(s,this.workletOptions),this._worklet.onprocessorerror=this.onprocessorerror.bind(this),this.onReady(this._worklet))})}dispose(){return super.dispose(),this._dummyGain.disconnect(),this._worklet&&(this._worklet.port.postMessage("dispose"),this._worklet.disconnect()),this}}Kr('\n\t/**\n\t * The base AudioWorkletProcessor for use in Tone.js. Works with the [[ToneAudioWorklet]]. \n\t */\n\tclass ToneAudioWorkletProcessor extends AudioWorkletProcessor {\n\n\t\tconstructor(options) {\n\t\t\t\n\t\t\tsuper(options);\n\t\t\t/**\n\t\t\t * If the processor was disposed or not. Keep alive until it\'s disposed.\n\t\t\t */\n\t\t\tthis.disposed = false;\n\t\t   \t/** \n\t\t\t * The number of samples in the processing block\n\t\t\t */\n\t\t\tthis.blockSize = 128;\n\t\t\t/**\n\t\t\t * the sample rate\n\t\t\t */\n\t\t\tthis.sampleRate = sampleRate;\n\n\t\t\tthis.port.onmessage = (event) => {\n\t\t\t\t// when it receives a dispose \n\t\t\t\tif (event.data === "dispose") {\n\t\t\t\t\tthis.disposed = true;\n\t\t\t\t}\n\t\t\t};\n\t\t}\n\t}\n');Kr("\n\t/**\n\t * Abstract class for a single input/output processor. \n\t * has a 'generate' function which processes one sample at a time\n\t */\n\tclass SingleIOProcessor extends ToneAudioWorkletProcessor {\n\n\t\tconstructor(options) {\n\t\t\tsuper(Object.assign(options, {\n\t\t\t\tnumberOfInputs: 1,\n\t\t\t\tnumberOfOutputs: 1\n\t\t\t}));\n\t\t\t/**\n\t\t\t * Holds the name of the parameter and a single value of that\n\t\t\t * parameter at the current sample\n\t\t\t * @type { [name: string]: number }\n\t\t\t */\n\t\t\tthis.params = {}\n\t\t}\n\n\t\t/**\n\t\t * Generate an output sample from the input sample and parameters\n\t\t * @abstract\n\t\t * @param input number\n\t\t * @param channel number\n\t\t * @param parameters { [name: string]: number }\n\t\t * @returns number\n\t\t */\n\t\tgenerate(){}\n\n\t\t/**\n\t\t * Update the private params object with the \n\t\t * values of the parameters at the given index\n\t\t * @param parameters { [name: string]: Float32Array },\n\t\t * @param index number\n\t\t */\n\t\tupdateParams(parameters, index) {\n\t\t\tfor (const paramName in parameters) {\n\t\t\t\tconst param = parameters[paramName];\n\t\t\t\tif (param.length > 1) {\n\t\t\t\t\tthis.params[paramName] = parameters[paramName][index];\n\t\t\t\t} else {\n\t\t\t\t\tthis.params[paramName] = parameters[paramName][0];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t/**\n\t\t * Process a single frame of the audio\n\t\t * @param inputs Float32Array[][]\n\t\t * @param outputs Float32Array[][]\n\t\t */\n\t\tprocess(inputs, outputs, parameters) {\n\t\t\tconst input = inputs[0];\n\t\t\tconst output = outputs[0];\n\t\t\t// get the parameter values\n\t\t\tconst channelCount = Math.max(input && input.length || 0, output.length);\n\t\t\tfor (let sample = 0; sample < this.blockSize; sample++) {\n\t\t\t\tthis.updateParams(parameters, sample);\n\t\t\t\tfor (let channel = 0; channel < channelCount; channel++) {\n\t\t\t\t\tconst inputSample = input && input.length ? input[channel][sample] : 0;\n\t\t\t\t\toutput[channel][sample] = this.generate(inputSample, channel, this.params);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn !this.disposed;\n\t\t}\n\t};\n");Kr("\n\t/**\n\t * A multichannel buffer for use within an AudioWorkletProcessor as a delay line\n\t */\n\tclass DelayLine {\n\t\t\n\t\tconstructor(size, channels) {\n\t\t\tthis.buffer = [];\n\t\t\tthis.writeHead = []\n\t\t\tthis.size = size;\n\n\t\t\t// create the empty channels\n\t\t\tfor (let i = 0; i < channels; i++) {\n\t\t\t\tthis.buffer[i] = new Float32Array(this.size);\n\t\t\t\tthis.writeHead[i] = 0;\n\t\t\t}\n\t\t}\n\n\t\t/**\n\t\t * Push a value onto the end\n\t\t * @param channel number\n\t\t * @param value number\n\t\t */\n\t\tpush(channel, value) {\n\t\t\tthis.writeHead[channel] += 1;\n\t\t\tif (this.writeHead[channel] > this.size) {\n\t\t\t\tthis.writeHead[channel] = 0;\n\t\t\t}\n\t\t\tthis.buffer[channel][this.writeHead[channel]] = value;\n\t\t}\n\n\t\t/**\n\t\t * Get the recorded value of the channel given the delay\n\t\t * @param channel number\n\t\t * @param delay number delay samples\n\t\t */\n\t\tget(channel, delay) {\n\t\t\tlet readHead = this.writeHead[channel] - Math.floor(delay);\n\t\t\tif (readHead < 0) {\n\t\t\t\treadHead += this.size;\n\t\t\t}\n\t\t\treturn this.buffer[channel][readHead];\n\t\t}\n\t}\n");ta("feedback-comb-filter",'\n\tclass FeedbackCombFilterWorklet extends SingleIOProcessor {\n\n\t\tconstructor(options) {\n\t\t\tsuper(options);\n\t\t\tthis.delayLine = new DelayLine(this.sampleRate, options.channelCount || 2);\n\t\t}\n\n\t\tstatic get parameterDescriptors() {\n\t\t\treturn [{\n\t\t\t\tname: "delayTime",\n\t\t\t\tdefaultValue: 0.1,\n\t\t\t\tminValue: 0,\n\t\t\t\tmaxValue: 1,\n\t\t\t\tautomationRate: "k-rate"\n\t\t\t}, {\n\t\t\t\tname: "feedback",\n\t\t\t\tdefaultValue: 0.5,\n\t\t\t\tminValue: 0,\n\t\t\t\tmaxValue: 0.9999,\n\t\t\t\tautomationRate: "k-rate"\n\t\t\t}];\n\t\t}\n\n\t\tgenerate(input, channel, parameters) {\n\t\t\tconst delayedSample = this.delayLine.get(channel, parameters.delayTime * this.sampleRate);\n\t\t\tthis.delayLine.push(channel, input + delayedSample * parameters.feedback);\n\t\t\treturn delayedSample;\n\t\t}\n\t}\n');class sa extends ea{constructor(){super(Di(sa.getDefaults(),arguments,["delayTime","resonance"])),this.name="FeedbackCombFilter";const t=Di(sa.getDefaults(),arguments,["delayTime","resonance"]);this.input=new ko({context:this.context}),this.output=new ko({context:this.context}),this.delayTime=new xo({context:this.context,value:t.delayTime,units:"time",minValue:0,maxValue:1,param:this._dummyParam,swappable:!0}),this.resonance=new xo({context:this.context,value:t.resonance,units:"normalRange",param:this._dummyParam,swappable:!0}),Ui(this,["resonance","delayTime"])}_audioWorkletName(){return"feedback-comb-filter"}static getDefaults(){return Object.assign(wo.getDefaults(),{delayTime:.1,resonance:.5})}onReady(t){bo(this.input,t,this.output);const e=t.parameters.get("delayTime");this.delayTime.setParam(e);const s=t.parameters.get("feedback");this.resonance.setParam(s)}dispose(){return super.dispose(),this.input.dispose(),this.output.dispose(),this.delayTime.dispose(),this.resonance.dispose(),this}}class na extends wo{constructor(){super(Di(na.getDefaults(),arguments,["frequency","type"])),this.name="OnePoleFilter";const t=Di(na.getDefaults(),arguments,["frequency","type"]);this._frequency=t.frequency,this._type=t.type,this.input=new ko({context:this.context}),this.output=new ko({context:this.context}),this._createFilter()}static getDefaults(){return Object.assign(wo.getDefaults(),{frequency:880,type:"lowpass"})}_createFilter(){const t=this._filter,e=this.toFrequency(this._frequency),s=1/(2*Math.PI*e);if("lowpass"===this._type){const t=1/(s*this.context.sampleRate),e=t-1;this._filter=this.context.createIIRFilter([t,0],[1,e])}else{const t=1/(s*this.context.sampleRate)-1;this._filter=this.context.createIIRFilter([1,-1],[1,t])}this.input.chain(this._filter,this.output),t&&this.context.setTimeout(()=>{this.disposed||(this.input.disconnect(t),t.disconnect())},this.blockTime)}get frequency(){return this._frequency}set frequency(t){this._frequency=t,this._createFilter()}get type(){return this._type}set type(t){this._type=t,this._createFilter()}getFrequencyResponse(t=128){const e=new Float32Array(t);for(let s=0;s<t;s++){const n=19980*Math.pow(s/t,2)+20;e[s]=n}const s=new Float32Array(t),n=new Float32Array(t);return this._filter.getFrequencyResponse(e,s,n),s}dispose(){return super.dispose(),this.input.dispose(),this.output.dispose(),this._filter.disconnect(),this}}class ia extends wo{constructor(){super(Di(ia.getDefaults(),arguments,["delayTime","resonance","dampening"])),this.name="LowpassCombFilter";const t=Di(ia.getDefaults(),arguments,["delayTime","resonance","dampening"]);this._combFilter=this.output=new sa({context:this.context,delayTime:t.delayTime,resonance:t.resonance}),this.delayTime=this._combFilter.delayTime,this.resonance=this._combFilter.resonance,this._lowpass=this.input=new na({context:this.context,frequency:t.dampening,type:"lowpass"}),this._lowpass.connect(this._combFilter)}static getDefaults(){return Object.assign(wo.getDefaults(),{dampening:3e3,delayTime:.1,resonance:.5})}get dampening(){return this._lowpass.frequency}set dampening(t){this._lowpass.frequency=t}dispose(){return super.dispose(),this._combFilter.dispose(),this._lowpass.dispose(),this}}class oa extends Vr{constructor(){super(Di(oa.getDefaults(),arguments)),this.name="PluckSynth";const t=Di(oa.getDefaults(),arguments);this._noise=new Jo({context:this.context,type:"pink"}),this.attackNoise=t.attackNoise,this._lfcf=new ia({context:this.context,dampening:t.dampening,resonance:t.resonance}),this.resonance=t.resonance,this.release=t.release,this._noise.connect(this._lfcf),this._lfcf.connect(this.output)}static getDefaults(){return Ai(Vr.getDefaults(),{attackNoise:1,dampening:4e3,resonance:.7,release:1})}get dampening(){return this._lfcf.dampening}set dampening(t){this._lfcf.dampening=t}triggerAttack(t,e){const s=this.toFrequency(t);e=this.toSeconds(e);const n=1/s;return this._lfcf.delayTime.setValueAtTime(n,e),this._noise.start(e),this._noise.stop(e+n*this.attackNoise),this._lfcf.resonance.cancelScheduledValues(e),this._lfcf.resonance.setValueAtTime(this.resonance,e),this}triggerRelease(t){return this._lfcf.resonance.linearRampTo(0,this.release,t),this}dispose(){return super.dispose(),this._noise.dispose(),this._lfcf.dispose(),this}}class ra extends Vr{constructor(){super(Di(ra.getDefaults(),arguments,["voice","options"])),this.name="PolySynth",this._availableVoices=[],this._activeVoices=[],this._voices=[],this._gcTimeout=-1,this._averageActiveVoices=0;const t=Di(ra.getDefaults(),arguments,["voice","options"]);ti(!ui(t.voice),"DEPRECATED: The polyphony count is no longer the first argument.");const e=t.voice.getDefaults();this.options=Object.assign(e,t.options),this.voice=t.voice,this.maxPolyphony=t.maxPolyphony,this._dummyVoice=this._getNextAvailableVoice();const s=this._voices.indexOf(this._dummyVoice);this._voices.splice(s,1),this._gcTimeout=this.context.setInterval(this._collectGarbage.bind(this),1)}static getDefaults(){return Object.assign(Vr.getDefaults(),{maxPolyphony:32,options:{},voice:jr})}get activeVoices(){return this._activeVoices.length}_makeVoiceAvailable(t){this._availableVoices.push(t);const e=this._activeVoices.findIndex(e=>e.voice===t);this._activeVoices.splice(e,1)}_getNextAvailableVoice(){if(this._availableVoices.length)return this._availableVoices.shift();if(this._voices.length<this.maxPolyphony){const t=new this.voice(Object.assign(this.options,{context:this.context,onsilence:this._makeVoiceAvailable.bind(this)}));return t.connect(this.output),this._voices.push(t),t}ri("Max polyphony exceeded. Note dropped.")}_collectGarbage(){if(this._averageActiveVoices=Math.max(.95*this._averageActiveVoices,this.activeVoices),this._availableVoices.length&&this._voices.length>Math.ceil(this._averageActiveVoices+1)){const t=this._availableVoices.shift(),e=this._voices.indexOf(t);this._voices.splice(e,1),this.context.isOffline||t.dispose()}}_triggerAttack(t,e,s){t.forEach(t=>{const n=new No(this.context,t).toMidi(),i=this._getNextAvailableVoice();i&&(i.triggerAttack(t,e,s),this._activeVoices.push({midi:n,voice:i,released:!1}),this.log("triggerAttack",t,e))})}_triggerRelease(t,e){t.forEach(t=>{const s=new No(this.context,t).toMidi(),n=this._activeVoices.find(({midi:t,released:e})=>t===s&&!e);n&&(n.voice.triggerRelease(e),n.released=!0,this.log("triggerRelease",t,e))})}_scheduleEvent(t,e,s,n){ti(!this.disposed,"Synth was already disposed"),s<=this.now()?"attack"===t?this._triggerAttack(e,s,n):this._triggerRelease(e,s):this.context.setTimeout(()=>{this._scheduleEvent(t,e,s,n)},s-this.now())}triggerAttack(t,e,s){Array.isArray(t)||(t=[t]);const n=this.toSeconds(e);return this._scheduleEvent("attack",t,n,s),this}triggerRelease(t,e){Array.isArray(t)||(t=[t]);const s=this.toSeconds(e);return this._scheduleEvent("release",t,s),this}triggerAttackRelease(t,e,s,n){const i=this.toSeconds(s);if(this.triggerAttack(t,i,n),di(e)){ti(di(t),"If the duration is an array, the notes must also be an array"),t=t;for(let s=0;s<t.length;s++){const n=e[Math.min(s,e.length-1)],o=this.toSeconds(n);ti(o>0,"The duration must be greater than 0"),this.triggerRelease(t[s],i+o)}}else{const s=this.toSeconds(e);ti(s>0,"The duration must be greater than 0"),this.triggerRelease(t,i+s)}return this}sync(){return this._syncState()&&(this._syncMethod("triggerAttack",1),this._syncMethod("triggerRelease",1)),this}set(t){const e=Mi(t,["onsilence","context"]);return this.options=Ai(this.options,e),this._voices.forEach(t=>t.set(e)),this._dummyVoice.set(e),this}get(){return this._dummyVoice.get()}releaseAll(t){const e=this.toSeconds(t);return this._activeVoices.forEach(({voice:t})=>{t.triggerRelease(e)}),this}dispose(){return super.dispose(),this._dummyVoice.dispose(),this._voices.forEach(t=>t.dispose()),this._activeVoices=[],this._availableVoices=[],this.context.clearInterval(this._gcTimeout),this}}class aa extends Vr{constructor(){super(Di(aa.getDefaults(),arguments,["urls","onload","baseUrl"],"urls")),this.name="Sampler",this._activeSources=new Map;const t=Di(aa.getDefaults(),arguments,["urls","onload","baseUrl"],"urls"),e={};Object.keys(t.urls).forEach(s=>{const n=parseInt(s,10);if(ti(_i(s)||ui(n)&&isFinite(n),"url key is neither a note or midi pitch: "+s),_i(s)){const n=new lo(this.context,s).toMidi();e[n]=t.urls[s]}else ui(n)&&isFinite(n)&&(e[n]=t.urls[n])}),this._buffers=new Vo({urls:e,onload:t.onload,baseUrl:t.baseUrl,onerror:t.onerror}),this.attack=t.attack,this.release=t.release,this.curve=t.curve,this._buffers.loaded&&Promise.resolve().then(t.onload)}static getDefaults(){return Object.assign(Vr.getDefaults(),{attack:0,baseUrl:"",curve:"exponential",onload:Zi,onerror:Zi,release:.1,urls:{}})}_findClosest(t){let e=0;for(;e<96;){if(this._buffers.has(t+e))return-e;if(this._buffers.has(t-e))return e;e++}throw new Error("No available buffers for note: "+t)}triggerAttack(t,e,s=1){return this.log("triggerAttack",t,e,s),Array.isArray(t)||(t=[t]),t.forEach(t=>{const n=ro(new lo(this.context,t).toFrequency()),i=Math.round(n),o=n-i,r=this._findClosest(i),a=i-r,c=this._buffers.get(a),h=no(r+o),u=new $o({url:c,context:this.context,curve:this.curve,fadeIn:this.attack,fadeOut:this.release,playbackRate:h}).connect(this.output);u.start(e,0,c.duration/h,s),di(this._activeSources.get(i))||this._activeSources.set(i,[]),this._activeSources.get(i).push(u),u.onended=()=>{if(this._activeSources&&this._activeSources.has(i)){const t=this._activeSources.get(i),e=t.indexOf(u);-1!==e&&t.splice(e,1)}}}),this}triggerRelease(t,e){return this.log("triggerRelease",t,e),Array.isArray(t)||(t=[t]),t.forEach(t=>{const s=new lo(this.context,t).toMidi();if(this._activeSources.has(s)&&this._activeSources.get(s).length){const t=this._activeSources.get(s);e=this.toSeconds(e),t.forEach(t=>{t.stop(e)}),this._activeSources.set(s,[])}}),this}releaseAll(t){const e=this.toSeconds(t);return this._activeSources.forEach(t=>{for(;t.length;){t.shift().stop(e)}}),this}sync(){return this._syncState()&&(this._syncMethod("triggerAttack",1),this._syncMethod("triggerRelease",1)),this}triggerAttackRelease(t,e,s,n=1){const i=this.toSeconds(s);return this.triggerAttack(t,i,n),di(e)?(ti(di(t),"notes must be an array when duration is array"),t.forEach((t,s)=>{const n=e[Math.min(s,e.length-1)];this.triggerRelease(t,i+this.toSeconds(n))})):this.triggerRelease(t,i+this.toSeconds(e)),this}add(t,e,s){if(ti(_i(t)||isFinite(t),"note must be a pitch or midi: "+t),_i(t)){const n=new lo(this.context,t).toMidi();this._buffers.add(n,e,s)}else this._buffers.add(t,e,s);return this}get loaded(){return this._buffers.loaded}dispose(){return super.dispose(),this._buffers.dispose(),this._activeSources.forEach(t=>{t.forEach(t=>t.dispose())}),this._activeSources.clear(),this}}vi([wr(0)],aa.prototype,"attack",void 0),vi([wr(0)],aa.prototype,"release",void 0);class ca extends vo{constructor(){super(Di(ca.getDefaults(),arguments,["callback","value"])),this.name="ToneEvent",this._state=new yo("stopped"),this._startOffset=0;const t=Di(ca.getDefaults(),arguments,["callback","value"]);this._loop=t.loop,this.callback=t.callback,this.value=t.value,this._loopStart=this.toTicks(t.loopStart),this._loopEnd=this.toTicks(t.loopEnd),this._playbackRate=t.playbackRate,this._probability=t.probability,this._humanize=t.humanize,this.mute=t.mute,this._playbackRate=t.playbackRate,this._state.increasing=!0,this._rescheduleEvents()}static getDefaults(){return Object.assign(vo.getDefaults(),{callback:Zi,humanize:!1,loop:!1,loopEnd:"1m",loopStart:0,mute:!1,playbackRate:1,probability:1,value:null})}_rescheduleEvents(t=-1){this._state.forEachFrom(t,t=>{let e;if("started"===t.state){-1!==t.id&&this.context.transport.clear(t.id);const s=t.time+Math.round(this.startOffset/this._playbackRate);if(!0===this._loop||ui(this._loop)&&this._loop>1){e=1/0,ui(this._loop)&&(e=this._loop*this._getLoopDuration());const n=this._state.getAfter(s);null!==n&&(e=Math.min(e,n.time-s)),e!==1/0&&(this._state.setStateAtTime("stopped",s+e+1,{id:-1}),e=new jo(this.context,e));const i=new jo(this.context,this._getLoopDuration());t.id=this.context.transport.scheduleRepeat(this._tick.bind(this),i,new jo(this.context,s),e)}else t.id=this.context.transport.schedule(this._tick.bind(this),new jo(this.context,s))}})}get state(){return this._state.getValueAtTime(this.context.transport.ticks)}get startOffset(){return this._startOffset}set startOffset(t){this._startOffset=t}get probability(){return this._probability}set probability(t){this._probability=t}get humanize(){return this._humanize}set humanize(t){this._humanize=t}start(t){const e=this.toTicks(t);return"stopped"===this._state.getValueAtTime(e)&&(this._state.add({id:-1,state:"started",time:e}),this._rescheduleEvents(e)),this}stop(t){this.cancel(t);const e=this.toTicks(t);if("started"===this._state.getValueAtTime(e)){this._state.setStateAtTime("stopped",e,{id:-1});const t=this._state.getBefore(e);let s=e;null!==t&&(s=t.time),this._rescheduleEvents(s)}return this}cancel(t){t=Oi(t,-1/0);const e=this.toTicks(t);return this._state.forEachFrom(e,t=>{this.context.transport.clear(t.id)}),this._state.cancel(e),this}_tick(t){const e=this.context.transport.getTicksAtTime(t);if(!this.mute&&"started"===this._state.getValueAtTime(e)){if(this.probability<1&&Math.random()>this.probability)return;if(this.humanize){let e=.02;pi(this.humanize)||(e=this.toSeconds(this.humanize)),t+=(2*Math.random()-1)*e}this.callback(t,this.value)}}_getLoopDuration(){return Math.round((this._loopEnd-this._loopStart)/this._playbackRate)}get loop(){return this._loop}set loop(t){this._loop=t,this._rescheduleEvents()}get playbackRate(){return this._playbackRate}set playbackRate(t){this._playbackRate=t,this._rescheduleEvents()}get loopEnd(){return new jo(this.context,this._loopEnd).toSeconds()}set loopEnd(t){this._loopEnd=this.toTicks(t),this._loop&&this._rescheduleEvents()}get loopStart(){return new jo(this.context,this._loopStart).toSeconds()}set loopStart(t){this._loopStart=this.toTicks(t),this._loop&&this._rescheduleEvents()}get progress(){if(this._loop){const t=this.context.transport.ticks,e=this._state.get(t);if(null!==e&&"started"===e.state){const s=this._getLoopDuration();return(t-e.time)%s/s}return 0}return 0}dispose(){return super.dispose(),this.cancel(),this._state.dispose(),this}}class ha extends vo{constructor(){super(Di(ha.getDefaults(),arguments,["callback","interval"])),this.name="Loop";const t=Di(ha.getDefaults(),arguments,["callback","interval"]);this._event=new ca({context:this.context,callback:this._tick.bind(this),loop:!0,loopEnd:t.interval,playbackRate:t.playbackRate,probability:t.probability}),this.callback=t.callback,this.iterations=t.iterations}static getDefaults(){return Object.assign(vo.getDefaults(),{interval:"4n",callback:Zi,playbackRate:1,iterations:1/0,probability:1,mute:!1,humanize:!1})}start(t){return this._event.start(t),this}stop(t){return this._event.stop(t),this}cancel(t){return this._event.cancel(t),this}_tick(t){this.callback(t)}get state(){return this._event.state}get progress(){return this._event.progress}get interval(){return this._event.loopEnd}set interval(t){this._event.loopEnd=t}get playbackRate(){return this._event.playbackRate}set playbackRate(t){this._event.playbackRate=t}get humanize(){return this._event.humanize}set humanize(t){this._event.humanize=t}get probability(){return this._event.probability}set probability(t){this._event.probability=t}get mute(){return this._event.mute}set mute(t){this._event.mute=t}get iterations(){return!0===this._event.loop?1/0:this._event.loop}set iterations(t){this._event.loop=t===1/0||t}dispose(){return super.dispose(),this._event.dispose(),this}}class ua extends ca{constructor(){super(Di(ua.getDefaults(),arguments,["callback","events"])),this.name="Part",this._state=new yo("stopped"),this._events=new Set;const t=Di(ua.getDefaults(),arguments,["callback","events"]);this._state.increasing=!0,t.events.forEach(t=>{di(t)?this.add(t[0],t[1]):this.add(t)})}static getDefaults(){return Object.assign(ca.getDefaults(),{events:[]})}start(t,e){const s=this.toTicks(t);if("started"!==this._state.getValueAtTime(s)){e=Oi(e,this._loop?this._loopStart:0),e=this._loop?Oi(e,this._loopStart):Oi(e,0);const t=this.toTicks(e);this._state.add({id:-1,offset:t,state:"started",time:s}),this._forEach(e=>{this._startNote(e,s,t)})}return this}_startNote(t,e,s){e-=s,this._loop?t.startOffset>=this._loopStart&&t.startOffset<this._loopEnd?(t.startOffset<s&&(e+=this._getLoopDuration()),t.start(new jo(this.context,e))):t.startOffset<this._loopStart&&t.startOffset>=s&&(t.loop=!1,t.start(new jo(this.context,e))):t.startOffset>=s&&t.start(new jo(this.context,e))}get startOffset(){return this._startOffset}set startOffset(t){this._startOffset=t,this._forEach(t=>{t.startOffset+=this._startOffset})}stop(t){const e=this.toTicks(t);return this._state.cancel(e),this._state.setStateAtTime("stopped",e),this._forEach(e=>{e.stop(t)}),this}at(t,e){const s=new mo(this.context,t).toTicks(),n=new jo(this.context,1).toSeconds(),i=this._events.values();let o=i.next();for(;!o.done;){const t=o.value;if(Math.abs(s-t.startOffset)<n)return ci(e)&&(t.value=e),t;o=i.next()}return ci(e)?(this.add(t,e),this.at(t)):null}add(t,e){t instanceof Object&&Reflect.has(t,"time")&&(t=(e=t).time);const s=this.toTicks(t);let n;return e instanceof ca?(n=e,n.callback=this._tick.bind(this)):n=new ca({callback:this._tick.bind(this),context:this.context,value:e}),n.startOffset=s,n.set({humanize:this.humanize,loop:this.loop,loopEnd:this.loopEnd,loopStart:this.loopStart,playbackRate:this.playbackRate,probability:this.probability}),this._events.add(n),this._restartEvent(n),this}_restartEvent(t){this._state.forEach(e=>{"started"===e.state?this._startNote(t,e.time,e.offset):t.stop(new jo(this.context,e.time))})}remove(t,e){return li(t)&&t.hasOwnProperty("time")&&(t=(e=t).time),t=this.toTicks(t),this._events.forEach(s=>{s.startOffset===t&&(ai(e)||ci(e)&&s.value===e)&&(this._events.delete(s),s.dispose())}),this}clear(){return this._forEach(t=>t.dispose()),this._events.clear(),this}cancel(t){return this._forEach(e=>e.cancel(t)),this._state.cancel(this.toTicks(t)),this}_forEach(t){return this._events&&this._events.forEach(e=>{e instanceof ua?e._forEach(t):t(e)}),this}_setAll(t,e){this._forEach(s=>{s[t]=e})}_tick(t,e){this.mute||this.callback(t,e)}_testLoopBoundries(t){this._loop&&(t.startOffset<this._loopStart||t.startOffset>=this._loopEnd)?t.cancel(0):"stopped"===t.state&&this._restartEvent(t)}get probability(){return this._probability}set probability(t){this._probability=t,this._setAll("probability",t)}get humanize(){return this._humanize}set humanize(t){this._humanize=t,this._setAll("humanize",t)}get loop(){return this._loop}set loop(t){this._loop=t,this._forEach(e=>{e.loopStart=this.loopStart,e.loopEnd=this.loopEnd,e.loop=t,this._testLoopBoundries(e)})}get loopEnd(){return new jo(this.context,this._loopEnd).toSeconds()}set loopEnd(t){this._loopEnd=this.toTicks(t),this._loop&&this._forEach(e=>{e.loopEnd=t,this._testLoopBoundries(e)})}get loopStart(){return new jo(this.context,this._loopStart).toSeconds()}set loopStart(t){this._loopStart=this.toTicks(t),this._loop&&this._forEach(t=>{t.loopStart=this.loopStart,this._testLoopBoundries(t)})}get playbackRate(){return this._playbackRate}set playbackRate(t){this._playbackRate=t,this._setAll("playbackRate",t)}get length(){return this._events.size}dispose(){return super.dispose(),this.clear(),this}}function*la(t){let e=0;for(;e<t.length;)e=fa(e,t),yield t[e],e++}function*pa(t){let e=t.length-1;for(;e>=0;)e=fa(e,t),yield t[e],e--}function*da(t,e){for(;;)yield*e(t)}function fa(t,e){return Vi(t,0,e.length-1)}function*_a(t,e){let s=e?0:t.length-1;for(;;)s=fa(s,t),yield t[s],e?(s++,s>=t.length-1&&(e=!1)):(s--,s<=0&&(e=!0))}function*ma(t){let e=0,s=0;for(;e<t.length;)e=fa(e,t),yield t[e],s++,e+=s%2?2:-1}function*ga(t){let e=t.length-1,s=0;for(;e>=0;)e=fa(e,t),yield t[e],s++,e+=s%2?-2:1}function*va(t){const e=[];for(let s=0;s<t.length;s++)e.push(s);for(;e.length>0;){const s=fa(e.splice(Math.floor(e.length*Math.random()),1)[0],t);yield t[s]}}function*ya(t,e="up",s=0){switch(ti(t.length>0,"The array must have more than one value in it"),e){case"up":yield*da(t,la);case"down":yield*da(t,pa);case"upDown":yield*_a(t,!0);case"downUp":yield*_a(t,!1);case"alternateUp":yield*da(t,ma);case"alternateDown":yield*da(t,ga);case"random":yield*function*(t){for(;;){const e=Math.floor(Math.random()*t.length);yield t[e]}}(t);case"randomOnce":yield*da(t,va);case"randomWalk":yield*function*(t){let e=Math.floor(Math.random()*t.length);for(;;)0===e?e++:e===t.length-1||Math.random()<.5?e--:e++,yield t[e]}(t)}}class xa extends ha{constructor(){super(Di(xa.getDefaults(),arguments,["callback","values","pattern"])),this.name="Pattern";const t=Di(xa.getDefaults(),arguments,["callback","values","pattern"]);this.callback=t.callback,this._values=t.values,this._pattern=ya(t.values,t.pattern),this._type=t.pattern}static getDefaults(){return Object.assign(ha.getDefaults(),{pattern:"up",values:[],callback:Zi})}_tick(t){const e=this._pattern.next();this._value=e.value,this.callback(t,this._value)}get values(){return this._values}set values(t){this._values=t,this.pattern=this._type}get value(){return this._value}get pattern(){return this._type}set pattern(t){this._type=t,this._pattern=ya(this._values,this._type)}}class wa extends ca{constructor(){super(Di(wa.getDefaults(),arguments,["callback","events","subdivision"])),this.name="Sequence",this._part=new ua({callback:this._seqCallback.bind(this),context:this.context}),this._events=[],this._eventsArray=[];const t=Di(wa.getDefaults(),arguments,["callback","events","subdivision"]);this._subdivision=this.toTicks(t.subdivision),this.events=t.events,this.loop=t.loop,this.loopStart=t.loopStart,this.loopEnd=t.loopEnd,this.playbackRate=t.playbackRate,this.probability=t.probability,this.humanize=t.humanize,this.mute=t.mute,this.playbackRate=t.playbackRate}static getDefaults(){return Object.assign(Mi(ca.getDefaults(),["value"]),{events:[],loop:!0,loopEnd:0,loopStart:0,subdivision:"8n"})}_seqCallback(t,e){null!==e&&this.callback(t,e)}get events(){return this._events}set events(t){this.clear(),this._eventsArray=t,this._events=this._createSequence(this._eventsArray),this._eventsUpdated()}start(t,e){return this._part.start(t,e?this._indexTime(e):e),this}stop(t){return this._part.stop(t),this}get subdivision(){return new jo(this.context,this._subdivision).toSeconds()}_createSequence(t){return new Proxy(t,{get:(t,e)=>t[e],set:(t,e,s)=>(fi(e)&&isFinite(parseInt(e,10))&&di(s)?t[e]=this._createSequence(s):t[e]=s,this._eventsUpdated(),!0)})}_eventsUpdated(){this._part.clear(),this._rescheduleSequence(this._eventsArray,this._subdivision,this.startOffset),this.loopEnd=this.loopEnd}_rescheduleSequence(t,e,s){t.forEach((t,n)=>{const i=n*e+s;if(di(t))this._rescheduleSequence(t,e/t.length,i);else{const e=new jo(this.context,i,"i").toSeconds();this._part.add(e,t)}})}_indexTime(t){return new jo(this.context,t*this._subdivision+this.startOffset).toSeconds()}clear(){return this._part.clear(),this}dispose(){return super.dispose(),this._part.dispose(),this}get loop(){return this._part.loop}set loop(t){this._part.loop=t}get loopStart(){return this._loopStart}set loopStart(t){this._loopStart=t,this._part.loopStart=this._indexTime(t)}get loopEnd(){return this._loopEnd}set loopEnd(t){this._loopEnd=t,this._part.loopEnd=0===t?this._indexTime(this._eventsArray.length):this._indexTime(t)}get startOffset(){return this._part.startOffset}set startOffset(t){this._part.startOffset=t}get playbackRate(){return this._part.playbackRate}set playbackRate(t){this._part.playbackRate=t}get probability(){return this._part.probability}set probability(t){this._part.probability=t}get progress(){return this._part.progress}get humanize(){return this._part.humanize}set humanize(t){this._part.humanize=t}get length(){return this._part.length}}class ba extends wo{constructor(){super(Object.assign(Di(ba.getDefaults(),arguments,["fade"]))),this.name="CrossFade",this._panner=this.context.createStereoPanner(),this._split=this.context.createChannelSplitter(2),this._g2a=new Cr({context:this.context}),this.a=new ko({context:this.context,gain:0}),this.b=new ko({context:this.context,gain:0}),this.output=new ko({context:this.context}),this._internalChannels=[this.a,this.b];const t=Di(ba.getDefaults(),arguments,["fade"]);this.fade=new Do({context:this.context,units:"normalRange",value:t.fade}),Ui(this,"fade"),this.context.getConstant(1).connect(this._panner),this._panner.connect(this._split),this._panner.channelCount=1,this._panner.channelCountMode="explicit",To(this._split,this.a.gain,0),To(this._split,this.b.gain,1),this.fade.chain(this._g2a,this._panner.pan),this.a.connect(this.output),this.b.connect(this.output)}static getDefaults(){return Object.assign(wo.getDefaults(),{fade:.5})}dispose(){return super.dispose(),this.a.dispose(),this.b.dispose(),this.output.dispose(),this.fade.dispose(),this._g2a.dispose(),this._panner.disconnect(),this._split.disconnect(),this}}class Ta extends wo{constructor(t){super(t),this.name="Effect",this._dryWet=new ba({context:this.context}),this.wet=this._dryWet.fade,this.effectSend=new ko({context:this.context}),this.effectReturn=new ko({context:this.context}),this.input=new ko({context:this.context}),this.output=this._dryWet,this.input.fan(this._dryWet.a,this.effectSend),this.effectReturn.connect(this._dryWet.b),this.wet.setValueAtTime(t.wet,0),this._internalChannels=[this.effectReturn,this.effectSend],Ui(this,"wet")}static getDefaults(){return Object.assign(wo.getDefaults(),{wet:1})}connectEffect(t){return this._internalChannels.push(t),this.effectSend.chain(t,this.effectReturn),this}dispose(){return super.dispose(),this._dryWet.dispose(),this.effectSend.dispose(),this.effectReturn.dispose(),this.wet.dispose(),this}}class Sa extends Ta{constructor(t){super(t),this.name="LFOEffect",this._lfo=new yr({context:this.context,frequency:t.frequency,amplitude:t.depth}),this.depth=this._lfo.amplitude,this.frequency=this._lfo.frequency,this.type=t.type,Ui(this,["frequency","depth"])}static getDefaults(){return Object.assign(Ta.getDefaults(),{frequency:1,type:"sine",depth:1})}start(t){return this._lfo.start(t),this}stop(t){return this._lfo.stop(t),this}sync(){return this._lfo.sync(),this}unsync(){return this._lfo.unsync(),this}get type(){return this._lfo.type}set type(t){this._lfo.type=t}dispose(){return super.dispose(),this._lfo.dispose(),this.frequency.dispose(),this.depth.dispose(),this}}class ka extends Sa{constructor(){super(Di(ka.getDefaults(),arguments,["frequency","baseFrequency","octaves"])),this.name="AutoFilter";const t=Di(ka.getDefaults(),arguments,["frequency","baseFrequency","octaves"]);this.filter=new Wr(Object.assign(t.filter,{context:this.context})),this.connectEffect(this.filter),this._lfo.connect(this.filter.frequency),this.octaves=t.octaves,this.baseFrequency=t.baseFrequency}static getDefaults(){return Object.assign(Sa.getDefaults(),{baseFrequency:200,octaves:2.6,filter:{type:"lowpass",rolloff:-12,Q:1}})}get baseFrequency(){return this._lfo.min}set baseFrequency(t){this._lfo.min=this.toFrequency(t),this.octaves=this._octaves}get octaves(){return this._octaves}set octaves(t){this._octaves=t,this._lfo.max=this._lfo.min*Math.pow(2,t)}dispose(){return super.dispose(),this.filter.dispose(),this}}class Ca extends wo{constructor(){super(Object.assign(Di(Ca.getDefaults(),arguments,["pan"]))),this.name="Panner",this._panner=this.context.createStereoPanner(),this.input=this._panner,this.output=this._panner;const t=Di(Ca.getDefaults(),arguments,["pan"]);this.pan=new xo({context:this.context,param:this._panner.pan,value:t.pan,minValue:-1,maxValue:1}),this._panner.channelCount=t.channelCount,this._panner.channelCountMode="explicit",Ui(this,"pan")}static getDefaults(){return Object.assign(wo.getDefaults(),{pan:0,channelCount:1})}dispose(){return super.dispose(),this._panner.disconnect(),this.pan.dispose(),this}}class Aa extends Sa{constructor(){super(Di(Aa.getDefaults(),arguments,["frequency"])),this.name="AutoPanner";const t=Di(Aa.getDefaults(),arguments,["frequency"]);this._panner=new Ca({context:this.context,channelCount:t.channelCount}),this.connectEffect(this._panner),this._lfo.connect(this._panner.pan),this._lfo.min=-1,this._lfo.max=1}static getDefaults(){return Object.assign(Sa.getDefaults(),{channelCount:1})}dispose(){return super.dispose(),this._panner.dispose(),this}}class Da extends wo{constructor(){super(Di(Da.getDefaults(),arguments,["smoothing"])),this.name="Follower";const t=Di(Da.getDefaults(),arguments,["smoothing"]);this._abs=this.input=new kr({context:this.context}),this._lowpass=this.output=new na({context:this.context,frequency:1/this.toSeconds(t.smoothing),type:"lowpass"}),this._abs.connect(this._lowpass),this._smoothing=t.smoothing}static getDefaults(){return Object.assign(wo.getDefaults(),{smoothing:.05})}get smoothing(){return this._smoothing}set smoothing(t){this._smoothing=t,this._lowpass.frequency=1/this.toSeconds(this.smoothing)}dispose(){return super.dispose(),this._abs.dispose(),this._lowpass.dispose(),this}}class Oa extends Ta{constructor(){super(Di(Oa.getDefaults(),arguments,["baseFrequency","octaves","sensitivity"])),this.name="AutoWah";const t=Di(Oa.getDefaults(),arguments,["baseFrequency","octaves","sensitivity"]);this._follower=new Da({context:this.context,smoothing:t.follower}),this._sweepRange=new Rr({context:this.context,min:0,max:1,exponent:.5}),this._baseFrequency=this.toFrequency(t.baseFrequency),this._octaves=t.octaves,this._inputBoost=new ko({context:this.context}),this._bandpass=new Wr({context:this.context,rolloff:-48,frequency:0,Q:t.Q}),this._peaking=new Wr({context:this.context,type:"peaking"}),this._peaking.gain.value=t.gain,this.gain=this._peaking.gain,this.Q=this._bandpass.Q,this.effectSend.chain(this._inputBoost,this._follower,this._sweepRange),this._sweepRange.connect(this._bandpass.frequency),this._sweepRange.connect(this._peaking.frequency),this.effectSend.chain(this._bandpass,this._peaking,this.effectReturn),this._setSweepRange(),this.sensitivity=t.sensitivity,Ui(this,["gain","Q"])}static getDefaults(){return Object.assign(Ta.getDefaults(),{baseFrequency:100,octaves:6,sensitivity:0,Q:2,gain:2,follower:.2})}get octaves(){return this._octaves}set octaves(t){this._octaves=t,this._setSweepRange()}get follower(){return this._follower.smoothing}set follower(t){this._follower.smoothing=t}get baseFrequency(){return this._baseFrequency}set baseFrequency(t){this._baseFrequency=this.toFrequency(t),this._setSweepRange()}get sensitivity(){return so(1/this._inputBoost.gain.value)}set sensitivity(t){this._inputBoost.gain.value=1/eo(t)}_setSweepRange(){this._sweepRange.min=this._baseFrequency,this._sweepRange.max=Math.min(this._baseFrequency*Math.pow(2,this._octaves),this.context.sampleRate/2)}dispose(){return super.dispose(),this._follower.dispose(),this._sweepRange.dispose(),this._bandpass.dispose(),this._peaking.dispose(),this._inputBoost.dispose(),this}}ta("bit-crusher","\n\tclass BitCrusherWorklet extends SingleIOProcessor {\n\n\t\tstatic get parameterDescriptors() {\n\t\t\treturn [{\n\t\t\t\tname: \"bits\",\n\t\t\t\tdefaultValue: 12,\n\t\t\t\tminValue: 1,\n\t\t\t\tmaxValue: 16,\n\t\t\t\tautomationRate: 'k-rate'\n\t\t\t}];\n\t\t}\n\n\t\tgenerate(input, _channel, parameters) {\n\t\t\tconst step = Math.pow(0.5, parameters.bits - 1);\n\t\t\tconst val = step * Math.floor(input / step + 0.5);\n\t\t\treturn val;\n\t\t}\n\t}\n");class Ma extends Ta{constructor(){super(Di(Ma.getDefaults(),arguments,["bits"])),this.name="BitCrusher";const t=Di(Ma.getDefaults(),arguments,["bits"]);this._bitCrusherWorklet=new Ea({context:this.context,bits:t.bits}),this.connectEffect(this._bitCrusherWorklet),this.bits=this._bitCrusherWorklet.bits}static getDefaults(){return Object.assign(Ta.getDefaults(),{bits:4})}dispose(){return super.dispose(),this._bitCrusherWorklet.dispose(),this}}class Ea extends ea{constructor(){super(Di(Ea.getDefaults(),arguments)),this.name="BitCrusherWorklet";const t=Di(Ea.getDefaults(),arguments);this.input=new ko({context:this.context}),this.output=new ko({context:this.context}),this.bits=new xo({context:this.context,value:t.bits,units:"positive",minValue:1,maxValue:16,param:this._dummyParam,swappable:!0})}static getDefaults(){return Object.assign(ea.getDefaults(),{bits:12})}_audioWorkletName(){return"bit-crusher"}onReady(t){bo(this.input,t,this.output);const e=t.parameters.get("bits");this.bits.setParam(e)}dispose(){return super.dispose(),this.input.dispose(),this.output.dispose(),this.bits.dispose(),this}}class Ra extends Ta{constructor(){super(Di(Ra.getDefaults(),arguments,["order"])),this.name="Chebyshev";const t=Di(Ra.getDefaults(),arguments,["order"]);this._shaper=new rr({context:this.context,length:4096}),this._order=t.order,this.connectEffect(this._shaper),this.order=t.order,this.oversample=t.oversample}static getDefaults(){return Object.assign(Ta.getDefaults(),{order:1,oversample:"none"})}_getCoefficient(t,e,s){return s.has(e)||(0===e?s.set(e,0):1===e?s.set(e,t):s.set(e,2*t*this._getCoefficient(t,e-1,s)-this._getCoefficient(t,e-2,s))),s.get(e)}get order(){return this._order}set order(t){this._order=t,this._shaper.setMap(e=>this._getCoefficient(e,t,new Map))}get oversample(){return this._shaper.oversample}set oversample(t){this._shaper.oversample=t}dispose(){return super.dispose(),this._shaper.dispose(),this}}class qa extends wo{constructor(){super(Di(qa.getDefaults(),arguments,["channels"])),this.name="Split";const t=Di(qa.getDefaults(),arguments,["channels"]);this._splitter=this.input=this.output=this.context.createChannelSplitter(t.channels),this._internalChannels=[this._splitter]}static getDefaults(){return Object.assign(wo.getDefaults(),{channels:2})}dispose(){return super.dispose(),this._splitter.disconnect(),this}}class Fa extends wo{constructor(){super(Di(Fa.getDefaults(),arguments,["channels"])),this.name="Merge";const t=Di(Fa.getDefaults(),arguments,["channels"]);this._merger=this.output=this.input=this.context.createChannelMerger(t.channels)}static getDefaults(){return Object.assign(wo.getDefaults(),{channels:2})}dispose(){return super.dispose(),this._merger.disconnect(),this}}class Ia extends wo{constructor(t){super(t),this.name="StereoEffect",this.input=new ko({context:this.context}),this.input.channelCount=2,this.input.channelCountMode="explicit",this._dryWet=this.output=new ba({context:this.context,fade:t.wet}),this.wet=this._dryWet.fade,this._split=new qa({context:this.context,channels:2}),this._merge=new Fa({context:this.context,channels:2}),this.input.connect(this._split),this.input.connect(this._dryWet.a),this._merge.connect(this._dryWet.b),Ui(this,["wet"])}connectEffectLeft(...t){this._split.connect(t[0],0,0),bo(...t),To(t[t.length-1],this._merge,0,0)}connectEffectRight(...t){this._split.connect(t[0],1,0),bo(...t),To(t[t.length-1],this._merge,0,1)}static getDefaults(){return Object.assign(wo.getDefaults(),{wet:1})}dispose(){return super.dispose(),this._dryWet.dispose(),this._split.dispose(),this._merge.dispose(),this}}class Va extends Ia{constructor(t){super(t),this.feedback=new Do({context:this.context,value:t.feedback,units:"normalRange"}),this._feedbackL=new ko({context:this.context}),this._feedbackR=new ko({context:this.context}),this._feedbackSplit=new qa({context:this.context,channels:2}),this._feedbackMerge=new Fa({context:this.context,channels:2}),this._merge.connect(this._feedbackSplit),this._feedbackMerge.connect(this._split),this._feedbackSplit.connect(this._feedbackL,0,0),this._feedbackL.connect(this._feedbackMerge,0,0),this._feedbackSplit.connect(this._feedbackR,1,0),this._feedbackR.connect(this._feedbackMerge,0,1),this.feedback.fan(this._feedbackL.gain,this._feedbackR.gain),Ui(this,["feedback"])}static getDefaults(){return Object.assign(Ia.getDefaults(),{feedback:.5})}dispose(){return super.dispose(),this.feedback.dispose(),this._feedbackL.dispose(),this._feedbackR.dispose(),this._feedbackSplit.dispose(),this._feedbackMerge.dispose(),this}}class Na extends Va{constructor(){super(Di(Na.getDefaults(),arguments,["frequency","delayTime","depth"])),this.name="Chorus";const t=Di(Na.getDefaults(),arguments,["frequency","delayTime","depth"]);this._depth=t.depth,this._delayTime=t.delayTime/1e3,this._lfoL=new yr({context:this.context,frequency:t.frequency,min:0,max:1}),this._lfoR=new yr({context:this.context,frequency:t.frequency,min:0,max:1,phase:180}),this._delayNodeL=new Fo({context:this.context}),this._delayNodeR=new Fo({context:this.context}),this.frequency=this._lfoL.frequency,Ui(this,["frequency"]),this._lfoL.frequency.connect(this._lfoR.frequency),this.connectEffectLeft(this._delayNodeL),this.connectEffectRight(this._delayNodeR),this._lfoL.connect(this._delayNodeL.delayTime),this._lfoR.connect(this._delayNodeR.delayTime),this.depth=this._depth,this.type=t.type,this.spread=t.spread}static getDefaults(){return Object.assign(Va.getDefaults(),{frequency:1.5,delayTime:3.5,depth:.7,type:"sine",spread:180,feedback:0,wet:.5})}get depth(){return this._depth}set depth(t){this._depth=t;const e=this._delayTime*t;this._lfoL.min=Math.max(this._delayTime-e,0),this._lfoL.max=this._delayTime+e,this._lfoR.min=Math.max(this._delayTime-e,0),this._lfoR.max=this._delayTime+e}get delayTime(){return 1e3*this._delayTime}set delayTime(t){this._delayTime=t/1e3,this.depth=this._depth}get type(){return this._lfoL.type}set type(t){this._lfoL.type=t,this._lfoR.type=t}get spread(){return this._lfoR.phase-this._lfoL.phase}set spread(t){this._lfoL.phase=90-t/2,this._lfoR.phase=t/2+90}start(t){return this._lfoL.start(t),this._lfoR.start(t),this}stop(t){return this._lfoL.stop(t),this._lfoR.stop(t),this}sync(){return this._lfoL.sync(),this._lfoR.sync(),this}unsync(){return this._lfoL.unsync(),this._lfoR.unsync(),this}dispose(){return super.dispose(),this._lfoL.dispose(),this._lfoR.dispose(),this._delayNodeL.dispose(),this._delayNodeR.dispose(),this.frequency.dispose(),this}}class Pa extends Ta{constructor(){super(Di(Pa.getDefaults(),arguments,["distortion"])),this.name="Distortion";const t=Di(Pa.getDefaults(),arguments,["distortion"]);this._shaper=new rr({context:this.context,length:4096}),this._distortion=t.distortion,this.connectEffect(this._shaper),this.distortion=t.distortion,this.oversample=t.oversample}static getDefaults(){return Object.assign(Ta.getDefaults(),{distortion:.4,oversample:"none"})}get distortion(){return this._distortion}set distortion(t){this._distortion=t;const e=100*t,s=Math.PI/180;this._shaper.setMap(t=>Math.abs(t)<.001?0:(3+e)*t*20*s/(Math.PI+e*Math.abs(t)))}get oversample(){return this._shaper.oversample}set oversample(t){this._shaper.oversample=t}dispose(){return super.dispose(),this._shaper.dispose(),this}}class ja extends Ta{constructor(t){super(t),this.name="FeedbackEffect",this._feedbackGain=new ko({context:this.context,gain:t.feedback,units:"normalRange"}),this.feedback=this._feedbackGain.gain,Ui(this,"feedback"),this.effectReturn.chain(this._feedbackGain,this.effectSend)}static getDefaults(){return Object.assign(Ta.getDefaults(),{feedback:.125})}dispose(){return super.dispose(),this._feedbackGain.dispose(),this.feedback.dispose(),this}}class La extends ja{constructor(){super(Di(La.getDefaults(),arguments,["delayTime","feedback"])),this.name="FeedbackDelay";const t=Di(La.getDefaults(),arguments,["delayTime","feedback"]);this._delayNode=new Fo({context:this.context,delayTime:t.delayTime,maxDelay:t.maxDelay}),this.delayTime=this._delayNode.delayTime,this.connectEffect(this._delayNode),Ui(this,"delayTime")}static getDefaults(){return Object.assign(ja.getDefaults(),{delayTime:.25,maxDelay:1})}dispose(){return super.dispose(),this._delayNode.dispose(),this.delayTime.dispose(),this}}class za extends wo{constructor(t){super(t),this.name="PhaseShiftAllpass",this.input=new ko({context:this.context}),this.output=new ko({context:this.context}),this.offset90=new ko({context:this.context});this._bank0=this._createAllPassFilterBank([.6923878,.9360654322959,.988229522686,.9987488452737]),this._bank1=this._createAllPassFilterBank([.4021921162426,.856171088242,.9722909545651,.9952884791278]),this._oneSampleDelay=this.context.createIIRFilter([0,1],[1,0]),bo(this.input,...this._bank0,this._oneSampleDelay,this.output),bo(this.input,...this._bank1,this.offset90)}_createAllPassFilterBank(t){return t.map(t=>{const e=[[t*t,0,-1],[1,0,-t*t]];return this.context.createIIRFilter(e[0],e[1])})}dispose(){return super.dispose(),this.input.dispose(),this.output.dispose(),this.offset90.dispose(),this._bank0.forEach(t=>t.disconnect()),this._bank1.forEach(t=>t.disconnect()),this._oneSampleDelay.disconnect(),this}}class Ba extends Ta{constructor(){super(Di(Ba.getDefaults(),arguments,["frequency"])),this.name="FrequencyShifter";const t=Di(Ba.getDefaults(),arguments,["frequency"]);this.frequency=new Do({context:this.context,units:"frequency",value:t.frequency,minValue:-this.context.sampleRate/2,maxValue:this.context.sampleRate/2}),this._sine=new nr({context:this.context,type:"sine"}),this._cosine=new ir({context:this.context,phase:-90,type:"sine"}),this._sineMultiply=new cr({context:this.context}),this._cosineMultiply=new cr({context:this.context}),this._negate=new Ar({context:this.context}),this._add=new mr({context:this.context}),this._phaseShifter=new za({context:this.context}),this.effectSend.connect(this._phaseShifter),this.frequency.fan(this._sine.frequency,this._cosine.frequency),this._phaseShifter.offset90.connect(this._cosineMultiply),this._cosine.connect(this._cosineMultiply.factor),this._phaseShifter.connect(this._sineMultiply),this._sine.connect(this._sineMultiply.factor),this._sineMultiply.connect(this._negate),this._cosineMultiply.connect(this._add),this._negate.connect(this._add.addend),this._add.connect(this.effectReturn);const e=this.immediate();this._sine.start(e),this._cosine.start(e)}static getDefaults(){return Object.assign(Ta.getDefaults(),{frequency:0})}dispose(){return super.dispose(),this.frequency.dispose(),this._add.dispose(),this._cosine.dispose(),this._cosineMultiply.dispose(),this._negate.dispose(),this._phaseShifter.dispose(),this._sine.dispose(),this._sineMultiply.dispose(),this}}const Wa=[1557/44100,1617/44100,1491/44100,1422/44100,1277/44100,1356/44100,1188/44100,1116/44100],Ga=[225,556,441,341];class Ua extends Ia{constructor(){super(Di(Ua.getDefaults(),arguments,["roomSize","dampening"])),this.name="Freeverb",this._combFilters=[],this._allpassFiltersL=[],this._allpassFiltersR=[];const t=Di(Ua.getDefaults(),arguments,["roomSize","dampening"]);this.roomSize=new Do({context:this.context,value:t.roomSize,units:"normalRange"}),this._allpassFiltersL=Ga.map(t=>{const e=this.context.createBiquadFilter();return e.type="allpass",e.frequency.value=t,e}),this._allpassFiltersR=Ga.map(t=>{const e=this.context.createBiquadFilter();return e.type="allpass",e.frequency.value=t,e}),this._combFilters=Wa.map((e,s)=>{const n=new ia({context:this.context,dampening:t.dampening,delayTime:e});return s<Wa.length/2?this.connectEffectLeft(n,...this._allpassFiltersL):this.connectEffectRight(n,...this._allpassFiltersR),this.roomSize.connect(n.resonance),n}),Ui(this,["roomSize"])}static getDefaults(){return Object.assign(Ia.getDefaults(),{roomSize:.7,dampening:3e3})}get dampening(){return this._combFilters[0].dampening}set dampening(t){this._combFilters.forEach(e=>e.dampening=t)}dispose(){return super.dispose(),this._allpassFiltersL.forEach(t=>t.disconnect()),this._allpassFiltersR.forEach(t=>t.disconnect()),this._combFilters.forEach(t=>t.dispose()),this.roomSize.dispose(),this}}const Qa=[.06748,.06404,.08212,.09004],Za=[.773,.802,.753,.733],Xa=[347,113,37];class Ya extends Ia{constructor(){super(Di(Ya.getDefaults(),arguments,["roomSize"])),this.name="JCReverb",this._allpassFilters=[],this._feedbackCombFilters=[];const t=Di(Ya.getDefaults(),arguments,["roomSize"]);this.roomSize=new Do({context:this.context,value:t.roomSize,units:"normalRange"}),this._scaleRoomSize=new gr({context:this.context,min:-.733,max:.197}),this._allpassFilters=Xa.map(t=>{const e=this.context.createBiquadFilter();return e.type="allpass",e.frequency.value=t,e}),this._feedbackCombFilters=Qa.map((t,e)=>{const s=new sa({context:this.context,delayTime:t});return this._scaleRoomSize.connect(s.resonance),s.resonance.value=Za[e],e<Qa.length/2?this.connectEffectLeft(...this._allpassFilters,s):this.connectEffectRight(...this._allpassFilters,s),s}),this.roomSize.connect(this._scaleRoomSize),Ui(this,["roomSize"])}static getDefaults(){return Object.assign(Ia.getDefaults(),{roomSize:.5})}dispose(){return super.dispose(),this._allpassFilters.forEach(t=>t.disconnect()),this._feedbackCombFilters.forEach(t=>t.dispose()),this.roomSize.dispose(),this._scaleRoomSize.dispose(),this}}class Ha extends Va{constructor(t){super(t),this._feedbackL.disconnect(),this._feedbackL.connect(this._feedbackMerge,0,1),this._feedbackR.disconnect(),this._feedbackR.connect(this._feedbackMerge,0,0),Ui(this,["feedback"])}}class $a extends Ha{constructor(){super(Di($a.getDefaults(),arguments,["delayTime","feedback"])),this.name="PingPongDelay";const t=Di($a.getDefaults(),arguments,["delayTime","feedback"]);this._leftDelay=new Fo({context:this.context,maxDelay:t.maxDelay}),this._rightDelay=new Fo({context:this.context,maxDelay:t.maxDelay}),this._rightPreDelay=new Fo({context:this.context,maxDelay:t.maxDelay}),this.delayTime=new Do({context:this.context,units:"time",value:t.delayTime}),this.connectEffectLeft(this._leftDelay),this.connectEffectRight(this._rightPreDelay,this._rightDelay),this.delayTime.fan(this._leftDelay.delayTime,this._rightDelay.delayTime,this._rightPreDelay.delayTime),this._feedbackL.disconnect(),this._feedbackL.connect(this._rightDelay),Ui(this,["delayTime"])}static getDefaults(){return Object.assign(Ha.getDefaults(),{delayTime:.25,maxDelay:1})}dispose(){return super.dispose(),this._leftDelay.dispose(),this._rightDelay.dispose(),this._rightPreDelay.dispose(),this.delayTime.dispose(),this}}class Ja extends ja{constructor(){super(Di(Ja.getDefaults(),arguments,["pitch"])),this.name="PitchShift";const t=Di(Ja.getDefaults(),arguments,["pitch"]);this._frequency=new Do({context:this.context}),this._delayA=new Fo({maxDelay:1,context:this.context}),this._lfoA=new yr({context:this.context,min:0,max:.1,type:"sawtooth"}).connect(this._delayA.delayTime),this._delayB=new Fo({maxDelay:1,context:this.context}),this._lfoB=new yr({context:this.context,min:0,max:.1,type:"sawtooth",phase:180}).connect(this._delayB.delayTime),this._crossFade=new ba({context:this.context}),this._crossFadeLFO=new yr({context:this.context,min:0,max:1,type:"triangle",phase:90}).connect(this._crossFade.fade),this._feedbackDelay=new Fo({delayTime:t.delayTime,context:this.context}),this.delayTime=this._feedbackDelay.delayTime,Ui(this,"delayTime"),this._pitch=t.pitch,this._windowSize=t.windowSize,this._delayA.connect(this._crossFade.a),this._delayB.connect(this._crossFade.b),this._frequency.fan(this._lfoA.frequency,this._lfoB.frequency,this._crossFadeLFO.frequency),this.effectSend.fan(this._delayA,this._delayB),this._crossFade.chain(this._feedbackDelay,this.effectReturn);const e=this.now();this._lfoA.start(e),this._lfoB.start(e),this._crossFadeLFO.start(e),this.windowSize=this._windowSize}static getDefaults(){return Object.assign(ja.getDefaults(),{pitch:0,windowSize:.1,delayTime:0,feedback:0})}get pitch(){return this._pitch}set pitch(t){this._pitch=t;let e=0;t<0?(this._lfoA.min=0,this._lfoA.max=this._windowSize,this._lfoB.min=0,this._lfoB.max=this._windowSize,e=no(t-1)+1):(this._lfoA.min=this._windowSize,this._lfoA.max=0,this._lfoB.min=this._windowSize,this._lfoB.max=0,e=no(t)-1),this._frequency.value=e*(1.2/this._windowSize)}get windowSize(){return this._windowSize}set windowSize(t){this._windowSize=this.toSeconds(t),this.pitch=this._pitch}dispose(){return super.dispose(),this._frequency.dispose(),this._delayA.dispose(),this._delayB.dispose(),this._lfoA.dispose(),this._lfoB.dispose(),this._crossFade.dispose(),this._crossFadeLFO.dispose(),this._feedbackDelay.dispose(),this}}class Ka extends Ia{constructor(){super(Di(Ka.getDefaults(),arguments,["frequency","octaves","baseFrequency"])),this.name="Phaser";const t=Di(Ka.getDefaults(),arguments,["frequency","octaves","baseFrequency"]);this._lfoL=new yr({context:this.context,frequency:t.frequency,min:0,max:1}),this._lfoR=new yr({context:this.context,frequency:t.frequency,min:0,max:1,phase:180}),this._baseFrequency=this.toFrequency(t.baseFrequency),this._octaves=t.octaves,this.Q=new Do({context:this.context,value:t.Q,units:"positive"}),this._filtersL=this._makeFilters(t.stages,this._lfoL),this._filtersR=this._makeFilters(t.stages,this._lfoR),this.frequency=this._lfoL.frequency,this.frequency.value=t.frequency,this.connectEffectLeft(...this._filtersL),this.connectEffectRight(...this._filtersR),this._lfoL.frequency.connect(this._lfoR.frequency),this.baseFrequency=t.baseFrequency,this.octaves=t.octaves,this._lfoL.start(),this._lfoR.start(),Ui(this,["frequency","Q"])}static getDefaults(){return Object.assign(Ia.getDefaults(),{frequency:.5,octaves:3,stages:10,Q:10,baseFrequency:350})}_makeFilters(t,e){const s=[];for(let n=0;n<t;n++){const t=this.context.createBiquadFilter();t.type="allpass",this.Q.connect(t.Q),e.connect(t.frequency),s.push(t)}return s}get octaves(){return this._octaves}set octaves(t){this._octaves=t;const e=this._baseFrequency*Math.pow(2,t);this._lfoL.max=e,this._lfoR.max=e}get baseFrequency(){return this._baseFrequency}set baseFrequency(t){this._baseFrequency=this.toFrequency(t),this._lfoL.min=this._baseFrequency,this._lfoR.min=this._baseFrequency,this.octaves=this._octaves}dispose(){return super.dispose(),this.Q.dispose(),this._lfoL.dispose(),this._lfoR.dispose(),this._filtersL.forEach(t=>t.disconnect()),this._filtersR.forEach(t=>t.disconnect()),this.frequency.dispose(),this}}class tc extends Ta{constructor(){super(Di(tc.getDefaults(),arguments,["decay"])),this.name="Reverb",this._convolver=this.context.createConvolver(),this.ready=Promise.resolve();const t=Di(tc.getDefaults(),arguments,["decay"]);this._decay=t.decay,this._preDelay=t.preDelay,this.generate(),this.connectEffect(this._convolver)}static getDefaults(){return Object.assign(Ta.getDefaults(),{decay:1.5,preDelay:.01})}get decay(){return this._decay}set decay(t){ei(t=this.toSeconds(t),.001),this._decay=t,this.generate()}get preDelay(){return this._preDelay}set preDelay(t){ei(t=this.toSeconds(t),0),this._preDelay=t,this.generate()}generate(){return yi(this,void 0,void 0,(function*(){const t=this.ready,e=new Yi(2,this._decay+this._preDelay,this.context.sampleRate),s=new Jo({context:e}),n=new Jo({context:e}),i=new Fa({context:e});s.connect(i,0,0),n.connect(i,0,1);const o=new ko({context:e}).toDestination();i.connect(o),s.start(0),n.start(0),o.gain.setValueAtTime(0,0),o.gain.setValueAtTime(1,this._preDelay),o.gain.exponentialApproachValueAtTime(0,this._preDelay,this.decay);const r=e.render();return this.ready=r.then(Zi),yield t,this._convolver.buffer=(yield r).get(),this}))}dispose(){return super.dispose(),this._convolver.disconnect(),this}}class ec extends wo{constructor(){super(Di(ec.getDefaults(),arguments)),this.name="MidSideSplit",this._split=this.input=new qa({channels:2,context:this.context}),this._midAdd=new mr({context:this.context}),this.mid=new cr({context:this.context,value:Math.SQRT1_2}),this._sideSubtract=new Dr({context:this.context}),this.side=new cr({context:this.context,value:Math.SQRT1_2}),this._split.connect(this._midAdd,0),this._split.connect(this._midAdd.addend,1),this._split.connect(this._sideSubtract,0),this._split.connect(this._sideSubtract.subtrahend,1),this._midAdd.connect(this.mid),this._sideSubtract.connect(this.side)}dispose(){return super.dispose(),this.mid.dispose(),this.side.dispose(),this._midAdd.dispose(),this._sideSubtract.dispose(),this._split.dispose(),this}}class sc extends wo{constructor(){super(Di(sc.getDefaults(),arguments)),this.name="MidSideMerge",this.mid=new ko({context:this.context}),this.side=new ko({context:this.context}),this._left=new mr({context:this.context}),this._leftMult=new cr({context:this.context,value:Math.SQRT1_2}),this._right=new Dr({context:this.context}),this._rightMult=new cr({context:this.context,value:Math.SQRT1_2}),this._merge=this.output=new Fa({context:this.context}),this.mid.fan(this._left),this.side.connect(this._left.addend),this.mid.connect(this._right),this.side.connect(this._right.subtrahend),this._left.connect(this._leftMult),this._right.connect(this._rightMult),this._leftMult.connect(this._merge,0,0),this._rightMult.connect(this._merge,0,1)}dispose(){return super.dispose(),this.mid.dispose(),this.side.dispose(),this._leftMult.dispose(),this._rightMult.dispose(),this._left.dispose(),this._right.dispose(),this}}class nc extends Ta{constructor(t){super(t),this.name="MidSideEffect",this._midSideMerge=new sc({context:this.context}),this._midSideSplit=new ec({context:this.context}),this._midSend=this._midSideSplit.mid,this._sideSend=this._midSideSplit.side,this._midReturn=this._midSideMerge.mid,this._sideReturn=this._midSideMerge.side,this.effectSend.connect(this._midSideSplit),this._midSideMerge.connect(this.effectReturn)}connectEffectMid(...t){this._midSend.chain(...t,this._midReturn)}connectEffectSide(...t){this._sideSend.chain(...t,this._sideReturn)}dispose(){return super.dispose(),this._midSideSplit.dispose(),this._midSideMerge.dispose(),this._midSend.dispose(),this._sideSend.dispose(),this._midReturn.dispose(),this._sideReturn.dispose(),this}}class ic extends nc{constructor(){super(Di(ic.getDefaults(),arguments,["width"])),this.name="StereoWidener";const t=Di(ic.getDefaults(),arguments,["width"]);this.width=new Do({context:this.context,value:t.width,units:"normalRange"}),Ui(this,["width"]),this._twoTimesWidthMid=new cr({context:this.context,value:2}),this._twoTimesWidthSide=new cr({context:this.context,value:2}),this._midMult=new cr({context:this.context}),this._twoTimesWidthMid.connect(this._midMult.factor),this.connectEffectMid(this._midMult),this._oneMinusWidth=new Dr({context:this.context}),this._oneMinusWidth.connect(this._twoTimesWidthMid),To(this.context.getConstant(1),this._oneMinusWidth),this.width.connect(this._oneMinusWidth.subtrahend),this._sideMult=new cr({context:this.context}),this.width.connect(this._twoTimesWidthSide),this._twoTimesWidthSide.connect(this._sideMult.factor),this.connectEffectSide(this._sideMult)}static getDefaults(){return Object.assign(nc.getDefaults(),{width:.5})}dispose(){return super.dispose(),this.width.dispose(),this._midMult.dispose(),this._sideMult.dispose(),this._twoTimesWidthMid.dispose(),this._twoTimesWidthSide.dispose(),this._oneMinusWidth.dispose(),this}}class oc extends Ia{constructor(){super(Di(oc.getDefaults(),arguments,["frequency","depth"])),this.name="Tremolo";const t=Di(oc.getDefaults(),arguments,["frequency","depth"]);this._lfoL=new yr({context:this.context,type:t.type,min:1,max:0}),this._lfoR=new yr({context:this.context,type:t.type,min:1,max:0}),this._amplitudeL=new ko({context:this.context}),this._amplitudeR=new ko({context:this.context}),this.frequency=new Do({context:this.context,value:t.frequency,units:"frequency"}),this.depth=new Do({context:this.context,value:t.depth,units:"normalRange"}),Ui(this,["frequency","depth"]),this.connectEffectLeft(this._amplitudeL),this.connectEffectRight(this._amplitudeR),this._lfoL.connect(this._amplitudeL.gain),this._lfoR.connect(this._amplitudeR.gain),this.frequency.fan(this._lfoL.frequency,this._lfoR.frequency),this.depth.fan(this._lfoR.amplitude,this._lfoL.amplitude),this.spread=t.spread}static getDefaults(){return Object.assign(Ia.getDefaults(),{frequency:10,type:"sine",depth:.5,spread:180})}start(t){return this._lfoL.start(t),this._lfoR.start(t),this}stop(t){return this._lfoL.stop(t),this._lfoR.stop(t),this}sync(){return this._lfoL.sync(),this._lfoR.sync(),this.context.transport.syncSignal(this.frequency),this}unsync(){return this._lfoL.unsync(),this._lfoR.unsync(),this.context.transport.unsyncSignal(this.frequency),this}get type(){return this._lfoL.type}set type(t){this._lfoL.type=t,this._lfoR.type=t}get spread(){return this._lfoR.phase-this._lfoL.phase}set spread(t){this._lfoL.phase=90-t/2,this._lfoR.phase=t/2+90}dispose(){return super.dispose(),this._lfoL.dispose(),this._lfoR.dispose(),this._amplitudeL.dispose(),this._amplitudeR.dispose(),this.frequency.dispose(),this.depth.dispose(),this}}class rc extends Ta{constructor(){super(Di(rc.getDefaults(),arguments,["frequency","depth"])),this.name="Vibrato";const t=Di(rc.getDefaults(),arguments,["frequency","depth"]);this._delayNode=new Fo({context:this.context,delayTime:0,maxDelay:t.maxDelay}),this._lfo=new yr({context:this.context,type:t.type,min:0,max:t.maxDelay,frequency:t.frequency,phase:-90}).start().connect(this._delayNode.delayTime),this.frequency=this._lfo.frequency,this.depth=this._lfo.amplitude,this.depth.value=t.depth,Ui(this,["frequency","depth"]),this.effectSend.chain(this._delayNode,this.effectReturn)}static getDefaults(){return Object.assign(Ta.getDefaults(),{maxDelay:.005,frequency:5,depth:.1,type:"sine"})}get type(){return this._lfo.type}set type(t){this._lfo.type=t}dispose(){return super.dispose(),this._delayNode.dispose(),this._lfo.dispose(),this.frequency.dispose(),this.depth.dispose(),this}}class ac extends wo{constructor(){super(Di(ac.getDefaults(),arguments,["type","size"])),this.name="Analyser",this._analysers=[],this._buffers=[];const t=Di(ac.getDefaults(),arguments,["type","size"]);this.input=this.output=this._gain=new ko({context:this.context}),this._split=new qa({context:this.context,channels:t.channels}),this.input.connect(this._split),ei(t.channels,1);for(let e=0;e<t.channels;e++)this._analysers[e]=this.context.createAnalyser(),this._split.connect(this._analysers[e],e,0);this.size=t.size,this.type=t.type}static getDefaults(){return Object.assign(wo.getDefaults(),{size:1024,smoothing:.8,type:"fft",channels:1})}getValue(){return this._analysers.forEach((t,e)=>{const s=this._buffers[e];"fft"===this._type?t.getFloatFrequencyData(s):"waveform"===this._type&&t.getFloatTimeDomainData(s)}),1===this.channels?this._buffers[0]:this._buffers}get size(){return this._analysers[0].frequencyBinCount}set size(t){this._analysers.forEach((e,s)=>{e.fftSize=2*t,this._buffers[s]=new Float32Array(t)})}get channels(){return this._analysers.length}get type(){return this._type}set type(t){ti("waveform"===t||"fft"===t,"Analyser: invalid type: "+t),this._type=t}get smoothing(){return this._analysers[0].smoothingTimeConstant}set smoothing(t){this._analysers.forEach(e=>e.smoothingTimeConstant=t)}dispose(){return super.dispose(),this._analysers.forEach(t=>t.disconnect()),this._split.dispose(),this._gain.dispose(),this}}class cc extends wo{constructor(){super(Di(cc.getDefaults(),arguments)),this.name="MeterBase",this.input=this.output=this._analyser=new ac({context:this.context,size:256,type:"waveform"})}dispose(){return super.dispose(),this._analyser.dispose(),this}}class hc extends cc{constructor(){super(Di(hc.getDefaults(),arguments,["smoothing"])),this.name="Meter",this._rms=0;const t=Di(hc.getDefaults(),arguments,["smoothing"]);this.input=this.output=this._analyser=new ac({context:this.context,size:256,type:"waveform",channels:t.channels}),this.smoothing=t.smoothing,this.normalRange=t.normalRange}static getDefaults(){return Object.assign(cc.getDefaults(),{smoothing:.8,normalRange:!1,channels:1})}getLevel(){return ri("'getLevel' has been changed to 'getValue'"),this.getValue()}getValue(){const t=this._analyser.getValue(),e=(1===this.channels?[t]:t).map(t=>{const e=t.reduce((t,e)=>t+e*e,0),s=Math.sqrt(e/t.length);return this._rms=Math.max(s,this._rms*this.smoothing),this.normalRange?this._rms:so(this._rms)});return 1===this.channels?e[0]:e}get channels(){return this._analyser.channels}dispose(){return super.dispose(),this._analyser.dispose(),this}}class uc extends cc{constructor(){super(Di(uc.getDefaults(),arguments,["size"])),this.name="FFT";const t=Di(uc.getDefaults(),arguments,["size"]);this.normalRange=t.normalRange,this._analyser.type="fft",this.size=t.size}static getDefaults(){return Object.assign(wo.getDefaults(),{normalRange:!1,size:1024,smoothing:.8})}getValue(){return this._analyser.getValue().map(t=>this.normalRange?eo(t):t)}get size(){return this._analyser.size}set size(t){this._analyser.size=t}get smoothing(){return this._analyser.smoothing}set smoothing(t){this._analyser.smoothing=t}getFrequencyOfIndex(t){return ti(0<=t&&t<this.size,"index must be greater than or equal to 0 and less than "+this.size),t*this.context.sampleRate/(2*this.size)}}class lc extends cc{constructor(){super(Di(lc.getDefaults(),arguments)),this.name="DCMeter",this._analyser.type="waveform",this._analyser.size=256}getValue(){return this._analyser.getValue()[0]}}class pc extends cc{constructor(){super(Di(pc.getDefaults(),arguments,["size"])),this.name="Waveform";const t=Di(pc.getDefaults(),arguments,["size"]);this._analyser.type="waveform",this.size=t.size}static getDefaults(){return Object.assign(cc.getDefaults(),{size:1024})}getValue(){return this._analyser.getValue()}get size(){return this._analyser.size}set size(t){this._analyser.size=t}}class dc extends wo{constructor(){super(Di(dc.getDefaults(),arguments,["solo"])),this.name="Solo";const t=Di(dc.getDefaults(),arguments,["solo"]);this.input=this.output=new ko({context:this.context}),dc._allSolos.has(this.context)||dc._allSolos.set(this.context,new Set),dc._allSolos.get(this.context).add(this),this.solo=t.solo}static getDefaults(){return Object.assign(wo.getDefaults(),{solo:!1})}get solo(){return this._isSoloed()}set solo(t){t?this._addSolo():this._removeSolo(),dc._allSolos.get(this.context).forEach(t=>t._updateSolo())}get muted(){return 0===this.input.gain.value}_addSolo(){dc._soloed.has(this.context)||dc._soloed.set(this.context,new Set),dc._soloed.get(this.context).add(this)}_removeSolo(){dc._soloed.has(this.context)&&dc._soloed.get(this.context).delete(this)}_isSoloed(){return dc._soloed.has(this.context)&&dc._soloed.get(this.context).has(this)}_noSolos(){return!dc._soloed.has(this.context)||dc._soloed.has(this.context)&&0===dc._soloed.get(this.context).size}_updateSolo(){this._isSoloed()||this._noSolos()?this.input.gain.value=1:this.input.gain.value=0}dispose(){return super.dispose(),dc._allSolos.get(this.context).delete(this),this._removeSolo(),this}}dc._allSolos=new Map,dc._soloed=new Map;class fc extends wo{constructor(){super(Di(fc.getDefaults(),arguments,["pan","volume"])),this.name="PanVol";const t=Di(fc.getDefaults(),arguments,["pan","volume"]);this._panner=this.input=new Ca({context:this.context,pan:t.pan,channelCount:t.channelCount}),this.pan=this._panner.pan,this._volume=this.output=new Go({context:this.context,volume:t.volume}),this.volume=this._volume.volume,this._panner.connect(this._volume),this.mute=t.mute,Ui(this,["pan","volume"])}static getDefaults(){return Object.assign(wo.getDefaults(),{mute:!1,pan:0,volume:0,channelCount:1})}get mute(){return this._volume.mute}set mute(t){this._volume.mute=t}dispose(){return super.dispose(),this._panner.dispose(),this.pan.dispose(),this._volume.dispose(),this.volume.dispose(),this}}class _c extends wo{constructor(){super(Di(_c.getDefaults(),arguments,["volume","pan"])),this.name="Channel";const t=Di(_c.getDefaults(),arguments,["volume","pan"]);this._solo=this.input=new dc({solo:t.solo,context:this.context}),this._panVol=this.output=new fc({context:this.context,pan:t.pan,volume:t.volume,mute:t.mute,channelCount:t.channelCount}),this.pan=this._panVol.pan,this.volume=this._panVol.volume,this._solo.connect(this._panVol),Ui(this,["pan","volume"])}static getDefaults(){return Object.assign(wo.getDefaults(),{pan:0,volume:0,mute:!1,solo:!1,channelCount:1})}get solo(){return this._solo.solo}set solo(t){this._solo.solo=t}get muted(){return this._solo.muted||this.mute}get mute(){return this._panVol.mute}set mute(t){this._panVol.mute=t}_getBus(t){return _c.buses.has(t)||_c.buses.set(t,new ko({context:this.context})),_c.buses.get(t)}send(t,e=0){const s=this._getBus(t),n=new ko({context:this.context,units:"decibels",gain:e});return this.connect(n),n.connect(s),n}receive(t){return this._getBus(t).connect(this),this}dispose(){return super.dispose(),this._panVol.dispose(),this.pan.dispose(),this.volume.dispose(),this._solo.dispose(),this}}_c.buses=new Map;class mc extends wo{constructor(){super(Di(mc.getDefaults(),arguments)),this.name="Mono",this.input=new ko({context:this.context}),this._merge=this.output=new Fa({channels:2,context:this.context}),this.input.connect(this._merge,0,0),this.input.connect(this._merge,0,1)}dispose(){return super.dispose(),this._merge.dispose(),this.input.dispose(),this}}class gc extends wo{constructor(){super(Di(gc.getDefaults(),arguments,["lowFrequency","highFrequency"])),this.name="MultibandSplit",this.input=new ko({context:this.context}),this.output=void 0,this.low=new Wr({context:this.context,frequency:0,type:"lowpass"}),this._lowMidFilter=new Wr({context:this.context,frequency:0,type:"highpass"}),this.mid=new Wr({context:this.context,frequency:0,type:"lowpass"}),this.high=new Wr({context:this.context,frequency:0,type:"highpass"}),this._internalChannels=[this.low,this.mid,this.high];const t=Di(gc.getDefaults(),arguments,["lowFrequency","highFrequency"]);this.lowFrequency=new Do({context:this.context,units:"frequency",value:t.lowFrequency}),this.highFrequency=new Do({context:this.context,units:"frequency",value:t.highFrequency}),this.Q=new Do({context:this.context,units:"positive",value:t.Q}),this.input.fan(this.low,this.high),this.input.chain(this._lowMidFilter,this.mid),this.lowFrequency.fan(this.low.frequency,this._lowMidFilter.frequency),this.highFrequency.fan(this.mid.frequency,this.high.frequency),this.Q.connect(this.low.Q),this.Q.connect(this._lowMidFilter.Q),this.Q.connect(this.mid.Q),this.Q.connect(this.high.Q),Ui(this,["high","mid","low","highFrequency","lowFrequency"])}static getDefaults(){return Object.assign(wo.getDefaults(),{Q:1,highFrequency:2500,lowFrequency:400})}dispose(){return super.dispose(),Qi(this,["high","mid","low","highFrequency","lowFrequency"]),this.low.dispose(),this._lowMidFilter.dispose(),this.mid.dispose(),this.high.dispose(),this.lowFrequency.dispose(),this.highFrequency.dispose(),this.Q.dispose(),this}}class vc extends wo{constructor(){super(...arguments),this.name="Listener",this.positionX=new xo({context:this.context,param:this.context.rawContext.listener.positionX}),this.positionY=new xo({context:this.context,param:this.context.rawContext.listener.positionY}),this.positionZ=new xo({context:this.context,param:this.context.rawContext.listener.positionZ}),this.forwardX=new xo({context:this.context,param:this.context.rawContext.listener.forwardX}),this.forwardY=new xo({context:this.context,param:this.context.rawContext.listener.forwardY}),this.forwardZ=new xo({context:this.context,param:this.context.rawContext.listener.forwardZ}),this.upX=new xo({context:this.context,param:this.context.rawContext.listener.upX}),this.upY=new xo({context:this.context,param:this.context.rawContext.listener.upY}),this.upZ=new xo({context:this.context,param:this.context.rawContext.listener.upZ})}static getDefaults(){return Object.assign(wo.getDefaults(),{positionX:0,positionY:0,positionZ:0,forwardX:0,forwardY:0,forwardZ:-1,upX:0,upY:1,upZ:0})}dispose(){return super.dispose(),this.positionX.dispose(),this.positionY.dispose(),this.positionZ.dispose(),this.forwardX.dispose(),this.forwardY.dispose(),this.forwardZ.dispose(),this.upX.dispose(),this.upY.dispose(),this.upZ.dispose(),this}}ji(t=>{t.listener=new vc({context:t})}),zi(t=>{t.listener.dispose()});class yc extends wo{constructor(){super(Di(yc.getDefaults(),arguments,["positionX","positionY","positionZ"])),this.name="Panner3D";const t=Di(yc.getDefaults(),arguments,["positionX","positionY","positionZ"]);this._panner=this.input=this.output=this.context.createPanner(),this.panningModel=t.panningModel,this.maxDistance=t.maxDistance,this.distanceModel=t.distanceModel,this.coneOuterGain=t.coneOuterGain,this.coneOuterAngle=t.coneOuterAngle,this.coneInnerAngle=t.coneInnerAngle,this.refDistance=t.refDistance,this.rolloffFactor=t.rolloffFactor,this.positionX=new xo({context:this.context,param:this._panner.positionX,value:t.positionX}),this.positionY=new xo({context:this.context,param:this._panner.positionY,value:t.positionY}),this.positionZ=new xo({context:this.context,param:this._panner.positionZ,value:t.positionZ}),this.orientationX=new xo({context:this.context,param:this._panner.orientationX,value:t.orientationX}),this.orientationY=new xo({context:this.context,param:this._panner.orientationY,value:t.orientationY}),this.orientationZ=new xo({context:this.context,param:this._panner.orientationZ,value:t.orientationZ})}static getDefaults(){return Object.assign(wo.getDefaults(),{coneInnerAngle:360,coneOuterAngle:360,coneOuterGain:0,distanceModel:"inverse",maxDistance:1e4,orientationX:0,orientationY:0,orientationZ:0,panningModel:"equalpower",positionX:0,positionY:0,positionZ:0,refDistance:1,rolloffFactor:1})}setPosition(t,e,s){return this.positionX.value=t,this.positionY.value=e,this.positionZ.value=s,this}setOrientation(t,e,s){return this.orientationX.value=t,this.orientationY.value=e,this.orientationZ.value=s,this}get panningModel(){return this._panner.panningModel}set panningModel(t){this._panner.panningModel=t}get refDistance(){return this._panner.refDistance}set refDistance(t){this._panner.refDistance=t}get rolloffFactor(){return this._panner.rolloffFactor}set rolloffFactor(t){this._panner.rolloffFactor=t}get distanceModel(){return this._panner.distanceModel}set distanceModel(t){this._panner.distanceModel=t}get coneInnerAngle(){return this._panner.coneInnerAngle}set coneInnerAngle(t){this._panner.coneInnerAngle=t}get coneOuterAngle(){return this._panner.coneOuterAngle}set coneOuterAngle(t){this._panner.coneOuterAngle=t}get coneOuterGain(){return this._panner.coneOuterGain}set coneOuterGain(t){this._panner.coneOuterGain=t}get maxDistance(){return this._panner.maxDistance}set maxDistance(t){this._panner.maxDistance=t}dispose(){return super.dispose(),this._panner.disconnect(),this.orientationX.dispose(),this.orientationY.dispose(),this.orientationZ.dispose(),this.positionX.dispose(),this.positionY.dispose(),this.positionZ.dispose(),this}}class xc extends wo{constructor(){super(Di(xc.getDefaults(),arguments)),this.name="Recorder";const t=Di(xc.getDefaults(),arguments);this.input=new ko({context:this.context}),ti(xc.supported,"Media Recorder API is not available"),this._stream=this.context.createMediaStreamDestination(),this.input.connect(this._stream),this._recorder=new MediaRecorder(this._stream.stream,{mimeType:t.mimeType})}static getDefaults(){return wo.getDefaults()}get mimeType(){return this._recorder.mimeType}static get supported(){return null!==mi&&Reflect.has(mi,"MediaRecorder")}get state(){return"inactive"===this._recorder.state?"stopped":"paused"===this._recorder.state?"paused":"started"}start(){return yi(this,void 0,void 0,(function*(){ti("started"!==this.state,"Recorder is already started");const t=new Promise(t=>{const e=()=>{this._recorder.removeEventListener("start",e,!1),t()};this._recorder.addEventListener("start",e,!1)});return this._recorder.start(),yield t}))}stop(){return yi(this,void 0,void 0,(function*(){ti("stopped"!==this.state,"Recorder is not started");const t=new Promise(t=>{const e=s=>{this._recorder.removeEventListener("dataavailable",e,!1),t(s.data)};this._recorder.addEventListener("dataavailable",e,!1)});return this._recorder.stop(),yield t}))}pause(){return ti("started"===this.state,"Recorder must be started"),this._recorder.pause(),this}dispose(){return super.dispose(),this.input.dispose(),this._stream.disconnect(),this}}class wc extends wo{constructor(){super(Di(wc.getDefaults(),arguments,["threshold","ratio"])),this.name="Compressor",this._compressor=this.context.createDynamicsCompressor(),this.input=this._compressor,this.output=this._compressor;const t=Di(wc.getDefaults(),arguments,["threshold","ratio"]);this.threshold=new xo({minValue:this._compressor.threshold.minValue,maxValue:this._compressor.threshold.maxValue,context:this.context,convert:!1,param:this._compressor.threshold,units:"decibels",value:t.threshold}),this.attack=new xo({minValue:this._compressor.attack.minValue,maxValue:this._compressor.attack.maxValue,context:this.context,param:this._compressor.attack,units:"time",value:t.attack}),this.release=new xo({minValue:this._compressor.release.minValue,maxValue:this._compressor.release.maxValue,context:this.context,param:this._compressor.release,units:"time",value:t.release}),this.knee=new xo({minValue:this._compressor.knee.minValue,maxValue:this._compressor.knee.maxValue,context:this.context,convert:!1,param:this._compressor.knee,units:"decibels",value:t.knee}),this.ratio=new xo({minValue:this._compressor.ratio.minValue,maxValue:this._compressor.ratio.maxValue,context:this.context,convert:!1,param:this._compressor.ratio,units:"positive",value:t.ratio}),Ui(this,["knee","release","attack","ratio","threshold"])}static getDefaults(){return Object.assign(wo.getDefaults(),{attack:.003,knee:30,ratio:12,release:.25,threshold:-24})}get reduction(){return this._compressor.reduction}dispose(){return super.dispose(),this._compressor.disconnect(),this.attack.dispose(),this.release.dispose(),this.threshold.dispose(),this.ratio.dispose(),this.knee.dispose(),this}}class bc extends wo{constructor(){super(Object.assign(Di(bc.getDefaults(),arguments,["threshold","smoothing"]))),this.name="Gate";const t=Di(bc.getDefaults(),arguments,["threshold","smoothing"]);this._follower=new Da({context:this.context,smoothing:t.smoothing}),this._gt=new Mr({context:this.context,value:eo(t.threshold)}),this.input=new ko({context:this.context}),this._gate=this.output=new ko({context:this.context}),this.input.connect(this._gate),this.input.chain(this._follower,this._gt,this._gate.gain)}static getDefaults(){return Object.assign(wo.getDefaults(),{smoothing:.1,threshold:-40})}get threshold(){return so(this._gt.value)}set threshold(t){this._gt.value=eo(t)}get smoothing(){return this._follower.smoothing}set smoothing(t){this._follower.smoothing=t}dispose(){return super.dispose(),this.input.dispose(),this._follower.dispose(),this._gt.dispose(),this._gate.dispose(),this}}class Tc extends wo{constructor(){super(Object.assign(Di(Tc.getDefaults(),arguments,["threshold"]))),this.name="Limiter";const t=Di(Tc.getDefaults(),arguments,["threshold"]);this._compressor=this.input=this.output=new wc({context:this.context,ratio:20,attack:.003,release:.01,threshold:t.threshold}),this.threshold=this._compressor.threshold,Ui(this,"threshold")}static getDefaults(){return Object.assign(wo.getDefaults(),{threshold:-12})}get reduction(){return this._compressor.reduction}dispose(){return super.dispose(),this._compressor.dispose(),this.threshold.dispose(),this}}class Sc extends wo{constructor(){super(Object.assign(Di(Sc.getDefaults(),arguments))),this.name="MidSideCompressor";const t=Di(Sc.getDefaults(),arguments);this._midSideSplit=this.input=new ec({context:this.context}),this._midSideMerge=this.output=new sc({context:this.context}),this.mid=new wc(Object.assign(t.mid,{context:this.context})),this.side=new wc(Object.assign(t.side,{context:this.context})),this._midSideSplit.mid.chain(this.mid,this._midSideMerge.mid),this._midSideSplit.side.chain(this.side,this._midSideMerge.side),Ui(this,["mid","side"])}static getDefaults(){return Object.assign(wo.getDefaults(),{mid:{ratio:3,threshold:-24,release:.03,attack:.02,knee:16},side:{ratio:6,threshold:-30,release:.25,attack:.03,knee:10}})}dispose(){return super.dispose(),this.mid.dispose(),this.side.dispose(),this._midSideSplit.dispose(),this._midSideMerge.dispose(),this}}class kc extends wo{constructor(){super(Object.assign(Di(kc.getDefaults(),arguments))),this.name="MultibandCompressor";const t=Di(kc.getDefaults(),arguments);this._splitter=this.input=new gc({context:this.context,lowFrequency:t.lowFrequency,highFrequency:t.highFrequency}),this.lowFrequency=this._splitter.lowFrequency,this.highFrequency=this._splitter.highFrequency,this.output=new ko({context:this.context}),this.low=new wc(Object.assign(t.low,{context:this.context})),this.mid=new wc(Object.assign(t.mid,{context:this.context})),this.high=new wc(Object.assign(t.high,{context:this.context})),this._splitter.low.chain(this.low,this.output),this._splitter.mid.chain(this.mid,this.output),this._splitter.high.chain(this.high,this.output),Ui(this,["high","mid","low","highFrequency","lowFrequency"])}static getDefaults(){return Object.assign(wo.getDefaults(),{lowFrequency:250,highFrequency:2e3,low:{ratio:6,threshold:-30,release:.25,attack:.03,knee:10},mid:{ratio:3,threshold:-24,release:.03,attack:.02,knee:16},high:{ratio:3,threshold:-24,release:.03,attack:.02,knee:16}})}dispose(){return super.dispose(),this._splitter.dispose(),this.low.dispose(),this.mid.dispose(),this.high.dispose(),this.output.dispose(),this}}class Cc extends wo{constructor(){super(Di(Cc.getDefaults(),arguments,["low","mid","high"])),this.name="EQ3",this.output=new ko({context:this.context}),this._internalChannels=[];const t=Di(Cc.getDefaults(),arguments,["low","mid","high"]);this.input=this._multibandSplit=new gc({context:this.context,highFrequency:t.highFrequency,lowFrequency:t.lowFrequency}),this._lowGain=new ko({context:this.context,gain:t.low,units:"decibels"}),this._midGain=new ko({context:this.context,gain:t.mid,units:"decibels"}),this._highGain=new ko({context:this.context,gain:t.high,units:"decibels"}),this.low=this._lowGain.gain,this.mid=this._midGain.gain,this.high=this._highGain.gain,this.Q=this._multibandSplit.Q,this.lowFrequency=this._multibandSplit.lowFrequency,this.highFrequency=this._multibandSplit.highFrequency,this._multibandSplit.low.chain(this._lowGain,this.output),this._multibandSplit.mid.chain(this._midGain,this.output),this._multibandSplit.high.chain(this._highGain,this.output),Ui(this,["low","mid","high","lowFrequency","highFrequency"]),this._internalChannels=[this._multibandSplit]}static getDefaults(){return Object.assign(wo.getDefaults(),{high:0,highFrequency:2500,low:0,lowFrequency:400,mid:0})}dispose(){return super.dispose(),Qi(this,["low","mid","high","lowFrequency","highFrequency"]),this._multibandSplit.dispose(),this.lowFrequency.dispose(),this.highFrequency.dispose(),this._lowGain.dispose(),this._midGain.dispose(),this._highGain.dispose(),this.low.dispose(),this.mid.dispose(),this.high.dispose(),this.Q.dispose(),this}}class Ac extends wo{constructor(){super(Di(Ac.getDefaults(),arguments,["url","onload"])),this.name="Convolver",this._convolver=this.context.createConvolver();const t=Di(Ac.getDefaults(),arguments,["url","onload"]);this._buffer=new Xi(t.url,e=>{this.buffer=e,t.onload()}),this.input=new ko({context:this.context}),this.output=new ko({context:this.context}),this._buffer.loaded&&(this.buffer=this._buffer),this.normalize=t.normalize,this.input.chain(this._convolver,this.output)}static getDefaults(){return Object.assign(wo.getDefaults(),{normalize:!0,onload:Zi})}load(t){return yi(this,void 0,void 0,(function*(){this.buffer=yield this._buffer.load(t)}))}get buffer(){return this._buffer.length?this._buffer:null}set buffer(t){t&&this._buffer.set(t),this._convolver.buffer&&(this.input.disconnect(),this._convolver.disconnect(),this._convolver=this.context.createConvolver(),this.input.chain(this._convolver,this.output));const e=this._buffer.get();this._convolver.buffer=e||null}get normalize(){return this._convolver.normalize}set normalize(t){this._convolver.normalize=t}dispose(){return super.dispose(),this._buffer.dispose(),this._convolver.disconnect(),this}}function Dc(){return Ji().now()}function Oc(){return Ji().immediate()}const Mc=Ji().transport;function Ec(){return Ji().transport}const Rc=Ji().destination,qc=Ji().destination;function Fc(){return Ji().destination}const Ic=Ji().listener;function Vc(){return Ji().listener}const Nc=Ji().draw;function Pc(){return Ji().draw}const jc=Ji();function Lc(){return Xi.loaded()}const zc=Xi,Bc=Vo,Wc=$o}])}));

},{}]},{},[1])
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJkb2NzL2NvbW1vbi9qcy9zcmMvbWV0cm9ub21lLmpzIiwibm9kZV9tb2R1bGVzL3RvbmUvYnVpbGQvVG9uZS5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQ0FBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNoTEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJmaWxlIjoiZ2VuZXJhdGVkLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbigpe2Z1bmN0aW9uIHIoZSxuLHQpe2Z1bmN0aW9uIG8oaSxmKXtpZighbltpXSl7aWYoIWVbaV0pe3ZhciBjPVwiZnVuY3Rpb25cIj09dHlwZW9mIHJlcXVpcmUmJnJlcXVpcmU7aWYoIWYmJmMpcmV0dXJuIGMoaSwhMCk7aWYodSlyZXR1cm4gdShpLCEwKTt2YXIgYT1uZXcgRXJyb3IoXCJDYW5ub3QgZmluZCBtb2R1bGUgJ1wiK2krXCInXCIpO3Rocm93IGEuY29kZT1cIk1PRFVMRV9OT1RfRk9VTkRcIixhfXZhciBwPW5baV09e2V4cG9ydHM6e319O2VbaV1bMF0uY2FsbChwLmV4cG9ydHMsZnVuY3Rpb24ocil7dmFyIG49ZVtpXVsxXVtyXTtyZXR1cm4gbyhufHxyKX0scCxwLmV4cG9ydHMscixlLG4sdCl9cmV0dXJuIG5baV0uZXhwb3J0c31mb3IodmFyIHU9XCJmdW5jdGlvblwiPT10eXBlb2YgcmVxdWlyZSYmcmVxdWlyZSxpPTA7aTx0Lmxlbmd0aDtpKyspbyh0W2ldKTtyZXR1cm4gb31yZXR1cm4gcn0pKCkiLCJ2YXIgVG9uZSA9IHJlcXVpcmUoJ3RvbmUnKVxyXG5cclxuY2xhc3MgTWV0cm9ub21lIHtcclxuICAgIGNvbnN0cnVjdG9yIChicG0sIHBhdHRlcm4sIHJoeXRobSkge1xyXG4gICAgICAgIHRoaXMuYnBtID0gYnBtIHx8IDEyMDtcclxuICAgICAgICB0aGlzLnBhdHRlcm4gPSBwYXR0ZXJuIHx8IFsxLDAsMCwwXTtcclxuICAgICAgICB0aGlzLnJoeXRobSA9IHJoeXRobSB8fCBbMSwxLDEsMV07XHJcbiAgICAgICAgXHJcbiAgICAgICAgdGhpcy5wbGF5aW5nID0gZmFsc2U7XHJcbiAgICAgICAgXHJcbiAgICAgICAgdGhpcy5hdWRpbyA9IG5ldyBUb25lLlNhbXBsZXIoe1xyXG4gICAgICAgICAgdXJsczoge1xyXG4gICAgICAgICAgICBcIkM0XCI6IFwiYXNzZXRzL2dvY2sgYmxvY2subXAzXCIsXHJcbiAgICAgICAgICB9LFxyXG4gICAgICAgICAgcmVsZWFzZTogMSxcclxuICAgICAgICAgIG9ubG9hZDogKCkgPT4ge1xyXG4gICAgICAgICAgICBsZXQgYmVhdCA9IDA7XHJcbiAgICAgICAgICAgIFRvbmUuVHJhbnNwb3J0LnNjaGVkdWxlUmVwZWF0KCh0aW1lKSA9PiB7XHJcbiAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coYmVhdCk7XHJcbiAgICAgICAgICAgICAgdGhpcy5hdWRpby50cmlnZ2VyQXR0YWNrUmVsZWFzZShbJ0M0JywgJ0U0J11bdGhpcy5wYXR0ZXJuW2JlYXRdXSwgXCI0blwiLCB0aW1lKTtcclxuICAgICAgICAgICAgICAvLyBmb3IgKGxldCBuID0gMTsgbiA8IHRoaXMucGF0dGVybi5sZW5ndGg7IG4rKykge1xyXG4gICAgICAgICAgICAgIC8vICAgdGhpcy5hdWRpby50cmlnZ2VyQXR0YWNrUmVsZWFzZShcIkM0XCIsIFwiNG5cIiwgdGltZSArIChuICogMC41KSk7XHJcblxyXG4gICAgICAgICAgICAgIC8vIH1cclxuICAgICAgICAgICAgICBiZWF0ID0gKGJlYXQgKyAxKSAlIHRoaXMucGF0dGVybi5sZW5ndGg7XHJcbiAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIH0sIFwiNG5cIilcclxuICAgICAgICAgIH0sXHJcbiAgICAgICAgfSkudG9EZXN0aW5hdGlvbigpO1xyXG5cclxuICAgICAgICAvLyB0aGlzLmxvb3AgPSBuZXcgVG9uZS5Mb29wKHRpbWUgPT4ge1xyXG4gICAgICAgIC8vICAgdGhpcy5hdWRpby50cmlnZ2VyQXR0YWNrUmVsZWFzZShcIkM0XCIsIFwiOG5cIiwgdGltZSk7XHJcbiAgICAgICAgLy8gfSwgXCI0blwiKS5zdGFydCgpO1xyXG5cclxuICAgICAgICBUb25lLlRyYW5zcG9ydC5icG0udmFsdWUgPSB0aGlzLmJwbTtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgYXN5bmMgcGxheSgpIHtcclxuICAgICAgYXdhaXQgVG9uZS5zdGFydCgpO1xyXG4gICAgICAgIHRoaXMucGxheWluZyA9IHRydWU7XHJcbiAgICAgICAgdGhpcy5vZmZzZXRUaW1lID0gMDtcclxuICAgICAgICBhd2FpdCBUb25lLnN0YXJ0KCk7XHJcblxyXG4gICAgICAgIC8vIHRoaXMubG9vcC5zdGFydCgwKTtcclxuICAgICAgICBUb25lLlRyYW5zcG9ydC5zdGFydCgpO1xyXG4gICAgICAgIC8vIHRoaXMucGxheUJlYXQoMCk7XHJcblxyXG5cclxuXHJcbiAgICAgICAgLy8gd2hpbGUgKHRoaXMucGxheWluZykge1xyXG4gICAgICAgIC8vICAgICB0aGlzLnBsYXlCZWF0KDApXHJcbiAgICAgICAgLy8gICAgIGxldCBzdGFydCA9IG5ldyBEYXRlKCkuZ2V0VGltZSgpO1xyXG4gICAgICAgIC8vICAgICBsZXQgcmVzdWx0ID0gYXdhaXQgdGhpcy53YWl0QmVhdCgxKTtcclxuICAgICAgICAvLyAgICAgbGV0IGVuZCA9IG5ldyBEYXRlKCkuZ2V0VGltZSgpO1xyXG4gICAgICAgIC8vICAgICBjb25zb2xlLmxvZyhlbmQgLSBzdGFydClcclxuICAgICAgICAvLyAgICAgY29uc29sZS5sb2codGhpcy5nZXRCZWF0TWlsbGlzZWNvbmRzKDEpKTtcclxuICAgICAgICAvLyAgICAgdGhpcy5vZmZzZXRUaW1lID0gTWF0aC5tYXgoMCwgKGVuZCAtIHN0YXJ0KSAtIHRoaXMuZ2V0QmVhdE1pbGxpc2Vjb25kcygxKSk7XHJcbiAgICAgICAgLy8gICAgIGNvbnNvbGUubG9nKHRoaXMub2Zmc2V0VGltZSlcclxuICAgICAgICAgICAgLy8gY29uc29sZS5sb2cocmVzdWx0KTtcclxuXHJcbiAgICAgICAgICAgIC8vIGxldCBkaWYgPSBuZXcgRGF0ZSgpLmdldFRpbWUoKSAtIHN0YXJ0VGltZTtcclxuICAgICAgICAgICAgLy8gbGV0IGR1cmF0aW9uID0gdGhpcy5nZXRCZWF0TWlsbGlzZWNvbmRzKDEpXHJcblxyXG4gICAgICAgICAgICAvLyBpZiAoKGR1cmF0aW9uIC8gZGlmKSA+PSAxKSB7XHJcbiAgICAgICAgICAgIC8vICAgY29uc29sZS5sb2coJ3BsYXlpbmcnKTtcclxuICAgICAgICAgICAgLy8gICBzdGFydFRpbWUgKz0gZHVyYXRpb24gKiBNYXRoLmZsb29yKGR1cmF0aW9uIC8gZGlmKTtcclxuICAgICAgICAgICAgLy8gICB0aGlzLnBsYXlCZWF0KDApXHJcbiAgICAgICAgICAgIC8vIH1cclxuICAgICAgICAvLyB9XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0QmVhdE1pbGxpc2Vjb25kcyhkdXJhdGlvbiwgYnBtKSB7XHJcbiAgICAgIGR1cmF0aW9uID0gZHVyYXRpb24gfHwgMTtcclxuICAgICAgYnBtID0gYnBtIHx8IHRoaXMuYnBtO1xyXG4gICAgICBcclxuICAgICAgcmV0dXJuICgoKDYwIC8gYnBtKSAqIChkdXJhdGlvbiAqIDEwMDApKSlcclxuICAgIH1cclxuXHJcbiAgICB3YWl0QmVhdChiZWF0KSB7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKHJlc29sdmUgPT4ge1xyXG4gICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcclxuICAgICAgICAgICAgICAgIHJlc29sdmUoJ3Jlc29sdmVkJylcclxuICAgICAgICAgICAgfSwgKChiZWF0ICogKDYwIC8gdGhpcy5icG0pKSAqIDEwMDApIC0gdGhpcy5vZmZzZXRUaW1lKVxyXG4gICAgICAgIH0pXHJcbiAgICB9XHJcblxyXG4gICAgc3RvcCgpIHtcclxuICAgICAgICB0aGlzLnBsYXlpbmcgPSBmYWxzZTtcclxuICAgICAgICAvLyB0aGlzLmxvb3Auc3RvcCgpO1xyXG4gICAgICAgIFRvbmUuVHJhbnNwb3J0LnN0b3AoKTtcclxuICAgIH1cclxuXHJcbiAgICBwbGF5QmVhdChwaXRjaCkge1xyXG4gICAgICAgIHRoaXMuYXVkaW8udHJpZ2dlckF0dGFja1JlbGVhc2UoXCJDNFwiLCAxKTs7XHJcbiAgICAgICAgLy8gYXVkaW8uY3VycmVudFRpbWUgPSAwO1xyXG4gICAgICAgIC8vIGF1ZGlvLnBsYXkoKTtcclxuXHJcbiAgICAgICAgLy8gYXVkaW8uc3RhcnQoKTtcclxuICAgIH1cclxuXHJcbiAgICBzZXRCcG0oYnBtKSB7XHJcbiAgICAgIHRoaXMuYnBtID0gYnBtIHx8IDEyMDtcclxuICAgICAgVG9uZS5UcmFuc3BvcnQuYnBtLnZhbHVlID0gdGhpcy5icG07XHJcbiAgICB9XHJcbn1cclxuXHJcbi8vIGNvZGUgYnkgQW5kcmV3IFdpbGxlbXMgaHR0cHM6Ly9zdGFja292ZXJmbG93LmNvbS9hLzM3NjIzOTU5LzE3MTI5NjU5XHJcblxyXG5mdW5jdGlvbiBvblJhbmdlQ2hhbmdlKHJhbmdlSW5wdXRFbG10LCBsaXN0ZW5lcikge1xyXG5cclxuICAgIHZhciBpbnB1dEV2dEhhc05ldmVyRmlyZWQgPSB0cnVlO1xyXG4gIFxyXG4gICAgdmFyIHJhbmdlVmFsdWUgPSB7Y3VycmVudDogdW5kZWZpbmVkLCBtb3N0UmVjZW50OiB1bmRlZmluZWR9O1xyXG4gICAgXHJcbiAgICByYW5nZUlucHV0RWxtdC5hZGRFdmVudExpc3RlbmVyKFwiaW5wdXRcIiwgZnVuY3Rpb24oZXZ0KSB7XHJcbiAgICAgIGlucHV0RXZ0SGFzTmV2ZXJGaXJlZCA9IGZhbHNlO1xyXG4gICAgICByYW5nZVZhbHVlLmN1cnJlbnQgPSBldnQudGFyZ2V0LnZhbHVlO1xyXG4gICAgICBpZiAocmFuZ2VWYWx1ZS5jdXJyZW50ICE9PSByYW5nZVZhbHVlLm1vc3RSZWNlbnQpIHtcclxuICAgICAgICBsaXN0ZW5lcihldnQpO1xyXG4gICAgICB9XHJcbiAgICAgIHJhbmdlVmFsdWUubW9zdFJlY2VudCA9IHJhbmdlVmFsdWUuY3VycmVudDtcclxuICAgIH0pO1xyXG4gIFxyXG4gICAgcmFuZ2VJbnB1dEVsbXQuYWRkRXZlbnRMaXN0ZW5lcihcImNoYW5nZVwiLCBmdW5jdGlvbihldnQpIHtcclxuICAgICAgaWYgKGlucHV0RXZ0SGFzTmV2ZXJGaXJlZCkge1xyXG4gICAgICAgIGxpc3RlbmVyKGV2dCk7XHJcbiAgICAgIH1cclxuICAgIH0pOyBcclxuICBcclxufVxyXG5cclxuXHJcbm1ldCA9IG5ldyBNZXRyb25vbWUoKTtcclxuXHJcbmxldCB0ZW1wb0RpdiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy50ZW1wbycpO1xyXG5cclxuLy8gdmFyIHRlbXBvU2xpZGVyQ2hhbmdlID0gKGUpID0+IHtcclxuLy8gICAgIGxldCBpbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyN0ZW1wby1pbnB1dCcpXHJcbi8vICAgICBjb25zb2xlLmxvZyhpbnB1dClcclxuLy8gICAgIGlucHV0LnNldEF0dHJpYnV0ZSgndmFsdWUnLCBlLnRhcmdldC52YWx1ZSlcclxuLy8gfVxyXG5cclxuLy8gb25SYW5nZUNoYW5nZSh0ZW1wb1NsaWRlci5xdWVyeVNlbGVjdG9yKCcjdGVtcG8tc2xpZGVyJyksIHRlbXBvU2xpZGVyQ2hhbmdlKVxyXG5cclxubGV0IHRlbXBvU2xpZGVyID0gdGVtcG9EaXYucXVlcnlTZWxlY3RvcignI3RlbXBvLXNsaWRlcicpO1xyXG50ZW1wb1NsaWRlci5hZGRFdmVudExpc3RlbmVyKCdpbnB1dCcsIGUgPT4ge1xyXG4gICAgbGV0IGlucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI3RlbXBvLWlucHV0Jyk7XHJcbiAgICBpbnB1dC52YWx1ZSA9IHRlbXBvU2xpZGVyLnZhbHVlO1xyXG4gICAgbWV0LnNldEJwbShwYXJzZUludCh0ZW1wb1NsaWRlci52YWx1ZSkpO1xyXG59KVxyXG5cclxudmFyIHRlbXBvSW5wdXQgPSB0ZW1wb0Rpdi5xdWVyeVNlbGVjdG9yKCcjdGVtcG8taW5wdXQnKVxyXG5cclxudGVtcG9JbnB1dC5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCBlID0+IHtcclxuICAgIGxldCBzbGlkZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjdGVtcG8tc2xpZGVyJyk7XHJcbiAgICBzbGlkZXIudmFsdWUgPSB0ZW1wb0lucHV0LnZhbHVlO1xyXG4gICAgbWV0LnNldEJwbShwYXJzZUludCh0ZW1wb0lucHV0LnZhbHVlKSk7XHJcbn0pXHJcblxyXG5jb25zdCBidXR0b25zID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5wbGF5LWJ1dHRvblwiKTtcclxuXHJcbmJ1dHRvbnMuZm9yRWFjaCgoYnV0dG9uKSA9PiB7XHJcbiAgYnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICBjb25zdCBjdXJyZW50U3RhdGUgPSBidXR0b24uZ2V0QXR0cmlidXRlKFwiZGF0YS1zdGF0ZVwiKTtcclxuXHJcbiAgICBpZiAoIWN1cnJlbnRTdGF0ZSB8fCBjdXJyZW50U3RhdGUgPT09IFwic3RvcHBlZFwiKSB7XHJcbiAgICAgIGJ1dHRvbi5zZXRBdHRyaWJ1dGUoXCJkYXRhLXN0YXRlXCIsIFwicGxheWluZ1wiKTtcclxuICAgICAgbWV0LnBsYXkoKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIGJ1dHRvbi5zZXRBdHRyaWJ1dGUoXCJkYXRhLXN0YXRlXCIsIFwic3RvcHBlZFwiKTtcclxuICAgICAgbWV0LnN0b3AoKTtcclxuICAgIH1cclxuICB9KTtcclxufSk7XHJcbiIsIiFmdW5jdGlvbih0LGUpe1wib2JqZWN0XCI9PXR5cGVvZiBleHBvcnRzJiZcIm9iamVjdFwiPT10eXBlb2YgbW9kdWxlP21vZHVsZS5leHBvcnRzPWUoKTpcImZ1bmN0aW9uXCI9PXR5cGVvZiBkZWZpbmUmJmRlZmluZS5hbWQ/ZGVmaW5lKFtdLGUpOlwib2JqZWN0XCI9PXR5cGVvZiBleHBvcnRzP2V4cG9ydHMuVG9uZT1lKCk6dC5Ub25lPWUoKX0oXCJ1bmRlZmluZWRcIiE9dHlwZW9mIHNlbGY/c2VsZjp0aGlzLChmdW5jdGlvbigpe3JldHVybiBmdW5jdGlvbih0KXt2YXIgZT17fTtmdW5jdGlvbiBzKG4pe2lmKGVbbl0pcmV0dXJuIGVbbl0uZXhwb3J0czt2YXIgaT1lW25dPXtpOm4sbDohMSxleHBvcnRzOnt9fTtyZXR1cm4gdFtuXS5jYWxsKGkuZXhwb3J0cyxpLGkuZXhwb3J0cyxzKSxpLmw9ITAsaS5leHBvcnRzfXJldHVybiBzLm09dCxzLmM9ZSxzLmQ9ZnVuY3Rpb24odCxlLG4pe3Mubyh0LGUpfHxPYmplY3QuZGVmaW5lUHJvcGVydHkodCxlLHtlbnVtZXJhYmxlOiEwLGdldDpufSl9LHMucj1mdW5jdGlvbih0KXtcInVuZGVmaW5lZFwiIT10eXBlb2YgU3ltYm9sJiZTeW1ib2wudG9TdHJpbmdUYWcmJk9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LFN5bWJvbC50b1N0cmluZ1RhZyx7dmFsdWU6XCJNb2R1bGVcIn0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LFwiX19lc01vZHVsZVwiLHt2YWx1ZTohMH0pfSxzLnQ9ZnVuY3Rpb24odCxlKXtpZigxJmUmJih0PXModCkpLDgmZSlyZXR1cm4gdDtpZig0JmUmJlwib2JqZWN0XCI9PXR5cGVvZiB0JiZ0JiZ0Ll9fZXNNb2R1bGUpcmV0dXJuIHQ7dmFyIG49T2JqZWN0LmNyZWF0ZShudWxsKTtpZihzLnIobiksT2JqZWN0LmRlZmluZVByb3BlcnR5KG4sXCJkZWZhdWx0XCIse2VudW1lcmFibGU6ITAsdmFsdWU6dH0pLDImZSYmXCJzdHJpbmdcIiE9dHlwZW9mIHQpZm9yKHZhciBpIGluIHQpcy5kKG4saSxmdW5jdGlvbihlKXtyZXR1cm4gdFtlXX0uYmluZChudWxsLGkpKTtyZXR1cm4gbn0scy5uPWZ1bmN0aW9uKHQpe3ZhciBlPXQmJnQuX19lc01vZHVsZT9mdW5jdGlvbigpe3JldHVybiB0LmRlZmF1bHR9OmZ1bmN0aW9uKCl7cmV0dXJuIHR9O3JldHVybiBzLmQoZSxcImFcIixlKSxlfSxzLm89ZnVuY3Rpb24odCxlKXtyZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHQsZSl9LHMucD1cIlwiLHMocy5zPTkpfShbZnVuY3Rpb24odCxlLHMpeyFmdW5jdGlvbih0LGUscyxuKXtcInVzZSBzdHJpY3RcIjtmdW5jdGlvbiBpKHQpe3JldHVybiB0JiZcIm9iamVjdFwiPT10eXBlb2YgdCYmXCJkZWZhdWx0XCJpbiB0P3Q6e2RlZmF1bHQ6dH19dmFyIG89aShlKSxyPWkocyksYT1pKG4pLGM9ZnVuY3Rpb24odCxlLHMpe3JldHVybntlbmRUaW1lOmUsaW5zZXJ0VGltZTpzLHR5cGU6XCJleHBvbmVudGlhbFJhbXBUb1ZhbHVlXCIsdmFsdWU6dH19LGg9ZnVuY3Rpb24odCxlLHMpe3JldHVybntlbmRUaW1lOmUsaW5zZXJ0VGltZTpzLHR5cGU6XCJsaW5lYXJSYW1wVG9WYWx1ZVwiLHZhbHVlOnR9fSx1PWZ1bmN0aW9uKHQsZSl7cmV0dXJue3N0YXJ0VGltZTplLHR5cGU6XCJzZXRWYWx1ZVwiLHZhbHVlOnR9fSxsPWZ1bmN0aW9uKHQsZSxzKXtyZXR1cm57ZHVyYXRpb246cyxzdGFydFRpbWU6ZSx0eXBlOlwic2V0VmFsdWVDdXJ2ZVwiLHZhbHVlczp0fX0scD1mdW5jdGlvbih0LGUscyl7dmFyIG49cy5zdGFydFRpbWUsaT1zLnRhcmdldCxvPXMudGltZUNvbnN0YW50O3JldHVybiBpKyhlLWkpKk1hdGguZXhwKChuLXQpL28pfSxkPWZ1bmN0aW9uKHQpe3JldHVyblwiZXhwb25lbnRpYWxSYW1wVG9WYWx1ZVwiPT09dC50eXBlfSxmPWZ1bmN0aW9uKHQpe3JldHVyblwibGluZWFyUmFtcFRvVmFsdWVcIj09PXQudHlwZX0sXz1mdW5jdGlvbih0KXtyZXR1cm4gZCh0KXx8Zih0KX0sbT1mdW5jdGlvbih0KXtyZXR1cm5cInNldFZhbHVlXCI9PT10LnR5cGV9LGc9ZnVuY3Rpb24odCl7cmV0dXJuXCJzZXRWYWx1ZUN1cnZlXCI9PT10LnR5cGV9LHY9ZnVuY3Rpb24gdChlLHMsbixpKXt2YXIgbz1lW3NdO3JldHVybiB2b2lkIDA9PT1vP2k6XyhvKXx8bShvKT9vLnZhbHVlOmcobyk/by52YWx1ZXNbby52YWx1ZXMubGVuZ3RoLTFdOnAobix0KGUscy0xLG8uc3RhcnRUaW1lLGkpLG8pfSx5PWZ1bmN0aW9uKHQsZSxzLG4saSl7cmV0dXJuIHZvaWQgMD09PXM/W24uaW5zZXJ0VGltZSxpXTpfKHMpP1tzLmVuZFRpbWUscy52YWx1ZV06bShzKT9bcy5zdGFydFRpbWUscy52YWx1ZV06ZyhzKT9bcy5zdGFydFRpbWUrcy5kdXJhdGlvbixzLnZhbHVlc1tzLnZhbHVlcy5sZW5ndGgtMV1dOltzLnN0YXJ0VGltZSx2KHQsZS0xLHMuc3RhcnRUaW1lLGkpXX0seD1mdW5jdGlvbih0KXtyZXR1cm5cImNhbmNlbEFuZEhvbGRcIj09PXQudHlwZX0sdz1mdW5jdGlvbih0KXtyZXR1cm5cImNhbmNlbFNjaGVkdWxlZFZhbHVlc1wiPT09dC50eXBlfSxiPWZ1bmN0aW9uKHQpe3JldHVybiB4KHQpfHx3KHQpP3QuY2FuY2VsVGltZTpkKHQpfHxmKHQpP3QuZW5kVGltZTp0LnN0YXJ0VGltZX0sVD1mdW5jdGlvbih0LGUscyxuKXt2YXIgaT1uLmVuZFRpbWUsbz1uLnZhbHVlO3JldHVybiBzPT09bz9vOjA8cyYmMDxvfHxzPDAmJm88MD9zKk1hdGgucG93KG8vcywodC1lKS8oaS1lKSk6MH0sUz1mdW5jdGlvbih0LGUscyxuKXtyZXR1cm4gcysodC1lKS8obi5lbmRUaW1lLWUpKihuLnZhbHVlLXMpfSxrPWZ1bmN0aW9uKHQsZSl7dmFyIHM9ZS5kdXJhdGlvbixuPWUuc3RhcnRUaW1lLGk9ZS52YWx1ZXM7cmV0dXJuIGZ1bmN0aW9uKHQsZSl7dmFyIHM9TWF0aC5mbG9vcihlKSxuPU1hdGguY2VpbChlKTtyZXR1cm4gcz09PW4/dFtzXTooMS0oZS1zKSkqdFtzXSsoMS0obi1lKSkqdFtuXX0oaSwodC1uKS9zKihpLmxlbmd0aC0xKSl9LEM9ZnVuY3Rpb24odCl7cmV0dXJuXCJzZXRUYXJnZXRcIj09PXQudHlwZX0sQT1mdW5jdGlvbigpe2Z1bmN0aW9uIHQoZSl7ci5kZWZhdWx0KHRoaXMsdCksdGhpcy5fYXV0b21hdGlvbkV2ZW50cz1bXSx0aGlzLl9jdXJyZW5UaW1lPTAsdGhpcy5fZGVmYXVsdFZhbHVlPWV9cmV0dXJuIGEuZGVmYXVsdCh0LFt7a2V5OlN5bWJvbC5pdGVyYXRvcix2YWx1ZTpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9hdXRvbWF0aW9uRXZlbnRzW1N5bWJvbC5pdGVyYXRvcl0oKX19LHtrZXk6XCJhZGRcIix2YWx1ZTpmdW5jdGlvbih0KXt2YXIgZT1iKHQpO2lmKHgodCl8fHcodCkpe3ZhciBzPXRoaXMuX2F1dG9tYXRpb25FdmVudHMuZmluZEluZGV4KChmdW5jdGlvbihzKXtyZXR1cm4gdyh0KSYmZyhzKT9zLnN0YXJ0VGltZStzLmR1cmF0aW9uPj1lOmIocyk+PWV9KSksbj10aGlzLl9hdXRvbWF0aW9uRXZlbnRzW3NdO2lmKC0xIT09cyYmKHRoaXMuX2F1dG9tYXRpb25FdmVudHM9dGhpcy5fYXV0b21hdGlvbkV2ZW50cy5zbGljZSgwLHMpKSx4KHQpKXt2YXIgaT10aGlzLl9hdXRvbWF0aW9uRXZlbnRzW3RoaXMuX2F1dG9tYXRpb25FdmVudHMubGVuZ3RoLTFdO2lmKHZvaWQgMCE9PW4mJl8obikpe2lmKEMoaSkpdGhyb3cgbmV3IEVycm9yKFwiVGhlIGludGVybmFsIGxpc3QgaXMgbWFsZm9ybWVkLlwiKTt2YXIgbz1nKGkpP2kuc3RhcnRUaW1lK2kuZHVyYXRpb246YihpKSxyPWcoaSk/aS52YWx1ZXNbaS52YWx1ZXMubGVuZ3RoLTFdOmkudmFsdWUsYT1kKG4pP1QoZSxvLHIsbik6UyhlLG8scixuKSxwPWQobik/YyhhLGUsdGhpcy5fY3VycmVuVGltZSk6aChhLGUsdGhpcy5fY3VycmVuVGltZSk7dGhpcy5fYXV0b21hdGlvbkV2ZW50cy5wdXNoKHApfXZvaWQgMCE9PWkmJkMoaSkmJnRoaXMuX2F1dG9tYXRpb25FdmVudHMucHVzaCh1KHRoaXMuZ2V0VmFsdWUoZSksZSkpLHZvaWQgMCE9PWkmJmcoaSkmJmkuc3RhcnRUaW1lK2kuZHVyYXRpb24+ZSYmKHRoaXMuX2F1dG9tYXRpb25FdmVudHNbdGhpcy5fYXV0b21hdGlvbkV2ZW50cy5sZW5ndGgtMV09bChuZXcgRmxvYXQzMkFycmF5KFs2LDddKSxpLnN0YXJ0VGltZSxlLWkuc3RhcnRUaW1lKSl9fWVsc2V7dmFyIG09dGhpcy5fYXV0b21hdGlvbkV2ZW50cy5maW5kSW5kZXgoKGZ1bmN0aW9uKHQpe3JldHVybiBiKHQpPmV9KSksdj0tMT09PW0/dGhpcy5fYXV0b21hdGlvbkV2ZW50c1t0aGlzLl9hdXRvbWF0aW9uRXZlbnRzLmxlbmd0aC0xXTp0aGlzLl9hdXRvbWF0aW9uRXZlbnRzW20tMV07aWYodm9pZCAwIT09diYmZyh2KSYmYih2KSt2LmR1cmF0aW9uPmUpcmV0dXJuITE7dmFyIHk9ZCh0KT9jKHQudmFsdWUsdC5lbmRUaW1lLHRoaXMuX2N1cnJlblRpbWUpOmYodCk/aCh0LnZhbHVlLGUsdGhpcy5fY3VycmVuVGltZSk6dDtpZigtMT09PW0pdGhpcy5fYXV0b21hdGlvbkV2ZW50cy5wdXNoKHkpO2Vsc2V7aWYoZyh0KSYmZSt0LmR1cmF0aW9uPmIodGhpcy5fYXV0b21hdGlvbkV2ZW50c1ttXSkpcmV0dXJuITE7dGhpcy5fYXV0b21hdGlvbkV2ZW50cy5zcGxpY2UobSwwLHkpfX1yZXR1cm4hMH19LHtrZXk6XCJmbHVzaFwiLHZhbHVlOmZ1bmN0aW9uKHQpe3ZhciBlPXRoaXMuX2F1dG9tYXRpb25FdmVudHMuZmluZEluZGV4KChmdW5jdGlvbihlKXtyZXR1cm4gYihlKT50fSkpO2lmKGU+MSl7dmFyIHM9dGhpcy5fYXV0b21hdGlvbkV2ZW50cy5zbGljZShlLTEpLG49c1swXTtDKG4pJiZzLnVuc2hpZnQodSh2KHRoaXMuX2F1dG9tYXRpb25FdmVudHMsZS0yLG4uc3RhcnRUaW1lLHRoaXMuX2RlZmF1bHRWYWx1ZSksbi5zdGFydFRpbWUpKSx0aGlzLl9hdXRvbWF0aW9uRXZlbnRzPXN9fX0se2tleTpcImdldFZhbHVlXCIsdmFsdWU6ZnVuY3Rpb24odCl7aWYoMD09PXRoaXMuX2F1dG9tYXRpb25FdmVudHMubGVuZ3RoKXJldHVybiB0aGlzLl9kZWZhdWx0VmFsdWU7dmFyIGU9dGhpcy5fYXV0b21hdGlvbkV2ZW50c1t0aGlzLl9hdXRvbWF0aW9uRXZlbnRzLmxlbmd0aC0xXSxzPXRoaXMuX2F1dG9tYXRpb25FdmVudHMuZmluZEluZGV4KChmdW5jdGlvbihlKXtyZXR1cm4gYihlKT50fSkpLG49dGhpcy5fYXV0b21hdGlvbkV2ZW50c1tzXSxpPWIoZSk8PXQ/ZTp0aGlzLl9hdXRvbWF0aW9uRXZlbnRzW3MtMV07aWYodm9pZCAwIT09aSYmQyhpKSYmKHZvaWQgMD09PW58fCFfKG4pfHxuLmluc2VydFRpbWU+dCkpcmV0dXJuIHAodCx2KHRoaXMuX2F1dG9tYXRpb25FdmVudHMscy0yLGkuc3RhcnRUaW1lLHRoaXMuX2RlZmF1bHRWYWx1ZSksaSk7aWYodm9pZCAwIT09aSYmbShpKSYmKHZvaWQgMD09PW58fCFfKG4pKSlyZXR1cm4gaS52YWx1ZTtpZih2b2lkIDAhPT1pJiZnKGkpJiYodm9pZCAwPT09bnx8IV8obil8fGkuc3RhcnRUaW1lK2kuZHVyYXRpb24+dCkpcmV0dXJuIHQ8aS5zdGFydFRpbWUraS5kdXJhdGlvbj9rKHQsaSk6aS52YWx1ZXNbaS52YWx1ZXMubGVuZ3RoLTFdO2lmKHZvaWQgMCE9PWkmJl8oaSkmJih2b2lkIDA9PT1ufHwhXyhuKSkpcmV0dXJuIGkudmFsdWU7aWYodm9pZCAwIT09biYmZChuKSl7dmFyIHI9eSh0aGlzLl9hdXRvbWF0aW9uRXZlbnRzLHMtMSxpLG4sdGhpcy5fZGVmYXVsdFZhbHVlKSxhPW8uZGVmYXVsdChyLDIpLGM9YVswXSxoPWFbMV07cmV0dXJuIFQodCxjLGgsbil9aWYodm9pZCAwIT09biYmZihuKSl7dmFyIHU9eSh0aGlzLl9hdXRvbWF0aW9uRXZlbnRzLHMtMSxpLG4sdGhpcy5fZGVmYXVsdFZhbHVlKSxsPW8uZGVmYXVsdCh1LDIpLHg9bFswXSx3PWxbMV07cmV0dXJuIFModCx4LHcsbil9cmV0dXJuIHRoaXMuX2RlZmF1bHRWYWx1ZX19XSksdH0oKTt0LkF1dG9tYXRpb25FdmVudExpc3Q9QSx0LmNyZWF0ZUNhbmNlbEFuZEhvbGRBdXRvbWF0aW9uRXZlbnQ9ZnVuY3Rpb24odCl7cmV0dXJue2NhbmNlbFRpbWU6dCx0eXBlOlwiY2FuY2VsQW5kSG9sZFwifX0sdC5jcmVhdGVDYW5jZWxTY2hlZHVsZWRWYWx1ZXNBdXRvbWF0aW9uRXZlbnQ9ZnVuY3Rpb24odCl7cmV0dXJue2NhbmNlbFRpbWU6dCx0eXBlOlwiY2FuY2VsU2NoZWR1bGVkVmFsdWVzXCJ9fSx0LmNyZWF0ZUV4cG9uZW50aWFsUmFtcFRvVmFsdWVBdXRvbWF0aW9uRXZlbnQ9ZnVuY3Rpb24odCxlKXtyZXR1cm57ZW5kVGltZTplLHR5cGU6XCJleHBvbmVudGlhbFJhbXBUb1ZhbHVlXCIsdmFsdWU6dH19LHQuY3JlYXRlTGluZWFyUmFtcFRvVmFsdWVBdXRvbWF0aW9uRXZlbnQ9ZnVuY3Rpb24odCxlKXtyZXR1cm57ZW5kVGltZTplLHR5cGU6XCJsaW5lYXJSYW1wVG9WYWx1ZVwiLHZhbHVlOnR9fSx0LmNyZWF0ZVNldFRhcmdldEF1dG9tYXRpb25FdmVudD1mdW5jdGlvbih0LGUscyl7cmV0dXJue3N0YXJ0VGltZTplLHRhcmdldDp0LHRpbWVDb25zdGFudDpzLHR5cGU6XCJzZXRUYXJnZXRcIn19LHQuY3JlYXRlU2V0VmFsdWVBdXRvbWF0aW9uRXZlbnQ9dSx0LmNyZWF0ZVNldFZhbHVlQ3VydmVBdXRvbWF0aW9uRXZlbnQ9bCxPYmplY3QuZGVmaW5lUHJvcGVydHkodCxcIl9fZXNNb2R1bGVcIix7dmFsdWU6ITB9KX0oZSxzKDEpLHMoNykscyg4KSl9LGZ1bmN0aW9uKHQsZSxzKXt2YXIgbj1zKDIpLGk9cygzKSxvPXMoNCkscj1zKDYpO3QuZXhwb3J0cz1mdW5jdGlvbih0LGUpe3JldHVybiBuKHQpfHxpKHQsZSl8fG8odCxlKXx8cigpfX0sZnVuY3Rpb24odCxlKXt0LmV4cG9ydHM9ZnVuY3Rpb24odCl7aWYoQXJyYXkuaXNBcnJheSh0KSlyZXR1cm4gdH19LGZ1bmN0aW9uKHQsZSl7dC5leHBvcnRzPWZ1bmN0aW9uKHQsZSl7aWYoXCJ1bmRlZmluZWRcIiE9dHlwZW9mIFN5bWJvbCYmU3ltYm9sLml0ZXJhdG9yIGluIE9iamVjdCh0KSl7dmFyIHM9W10sbj0hMCxpPSExLG89dm9pZCAwO3RyeXtmb3IodmFyIHIsYT10W1N5bWJvbC5pdGVyYXRvcl0oKTshKG49KHI9YS5uZXh0KCkpLmRvbmUpJiYocy5wdXNoKHIudmFsdWUpLCFlfHxzLmxlbmd0aCE9PWUpO249ITApO31jYXRjaCh0KXtpPSEwLG89dH1maW5hbGx5e3RyeXtufHxudWxsPT1hLnJldHVybnx8YS5yZXR1cm4oKX1maW5hbGx5e2lmKGkpdGhyb3cgb319cmV0dXJuIHN9fX0sZnVuY3Rpb24odCxlLHMpe3ZhciBuPXMoNSk7dC5leHBvcnRzPWZ1bmN0aW9uKHQsZSl7aWYodCl7aWYoXCJzdHJpbmdcIj09dHlwZW9mIHQpcmV0dXJuIG4odCxlKTt2YXIgcz1PYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwodCkuc2xpY2UoOCwtMSk7cmV0dXJuXCJPYmplY3RcIj09PXMmJnQuY29uc3RydWN0b3ImJihzPXQuY29uc3RydWN0b3IubmFtZSksXCJNYXBcIj09PXN8fFwiU2V0XCI9PT1zP0FycmF5LmZyb20odCk6XCJBcmd1bWVudHNcIj09PXN8fC9eKD86VWl8SSludCg/Ojh8MTZ8MzIpKD86Q2xhbXBlZCk/QXJyYXkkLy50ZXN0KHMpP24odCxlKTp2b2lkIDB9fX0sZnVuY3Rpb24odCxlKXt0LmV4cG9ydHM9ZnVuY3Rpb24odCxlKXsobnVsbD09ZXx8ZT50Lmxlbmd0aCkmJihlPXQubGVuZ3RoKTtmb3IodmFyIHM9MCxuPW5ldyBBcnJheShlKTtzPGU7cysrKW5bc109dFtzXTtyZXR1cm4gbn19LGZ1bmN0aW9uKHQsZSl7dC5leHBvcnRzPWZ1bmN0aW9uKCl7dGhyb3cgbmV3IFR5cGVFcnJvcihcIkludmFsaWQgYXR0ZW1wdCB0byBkZXN0cnVjdHVyZSBub24taXRlcmFibGUgaW5zdGFuY2UuXFxuSW4gb3JkZXIgdG8gYmUgaXRlcmFibGUsIG5vbi1hcnJheSBvYmplY3RzIG11c3QgaGF2ZSBhIFtTeW1ib2wuaXRlcmF0b3JdKCkgbWV0aG9kLlwiKX19LGZ1bmN0aW9uKHQsZSl7dC5leHBvcnRzPWZ1bmN0aW9uKHQsZSl7aWYoISh0IGluc3RhbmNlb2YgZSkpdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvblwiKX19LGZ1bmN0aW9uKHQsZSl7ZnVuY3Rpb24gcyh0LGUpe2Zvcih2YXIgcz0wO3M8ZS5sZW5ndGg7cysrKXt2YXIgbj1lW3NdO24uZW51bWVyYWJsZT1uLmVudW1lcmFibGV8fCExLG4uY29uZmlndXJhYmxlPSEwLFwidmFsdWVcImluIG4mJihuLndyaXRhYmxlPSEwKSxPYmplY3QuZGVmaW5lUHJvcGVydHkodCxuLmtleSxuKX19dC5leHBvcnRzPWZ1bmN0aW9uKHQsZSxuKXtyZXR1cm4gZSYmcyh0LnByb3RvdHlwZSxlKSxuJiZzKHQsbiksdH19LGZ1bmN0aW9uKHQsZSxzKXtcInVzZSBzdHJpY3RcIjtzLnIoZSkscy5kKGUsXCJnZXRDb250ZXh0XCIsKGZ1bmN0aW9uKCl7cmV0dXJuIEppfSkpLHMuZChlLFwic2V0Q29udGV4dFwiLChmdW5jdGlvbigpe3JldHVybiBLaX0pKSxzLmQoZSxcIkNsb2NrXCIsKGZ1bmN0aW9uKCl7cmV0dXJuIHFvfSkpLHMuZChlLFwiQ29udGV4dFwiLChmdW5jdGlvbigpe3JldHVybiBHaX0pKSxzLmQoZSxcIkJhc2VDb250ZXh0XCIsKGZ1bmN0aW9uKCl7cmV0dXJuIFdpfSkpLHMuZChlLFwiRGVsYXlcIiwoZnVuY3Rpb24oKXtyZXR1cm4gRm99KSkscy5kKGUsXCJHYWluXCIsKGZ1bmN0aW9uKCl7cmV0dXJuIGtvfSkpLHMuZChlLFwiT2ZmbGluZVwiLChmdW5jdGlvbigpe3JldHVybiBJb30pKSxzLmQoZSxcIk9mZmxpbmVDb250ZXh0XCIsKGZ1bmN0aW9uKCl7cmV0dXJuIFlpfSkpLHMuZChlLFwiUGFyYW1cIiwoZnVuY3Rpb24oKXtyZXR1cm4geG99KSkscy5kKGUsXCJUb25lQXVkaW9CdWZmZXJcIiwoZnVuY3Rpb24oKXtyZXR1cm4gWGl9KSkscy5kKGUsXCJUb25lQXVkaW9CdWZmZXJzXCIsKGZ1bmN0aW9uKCl7cmV0dXJuIFZvfSkpLHMuZChlLFwiVG9uZUF1ZGlvTm9kZVwiLChmdW5jdGlvbigpe3JldHVybiB3b30pKSxzLmQoZSxcImNvbm5lY3RTZXJpZXNcIiwoZnVuY3Rpb24oKXtyZXR1cm4gYm99KSkscy5kKGUsXCJjb25uZWN0XCIsKGZ1bmN0aW9uKCl7cmV0dXJuIFRvfSkpLHMuZChlLFwiZGlzY29ubmVjdFwiLChmdW5jdGlvbigpe3JldHVybiBTb30pKSxzLmQoZSxcIkZyZXF1ZW5jeUNsYXNzXCIsKGZ1bmN0aW9uKCl7cmV0dXJuIGxvfSkpLHMuZChlLFwiRnJlcXVlbmN5XCIsKGZ1bmN0aW9uKCl7cmV0dXJuIF9vfSkpLHMuZChlLFwiTWlkaUNsYXNzXCIsKGZ1bmN0aW9uKCl7cmV0dXJuIE5vfSkpLHMuZChlLFwiTWlkaVwiLChmdW5jdGlvbigpe3JldHVybiBQb30pKSxzLmQoZSxcIlRpbWVDbGFzc1wiLChmdW5jdGlvbigpe3JldHVybiBob30pKSxzLmQoZSxcIlRpbWVcIiwoZnVuY3Rpb24oKXtyZXR1cm4gdW99KSkscy5kKGUsXCJUaWNrc0NsYXNzXCIsKGZ1bmN0aW9uKCl7cmV0dXJuIGpvfSkpLHMuZChlLFwiVGlja3NcIiwoZnVuY3Rpb24oKXtyZXR1cm4gTG99KSkscy5kKGUsXCJUcmFuc3BvcnRUaW1lQ2xhc3NcIiwoZnVuY3Rpb24oKXtyZXR1cm4gbW99KSkscy5kKGUsXCJUcmFuc3BvcnRUaW1lXCIsKGZ1bmN0aW9uKCl7cmV0dXJuIGdvfSkpLHMuZChlLFwiRW1pdHRlclwiLChmdW5jdGlvbigpe3JldHVybiBCaX0pKSxzLmQoZSxcIkludGVydmFsVGltZWxpbmVcIiwoZnVuY3Rpb24oKXtyZXR1cm4gQm99KSkscy5kKGUsXCJTdGF0ZVRpbWVsaW5lXCIsKGZ1bmN0aW9uKCl7cmV0dXJuIHlvfSkpLHMuZChlLFwiVGltZWxpbmVcIiwoZnVuY3Rpb24oKXtyZXR1cm4gTml9KSkscy5kKGUsXCJpc1VuZGVmXCIsKGZ1bmN0aW9uKCl7cmV0dXJuIGFpfSkpLHMuZChlLFwiaXNEZWZpbmVkXCIsKGZ1bmN0aW9uKCl7cmV0dXJuIGNpfSkpLHMuZChlLFwiaXNGdW5jdGlvblwiLChmdW5jdGlvbigpe3JldHVybiBoaX0pKSxzLmQoZSxcImlzTnVtYmVyXCIsKGZ1bmN0aW9uKCl7cmV0dXJuIHVpfSkpLHMuZChlLFwiaXNPYmplY3RcIiwoZnVuY3Rpb24oKXtyZXR1cm4gbGl9KSkscy5kKGUsXCJpc0Jvb2xlYW5cIiwoZnVuY3Rpb24oKXtyZXR1cm4gcGl9KSkscy5kKGUsXCJpc0FycmF5XCIsKGZ1bmN0aW9uKCl7cmV0dXJuIGRpfSkpLHMuZChlLFwiaXNTdHJpbmdcIiwoZnVuY3Rpb24oKXtyZXR1cm4gZml9KSkscy5kKGUsXCJpc05vdGVcIiwoZnVuY3Rpb24oKXtyZXR1cm4gX2l9KSkscy5kKGUsXCJkYlRvR2FpblwiLChmdW5jdGlvbigpe3JldHVybiBlb30pKSxzLmQoZSxcImdhaW5Ub0RiXCIsKGZ1bmN0aW9uKCl7cmV0dXJuIHNvfSkpLHMuZChlLFwiaW50ZXJ2YWxUb0ZyZXF1ZW5jeVJhdGlvXCIsKGZ1bmN0aW9uKCl7cmV0dXJuIG5vfSkpLHMuZChlLFwiZnRvbVwiLChmdW5jdGlvbigpe3JldHVybiBvb30pKSxzLmQoZSxcIm10b2ZcIiwoZnVuY3Rpb24oKXtyZXR1cm4gYW99KSkscy5kKGUsXCJvcHRpb25zRnJvbUFyZ3VtZW50c1wiLChmdW5jdGlvbigpe3JldHVybiBEaX0pKSxzLmQoZSxcImRlZmF1bHRBcmdcIiwoZnVuY3Rpb24oKXtyZXR1cm4gT2l9KSkscy5kKGUsXCJVbml0XCIsKGZ1bmN0aW9uKCl7cmV0dXJuIGl9KSkscy5kKGUsXCJkZWJ1Z1wiLChmdW5jdGlvbigpe3JldHVybiBufSkpLHMuZChlLFwiTm9pc2VcIiwoZnVuY3Rpb24oKXtyZXR1cm4gSm99KSkscy5kKGUsXCJVc2VyTWVkaWFcIiwoZnVuY3Rpb24oKXtyZXR1cm4gZXJ9KSkscy5kKGUsXCJPc2NpbGxhdG9yXCIsKGZ1bmN0aW9uKCl7cmV0dXJuIGlyfSkpLHMuZChlLFwiQU1Pc2NpbGxhdG9yXCIsKGZ1bmN0aW9uKCl7cmV0dXJuIGhyfSkpLHMuZChlLFwiRk1Pc2NpbGxhdG9yXCIsKGZ1bmN0aW9uKCl7cmV0dXJuIHVyfSkpLHMuZChlLFwiUHVsc2VPc2NpbGxhdG9yXCIsKGZ1bmN0aW9uKCl7cmV0dXJuIGxyfSkpLHMuZChlLFwiRmF0T3NjaWxsYXRvclwiLChmdW5jdGlvbigpe3JldHVybiBwcn0pKSxzLmQoZSxcIlBXTU9zY2lsbGF0b3JcIiwoZnVuY3Rpb24oKXtyZXR1cm4gZHJ9KSkscy5kKGUsXCJPbW5pT3NjaWxsYXRvclwiLChmdW5jdGlvbigpe3JldHVybiBfcn0pKSxzLmQoZSxcIlRvbmVPc2NpbGxhdG9yTm9kZVwiLChmdW5jdGlvbigpe3JldHVybiBucn0pKSxzLmQoZSxcIkxGT1wiLChmdW5jdGlvbigpe3JldHVybiB5cn0pKSxzLmQoZSxcIlRvbmVCdWZmZXJTb3VyY2VcIiwoZnVuY3Rpb24oKXtyZXR1cm4gJG99KSkscy5kKGUsXCJQbGF5ZXJcIiwoZnVuY3Rpb24oKXtyZXR1cm4gYnJ9KSkscy5kKGUsXCJQbGF5ZXJzXCIsKGZ1bmN0aW9uKCl7cmV0dXJuIFRyfSkpLHMuZChlLFwiR3JhaW5QbGF5ZXJcIiwoZnVuY3Rpb24oKXtyZXR1cm4gU3J9KSkscy5kKGUsXCJBZGRcIiwoZnVuY3Rpb24oKXtyZXR1cm4gbXJ9KSkscy5kKGUsXCJBYnNcIiwoZnVuY3Rpb24oKXtyZXR1cm4ga3J9KSkscy5kKGUsXCJBdWRpb1RvR2FpblwiLChmdW5jdGlvbigpe3JldHVybiBhcn0pKSxzLmQoZSxcIkdhaW5Ub0F1ZGlvXCIsKGZ1bmN0aW9uKCl7cmV0dXJuIENyfSkpLHMuZChlLFwiR3JlYXRlclRoYW5cIiwoZnVuY3Rpb24oKXtyZXR1cm4gTXJ9KSkscy5kKGUsXCJHcmVhdGVyVGhhblplcm9cIiwoZnVuY3Rpb24oKXtyZXR1cm4gT3J9KSkscy5kKGUsXCJNdWx0aXBseVwiLChmdW5jdGlvbigpe3JldHVybiBjcn0pKSxzLmQoZSxcIk5lZ2F0ZVwiLChmdW5jdGlvbigpe3JldHVybiBBcn0pKSxzLmQoZSxcIlBvd1wiLChmdW5jdGlvbigpe3JldHVybiBFcn0pKSxzLmQoZSxcIlNpZ25hbFwiLChmdW5jdGlvbigpe3JldHVybiBEb30pKSxzLmQoZSxcImNvbm5lY3RTaWduYWxcIiwoZnVuY3Rpb24oKXtyZXR1cm4gT299KSkscy5kKGUsXCJTY2FsZVwiLChmdW5jdGlvbigpe3JldHVybiBncn0pKSxzLmQoZSxcIlNjYWxlRXhwXCIsKGZ1bmN0aW9uKCl7cmV0dXJuIFJyfSkpLHMuZChlLFwiU3VidHJhY3RcIiwoZnVuY3Rpb24oKXtyZXR1cm4gRHJ9KSkscy5kKGUsXCJTeW5jZWRTaWduYWxcIiwoZnVuY3Rpb24oKXtyZXR1cm4gcXJ9KSkscy5kKGUsXCJXYXZlU2hhcGVyXCIsKGZ1bmN0aW9uKCl7cmV0dXJuIHJyfSkpLHMuZChlLFwiWmVyb1wiLChmdW5jdGlvbigpe3JldHVybiB2cn0pKSxzLmQoZSxcIkFNU3ludGhcIiwoZnVuY3Rpb24oKXtyZXR1cm4genJ9KSkscy5kKGUsXCJEdW9TeW50aFwiLChmdW5jdGlvbigpe3JldHVybiBRcn0pKSxzLmQoZSxcIkZNU3ludGhcIiwoZnVuY3Rpb24oKXtyZXR1cm4gWnJ9KSkscy5kKGUsXCJNZXRhbFN5bnRoXCIsKGZ1bmN0aW9uKCl7cmV0dXJuIFlyfSkpLHMuZChlLFwiTWVtYnJhbmVTeW50aFwiLChmdW5jdGlvbigpe3JldHVybiBIcn0pKSxzLmQoZSxcIk1vbm9TeW50aFwiLChmdW5jdGlvbigpe3JldHVybiBVcn0pKSxzLmQoZSxcIk5vaXNlU3ludGhcIiwoZnVuY3Rpb24oKXtyZXR1cm4gJHJ9KSkscy5kKGUsXCJQbHVja1N5bnRoXCIsKGZ1bmN0aW9uKCl7cmV0dXJuIG9hfSkpLHMuZChlLFwiUG9seVN5bnRoXCIsKGZ1bmN0aW9uKCl7cmV0dXJuIHJhfSkpLHMuZChlLFwiU2FtcGxlclwiLChmdW5jdGlvbigpe3JldHVybiBhYX0pKSxzLmQoZSxcIlN5bnRoXCIsKGZ1bmN0aW9uKCl7cmV0dXJuIGpyfSkpLHMuZChlLFwiTG9vcFwiLChmdW5jdGlvbigpe3JldHVybiBoYX0pKSxzLmQoZSxcIlBhcnRcIiwoZnVuY3Rpb24oKXtyZXR1cm4gdWF9KSkscy5kKGUsXCJQYXR0ZXJuXCIsKGZ1bmN0aW9uKCl7cmV0dXJuIHhhfSkpLHMuZChlLFwiU2VxdWVuY2VcIiwoZnVuY3Rpb24oKXtyZXR1cm4gd2F9KSkscy5kKGUsXCJUb25lRXZlbnRcIiwoZnVuY3Rpb24oKXtyZXR1cm4gY2F9KSkscy5kKGUsXCJBdXRvRmlsdGVyXCIsKGZ1bmN0aW9uKCl7cmV0dXJuIGthfSkpLHMuZChlLFwiQXV0b1Bhbm5lclwiLChmdW5jdGlvbigpe3JldHVybiBBYX0pKSxzLmQoZSxcIkF1dG9XYWhcIiwoZnVuY3Rpb24oKXtyZXR1cm4gT2F9KSkscy5kKGUsXCJCaXRDcnVzaGVyXCIsKGZ1bmN0aW9uKCl7cmV0dXJuIE1hfSkpLHMuZChlLFwiQ2hlYnlzaGV2XCIsKGZ1bmN0aW9uKCl7cmV0dXJuIFJhfSkpLHMuZChlLFwiQ2hvcnVzXCIsKGZ1bmN0aW9uKCl7cmV0dXJuIE5hfSkpLHMuZChlLFwiRGlzdG9ydGlvblwiLChmdW5jdGlvbigpe3JldHVybiBQYX0pKSxzLmQoZSxcIkZlZWRiYWNrRGVsYXlcIiwoZnVuY3Rpb24oKXtyZXR1cm4gTGF9KSkscy5kKGUsXCJGcmVxdWVuY3lTaGlmdGVyXCIsKGZ1bmN0aW9uKCl7cmV0dXJuIEJhfSkpLHMuZChlLFwiRnJlZXZlcmJcIiwoZnVuY3Rpb24oKXtyZXR1cm4gVWF9KSkscy5kKGUsXCJKQ1JldmVyYlwiLChmdW5jdGlvbigpe3JldHVybiBZYX0pKSxzLmQoZSxcIlBpbmdQb25nRGVsYXlcIiwoZnVuY3Rpb24oKXtyZXR1cm4gJGF9KSkscy5kKGUsXCJQaXRjaFNoaWZ0XCIsKGZ1bmN0aW9uKCl7cmV0dXJuIEphfSkpLHMuZChlLFwiUGhhc2VyXCIsKGZ1bmN0aW9uKCl7cmV0dXJuIEthfSkpLHMuZChlLFwiUmV2ZXJiXCIsKGZ1bmN0aW9uKCl7cmV0dXJuIHRjfSkpLHMuZChlLFwiU3RlcmVvV2lkZW5lclwiLChmdW5jdGlvbigpe3JldHVybiBpY30pKSxzLmQoZSxcIlRyZW1vbG9cIiwoZnVuY3Rpb24oKXtyZXR1cm4gb2N9KSkscy5kKGUsXCJWaWJyYXRvXCIsKGZ1bmN0aW9uKCl7cmV0dXJuIHJjfSkpLHMuZChlLFwiQW5hbHlzZXJcIiwoZnVuY3Rpb24oKXtyZXR1cm4gYWN9KSkscy5kKGUsXCJNZXRlclwiLChmdW5jdGlvbigpe3JldHVybiBoY30pKSxzLmQoZSxcIkZGVFwiLChmdW5jdGlvbigpe3JldHVybiB1Y30pKSxzLmQoZSxcIkRDTWV0ZXJcIiwoZnVuY3Rpb24oKXtyZXR1cm4gbGN9KSkscy5kKGUsXCJXYXZlZm9ybVwiLChmdW5jdGlvbigpe3JldHVybiBwY30pKSxzLmQoZSxcIkZvbGxvd2VyXCIsKGZ1bmN0aW9uKCl7cmV0dXJuIERhfSkpLHMuZChlLFwiQ2hhbm5lbFwiLChmdW5jdGlvbigpe3JldHVybiBfY30pKSxzLmQoZSxcIkNyb3NzRmFkZVwiLChmdW5jdGlvbigpe3JldHVybiBiYX0pKSxzLmQoZSxcIk1lcmdlXCIsKGZ1bmN0aW9uKCl7cmV0dXJuIEZhfSkpLHMuZChlLFwiTWlkU2lkZU1lcmdlXCIsKGZ1bmN0aW9uKCl7cmV0dXJuIHNjfSkpLHMuZChlLFwiTWlkU2lkZVNwbGl0XCIsKGZ1bmN0aW9uKCl7cmV0dXJuIGVjfSkpLHMuZChlLFwiTW9ub1wiLChmdW5jdGlvbigpe3JldHVybiBtY30pKSxzLmQoZSxcIk11bHRpYmFuZFNwbGl0XCIsKGZ1bmN0aW9uKCl7cmV0dXJuIGdjfSkpLHMuZChlLFwiUGFubmVyXCIsKGZ1bmN0aW9uKCl7cmV0dXJuIENhfSkpLHMuZChlLFwiUGFubmVyM0RcIiwoZnVuY3Rpb24oKXtyZXR1cm4geWN9KSkscy5kKGUsXCJQYW5Wb2xcIiwoZnVuY3Rpb24oKXtyZXR1cm4gZmN9KSkscy5kKGUsXCJSZWNvcmRlclwiLChmdW5jdGlvbigpe3JldHVybiB4Y30pKSxzLmQoZSxcIlNvbG9cIiwoZnVuY3Rpb24oKXtyZXR1cm4gZGN9KSkscy5kKGUsXCJTcGxpdFwiLChmdW5jdGlvbigpe3JldHVybiBxYX0pKSxzLmQoZSxcIlZvbHVtZVwiLChmdW5jdGlvbigpe3JldHVybiBHb30pKSxzLmQoZSxcIkNvbXByZXNzb3JcIiwoZnVuY3Rpb24oKXtyZXR1cm4gd2N9KSkscy5kKGUsXCJHYXRlXCIsKGZ1bmN0aW9uKCl7cmV0dXJuIGJjfSkpLHMuZChlLFwiTGltaXRlclwiLChmdW5jdGlvbigpe3JldHVybiBUY30pKSxzLmQoZSxcIk1pZFNpZGVDb21wcmVzc29yXCIsKGZ1bmN0aW9uKCl7cmV0dXJuIFNjfSkpLHMuZChlLFwiTXVsdGliYW5kQ29tcHJlc3NvclwiLChmdW5jdGlvbigpe3JldHVybiBrY30pKSxzLmQoZSxcIkFtcGxpdHVkZUVudmVsb3BlXCIsKGZ1bmN0aW9uKCl7cmV0dXJuIFByfSkpLHMuZChlLFwiRW52ZWxvcGVcIiwoZnVuY3Rpb24oKXtyZXR1cm4gRnJ9KSkscy5kKGUsXCJGcmVxdWVuY3lFbnZlbG9wZVwiLChmdW5jdGlvbigpe3JldHVybiBHcn0pKSxzLmQoZSxcIkVRM1wiLChmdW5jdGlvbigpe3JldHVybiBDY30pKSxzLmQoZSxcIkZpbHRlclwiLChmdW5jdGlvbigpe3JldHVybiBXcn0pKSxzLmQoZSxcIk9uZVBvbGVGaWx0ZXJcIiwoZnVuY3Rpb24oKXtyZXR1cm4gbmF9KSkscy5kKGUsXCJGZWVkYmFja0NvbWJGaWx0ZXJcIiwoZnVuY3Rpb24oKXtyZXR1cm4gc2F9KSkscy5kKGUsXCJMb3dwYXNzQ29tYkZpbHRlclwiLChmdW5jdGlvbigpe3JldHVybiBpYX0pKSxzLmQoZSxcIkNvbnZvbHZlclwiLChmdW5jdGlvbigpe3JldHVybiBBY30pKSxzLmQoZSxcIkJpcXVhZEZpbHRlclwiLChmdW5jdGlvbigpe3JldHVybiBCcn0pKSxzLmQoZSxcInZlcnNpb25cIiwoZnVuY3Rpb24oKXtyZXR1cm4gb30pKSxzLmQoZSxcInN0YXJ0XCIsKGZ1bmN0aW9uKCl7cmV0dXJuIHRvfSkpLHMuZChlLFwic3VwcG9ydGVkXCIsKGZ1bmN0aW9uKCl7cmV0dXJuIEtufSkpLHMuZChlLFwibm93XCIsKGZ1bmN0aW9uKCl7cmV0dXJuIERjfSkpLHMuZChlLFwiaW1tZWRpYXRlXCIsKGZ1bmN0aW9uKCl7cmV0dXJuIE9jfSkpLHMuZChlLFwiVHJhbnNwb3J0XCIsKGZ1bmN0aW9uKCl7cmV0dXJuIE1jfSkpLHMuZChlLFwiZ2V0VHJhbnNwb3J0XCIsKGZ1bmN0aW9uKCl7cmV0dXJuIEVjfSkpLHMuZChlLFwiRGVzdGluYXRpb25cIiwoZnVuY3Rpb24oKXtyZXR1cm4gUmN9KSkscy5kKGUsXCJNYXN0ZXJcIiwoZnVuY3Rpb24oKXtyZXR1cm4gcWN9KSkscy5kKGUsXCJnZXREZXN0aW5hdGlvblwiLChmdW5jdGlvbigpe3JldHVybiBGY30pKSxzLmQoZSxcIkxpc3RlbmVyXCIsKGZ1bmN0aW9uKCl7cmV0dXJuIEljfSkpLHMuZChlLFwiZ2V0TGlzdGVuZXJcIiwoZnVuY3Rpb24oKXtyZXR1cm4gVmN9KSkscy5kKGUsXCJEcmF3XCIsKGZ1bmN0aW9uKCl7cmV0dXJuIE5jfSkpLHMuZChlLFwiZ2V0RHJhd1wiLChmdW5jdGlvbigpe3JldHVybiBQY30pKSxzLmQoZSxcImNvbnRleHRcIiwoZnVuY3Rpb24oKXtyZXR1cm4gamN9KSkscy5kKGUsXCJsb2FkZWRcIiwoZnVuY3Rpb24oKXtyZXR1cm4gTGN9KSkscy5kKGUsXCJCdWZmZXJcIiwoZnVuY3Rpb24oKXtyZXR1cm4gemN9KSkscy5kKGUsXCJCdWZmZXJzXCIsKGZ1bmN0aW9uKCl7cmV0dXJuIEJjfSkpLHMuZChlLFwiQnVmZmVyU291cmNlXCIsKGZ1bmN0aW9uKCl7cmV0dXJuIFdjfSkpO3ZhciBuPXt9O3MucihuKSxzLmQobixcImFzc2VydFwiLChmdW5jdGlvbigpe3JldHVybiB0aX0pKSxzLmQobixcImFzc2VydFJhbmdlXCIsKGZ1bmN0aW9uKCl7cmV0dXJuIGVpfSkpLHMuZChuLFwiYXNzZXJ0Q29udGV4dFJ1bm5pbmdcIiwoZnVuY3Rpb24oKXtyZXR1cm4gc2l9KSkscy5kKG4sXCJzZXRMb2dnZXJcIiwoZnVuY3Rpb24oKXtyZXR1cm4gaWl9KSkscy5kKG4sXCJsb2dcIiwoZnVuY3Rpb24oKXtyZXR1cm4gb2l9KSkscy5kKG4sXCJ3YXJuXCIsKGZ1bmN0aW9uKCl7cmV0dXJuIHJpfSkpO3ZhciBpPXt9O3MucihpKTtjb25zdCBvPVwiMTQuNy43N1wiO3ZhciByPXMoMCk7Y29uc3QgYT1uZXcgV2Vha1NldCxjPW5ldyBXZWFrTWFwLGg9bmV3IFdlYWtNYXAsdT1uZXcgV2Vha01hcCxsPW5ldyBXZWFrTWFwLHA9bmV3IFdlYWtNYXAsZD1uZXcgV2Vha01hcCxmPW5ldyBXZWFrTWFwLF89bmV3IFdlYWtNYXAsbT1uZXcgV2Vha01hcCxnPXtjb25zdHJ1Y3Q6KCk9Pmd9LHY9L15pbXBvcnQoPzooPzpbXFxzXStbXFx3XSt8KD86W1xcc10rW1xcd10rW1xcc10qLCk/W1xcc10qXFx7W1xcc10qW1xcd10rKD86W1xcc10rYXNbXFxzXStbXFx3XSspPyg/OltcXHNdKixbXFxzXSpbXFx3XSsoPzpbXFxzXSthc1tcXHNdK1tcXHddKyk/KSpbXFxzXSp9fCg/OltcXHNdK1tcXHddK1tcXHNdKiwpP1tcXHNdKlxcKltcXHNdK2FzW1xcc10rW1xcd10rKVtcXHNdK2Zyb20pPyg/OltcXHNdKikoXCIoW15cIlxcXFxdfFxcXFwuKStcInwnKFteJ1xcXFxdfFxcXFwuKSsnKSg/OltcXHNdKik7Py8seT0odCxlKT0+e2NvbnN0IHM9W107bGV0IG49dC5yZXBsYWNlKC9eW1xcc10rLyxcIlwiKSxpPW4ubWF0Y2godik7Zm9yKDtudWxsIT09aTspe2NvbnN0IHQ9aVsxXS5zbGljZSgxLC0xKSxvPWlbMF0ucmVwbGFjZSgvKFtcXHNdKyk/Oz8kLyxcIlwiKS5yZXBsYWNlKHQsbmV3IFVSTCh0LGUpLnRvU3RyaW5nKCkpO3MucHVzaChvKSxuPW4uc2xpY2UoaVswXS5sZW5ndGgpLnJlcGxhY2UoL15bXFxzXSsvLFwiXCIpLGk9bi5tYXRjaCh2KX1yZXR1cm5bcy5qb2luKFwiO1wiKSxuXX0seD10PT57aWYodm9pZCAwIT09dCYmIUFycmF5LmlzQXJyYXkodCkpdGhyb3cgbmV3IFR5cGVFcnJvcihcIlRoZSBwYXJhbWV0ZXJEZXNjcmlwdG9ycyBwcm9wZXJ0eSBvZiBnaXZlbiB2YWx1ZSBmb3IgcHJvY2Vzc29yQ3RvciBpcyBub3QgYW4gYXJyYXkuXCIpfSx3PXQ9PntpZighKHQ9Pnt0cnl7bmV3IG5ldyBQcm94eSh0LGcpfWNhdGNoe3JldHVybiExfXJldHVybiEwfSkodCkpdGhyb3cgbmV3IFR5cGVFcnJvcihcIlRoZSBnaXZlbiB2YWx1ZSBmb3IgcHJvY2Vzc29yQ3RvciBzaG91bGQgYmUgYSBjb25zdHJ1Y3Rvci5cIik7aWYobnVsbD09PXQucHJvdG90eXBlfHxcIm9iamVjdFwiIT10eXBlb2YgdC5wcm90b3R5cGUpdGhyb3cgbmV3IFR5cGVFcnJvcihcIlRoZSBnaXZlbiB2YWx1ZSBmb3IgcHJvY2Vzc29yQ3RvciBzaG91bGQgaGF2ZSBhIHByb3RvdHlwZS5cIil9LGI9KHQsZSk9Pntjb25zdCBzPXQuZ2V0KGUpO2lmKHZvaWQgMD09PXMpdGhyb3cgbmV3IEVycm9yKFwiQSB2YWx1ZSB3aXRoIHRoZSBnaXZlbiBrZXkgY291bGQgbm90IGJlIGZvdW5kLlwiKTtyZXR1cm4gc30sVD0odCxlKT0+e2NvbnN0IHM9QXJyYXkuZnJvbSh0KS5maWx0ZXIoZSk7aWYocy5sZW5ndGg+MSl0aHJvdyBFcnJvcihcIk1vcmUgdGhhbiBvbmUgZWxlbWVudCB3YXMgZm91bmQuXCIpO2lmKDA9PT1zLmxlbmd0aCl0aHJvdyBFcnJvcihcIk5vIGVsZW1lbnQgd2FzIGZvdW5kLlwiKTtjb25zdFtuXT1zO3JldHVybiB0LmRlbGV0ZShuKSxufSxTPSh0LGUscyxuKT0+e2NvbnN0IGk9Yih0LGUpLG89VChpLHQ9PnRbMF09PT1zJiZ0WzFdPT09bik7cmV0dXJuIDA9PT1pLnNpemUmJnQuZGVsZXRlKGUpLG99LGs9dD0+YihkLHQpLEM9dD0+e2lmKGEuaGFzKHQpKXRocm93IG5ldyBFcnJvcihcIlRoZSBBdWRpb05vZGUgaXMgYWxyZWFkeSBzdG9yZWQuXCIpO2EuYWRkKHQpLGsodCkuZm9yRWFjaCh0PT50KCEwKSl9LEE9dD0+XCJwb3J0XCJpbiB0LEQ9dD0+e2lmKCFhLmhhcyh0KSl0aHJvdyBuZXcgRXJyb3IoXCJUaGUgQXVkaW9Ob2RlIGlzIG5vdCBzdG9yZWQuXCIpO2EuZGVsZXRlKHQpLGsodCkuZm9yRWFjaCh0PT50KCExKSl9LE89KHQsZSk9PnshQSh0KSYmZS5ldmVyeSh0PT4wPT09dC5zaXplKSYmRCh0KX0sTT17Y2hhbm5lbENvdW50OjIsY2hhbm5lbENvdW50TW9kZTpcIm1heFwiLGNoYW5uZWxJbnRlcnByZXRhdGlvbjpcInNwZWFrZXJzXCIsZmZ0U2l6ZToyMDQ4LG1heERlY2liZWxzOi0zMCxtaW5EZWNpYmVsczotMTAwLHNtb290aGluZ1RpbWVDb25zdGFudDouOH0sRT0odCxlKT0+dC5jb250ZXh0PT09ZSxSPXQ9Pnt0cnl7dC5jb3B5VG9DaGFubmVsKG5ldyBGbG9hdDMyQXJyYXkoMSksMCwtMSl9Y2F0Y2h7cmV0dXJuITF9cmV0dXJuITB9LHE9KCk9Pm5ldyBET01FeGNlcHRpb24oXCJcIixcIkluZGV4U2l6ZUVycm9yXCIpLEY9dD0+e3ZhciBlO3QuZ2V0Q2hhbm5lbERhdGE9KGU9dC5nZXRDaGFubmVsRGF0YSxzPT57dHJ5e3JldHVybiBlLmNhbGwodCxzKX1jYXRjaCh0KXtpZigxMj09PXQuY29kZSl0aHJvdyBxKCk7dGhyb3cgdH19KX0sST17bnVtYmVyT2ZDaGFubmVsczoxfSxWPS0zNDAyODIzNDY2Mzg1Mjg4NmUyMixOPS1WLFA9dD0+YS5oYXModCksaj17YnVmZmVyOm51bGwsY2hhbm5lbENvdW50OjIsY2hhbm5lbENvdW50TW9kZTpcIm1heFwiLGNoYW5uZWxJbnRlcnByZXRhdGlvbjpcInNwZWFrZXJzXCIsbG9vcDohMSxsb29wRW5kOjAsbG9vcFN0YXJ0OjAscGxheWJhY2tSYXRlOjF9LEw9dD0+YihjLHQpLHo9dD0+Yih1LHQpLEI9KHQsZSk9Pntjb25zdHthY3RpdmVJbnB1dHM6c309TCh0KTtzLmZvckVhY2gocz0+cy5mb3JFYWNoKChbc10pPT57ZS5pbmNsdWRlcyh0KXx8QihzLFsuLi5lLHRdKX0pKTtjb25zdCBuPSh0PT5cInBsYXliYWNrUmF0ZVwiaW4gdCkodCk/W3QucGxheWJhY2tSYXRlXTpBKHQpP0FycmF5LmZyb20odC5wYXJhbWV0ZXJzLnZhbHVlcygpKToodD0+XCJmcmVxdWVuY3lcImluIHQmJlwiZ2FpblwiaW4gdCkodCk/W3QuUSx0LmRldHVuZSx0LmZyZXF1ZW5jeSx0LmdhaW5dOih0PT5cIm9mZnNldFwiaW4gdCkodCk/W3Qub2Zmc2V0XToodD0+IShcImZyZXF1ZW5jeVwiaW4gdCkmJlwiZ2FpblwiaW4gdCkodCk/W3QuZ2Fpbl06KHQ9PlwiZGV0dW5lXCJpbiB0JiZcImZyZXF1ZW5jeVwiaW4gdCkodCk/W3QuZGV0dW5lLHQuZnJlcXVlbmN5XToodD0+XCJwYW5cImluIHQpKHQpP1t0LnBhbl06W107Zm9yKGNvbnN0IHQgb2Ygbil7Y29uc3Qgcz16KHQpO3ZvaWQgMCE9PXMmJnMuYWN0aXZlSW5wdXRzLmZvckVhY2goKFt0XSk9PkIodCxlKSl9UCh0KSYmRCh0KX0sVz10PT57Qih0LmRlc3RpbmF0aW9uLFtdKX0sRz10PT52b2lkIDA9PT10fHxcIm51bWJlclwiPT10eXBlb2YgdHx8XCJzdHJpbmdcIj09dHlwZW9mIHQmJihcImJhbGFuY2VkXCI9PT10fHxcImludGVyYWN0aXZlXCI9PT10fHxcInBsYXliYWNrXCI9PT10KSxVPXQ9PlwiY29udGV4dFwiaW4gdCxRPXQ9PlUodFswXSksWj0odCxlLHMsbik9Pntmb3IoY29uc3QgZSBvZiB0KWlmKHMoZSkpe2lmKG4pcmV0dXJuITE7dGhyb3cgRXJyb3IoXCJUaGUgc2V0IGNvbnRhaW5zIGF0IGxlYXN0IG9uZSBzaW1pbGFyIGVsZW1lbnQuXCIpfXJldHVybiB0LmFkZChlKSwhMH0sWD0odCxlLFtzLG5dLGkpPT57Wih0LFtlLHMsbl0sdD0+dFswXT09PWUmJnRbMV09PT1zLGkpfSxZPSh0LFtlLHMsbl0saSk9Pntjb25zdCBvPXQuZ2V0KGUpO3ZvaWQgMD09PW8/dC5zZXQoZSxuZXcgU2V0KFtbcyxuXV0pKTpaKG8sW3Msbl0sdD0+dFswXT09PXMsaSl9LEg9dD0+XCJpbnB1dHNcImluIHQsJD0odCxlLHMsbik9PntpZihIKGUpKXtjb25zdCBpPWUuaW5wdXRzW25dO3JldHVybiB0LmNvbm5lY3QoaSxzLDApLFtpLHMsMF19cmV0dXJuIHQuY29ubmVjdChlLHMsbiksW2UscyxuXX0sSj0odCxlLHMpPT57Zm9yKGNvbnN0IG4gb2YgdClpZihuWzBdPT09ZSYmblsxXT09PXMpcmV0dXJuIHQuZGVsZXRlKG4pLG47cmV0dXJuIG51bGx9LEs9KHQsZSk9PntpZighayh0KS5kZWxldGUoZSkpdGhyb3cgbmV3IEVycm9yKFwiTWlzc2luZyB0aGUgZXhwZWN0ZWQgZXZlbnQgbGlzdGVuZXIuXCIpfSx0dD0odCxlLHMpPT57Y29uc3Qgbj1iKHQsZSksaT1UKG4sdD0+dFswXT09PXMpO3JldHVybiAwPT09bi5zaXplJiZ0LmRlbGV0ZShlKSxpfSxldD0odCxlLHMsbik9PntIKGUpP3QuZGlzY29ubmVjdChlLmlucHV0c1tuXSxzLDApOnQuZGlzY29ubmVjdChlLHMsbil9LHN0PXQ9PmIoaCx0KSxudD10PT5iKGwsdCksaXQ9dD0+Zi5oYXModCksb3Q9dD0+IWEuaGFzKHQpLHJ0PXQ9Pm5ldyBQcm9taXNlKGU9Pntjb25zdCBzPXQuY3JlYXRlU2NyaXB0UHJvY2Vzc29yKDI1NiwxLDEpLG49dC5jcmVhdGVHYWluKCksaT10LmNyZWF0ZUJ1ZmZlcigxLDIsNDQxMDApLG89aS5nZXRDaGFubmVsRGF0YSgwKTtvWzBdPTEsb1sxXT0xO2NvbnN0IHI9dC5jcmVhdGVCdWZmZXJTb3VyY2UoKTtyLmJ1ZmZlcj1pLHIubG9vcD0hMCxyLmNvbm5lY3QocykuY29ubmVjdCh0LmRlc3RpbmF0aW9uKSxyLmNvbm5lY3Qobiksci5kaXNjb25uZWN0KG4pLHMub25hdWRpb3Byb2Nlc3M9bj0+e2NvbnN0IGk9bi5pbnB1dEJ1ZmZlci5nZXRDaGFubmVsRGF0YSgwKTtBcnJheS5wcm90b3R5cGUuc29tZS5jYWxsKGksdD0+MT09PXQpP2UoITApOmUoITEpLHIuc3RvcCgpLHMub25hdWRpb3Byb2Nlc3M9bnVsbCxyLmRpc2Nvbm5lY3Qocykscy5kaXNjb25uZWN0KHQuZGVzdGluYXRpb24pfSxyLnN0YXJ0KCl9KSxhdD0odCxlKT0+e2NvbnN0IHM9bmV3IE1hcDtmb3IoY29uc3QgZSBvZiB0KWZvcihjb25zdCB0IG9mIGUpe2NvbnN0IGU9cy5nZXQodCk7cy5zZXQodCx2b2lkIDA9PT1lPzE6ZSsxKX1zLmZvckVhY2goKHQscyk9PmUocyx0KSl9LGN0PXQ9PlwiY29udGV4dFwiaW4gdCxodD0odCxlLHMsbik9Pntjb25zdHthY3RpdmVJbnB1dHM6aSxwYXNzaXZlSW5wdXRzOm99PXooZSkse291dHB1dHM6cn09TCh0KSxhPWsodCksYz1yPT57Y29uc3QgYT1zdCh0KSxjPW50KGUpO2lmKHIpe2NvbnN0IGU9dHQobyx0LHMpO1goaSx0LGUsITEpLG58fGl0KHQpfHxhLmNvbm5lY3QoYyxzKX1lbHNle2NvbnN0IGU9KCh0LGUscyk9PlQodCx0PT50WzBdPT09ZSYmdFsxXT09PXMpKShpLHQscyk7WShvLGUsITEpLG58fGl0KHQpfHxhLmRpc2Nvbm5lY3QoYyxzKX19O3JldHVybiEhWihyLFtlLHNdLHQ9PnRbMF09PT1lJiZ0WzFdPT09cywhMCkmJihhLmFkZChjKSxQKHQpP1goaSx0LFtzLGNdLCEwKTpZKG8sW3QscyxjXSwhMCksITApfSx1dD0odCxlLHMsbixpKT0+e2NvbnN0W28scl09KCh0LGUscyxuKT0+e2NvbnN0e2FjdGl2ZUlucHV0czppLHBhc3NpdmVJbnB1dHM6b309TChlKSxyPUooaVtuXSx0LHMpO2lmKG51bGw9PT1yKXtyZXR1cm5bUyhvLHQscyxuKVsyXSwhMV19cmV0dXJuW3JbMl0sITBdfSkodCxzLG4saSk7aWYobnVsbCE9PW8mJihLKHQsbyksIXJ8fGV8fGl0KHQpfHxldChzdCh0KSxzdChzKSxuLGkpKSxQKHMpKXtjb25zdHthY3RpdmVJbnB1dHM6dH09TChzKTtPKHMsdCl9fSxsdD0odCxlLHMsbik9Pntjb25zdFtpLG9dPSgodCxlLHMpPT57Y29uc3R7YWN0aXZlSW5wdXRzOm4scGFzc2l2ZUlucHV0czppfT16KGUpLG89SihuLHQscyk7aWYobnVsbD09PW8pe3JldHVyblt0dChpLHQscylbMV0sITFdfXJldHVybltvWzJdLCEwXX0pKHQscyxuKTtudWxsIT09aSYmKEsodCxpKSwhb3x8ZXx8aXQodCl8fHN0KHQpLmRpc2Nvbm5lY3QobnQocyksbikpfTtjbGFzcyBwdHtjb25zdHJ1Y3Rvcih0KXt0aGlzLl9tYXA9bmV3IE1hcCh0KX1nZXQgc2l6ZSgpe3JldHVybiB0aGlzLl9tYXAuc2l6ZX1lbnRyaWVzKCl7cmV0dXJuIHRoaXMuX21hcC5lbnRyaWVzKCl9Zm9yRWFjaCh0LGU9bnVsbCl7cmV0dXJuIHRoaXMuX21hcC5mb3JFYWNoKChzLG4pPT50LmNhbGwoZSxzLG4sdGhpcykpfWdldCh0KXtyZXR1cm4gdGhpcy5fbWFwLmdldCh0KX1oYXModCl7cmV0dXJuIHRoaXMuX21hcC5oYXModCl9a2V5cygpe3JldHVybiB0aGlzLl9tYXAua2V5cygpfXZhbHVlcygpe3JldHVybiB0aGlzLl9tYXAudmFsdWVzKCl9fWNvbnN0IGR0PXtjaGFubmVsQ291bnQ6MixjaGFubmVsQ291bnRNb2RlOlwiZXhwbGljaXRcIixjaGFubmVsSW50ZXJwcmV0YXRpb246XCJzcGVha2Vyc1wiLG51bWJlck9mSW5wdXRzOjEsbnVtYmVyT2ZPdXRwdXRzOjEscGFyYW1ldGVyRGF0YTp7fSxwcm9jZXNzb3JPcHRpb25zOnt9fTtmdW5jdGlvbiBmdCh0LGUscyxuLGkpe2lmKFwiZnVuY3Rpb25cIj09dHlwZW9mIHQuY29weUZyb21DaGFubmVsKTA9PT1lW3NdLmJ5dGVMZW5ndGgmJihlW3NdPW5ldyBGbG9hdDMyQXJyYXkoMTI4KSksdC5jb3B5RnJvbUNoYW5uZWwoZVtzXSxuLGkpO2Vsc2V7Y29uc3Qgbz10LmdldENoYW5uZWxEYXRhKG4pO2lmKDA9PT1lW3NdLmJ5dGVMZW5ndGgpZVtzXT1vLnNsaWNlKGksaSsxMjgpO2Vsc2V7Y29uc3QgdD1uZXcgRmxvYXQzMkFycmF5KG8uYnVmZmVyLGkqRmxvYXQzMkFycmF5LkJZVEVTX1BFUl9FTEVNRU5ULDEyOCk7ZVtzXS5zZXQodCl9fX1jb25zdCBfdD0odCxlLHMsbixpKT0+e1wiZnVuY3Rpb25cIj09dHlwZW9mIHQuY29weVRvQ2hhbm5lbD8wIT09ZVtzXS5ieXRlTGVuZ3RoJiZ0LmNvcHlUb0NoYW5uZWwoZVtzXSxuLGkpOjAhPT1lW3NdLmJ5dGVMZW5ndGgmJnQuZ2V0Q2hhbm5lbERhdGEobikuc2V0KGVbc10saSl9LG10PSh0LGUpPT57Y29uc3Qgcz1bXTtmb3IobGV0IG49MDtuPHQ7bis9MSl7Y29uc3QgdD1bXSxpPVwibnVtYmVyXCI9PXR5cGVvZiBlP2U6ZVtuXTtmb3IobGV0IGU9MDtlPGk7ZSs9MSl0LnB1c2gobmV3IEZsb2F0MzJBcnJheSgxMjgpKTtzLnB1c2godCl9cmV0dXJuIHN9LGd0PWFzeW5jKHQsZSxzLG4saSxvLHIpPT57Y29uc3QgYT1udWxsPT09ZT8xMjgqTWF0aC5jZWlsKHQuY29udGV4dC5sZW5ndGgvMTI4KTplLmxlbmd0aCxjPW4uY2hhbm5lbENvdW50Km4ubnVtYmVyT2ZJbnB1dHMsaD1pLnJlZHVjZSgodCxlKT0+dCtlLDApLHU9MD09PWg/bnVsbDpzLmNyZWF0ZUJ1ZmZlcihoLGEscy5zYW1wbGVSYXRlKTtpZih2b2lkIDA9PT1vKXRocm93IG5ldyBFcnJvcihcIk1pc3NpbmcgdGhlIHByb2Nlc3NvciBjb25zdHJ1Y3Rvci5cIik7Y29uc3QgbD1MKHQpLHA9YXdhaXQoKHQsZSk9Pntjb25zdCBzPWIobSx0KSxuPXN0KGUpO3JldHVybiBiKHMsbil9KShzLHQpLGQ9bXQobi5udW1iZXJPZklucHV0cyxuLmNoYW5uZWxDb3VudCksZj1tdChuLm51bWJlck9mT3V0cHV0cyxpKSxfPUFycmF5LmZyb20odC5wYXJhbWV0ZXJzLmtleXMoKSkucmVkdWNlKCh0LGUpPT4oey4uLnQsW2VdOm5ldyBGbG9hdDMyQXJyYXkoMTI4KX0pLHt9KTtmb3IobGV0IGg9MDtoPGE7aCs9MTI4KXtpZihuLm51bWJlck9mSW5wdXRzPjAmJm51bGwhPT1lKWZvcihsZXQgdD0wO3Q8bi5udW1iZXJPZklucHV0czt0Kz0xKWZvcihsZXQgcz0wO3M8bi5jaGFubmVsQ291bnQ7cys9MSlmdChlLGRbdF0scyxzLGgpO3ZvaWQgMCE9PW8ucGFyYW1ldGVyRGVzY3JpcHRvcnMmJm51bGwhPT1lJiZvLnBhcmFtZXRlckRlc2NyaXB0b3JzLmZvckVhY2goKHtuYW1lOnR9LHMpPT57ZnQoZSxfLHQsYytzLGgpfSk7Zm9yKGxldCB0PTA7dDxuLm51bWJlck9mSW5wdXRzO3QrPTEpZm9yKGxldCBlPTA7ZTxpW3RdO2UrPTEpMD09PWZbdF1bZV0uYnl0ZUxlbmd0aCYmKGZbdF1bZV09bmV3IEZsb2F0MzJBcnJheSgxMjgpKTt0cnl7Y29uc3QgdD1kLm1hcCgodCxlKT0+MD09PWwuYWN0aXZlSW5wdXRzW2VdLnNpemU/W106dCksZT1yKGgvcy5zYW1wbGVSYXRlLHMuc2FtcGxlUmF0ZSwoKT0+cC5wcm9jZXNzKHQsZixfKSk7aWYobnVsbCE9PXUpZm9yKGxldCB0PTAsZT0wO3Q8bi5udW1iZXJPZk91dHB1dHM7dCs9MSl7Zm9yKGxldCBzPTA7czxpW3RdO3MrPTEpX3QodSxmW3RdLHMsZStzLGgpO2UrPWlbdF19aWYoIWUpYnJlYWt9Y2F0Y2goZSl7dC5kaXNwYXRjaEV2ZW50KG5ldyBFcnJvckV2ZW50KFwicHJvY2Vzc29yZXJyb3JcIix7Y29sbm86ZS5jb2xubyxmaWxlbmFtZTplLmZpbGVuYW1lLGxpbmVubzplLmxpbmVubyxtZXNzYWdlOmUubWVzc2FnZX0pKTticmVha319cmV0dXJuIHV9LHZ0PXtROjEsY2hhbm5lbENvdW50OjIsY2hhbm5lbENvdW50TW9kZTpcIm1heFwiLGNoYW5uZWxJbnRlcnByZXRhdGlvbjpcInNwZWFrZXJzXCIsZGV0dW5lOjAsZnJlcXVlbmN5OjM1MCxnYWluOjAsdHlwZTpcImxvd3Bhc3NcIn0seXQ9e2NoYW5uZWxDb3VudDoxLGNoYW5uZWxDb3VudE1vZGU6XCJleHBsaWNpdFwiLGNoYW5uZWxJbnRlcnByZXRhdGlvbjpcInNwZWFrZXJzXCIsbnVtYmVyT2ZJbnB1dHM6Nn0seHQ9e2NoYW5uZWxDb3VudDo2LGNoYW5uZWxDb3VudE1vZGU6XCJleHBsaWNpdFwiLGNoYW5uZWxJbnRlcnByZXRhdGlvbjpcImRpc2NyZXRlXCIsbnVtYmVyT2ZPdXRwdXRzOjZ9LHd0PXtjaGFubmVsQ291bnQ6MixjaGFubmVsQ291bnRNb2RlOlwibWF4XCIsY2hhbm5lbEludGVycHJldGF0aW9uOlwic3BlYWtlcnNcIixvZmZzZXQ6MX0sYnQ9e2J1ZmZlcjpudWxsLGNoYW5uZWxDb3VudDoyLGNoYW5uZWxDb3VudE1vZGU6XCJjbGFtcGVkLW1heFwiLGNoYW5uZWxJbnRlcnByZXRhdGlvbjpcInNwZWFrZXJzXCIsZGlzYWJsZU5vcm1hbGl6YXRpb246ITF9LFR0PXtjaGFubmVsQ291bnQ6MixjaGFubmVsQ291bnRNb2RlOlwibWF4XCIsY2hhbm5lbEludGVycHJldGF0aW9uOlwic3BlYWtlcnNcIixkZWxheVRpbWU6MCxtYXhEZWxheVRpbWU6MX0sU3Q9KHQsZSxzKT0+e2NvbnN0IG49ZVtzXTtpZih2b2lkIDA9PT1uKXRocm93IHQoKTtyZXR1cm4gbn0sa3Q9e2F0dGFjazouMDAzLGNoYW5uZWxDb3VudDoyLGNoYW5uZWxDb3VudE1vZGU6XCJjbGFtcGVkLW1heFwiLGNoYW5uZWxJbnRlcnByZXRhdGlvbjpcInNwZWFrZXJzXCIsa25lZTozMCxyYXRpbzoxMixyZWxlYXNlOi4yNSx0aHJlc2hvbGQ6LTI0fSxDdD17Y2hhbm5lbENvdW50OjIsY2hhbm5lbENvdW50TW9kZTpcIm1heFwiLGNoYW5uZWxJbnRlcnByZXRhdGlvbjpcInNwZWFrZXJzXCIsZ2FpbjoxfSxBdD0oKT0+bmV3IERPTUV4Y2VwdGlvbihcIlwiLFwiSW52YWxpZFN0YXRlRXJyb3JcIiksRHQ9KCk9Pm5ldyBET01FeGNlcHRpb24oXCJcIixcIkludmFsaWRBY2Nlc3NFcnJvclwiKSxPdD17Y2hhbm5lbENvdW50OjIsY2hhbm5lbENvdW50TW9kZTpcIm1heFwiLGNoYW5uZWxJbnRlcnByZXRhdGlvbjpcInNwZWFrZXJzXCJ9LE10PSh0LGUscyxuLGksbyxyLGEsYyxoLHUpPT57Y29uc3QgbD1oLmxlbmd0aDtsZXQgcD1hO2ZvcihsZXQgYT0wO2E8bDthKz0xKXtsZXQgbD1zWzBdKmhbYV07Zm9yKGxldCBlPTE7ZTxpO2UrPTEpe2NvbnN0IG49cC1lJmMtMTtsKz1zW2VdKm9bbl0sbC09dFtlXSpyW25dfWZvcihsZXQgdD1pO3Q8bjt0Kz0xKWwrPXNbdF0qb1twLXQmYy0xXTtmb3IobGV0IHM9aTtzPGU7cys9MSlsLT10W3NdKnJbcC1zJmMtMV07b1twXT1oW2FdLHJbcF09bCxwPXArMSZjLTEsdVthXT1sfXJldHVybiBwfSxFdD17Y2hhbm5lbENvdW50OjIsY2hhbm5lbENvdW50TW9kZTpcImV4cGxpY2l0XCIsY2hhbm5lbEludGVycHJldGF0aW9uOlwic3BlYWtlcnNcIn0sUnQ9dD0+e2NvbnN0IGU9bmV3IFVpbnQzMkFycmF5KFsxMTc5MDExNDEwLDQwLDExNjMyODA3MjcsNTQ0NTAxMDk0LDE2LDEzMTA3Myw0NDEwMCwxNzY0MDAsMTA0ODU4MCwxNjM1MDE3MDYwLDQsMF0pO3RyeXtjb25zdCBzPXQuZGVjb2RlQXVkaW9EYXRhKGUuYnVmZmVyLCgpPT57fSk7cmV0dXJuIHZvaWQgMCE9PXMmJihzLmNhdGNoKCgpPT57fSksITApfWNhdGNoe31yZXR1cm4hMX0scXQ9e251bWJlck9mQ2hhbm5lbHM6MX0sRnQ9KHQsZSxzKT0+e2NvbnN0IG49ZVtzXTt2b2lkIDAhPT1uJiZuIT09dFtzXSYmKHRbc109bil9LEl0PSh0LGUpPT57RnQodCxlLFwiY2hhbm5lbENvdW50XCIpLEZ0KHQsZSxcImNoYW5uZWxDb3VudE1vZGVcIiksRnQodCxlLFwiY2hhbm5lbEludGVycHJldGF0aW9uXCIpfSxWdD10PT5cImZ1bmN0aW9uXCI9PXR5cGVvZiB0LmdldEZsb2F0VGltZURvbWFpbkRhdGEsTnQ9KHQsZSxzKT0+e2NvbnN0IG49ZVtzXTt2b2lkIDAhPT1uJiZuIT09dFtzXS52YWx1ZSYmKHRbc10udmFsdWU9bil9LFB0PXQ9Pnt2YXIgZTt0LnN0YXJ0PShlPXQuc3RhcnQsKHM9MCxuPTAsaSk9PntpZihcIm51bWJlclwiPT10eXBlb2YgaSYmaTwwfHxuPDB8fHM8MCl0aHJvdyBuZXcgUmFuZ2VFcnJvcihcIlRoZSBwYXJhbWV0ZXJzIGNhbid0IGJlIG5lZ2F0aXZlLlwiKTtlLmNhbGwodCxzLG4saSl9KX0sanQ9dD0+e3ZhciBlO3Quc3RvcD0oZT10LnN0b3AsKHM9MCk9PntpZihzPDApdGhyb3cgbmV3IFJhbmdlRXJyb3IoXCJUaGUgcGFyYW1ldGVyIGNhbid0IGJlIG5lZ2F0aXZlLlwiKTtlLmNhbGwodCxzKX0pfSxMdD0odCxlKT0+bnVsbD09PXQ/NTEyOk1hdGgubWF4KDUxMixNYXRoLm1pbigxNjM4NCxNYXRoLnBvdygyLE1hdGgucm91bmQoTWF0aC5sb2cyKHQqZSkpKSkpLHp0PWFzeW5jKHQsZSk9Pm5ldyB0KGF3YWl0KHQ9Pm5ldyBQcm9taXNlKChlLHMpPT57Y29uc3R7cG9ydDE6bixwb3J0MjppfT1uZXcgTWVzc2FnZUNoYW5uZWw7bi5vbm1lc3NhZ2U9KHtkYXRhOnR9KT0+e24uY2xvc2UoKSxpLmNsb3NlKCksZSh0KX0sbi5vbm1lc3NhZ2VlcnJvcj0oe2RhdGE6dH0pPT57bi5jbG9zZSgpLGkuY2xvc2UoKSxzKHQpfSxpLnBvc3RNZXNzYWdlKHQpfSkpKGUpKSxCdD0odCxlKT0+e2NvbnN0IHM9dC5jcmVhdGVCaXF1YWRGaWx0ZXIoKTtyZXR1cm4gSXQocyxlKSxOdChzLGUsXCJRXCIpLE50KHMsZSxcImRldHVuZVwiKSxOdChzLGUsXCJmcmVxdWVuY3lcIiksTnQocyxlLFwiZ2FpblwiKSxGdChzLGUsXCJ0eXBlXCIpLHN9LFd0PSh0LGUpPT57Y29uc3Qgcz10LmNyZWF0ZUNoYW5uZWxTcGxpdHRlcihlLm51bWJlck9mT3V0cHV0cyk7cmV0dXJuIEl0KHMsZSksKHQ9Pntjb25zdCBlPXQubnVtYmVyT2ZPdXRwdXRzO09iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LFwiY2hhbm5lbENvdW50XCIse2dldDooKT0+ZSxzZXQ6dD0+e2lmKHQhPT1lKXRocm93IEF0KCl9fSksT2JqZWN0LmRlZmluZVByb3BlcnR5KHQsXCJjaGFubmVsQ291bnRNb2RlXCIse2dldDooKT0+XCJleHBsaWNpdFwiLHNldDp0PT57aWYoXCJleHBsaWNpdFwiIT09dCl0aHJvdyBBdCgpfX0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LFwiY2hhbm5lbEludGVycHJldGF0aW9uXCIse2dldDooKT0+XCJkaXNjcmV0ZVwiLHNldDp0PT57aWYoXCJkaXNjcmV0ZVwiIT09dCl0aHJvdyBBdCgpfX0pfSkocyksc30sR3Q9KHQsZSk9Pih0LmNvbm5lY3Q9ZS5jb25uZWN0LmJpbmQoZSksdC5kaXNjb25uZWN0PWUuZGlzY29ubmVjdC5iaW5kKGUpLHQpLFV0PSh0LGUpPT57Y29uc3Qgcz10LmNyZWF0ZURlbGF5KGUubWF4RGVsYXlUaW1lKTtyZXR1cm4gSXQocyxlKSxOdChzLGUsXCJkZWxheVRpbWVcIiksc30sUXQ9KHQsZSk9Pntjb25zdCBzPXQuY3JlYXRlR2FpbigpO3JldHVybiBJdChzLGUpLE50KHMsZSxcImdhaW5cIiksc307ZnVuY3Rpb24gWnQodCxlKXtjb25zdCBzPWVbMF0qZVswXStlWzFdKmVbMV07cmV0dXJuWyh0WzBdKmVbMF0rdFsxXSplWzFdKS9zLCh0WzFdKmVbMF0tdFswXSplWzFdKS9zXX1mdW5jdGlvbiBYdCh0LGUpe2xldCBzPVswLDBdO2ZvcihsZXQgbz10Lmxlbmd0aC0xO28+PTA7by09MSlpPWUscz1bKG49cylbMF0qaVswXS1uWzFdKmlbMV0sblswXSppWzFdK25bMV0qaVswXV0sc1swXSs9dFtvXTt2YXIgbixpO3JldHVybiBzfWNvbnN0IFl0PSh0LGUscyxuKT0+dC5jcmVhdGVTY3JpcHRQcm9jZXNzb3IoZSxzLG4pLEh0PSgpPT5uZXcgRE9NRXhjZXB0aW9uKFwiXCIsXCJOb3RTdXBwb3J0ZWRFcnJvclwiKSwkdD17bnVtYmVyT2ZDaGFubmVsczoxfSxKdD17Y2hhbm5lbENvdW50OjIsY2hhbm5lbENvdW50TW9kZTpcIm1heFwiLGNoYW5uZWxJbnRlcnByZXRhdGlvbjpcInNwZWFrZXJzXCIsZGV0dW5lOjAsZnJlcXVlbmN5OjQ0MCxwZXJpb2RpY1dhdmU6dm9pZCAwLHR5cGU6XCJzaW5lXCJ9LEt0PXtjaGFubmVsQ291bnQ6MixjaGFubmVsQ291bnRNb2RlOlwiY2xhbXBlZC1tYXhcIixjaGFubmVsSW50ZXJwcmV0YXRpb246XCJzcGVha2Vyc1wiLGNvbmVJbm5lckFuZ2xlOjM2MCxjb25lT3V0ZXJBbmdsZTozNjAsY29uZU91dGVyR2FpbjowLGRpc3RhbmNlTW9kZWw6XCJpbnZlcnNlXCIsbWF4RGlzdGFuY2U6MWU0LG9yaWVudGF0aW9uWDoxLG9yaWVudGF0aW9uWTowLG9yaWVudGF0aW9uWjowLHBhbm5pbmdNb2RlbDpcImVxdWFscG93ZXJcIixwb3NpdGlvblg6MCxwb3NpdGlvblk6MCxwb3NpdGlvblo6MCxyZWZEaXN0YW5jZToxLHJvbGxvZmZGYWN0b3I6MX0sdGU9e2Rpc2FibGVOb3JtYWxpemF0aW9uOiExfSxlZT17Y2hhbm5lbENvdW50OjIsY2hhbm5lbENvdW50TW9kZTpcImV4cGxpY2l0XCIsY2hhbm5lbEludGVycHJldGF0aW9uOlwic3BlYWtlcnNcIixwYW46MH0sc2U9KCk9Pm5ldyBET01FeGNlcHRpb24oXCJcIixcIlVua25vd25FcnJvclwiKSxuZT17Y2hhbm5lbENvdW50OjIsY2hhbm5lbENvdW50TW9kZTpcIm1heFwiLGNoYW5uZWxJbnRlcnByZXRhdGlvbjpcInNwZWFrZXJzXCIsY3VydmU6bnVsbCxvdmVyc2FtcGxlOlwibm9uZVwifSxpZT10PT57aWYobnVsbD09PXQpcmV0dXJuITE7Y29uc3QgZT10Lmxlbmd0aDtyZXR1cm4gZSUyIT0wPzAhPT10W01hdGguZmxvb3IoZS8yKV06dFtlLzItMV0rdFtlLzJdIT09MH0sb2U9KHQsZSxzLG4pPT57bGV0IGk9T2JqZWN0LmdldFByb3RvdHlwZU9mKHQpO2Zvcig7IWkuaGFzT3duUHJvcGVydHkoZSk7KWk9T2JqZWN0LmdldFByb3RvdHlwZU9mKGkpO2NvbnN0e2dldDpvLHNldDpyfT1PYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKGksZSk7T2JqZWN0LmRlZmluZVByb3BlcnR5KHQsZSx7Z2V0OnMobyksc2V0Om4ocil9KX0scmU9KHQsZSxzKT0+e3RyeXt0LnNldFZhbHVlQXRUaW1lKGUscyl9Y2F0Y2gobil7aWYoOSE9PW4uY29kZSl0aHJvdyBuO3JlKHQsZSxzKzFlLTcpfX0sYWU9dD0+e2NvbnN0IGU9dC5jcmVhdGVPc2NpbGxhdG9yKCk7dHJ5e2Uuc3RhcnQoLTEpfWNhdGNoKHQpe3JldHVybiB0IGluc3RhbmNlb2YgUmFuZ2VFcnJvcn1yZXR1cm4hMX0sY2U9dD0+e2NvbnN0IGU9dC5jcmVhdGVCdWZmZXIoMSwxLDQ0MTAwKSxzPXQuY3JlYXRlQnVmZmVyU291cmNlKCk7cy5idWZmZXI9ZSxzLnN0YXJ0KCkscy5zdG9wKCk7dHJ5e3JldHVybiBzLnN0b3AoKSwhMH1jYXRjaHtyZXR1cm4hMX19LGhlPXQ9Pntjb25zdCBlPXQuY3JlYXRlT3NjaWxsYXRvcigpO3RyeXtlLnN0b3AoLTEpfWNhdGNoKHQpe3JldHVybiB0IGluc3RhbmNlb2YgUmFuZ2VFcnJvcn1yZXR1cm4hMX0sdWU9KCk9Pnt0cnl7bmV3IERPTUV4Y2VwdGlvbn1jYXRjaHtyZXR1cm4hMX1yZXR1cm4hMH0sbGU9KCk9Pm5ldyBQcm9taXNlKHQ9Pntjb25zdCBlPW5ldyBBcnJheUJ1ZmZlcigwKSx7cG9ydDE6cyxwb3J0MjpufT1uZXcgTWVzc2FnZUNoYW5uZWw7cy5vbm1lc3NhZ2U9KHtkYXRhOmV9KT0+dChudWxsIT09ZSksbi5wb3N0TWVzc2FnZShlLFtlXSl9KSxwZT0odCxlKT0+e2NvbnN0IHM9ZS5jcmVhdGVHYWluKCk7dC5jb25uZWN0KHMpO2NvbnN0IG49KGk9dC5kaXNjb25uZWN0LCgpPT57aS5jYWxsKHQscyksdC5yZW1vdmVFdmVudExpc3RlbmVyKFwiZW5kZWRcIixuKX0pO3ZhciBpO3QuYWRkRXZlbnRMaXN0ZW5lcihcImVuZGVkXCIsbiksR3QodCxzKSx0LnN0b3A9KGU9PntsZXQgbj0hMTtyZXR1cm4oaT0wKT0+e2lmKG4pdHJ5e2UuY2FsbCh0LGkpfWNhdGNoe3MuZ2Fpbi5zZXRWYWx1ZUF0VGltZSgwLGkpfWVsc2UgZS5jYWxsKHQsaSksbj0hMH19KSh0LnN0b3ApfSxkZT0odCxlKT0+cz0+e2NvbnN0IG49e3ZhbHVlOnR9O3JldHVybiBPYmplY3QuZGVmaW5lUHJvcGVydGllcyhzLHtjdXJyZW50VGFyZ2V0Om4sdGFyZ2V0Om59KSxcImZ1bmN0aW9uXCI9PXR5cGVvZiBlP2UuY2FsbCh0LHMpOmUuaGFuZGxlRXZlbnQuY2FsbCh0LHMpfSxmZT0oX2U9WiwodCxlLFtzLG4saV0sbyk9PntfZSh0W25dLFtlLHMsaV0sdD0+dFswXT09PWUmJnRbMV09PT1zLG8pfSk7dmFyIF9lO2NvbnN0IG1lPSh0PT4oZSxzLFtuLGksb10scik9Pntjb25zdCBhPWUuZ2V0KG4pO3ZvaWQgMD09PWE/ZS5zZXQobixuZXcgU2V0KFtbaSxzLG9dXSkpOnQoYSxbaSxzLG9dLHQ9PnRbMF09PT1pJiZ0WzFdPT09cyxyKX0pKFopLGdlPSh0PT4oZSxzLG4saSk9PnQoZVtpXSx0PT50WzBdPT09cyYmdFsxXT09PW4pKShUKSx2ZT1uZXcgV2Vha01hcCx5ZT0odD0+ZT0+e3ZhciBzO3JldHVybiBudWxsIT09KHM9dC5nZXQoZSkpJiZ2b2lkIDAhPT1zP3M6MH0pKHZlKSx4ZT0od2U9bmV3IE1hcCxiZT1uZXcgV2Vha01hcCwodCxlKT0+e2NvbnN0IHM9YmUuZ2V0KHQpO2lmKHZvaWQgMCE9PXMpcmV0dXJuIHM7Y29uc3Qgbj13ZS5nZXQodCk7aWYodm9pZCAwIT09bilyZXR1cm4gbjt0cnl7Y29uc3Qgcz1lKCk7cmV0dXJuIHMgaW5zdGFuY2VvZiBQcm9taXNlPyh3ZS5zZXQodCxzKSxzLmNhdGNoKCgpPT4hMSkudGhlbihlPT4od2UuZGVsZXRlKHQpLGJlLnNldCh0LGUpLGUpKSk6KGJlLnNldCh0LHMpLHMpfWNhdGNoe3JldHVybiBiZS5zZXQodCwhMSksITF9fSk7dmFyIHdlLGJlO2NvbnN0IFRlPVwidW5kZWZpbmVkXCI9PXR5cGVvZiB3aW5kb3c/bnVsbDp3aW5kb3csU2U9KGtlPXhlLENlPXEsKHQsZSk9Pntjb25zdCBzPXQuY3JlYXRlQW5hbHlzZXIoKTtpZihJdChzLGUpLCEoZS5tYXhEZWNpYmVscz5lLm1pbkRlY2liZWxzKSl0aHJvdyBDZSgpO3JldHVybiBGdChzLGUsXCJmZnRTaXplXCIpLEZ0KHMsZSxcIm1heERlY2liZWxzXCIpLEZ0KHMsZSxcIm1pbkRlY2liZWxzXCIpLEZ0KHMsZSxcInNtb290aGluZ1RpbWVDb25zdGFudFwiKSxrZShWdCwoKT0+VnQocykpfHwodD0+e3QuZ2V0RmxvYXRUaW1lRG9tYWluRGF0YT1lPT57Y29uc3Qgcz1uZXcgVWludDhBcnJheShlLmxlbmd0aCk7dC5nZXRCeXRlVGltZURvbWFpbkRhdGEocyk7Y29uc3Qgbj1NYXRoLm1heChzLmxlbmd0aCx0LmZmdFNpemUpO2ZvcihsZXQgdD0wO3Q8bjt0Kz0xKWVbdF09LjAwNzgxMjUqKHNbdF0tMTI4KTtyZXR1cm4gZX19KShzKSxzfSk7dmFyIGtlLENlO2NvbnN0IEFlPShEZT1MLHQ9Pntjb25zdCBlPURlKHQpO2lmKG51bGw9PT1lLnJlbmRlcmVyKXRocm93IG5ldyBFcnJvcihcIk1pc3NpbmcgdGhlIHJlbmRlcmVyIG9mIHRoZSBnaXZlbiBBdWRpb05vZGUgaW4gdGhlIGF1ZGlvIGdyYXBoLlwiKTtyZXR1cm4gZS5yZW5kZXJlcn0pO3ZhciBEZTtjb25zdCBPZT0oKHQsZSxzKT0+YXN5bmMobixpLG8scik9Pntjb25zdCBhPXQobiksYz1bLi4ucixuXTthd2FpdCBQcm9taXNlLmFsbChhLmFjdGl2ZUlucHV0cy5tYXAoKHQscik9PkFycmF5LmZyb20odCkuZmlsdGVyKChbdF0pPT4hYy5pbmNsdWRlcyh0KSkubWFwKGFzeW5jKFt0LGFdKT0+e2NvbnN0IGg9ZSh0KSx1PWF3YWl0IGgucmVuZGVyKHQsaSxjKSxsPW4uY29udGV4dC5kZXN0aW5hdGlvbjtzKHQpfHxuPT09bCYmcyhuKXx8dS5jb25uZWN0KG8sYSxyKX0pKS5yZWR1Y2UoKHQsZSk9PlsuLi50LC4uLmVdLFtdKSl9KShMLEFlLGl0KSxNZT0oRWU9U2UsUmU9c3QscWU9T2UsKCk9Pntjb25zdCB0PW5ldyBXZWFrTWFwO3JldHVybntyZW5kZXIoZSxzLG4pe2NvbnN0IGk9dC5nZXQocyk7cmV0dXJuIHZvaWQgMCE9PWk/UHJvbWlzZS5yZXNvbHZlKGkpOihhc3luYyhlLHMsbik9PntsZXQgaT1SZShlKTtpZighRShpLHMpKXtjb25zdCB0PXtjaGFubmVsQ291bnQ6aS5jaGFubmVsQ291bnQsY2hhbm5lbENvdW50TW9kZTppLmNoYW5uZWxDb3VudE1vZGUsY2hhbm5lbEludGVycHJldGF0aW9uOmkuY2hhbm5lbEludGVycHJldGF0aW9uLGZmdFNpemU6aS5mZnRTaXplLG1heERlY2liZWxzOmkubWF4RGVjaWJlbHMsbWluRGVjaWJlbHM6aS5taW5EZWNpYmVscyxzbW9vdGhpbmdUaW1lQ29uc3RhbnQ6aS5zbW9vdGhpbmdUaW1lQ29uc3RhbnR9O2k9RWUocyx0KX1yZXR1cm4gdC5zZXQocyxpKSxhd2FpdCBxZShlLHMsaSxuKSxpfSkoZSxzLG4pfX19KTt2YXIgRWUsUmUscWU7Y29uc3QgRmU9KEllPXAsdD0+e2NvbnN0IGU9SWUuZ2V0KHQpO2lmKHZvaWQgMD09PWUpdGhyb3cgQXQoKTtyZXR1cm4gZX0pO3ZhciBJZTtjb25zdCBWZT0odD0+bnVsbD09PXQ/bnVsbDp0Lmhhc093blByb3BlcnR5KFwiT2ZmbGluZUF1ZGlvQ29udGV4dFwiKT90Lk9mZmxpbmVBdWRpb0NvbnRleHQ6dC5oYXNPd25Qcm9wZXJ0eShcIndlYmtpdE9mZmxpbmVBdWRpb0NvbnRleHRcIik/dC53ZWJraXRPZmZsaW5lQXVkaW9Db250ZXh0Om51bGwpKFRlKSxOZT0oUGU9VmUsdD0+bnVsbCE9PVBlJiZ0IGluc3RhbmNlb2YgUGUpO3ZhciBQZTtjb25zdCBqZT1uZXcgV2Vha01hcCxMZT0oemU9ZGUsY2xhc3N7Y29uc3RydWN0b3IodCl7dGhpcy5fbmF0aXZlRXZlbnRUYXJnZXQ9dCx0aGlzLl9saXN0ZW5lcnM9bmV3IFdlYWtNYXB9YWRkRXZlbnRMaXN0ZW5lcih0LGUscyl7aWYobnVsbCE9PWUpe2xldCBuPXRoaXMuX2xpc3RlbmVycy5nZXQoZSk7dm9pZCAwPT09biYmKG49emUodGhpcyxlKSxcImZ1bmN0aW9uXCI9PXR5cGVvZiBlJiZ0aGlzLl9saXN0ZW5lcnMuc2V0KGUsbikpLHRoaXMuX25hdGl2ZUV2ZW50VGFyZ2V0LmFkZEV2ZW50TGlzdGVuZXIodCxuLHMpfX1kaXNwYXRjaEV2ZW50KHQpe3JldHVybiB0aGlzLl9uYXRpdmVFdmVudFRhcmdldC5kaXNwYXRjaEV2ZW50KHQpfXJlbW92ZUV2ZW50TGlzdGVuZXIodCxlLHMpe2NvbnN0IG49bnVsbD09PWU/dm9pZCAwOnRoaXMuX2xpc3RlbmVycy5nZXQoZSk7dGhpcy5fbmF0aXZlRXZlbnRUYXJnZXQucmVtb3ZlRXZlbnRMaXN0ZW5lcih0LHZvaWQgMD09PW4/bnVsbDpuLHMpfX0pO3ZhciB6ZTtjb25zdCBCZT0odD0+bnVsbD09PXQ/bnVsbDp0Lmhhc093blByb3BlcnR5KFwiQXVkaW9Db250ZXh0XCIpP3QuQXVkaW9Db250ZXh0OnQuaGFzT3duUHJvcGVydHkoXCJ3ZWJraXRBdWRpb0NvbnRleHRcIik/dC53ZWJraXRBdWRpb0NvbnRleHQ6bnVsbCkoVGUpLFdlPShHZT1CZSx0PT5udWxsIT09R2UmJnQgaW5zdGFuY2VvZiBHZSk7dmFyIEdlO2NvbnN0IFVlPSh0PT5lPT5udWxsIT09dCYmXCJmdW5jdGlvblwiPT10eXBlb2YgdC5BdWRpb05vZGUmJmUgaW5zdGFuY2VvZiB0LkF1ZGlvTm9kZSkoVGUpLFFlPSh0PT5lPT5udWxsIT09dCYmXCJmdW5jdGlvblwiPT10eXBlb2YgdC5BdWRpb1BhcmFtJiZlIGluc3RhbmNlb2YgdC5BdWRpb1BhcmFtKShUZSksWmU9KCh0LGUscyxuLGksbyxyLGEsYyx1LGwscCxmLF8sbSk9PmNsYXNzIGV4dGVuZHMgdXtjb25zdHJ1Y3RvcihlLG4saSxvKXtzdXBlcihpKSx0aGlzLl9jb250ZXh0PWUsdGhpcy5fbmF0aXZlQXVkaW9Ob2RlPWk7Y29uc3Qgcj1sKGUpO3AocikmJiEwIT09cyhydCwoKT0+cnQocikpJiYodD0+e2NvbnN0IGU9bmV3IE1hcDt2YXIgcyxuO3QuY29ubmVjdD0ocz10LmNvbm5lY3QuYmluZCh0KSwodCxuPTAsaT0wKT0+e2NvbnN0IG89Y3QodCk/cyh0LG4saSk6cyh0LG4pLHI9ZS5nZXQodCk7cmV0dXJuIHZvaWQgMD09PXI/ZS5zZXQodCxbe2lucHV0Omksb3V0cHV0Om59XSk6ci5ldmVyeSh0PT50LmlucHV0IT09aXx8dC5vdXRwdXQhPT1uKSYmci5wdXNoKHtpbnB1dDppLG91dHB1dDpufSksb30pLHQuZGlzY29ubmVjdD0obj10LmRpc2Nvbm5lY3QsKHMsaSxvKT0+e2lmKG4uYXBwbHkodCksdm9pZCAwPT09cyllLmNsZWFyKCk7ZWxzZSBpZihcIm51bWJlclwiPT10eXBlb2Ygcylmb3IoY29uc3RbdCxuXW9mIGUpe2NvbnN0IGk9bi5maWx0ZXIodD0+dC5vdXRwdXQhPT1zKTswPT09aS5sZW5ndGg/ZS5kZWxldGUodCk6ZS5zZXQodCxpKX1lbHNlIGlmKGUuaGFzKHMpKWlmKHZvaWQgMD09PWkpZS5kZWxldGUocyk7ZWxzZXtjb25zdCB0PWUuZ2V0KHMpO2lmKHZvaWQgMCE9PXQpe2NvbnN0IG49dC5maWx0ZXIodD0+dC5vdXRwdXQhPT1pJiYodC5pbnB1dCE9PW98fHZvaWQgMD09PW8pKTswPT09bi5sZW5ndGg/ZS5kZWxldGUocyk6ZS5zZXQocyxuKX19Zm9yKGNvbnN0W3Msbl1vZiBlKW4uZm9yRWFjaChlPT57Y3Qocyk/dC5jb25uZWN0KHMsZS5vdXRwdXQsZS5pbnB1dCk6dC5jb25uZWN0KHMsZS5vdXRwdXQpfSl9KX0pKGkpLGguc2V0KHRoaXMsaSksZC5zZXQodGhpcyxuZXcgU2V0KSxcImNsb3NlZFwiIT09ZS5zdGF0ZSYmbiYmQyh0aGlzKSx0KHRoaXMsbyxpKX1nZXQgY2hhbm5lbENvdW50KCl7cmV0dXJuIHRoaXMuX25hdGl2ZUF1ZGlvTm9kZS5jaGFubmVsQ291bnR9c2V0IGNoYW5uZWxDb3VudCh0KXt0aGlzLl9uYXRpdmVBdWRpb05vZGUuY2hhbm5lbENvdW50PXR9Z2V0IGNoYW5uZWxDb3VudE1vZGUoKXtyZXR1cm4gdGhpcy5fbmF0aXZlQXVkaW9Ob2RlLmNoYW5uZWxDb3VudE1vZGV9c2V0IGNoYW5uZWxDb3VudE1vZGUodCl7dGhpcy5fbmF0aXZlQXVkaW9Ob2RlLmNoYW5uZWxDb3VudE1vZGU9dH1nZXQgY2hhbm5lbEludGVycHJldGF0aW9uKCl7cmV0dXJuIHRoaXMuX25hdGl2ZUF1ZGlvTm9kZS5jaGFubmVsSW50ZXJwcmV0YXRpb259c2V0IGNoYW5uZWxJbnRlcnByZXRhdGlvbih0KXt0aGlzLl9uYXRpdmVBdWRpb05vZGUuY2hhbm5lbEludGVycHJldGF0aW9uPXR9Z2V0IGNvbnRleHQoKXtyZXR1cm4gdGhpcy5fY29udGV4dH1nZXQgbnVtYmVyT2ZJbnB1dHMoKXtyZXR1cm4gdGhpcy5fbmF0aXZlQXVkaW9Ob2RlLm51bWJlck9mSW5wdXRzfWdldCBudW1iZXJPZk91dHB1dHMoKXtyZXR1cm4gdGhpcy5fbmF0aXZlQXVkaW9Ob2RlLm51bWJlck9mT3V0cHV0c31jb25uZWN0KHQscz0wLGE9MCl7aWYoczwwfHxzPj10aGlzLl9uYXRpdmVBdWRpb05vZGUubnVtYmVyT2ZPdXRwdXRzKXRocm93IGkoKTtjb25zdCBoPWwodGhpcy5fY29udGV4dCksdT1tKGgpO2lmKGYodCl8fF8odCkpdGhyb3cgbygpO2lmKFUodCkpe2NvbnN0IGk9c3QodCk7dHJ5e2NvbnN0IGU9JCh0aGlzLl9uYXRpdmVBdWRpb05vZGUsaSxzLGEpLG49b3QodGhpcyk7KHV8fG4pJiZ0aGlzLl9uYXRpdmVBdWRpb05vZGUuZGlzY29ubmVjdCguLi5lKSxcImNsb3NlZFwiIT09dGhpcy5jb250ZXh0LnN0YXRlJiYhbiYmb3QodCkmJkModCl9Y2F0Y2godCl7aWYoMTI9PT10LmNvZGUpdGhyb3cgbygpO3Rocm93IHR9aWYoZSh0aGlzLHQscyxhLHUpKXtjb25zdCBlPWMoW3RoaXNdLHQpO2F0KGUsbih1KSl9cmV0dXJuIHR9Y29uc3QgcD1udCh0KTtpZihcInBsYXliYWNrUmF0ZVwiPT09cC5uYW1lKXRocm93IHIoKTt0cnl7dGhpcy5fbmF0aXZlQXVkaW9Ob2RlLmNvbm5lY3QocCxzKSwodXx8b3QodGhpcykpJiZ0aGlzLl9uYXRpdmVBdWRpb05vZGUuZGlzY29ubmVjdChwLHMpfWNhdGNoKHQpe2lmKDEyPT09dC5jb2RlKXRocm93IG8oKTt0aHJvdyB0fWlmKGh0KHRoaXMsdCxzLHUpKXtjb25zdCBlPWMoW3RoaXNdLHQpO2F0KGUsbih1KSl9fWRpc2Nvbm5lY3QodCxlLHMpe2xldCBuO2NvbnN0IHI9bCh0aGlzLl9jb250ZXh0KSxoPW0ocik7aWYodm9pZCAwPT09dCluPSgodCxlKT0+e2NvbnN0IHM9TCh0KSxuPVtdO2Zvcihjb25zdCBpIG9mIHMub3V0cHV0cylRKGkpP3V0KHQsZSwuLi5pKTpsdCh0LGUsLi4uaSksbi5wdXNoKGlbMF0pO3JldHVybiBzLm91dHB1dHMuY2xlYXIoKSxufSkodGhpcyxoKTtlbHNlIGlmKFwibnVtYmVyXCI9PXR5cGVvZiB0KXtpZih0PDB8fHQ+PXRoaXMubnVtYmVyT2ZPdXRwdXRzKXRocm93IGkoKTtuPSgodCxlLHMpPT57Y29uc3Qgbj1MKHQpLGk9W107Zm9yKGNvbnN0IG8gb2Ygbi5vdXRwdXRzKW9bMV09PT1zJiYoUShvKT91dCh0LGUsLi4ubyk6bHQodCxlLC4uLm8pLGkucHVzaChvWzBdKSxuLm91dHB1dHMuZGVsZXRlKG8pKTtyZXR1cm4gaX0pKHRoaXMsaCx0KX1lbHNle2lmKHZvaWQgMCE9PWUmJihlPDB8fGU+PXRoaXMubnVtYmVyT2ZPdXRwdXRzKSl0aHJvdyBpKCk7aWYoVSh0KSYmdm9pZCAwIT09cyYmKHM8MHx8cz49dC5udW1iZXJPZklucHV0cykpdGhyb3cgaSgpO2lmKG49KCh0LGUscyxuLGkpPT57Y29uc3Qgbz1MKHQpO3JldHVybiBBcnJheS5mcm9tKG8ub3V0cHV0cykuZmlsdGVyKHQ9PiEodFswXSE9PXN8fHZvaWQgMCE9PW4mJnRbMV0hPT1ufHx2b2lkIDAhPT1pJiZ0WzJdIT09aSkpLm1hcChzPT4oUShzKT91dCh0LGUsLi4ucyk6bHQodCxlLC4uLnMpLG8ub3V0cHV0cy5kZWxldGUocyksc1swXSkpfSkodGhpcyxoLHQsZSxzKSwwPT09bi5sZW5ndGgpdGhyb3cgbygpfWZvcihjb25zdCB0IG9mIG4pe2NvbnN0IGU9YyhbdGhpc10sdCk7YXQoZSxhKX19fSkoKFhlPWMsKHQsZSxzKT0+e2NvbnN0IG49W107Zm9yKGxldCB0PTA7dDxzLm51bWJlck9mSW5wdXRzO3QrPTEpbi5wdXNoKG5ldyBTZXQpO1hlLnNldCh0LHthY3RpdmVJbnB1dHM6bixvdXRwdXRzOm5ldyBTZXQscGFzc2l2ZUlucHV0czpuZXcgV2Vha01hcCxyZW5kZXJlcjplfSl9KSwoKHQsZSxzLG4saSxvLHIsYSxjLGgsdSxsLHApPT4oZCxmLF8sbSxnKT0+e2NvbnN0e2FjdGl2ZUlucHV0czp2LHBhc3NpdmVJbnB1dHM6eX09byhmKSx7b3V0cHV0czp4fT1vKGQpLHc9YShkKSxiPW89Pntjb25zdCBhPWMoZiksaD1jKGQpO2lmKG8pe2NvbnN0IGU9Uyh5LGQsXyxtKTt0KHYsZCxlLCExKSxnfHxsKGQpfHxzKGgsYSxfLG0pLHAoZikmJkMoZil9ZWxzZXtjb25zdCB0PW4odixkLF8sbSk7ZSh5LG0sdCwhMSksZ3x8bChkKXx8aShoLGEsXyxtKTtjb25zdCBzPXIoZik7MD09PXM/dShmKSYmTyhmLHYpOnNldFRpbWVvdXQoKCk9Pnt1KGYpJiZPKGYsdil9LDFlMypzKX19O3JldHVybiEhaCh4LFtmLF8sbV0sdD0+dFswXT09PWYmJnRbMV09PT1fJiZ0WzJdPT09bSwhMCkmJih3LmFkZChiKSx1KGQpP3QodixkLFtfLG0sYl0sITApOmUoeSxtLFtkLF8sYl0sITApLCEwKX0pKGZlLG1lLCQsZ2UsZXQsTCx5ZSxrLHN0LFosUCxpdCxvdCkseGUsKCh0LGUscyxuLGksbyk9PnI9PihhLGMpPT57Y29uc3QgaD10LmdldChhKTtpZih2b2lkIDA9PT1oKXtpZighciYmbyhhKSl7Y29uc3QgdD1uKGEpLHtvdXRwdXRzOm99PXMoYSk7Zm9yKGNvbnN0IHMgb2YgbylpZihRKHMpKXtjb25zdCBpPW4oc1swXSk7ZSh0LGksc1sxXSxzWzJdKX1lbHNle2NvbnN0IGU9aShzWzBdKTt0LmRpc2Nvbm5lY3QoZSxzWzFdKX19dC5zZXQoYSxjKX1lbHNlIHQuc2V0KGEsaCtjKX0pKGYsZXQsTCxzdCxudCxQKSxxLER0LEh0LCgodCxlLHMsbixpLG8scixhKT0+KGMsaCk9Pntjb25zdCB1PWUuZ2V0KGMpO2lmKHZvaWQgMD09PXUpdGhyb3cgbmV3IEVycm9yKFwiTWlzc2luZyB0aGUgZXhwZWN0ZWQgY3ljbGUgY291bnQuXCIpO2NvbnN0IGw9byhjLmNvbnRleHQpLHA9YShsKTtpZih1PT09aCl7aWYoZS5kZWxldGUoYyksIXAmJnIoYykpe2NvbnN0IGU9bihjKSx7b3V0cHV0czpvfT1zKGMpO2Zvcihjb25zdCBzIG9mIG8paWYoUShzKSl7Y29uc3QgaT1uKHNbMF0pO3QoZSxpLHNbMV0sc1syXSl9ZWxzZXtjb25zdCB0PWkoc1swXSk7ZS5jb25uZWN0KHQsc1sxXSl9fX1lbHNlIGUuc2V0KGMsdS1oKX0pKCQsZixMLHN0LG50LEZlLFAsTmUpLCgodCxlLHMpPT5mdW5jdGlvbiBuKGksbyl7Y29uc3Qgcj1VKG8pP286cyh0LG8pO2lmKCh0PT5cImRlbGF5VGltZVwiaW4gdCkocikpcmV0dXJuW107aWYoaVswXT09PXIpcmV0dXJuW2ldO2lmKGkuaW5jbHVkZXMocikpcmV0dXJuW107Y29uc3R7b3V0cHV0czphfT1lKHIpO3JldHVybiBBcnJheS5mcm9tKGEpLm1hcCh0PT5uKFsuLi5pLHJdLHRbMF0pKS5yZWR1Y2UoKHQsZSk9PnQuY29uY2F0KGUpLFtdKX0pKGplLEwsYiksTGUsRmUsV2UsVWUsUWUsTmUpO3ZhciBYZTtjb25zdCBZZT0oKHQsZSxzLG4saSxvKT0+Y2xhc3MgZXh0ZW5kcyB0e2NvbnN0cnVjdG9yKHQscyl7Y29uc3Qgcj1pKHQpLGE9ey4uLk0sLi4uc30sYz1uKHIsYSk7c3VwZXIodCwhMSxjLG8ocik/ZSgpOm51bGwpLHRoaXMuX25hdGl2ZUFuYWx5c2VyTm9kZT1jfWdldCBmZnRTaXplKCl7cmV0dXJuIHRoaXMuX25hdGl2ZUFuYWx5c2VyTm9kZS5mZnRTaXplfXNldCBmZnRTaXplKHQpe3RoaXMuX25hdGl2ZUFuYWx5c2VyTm9kZS5mZnRTaXplPXR9Z2V0IGZyZXF1ZW5jeUJpbkNvdW50KCl7cmV0dXJuIHRoaXMuX25hdGl2ZUFuYWx5c2VyTm9kZS5mcmVxdWVuY3lCaW5Db3VudH1nZXQgbWF4RGVjaWJlbHMoKXtyZXR1cm4gdGhpcy5fbmF0aXZlQW5hbHlzZXJOb2RlLm1heERlY2liZWxzfXNldCBtYXhEZWNpYmVscyh0KXtjb25zdCBlPXRoaXMuX25hdGl2ZUFuYWx5c2VyTm9kZS5tYXhEZWNpYmVscztpZih0aGlzLl9uYXRpdmVBbmFseXNlck5vZGUubWF4RGVjaWJlbHM9dCwhKHQ+dGhpcy5fbmF0aXZlQW5hbHlzZXJOb2RlLm1pbkRlY2liZWxzKSl0aHJvdyB0aGlzLl9uYXRpdmVBbmFseXNlck5vZGUubWF4RGVjaWJlbHM9ZSxzKCl9Z2V0IG1pbkRlY2liZWxzKCl7cmV0dXJuIHRoaXMuX25hdGl2ZUFuYWx5c2VyTm9kZS5taW5EZWNpYmVsc31zZXQgbWluRGVjaWJlbHModCl7Y29uc3QgZT10aGlzLl9uYXRpdmVBbmFseXNlck5vZGUubWluRGVjaWJlbHM7aWYodGhpcy5fbmF0aXZlQW5hbHlzZXJOb2RlLm1pbkRlY2liZWxzPXQsISh0aGlzLl9uYXRpdmVBbmFseXNlck5vZGUubWF4RGVjaWJlbHM+dCkpdGhyb3cgdGhpcy5fbmF0aXZlQW5hbHlzZXJOb2RlLm1pbkRlY2liZWxzPWUscygpfWdldCBzbW9vdGhpbmdUaW1lQ29uc3RhbnQoKXtyZXR1cm4gdGhpcy5fbmF0aXZlQW5hbHlzZXJOb2RlLnNtb290aGluZ1RpbWVDb25zdGFudH1zZXQgc21vb3RoaW5nVGltZUNvbnN0YW50KHQpe3RoaXMuX25hdGl2ZUFuYWx5c2VyTm9kZS5zbW9vdGhpbmdUaW1lQ29uc3RhbnQ9dH1nZXRCeXRlRnJlcXVlbmN5RGF0YSh0KXt0aGlzLl9uYXRpdmVBbmFseXNlck5vZGUuZ2V0Qnl0ZUZyZXF1ZW5jeURhdGEodCl9Z2V0Qnl0ZVRpbWVEb21haW5EYXRhKHQpe3RoaXMuX25hdGl2ZUFuYWx5c2VyTm9kZS5nZXRCeXRlVGltZURvbWFpbkRhdGEodCl9Z2V0RmxvYXRGcmVxdWVuY3lEYXRhKHQpe3RoaXMuX25hdGl2ZUFuYWx5c2VyTm9kZS5nZXRGbG9hdEZyZXF1ZW5jeURhdGEodCl9Z2V0RmxvYXRUaW1lRG9tYWluRGF0YSh0KXt0aGlzLl9uYXRpdmVBbmFseXNlck5vZGUuZ2V0RmxvYXRUaW1lRG9tYWluRGF0YSh0KX19KShaZSxNZSxxLFNlLEZlLE5lKSxIZT1uZXcgV2Vha1NldCwkZT0odD0+bnVsbD09PXQ/bnVsbDp0Lmhhc093blByb3BlcnR5KFwiQXVkaW9CdWZmZXJcIik/dC5BdWRpb0J1ZmZlcjpudWxsKShUZSksSmU9KEtlPW5ldyBVaW50MzJBcnJheSgxKSx0PT4oS2VbMF09dCxLZVswXSkpO3ZhciBLZTtjb25zdCB0cz0oKHQsZSk9PnM9PntzLmNvcHlGcm9tQ2hhbm5lbD0obixpLG89MCk9Pntjb25zdCByPXQobyksYT10KGkpO2lmKGE+PXMubnVtYmVyT2ZDaGFubmVscyl0aHJvdyBlKCk7Y29uc3QgYz1zLmxlbmd0aCxoPXMuZ2V0Q2hhbm5lbERhdGEoYSksdT1uLmxlbmd0aDtmb3IobGV0IHQ9cjwwPy1yOjA7dCtyPGMmJnQ8dTt0Kz0xKW5bdF09aFt0K3JdfSxzLmNvcHlUb0NoYW5uZWw9KG4saSxvPTApPT57Y29uc3Qgcj10KG8pLGE9dChpKTtpZihhPj1zLm51bWJlck9mQ2hhbm5lbHMpdGhyb3cgZSgpO2NvbnN0IGM9cy5sZW5ndGgsaD1zLmdldENoYW5uZWxEYXRhKGEpLHU9bi5sZW5ndGg7Zm9yKGxldCB0PXI8MD8tcjowO3QrcjxjJiZ0PHU7dCs9MSloW3Qrcl09blt0XX19KShKZSxxKSxlcz0odD0+ZT0+e2UuY29weUZyb21DaGFubmVsPShzPT4obixpLG89MCk9Pntjb25zdCByPXQobyksYT10KGkpO2lmKHI8ZS5sZW5ndGgpcmV0dXJuIHMuY2FsbChlLG4sYSxyKX0pKGUuY29weUZyb21DaGFubmVsKSxlLmNvcHlUb0NoYW5uZWw9KHM9PihuLGksbz0wKT0+e2NvbnN0IHI9dChvKSxhPXQoaSk7aWYocjxlLmxlbmd0aClyZXR1cm4gcy5jYWxsKGUsbixhLHIpfSkoZS5jb3B5VG9DaGFubmVsKX0pKEplKSxzcz0oKHQsZSxzLG4saSxvLHIsYSk9PntsZXQgYz1udWxsO3JldHVybiBjbGFzcyBoe2NvbnN0cnVjdG9yKGgpe2lmKG51bGw9PT1pKXRocm93IG5ldyBFcnJvcihcIk1pc3NpbmcgdGhlIG5hdGl2ZSBPZmZsaW5lQXVkaW9Db250ZXh0IGNvbnN0cnVjdG9yLlwiKTtjb25zdHtsZW5ndGg6dSxudW1iZXJPZkNoYW5uZWxzOmwsc2FtcGxlUmF0ZTpwfT17Li4uSSwuLi5ofTtudWxsPT09YyYmKGM9bmV3IGkoMSwxLDQ0MTAwKSk7Y29uc3QgZD1udWxsIT09biYmZShvLG8pP25ldyBuKHtsZW5ndGg6dSxudW1iZXJPZkNoYW5uZWxzOmwsc2FtcGxlUmF0ZTpwfSk6Yy5jcmVhdGVCdWZmZXIobCx1LHApO2lmKDA9PT1kLm51bWJlck9mQ2hhbm5lbHMpdGhyb3cgcygpO3JldHVyblwiZnVuY3Rpb25cIiE9dHlwZW9mIGQuY29weUZyb21DaGFubmVsPyhyKGQpLEYoZCkpOmUoUiwoKT0+UihkKSl8fGEoZCksdC5hZGQoZCksZH1zdGF0aWNbU3ltYm9sLmhhc0luc3RhbmNlXShlKXtyZXR1cm4gbnVsbCE9PWUmJlwib2JqZWN0XCI9PXR5cGVvZiBlJiZPYmplY3QuZ2V0UHJvdG90eXBlT2YoZSk9PT1oLnByb3RvdHlwZXx8dC5oYXMoZSl9fX0pKEhlLHhlLEh0LCRlLFZlLChucz0kZSwoKT0+e2lmKG51bGw9PT1ucylyZXR1cm4hMTt0cnl7bmV3IG5zKHtsZW5ndGg6MSxzYW1wbGVSYXRlOjQ0MTAwfSl9Y2F0Y2h7cmV0dXJuITF9cmV0dXJuITB9KSx0cyxlcyk7dmFyIG5zO2NvbnN0IGlzPShvcz1RdCwodCxlKT0+e2NvbnN0IHM9b3ModCx7Y2hhbm5lbENvdW50OjEsY2hhbm5lbENvdW50TW9kZTpcImV4cGxpY2l0XCIsY2hhbm5lbEludGVycHJldGF0aW9uOlwiZGlzY3JldGVcIixnYWluOjB9KTtlLmNvbm5lY3QocykuY29ubmVjdCh0LmRlc3RpbmF0aW9uKTtjb25zdCBuPSgpPT57ZS5yZW1vdmVFdmVudExpc3RlbmVyKFwiZW5kZWRcIixuKSxlLmRpc2Nvbm5lY3Qocykscy5kaXNjb25uZWN0KCl9O2UuYWRkRXZlbnRMaXN0ZW5lcihcImVuZGVkXCIsbil9KTt2YXIgb3M7Y29uc3QgcnM9KCh0LGUscyk9PmFzeW5jKG4saSxvLHIpPT57Y29uc3QgYT1lKG4pO2F3YWl0IFByb21pc2UuYWxsKEFycmF5LmZyb20oYS5hY3RpdmVJbnB1dHMpLm1hcChhc3luYyhbZSxuXSk9Pntjb25zdCBhPXQoZSksYz1hd2FpdCBhLnJlbmRlcihlLGkscik7cyhlKXx8Yy5jb25uZWN0KG8sbil9KSl9KShBZSx6LGl0KSxhcz0odD0+KGUscyxuLGkpPT50KHMsZSxuLGkpKShycyksY3M9KCh0LGUscyxuLGksbyxyLGEsYyxoLHUpPT4obCxwKT0+e2NvbnN0IGQ9bC5jcmVhdGVCdWZmZXJTb3VyY2UoKTtyZXR1cm4gSXQoZCxwKSxOdChkLHAsXCJwbGF5YmFja1JhdGVcIiksRnQoZCxwLFwiYnVmZmVyXCIpLEZ0KGQscCxcImxvb3BcIiksRnQoZCxwLFwibG9vcEVuZFwiKSxGdChkLHAsXCJsb29wU3RhcnRcIiksZShzLCgpPT5zKGwpKXx8KHQ9Pnt0LnN0YXJ0PShlPT57bGV0IHM9ITE7cmV0dXJuKG49MCxpPTAsbyk9PntpZihzKXRocm93IEF0KCk7ZS5jYWxsKHQsbixpLG8pLHM9ITB9fSkodC5zdGFydCl9KShkKSxlKG4sKCk9Pm4obCkpfHxjKGQpLGUoaSwoKT0+aShsKSl8fGgoZCxsKSxlKG8sKCk9Pm8obCkpfHxQdChkKSxlKHIsKCk9PnIobCkpfHx1KGQsbCksZShhLCgpPT5hKGwpKXx8anQoZCksdChsLGQpLGR9KShpcyx4ZSx0PT57Y29uc3QgZT10LmNyZWF0ZUJ1ZmZlclNvdXJjZSgpO2Uuc3RhcnQoKTt0cnl7ZS5zdGFydCgpfWNhdGNoe3JldHVybiEwfXJldHVybiExfSx0PT57Y29uc3QgZT10LmNyZWF0ZUJ1ZmZlclNvdXJjZSgpLHM9dC5jcmVhdGVCdWZmZXIoMSwxLDQ0MTAwKTtlLmJ1ZmZlcj1zO3RyeXtlLnN0YXJ0KDAsMSl9Y2F0Y2h7cmV0dXJuITF9cmV0dXJuITB9LHQ9Pntjb25zdCBlPXQuY3JlYXRlQnVmZmVyU291cmNlKCk7ZS5zdGFydCgpO3RyeXtlLnN0b3AoKX1jYXRjaHtyZXR1cm4hMX1yZXR1cm4hMH0sYWUsY2UsaGUsdD0+e3ZhciBlO3Quc3RhcnQ9KGU9dC5zdGFydCwocz0wLG49MCxpKT0+e2NvbnN0IG89dC5idWZmZXIscj1udWxsPT09bz9uOk1hdGgubWluKG8uZHVyYXRpb24sbik7bnVsbCE9PW8mJnI+by5kdXJhdGlvbi0uNS90LmNvbnRleHQuc2FtcGxlUmF0ZT9lLmNhbGwodCxzLDAsMCk6ZS5jYWxsKHQscyxyLGkpfSl9LChocz1vZSwodCxlKT0+e2NvbnN0IHM9ZS5jcmVhdGVCdWZmZXIoMSwxLDQ0MTAwKTtudWxsPT09dC5idWZmZXImJih0LmJ1ZmZlcj1zKSxocyh0LFwiYnVmZmVyXCIsZT0+KCk9Pntjb25zdCBuPWUuY2FsbCh0KTtyZXR1cm4gbj09PXM/bnVsbDpufSxlPT5uPT5lLmNhbGwodCxudWxsPT09bj9zOm4pKX0pLHBlKTt2YXIgaHM7Y29uc3QgdXM9KCh0LGUpPT4ocyxuLGksbyk9Pih0KG4pLnJlcGxheShpKSxlKG4scyxpLG8pKSkoKHQ9PmU9Pntjb25zdCBzPXQoZSk7aWYobnVsbD09PXMucmVuZGVyZXIpdGhyb3cgbmV3IEVycm9yKFwiTWlzc2luZyB0aGUgcmVuZGVyZXIgb2YgdGhlIGdpdmVuIEF1ZGlvUGFyYW0gaW4gdGhlIGF1ZGlvIGdyYXBoLlwiKTtyZXR1cm4gcy5yZW5kZXJlcn0pKHopLHJzKSxscz0oKHQsZSxzLG4saSk9PigpPT57Y29uc3Qgbz1uZXcgV2Vha01hcDtsZXQgcj1udWxsLGE9bnVsbDtyZXR1cm57c2V0IHN0YXJ0KHQpe3I9dH0sc2V0IHN0b3AodCl7YT10fSxyZW5kZXIoYyxoLHUpe2NvbnN0IGw9by5nZXQoaCk7cmV0dXJuIHZvaWQgMCE9PWw/UHJvbWlzZS5yZXNvbHZlKGwpOihhc3luYyhjLGgsdSk9PntsZXQgbD1zKGMpO2NvbnN0IHA9RShsLGgpO2lmKCFwKXtjb25zdCB0PXtidWZmZXI6bC5idWZmZXIsY2hhbm5lbENvdW50OmwuY2hhbm5lbENvdW50LGNoYW5uZWxDb3VudE1vZGU6bC5jaGFubmVsQ291bnRNb2RlLGNoYW5uZWxJbnRlcnByZXRhdGlvbjpsLmNoYW5uZWxJbnRlcnByZXRhdGlvbixsb29wOmwubG9vcCxsb29wRW5kOmwubG9vcEVuZCxsb29wU3RhcnQ6bC5sb29wU3RhcnQscGxheWJhY2tSYXRlOmwucGxheWJhY2tSYXRlLnZhbHVlfTtsPWUoaCx0KSxudWxsIT09ciYmbC5zdGFydCguLi5yKSxudWxsIT09YSYmbC5zdG9wKGEpfXJldHVybiBvLnNldChoLGwpLHA/YXdhaXQgdChoLGMucGxheWJhY2tSYXRlLGwucGxheWJhY2tSYXRlLHUpOmF3YWl0IG4oaCxjLnBsYXliYWNrUmF0ZSxsLnBsYXliYWNrUmF0ZSx1KSxhd2FpdCBpKGMsaCxsLHUpLGx9KShjLGgsdSl9fX0pKGFzLGNzLHN0LHVzLE9lKSxwcz0oKHQsZSxzLG4saSxvLGEsYyxoLHUsbCxwLGQpPT4oZixfLG0sZz1udWxsLHY9bnVsbCk9Pntjb25zdCB5PW5ldyByLkF1dG9tYXRpb25FdmVudExpc3QobS5kZWZhdWx0VmFsdWUpLHg9Xz9uKHkpOm51bGwsdz17Z2V0IGRlZmF1bHRWYWx1ZSgpe3JldHVybiBtLmRlZmF1bHRWYWx1ZX0sZ2V0IG1heFZhbHVlKCl7cmV0dXJuIG51bGw9PT1nP20ubWF4VmFsdWU6Z30sZ2V0IG1pblZhbHVlKCl7cmV0dXJuIG51bGw9PT12P20ubWluVmFsdWU6dn0sZ2V0IHZhbHVlKCl7cmV0dXJuIG0udmFsdWV9LHNldCB2YWx1ZSh0KXttLnZhbHVlPXQsdy5zZXRWYWx1ZUF0VGltZSh0LGYuY29udGV4dC5jdXJyZW50VGltZSl9LGNhbmNlbEFuZEhvbGRBdFRpbWUodCl7aWYoXCJmdW5jdGlvblwiPT10eXBlb2YgbS5jYW5jZWxBbmRIb2xkQXRUaW1lKW51bGw9PT14JiZ5LmZsdXNoKGYuY29udGV4dC5jdXJyZW50VGltZSkseS5hZGQoaSh0KSksbS5jYW5jZWxBbmRIb2xkQXRUaW1lKHQpO2Vsc2V7Y29uc3QgZT1BcnJheS5mcm9tKHkpLnBvcCgpO251bGw9PT14JiZ5LmZsdXNoKGYuY29udGV4dC5jdXJyZW50VGltZSkseS5hZGQoaSh0KSk7Y29uc3Qgcz1BcnJheS5mcm9tKHkpLnBvcCgpO20uY2FuY2VsU2NoZWR1bGVkVmFsdWVzKHQpLGUhPT1zJiZ2b2lkIDAhPT1zJiYoXCJleHBvbmVudGlhbFJhbXBUb1ZhbHVlXCI9PT1zLnR5cGU/bS5leHBvbmVudGlhbFJhbXBUb1ZhbHVlQXRUaW1lKHMudmFsdWUscy5lbmRUaW1lKTpcImxpbmVhclJhbXBUb1ZhbHVlXCI9PT1zLnR5cGU/bS5saW5lYXJSYW1wVG9WYWx1ZUF0VGltZShzLnZhbHVlLHMuZW5kVGltZSk6XCJzZXRWYWx1ZVwiPT09cy50eXBlP20uc2V0VmFsdWVBdFRpbWUocy52YWx1ZSxzLnN0YXJ0VGltZSk6XCJzZXRWYWx1ZUN1cnZlXCI9PT1zLnR5cGUmJm0uc2V0VmFsdWVDdXJ2ZUF0VGltZShzLnZhbHVlcyxzLnN0YXJ0VGltZSxzLmR1cmF0aW9uKSl9cmV0dXJuIHd9LGNhbmNlbFNjaGVkdWxlZFZhbHVlczp0PT4obnVsbD09PXgmJnkuZmx1c2goZi5jb250ZXh0LmN1cnJlbnRUaW1lKSx5LmFkZChvKHQpKSxtLmNhbmNlbFNjaGVkdWxlZFZhbHVlcyh0KSx3KSxleHBvbmVudGlhbFJhbXBUb1ZhbHVlQXRUaW1lKHQsZSl7aWYoMD09PXQpdGhyb3cgbmV3IFJhbmdlRXJyb3I7aWYoIU51bWJlci5pc0Zpbml0ZShlKXx8ZTwwKXRocm93IG5ldyBSYW5nZUVycm9yO3JldHVybiBudWxsPT09eCYmeS5mbHVzaChmLmNvbnRleHQuY3VycmVudFRpbWUpLHkuYWRkKGEodCxlKSksbS5leHBvbmVudGlhbFJhbXBUb1ZhbHVlQXRUaW1lKHQsZSksd30sbGluZWFyUmFtcFRvVmFsdWVBdFRpbWU6KHQsZSk9PihudWxsPT09eCYmeS5mbHVzaChmLmNvbnRleHQuY3VycmVudFRpbWUpLHkuYWRkKGModCxlKSksbS5saW5lYXJSYW1wVG9WYWx1ZUF0VGltZSh0LGUpLHcpLHNldFRhcmdldEF0VGltZToodCxlLHMpPT4obnVsbD09PXgmJnkuZmx1c2goZi5jb250ZXh0LmN1cnJlbnRUaW1lKSx5LmFkZChoKHQsZSxzKSksbS5zZXRUYXJnZXRBdFRpbWUodCxlLHMpLHcpLHNldFZhbHVlQXRUaW1lOih0LGUpPT4obnVsbD09PXgmJnkuZmx1c2goZi5jb250ZXh0LmN1cnJlbnRUaW1lKSx5LmFkZCh1KHQsZSkpLG0uc2V0VmFsdWVBdFRpbWUodCxlKSx3KSxzZXRWYWx1ZUN1cnZlQXRUaW1lKHQsZSxzKXtjb25zdCBuPXQgaW5zdGFuY2VvZiBGbG9hdDMyQXJyYXk/dDpuZXcgRmxvYXQzMkFycmF5KHQpO2lmKG51bGwhPT1wJiZcIndlYmtpdEF1ZGlvQ29udGV4dFwiPT09cC5uYW1lKXtjb25zdCB0PWUrcyxpPWYuY29udGV4dC5zYW1wbGVSYXRlLG89TWF0aC5jZWlsKGUqaSkscj1NYXRoLmZsb29yKHQqaSksYT1yLW8sYz1uZXcgRmxvYXQzMkFycmF5KGEpO2ZvcihsZXQgdD0wO3Q8YTt0Kz0xKXtjb25zdCByPShuLmxlbmd0aC0xKS9zKigobyt0KS9pLWUpLGE9TWF0aC5mbG9vcihyKSxoPU1hdGguY2VpbChyKTtjW3RdPWE9PT1oP25bYV06KDEtKHItYSkpKm5bYV0rKDEtKGgtcikpKm5baF19bnVsbD09PXgmJnkuZmx1c2goZi5jb250ZXh0LmN1cnJlbnRUaW1lKSx5LmFkZChsKGMsZSxzKSksbS5zZXRWYWx1ZUN1cnZlQXRUaW1lKGMsZSxzKTtjb25zdCBoPXIvaTtoPHQmJmQodyxjW2MubGVuZ3RoLTFdLGgpLGQodyxuW24ubGVuZ3RoLTFdLHQpfWVsc2UgbnVsbD09PXgmJnkuZmx1c2goZi5jb250ZXh0LmN1cnJlbnRUaW1lKSx5LmFkZChsKG4sZSxzKSksbS5zZXRWYWx1ZUN1cnZlQXRUaW1lKG4sZSxzKTtyZXR1cm4gd319O3JldHVybiBzLnNldCh3LG0pLGUuc2V0KHcsZiksdCh3LHgpLHd9KSgoZHM9dSwodCxlKT0+e2RzLnNldCh0LHthY3RpdmVJbnB1dHM6bmV3IFNldCxwYXNzaXZlSW5wdXRzOm5ldyBXZWFrTWFwLHJlbmRlcmVyOmV9KX0pLGplLGwsdD0+KHtyZXBsYXkoZSl7Zm9yKGNvbnN0IHMgb2YgdClpZihcImV4cG9uZW50aWFsUmFtcFRvVmFsdWVcIj09PXMudHlwZSl7Y29uc3R7ZW5kVGltZTp0LHZhbHVlOm59PXM7ZS5leHBvbmVudGlhbFJhbXBUb1ZhbHVlQXRUaW1lKG4sdCl9ZWxzZSBpZihcImxpbmVhclJhbXBUb1ZhbHVlXCI9PT1zLnR5cGUpe2NvbnN0e2VuZFRpbWU6dCx2YWx1ZTpufT1zO2UubGluZWFyUmFtcFRvVmFsdWVBdFRpbWUobix0KX1lbHNlIGlmKFwic2V0VGFyZ2V0XCI9PT1zLnR5cGUpe2NvbnN0e3N0YXJ0VGltZTp0LHRhcmdldDpuLHRpbWVDb25zdGFudDppfT1zO2Uuc2V0VGFyZ2V0QXRUaW1lKG4sdCxpKX1lbHNlIGlmKFwic2V0VmFsdWVcIj09PXMudHlwZSl7Y29uc3R7c3RhcnRUaW1lOnQsdmFsdWU6bn09cztlLnNldFZhbHVlQXRUaW1lKG4sdCl9ZWxzZXtpZihcInNldFZhbHVlQ3VydmVcIiE9PXMudHlwZSl0aHJvdyBuZXcgRXJyb3IoXCJDYW4ndCBhcHBseSBhbiB1bmtub3duIGF1dG9tYXRpb24uXCIpO3tjb25zdHtkdXJhdGlvbjp0LHN0YXJ0VGltZTpuLHZhbHVlczppfT1zO2Uuc2V0VmFsdWVDdXJ2ZUF0VGltZShpLG4sdCl9fX19KSxyLmNyZWF0ZUNhbmNlbEFuZEhvbGRBdXRvbWF0aW9uRXZlbnQsci5jcmVhdGVDYW5jZWxTY2hlZHVsZWRWYWx1ZXNBdXRvbWF0aW9uRXZlbnQsci5jcmVhdGVFeHBvbmVudGlhbFJhbXBUb1ZhbHVlQXV0b21hdGlvbkV2ZW50LHIuY3JlYXRlTGluZWFyUmFtcFRvVmFsdWVBdXRvbWF0aW9uRXZlbnQsci5jcmVhdGVTZXRUYXJnZXRBdXRvbWF0aW9uRXZlbnQsci5jcmVhdGVTZXRWYWx1ZUF1dG9tYXRpb25FdmVudCxyLmNyZWF0ZVNldFZhbHVlQ3VydmVBdXRvbWF0aW9uRXZlbnQsQmUscmUpO3ZhciBkcztjb25zdCBmcz0oKHQsZSxzLG4saSxvLHIsYSk9PmNsYXNzIGV4dGVuZHMgdHtjb25zdHJ1Y3Rvcih0LG4pe2NvbnN0IGE9byh0KSxjPXsuLi5qLC4uLm59LGg9aShhLGMpLHU9cihhKSxsPXU/ZSgpOm51bGw7c3VwZXIodCwhMSxoLGwpLHRoaXMuX2F1ZGlvQnVmZmVyU291cmNlTm9kZVJlbmRlcmVyPWwsdGhpcy5faXNCdWZmZXJOdWxsaWZpZWQ9ITEsdGhpcy5faXNCdWZmZXJTZXQ9bnVsbCE9PWMuYnVmZmVyLHRoaXMuX25hdGl2ZUF1ZGlvQnVmZmVyU291cmNlTm9kZT1oLHRoaXMuX29uZW5kZWQ9bnVsbCx0aGlzLl9wbGF5YmFja1JhdGU9cyh0aGlzLHUsaC5wbGF5YmFja1JhdGUsTixWKX1nZXQgYnVmZmVyKCl7cmV0dXJuIHRoaXMuX2lzQnVmZmVyTnVsbGlmaWVkP251bGw6dGhpcy5fbmF0aXZlQXVkaW9CdWZmZXJTb3VyY2VOb2RlLmJ1ZmZlcn1zZXQgYnVmZmVyKHQpe2lmKHRoaXMuX25hdGl2ZUF1ZGlvQnVmZmVyU291cmNlTm9kZS5idWZmZXI9dCxudWxsIT09dCl7aWYodGhpcy5faXNCdWZmZXJTZXQpdGhyb3cgbigpO3RoaXMuX2lzQnVmZmVyU2V0PSEwfX1nZXQgbG9vcCgpe3JldHVybiB0aGlzLl9uYXRpdmVBdWRpb0J1ZmZlclNvdXJjZU5vZGUubG9vcH1zZXQgbG9vcCh0KXt0aGlzLl9uYXRpdmVBdWRpb0J1ZmZlclNvdXJjZU5vZGUubG9vcD10fWdldCBsb29wRW5kKCl7cmV0dXJuIHRoaXMuX25hdGl2ZUF1ZGlvQnVmZmVyU291cmNlTm9kZS5sb29wRW5kfXNldCBsb29wRW5kKHQpe3RoaXMuX25hdGl2ZUF1ZGlvQnVmZmVyU291cmNlTm9kZS5sb29wRW5kPXR9Z2V0IGxvb3BTdGFydCgpe3JldHVybiB0aGlzLl9uYXRpdmVBdWRpb0J1ZmZlclNvdXJjZU5vZGUubG9vcFN0YXJ0fXNldCBsb29wU3RhcnQodCl7dGhpcy5fbmF0aXZlQXVkaW9CdWZmZXJTb3VyY2VOb2RlLmxvb3BTdGFydD10fWdldCBvbmVuZGVkKCl7cmV0dXJuIHRoaXMuX29uZW5kZWR9c2V0IG9uZW5kZWQodCl7Y29uc3QgZT1cImZ1bmN0aW9uXCI9PXR5cGVvZiB0P2EodGhpcyx0KTpudWxsO3RoaXMuX25hdGl2ZUF1ZGlvQnVmZmVyU291cmNlTm9kZS5vbmVuZGVkPWU7Y29uc3Qgcz10aGlzLl9uYXRpdmVBdWRpb0J1ZmZlclNvdXJjZU5vZGUub25lbmRlZDt0aGlzLl9vbmVuZGVkPW51bGwhPT1zJiZzPT09ZT90OnN9Z2V0IHBsYXliYWNrUmF0ZSgpe3JldHVybiB0aGlzLl9wbGF5YmFja1JhdGV9c3RhcnQodD0wLGU9MCxzKXtpZih0aGlzLl9uYXRpdmVBdWRpb0J1ZmZlclNvdXJjZU5vZGUuc3RhcnQodCxlLHMpLG51bGwhPT10aGlzLl9hdWRpb0J1ZmZlclNvdXJjZU5vZGVSZW5kZXJlciYmKHRoaXMuX2F1ZGlvQnVmZmVyU291cmNlTm9kZVJlbmRlcmVyLnN0YXJ0PXZvaWQgMD09PXM/W3QsZV06W3QsZSxzXSksXCJjbG9zZWRcIiE9PXRoaXMuY29udGV4dC5zdGF0ZSl7Qyh0aGlzKTtjb25zdCB0PSgpPT57dGhpcy5fbmF0aXZlQXVkaW9CdWZmZXJTb3VyY2VOb2RlLnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJlbmRlZFwiLHQpLFAodGhpcykmJkQodGhpcyl9O3RoaXMuX25hdGl2ZUF1ZGlvQnVmZmVyU291cmNlTm9kZS5hZGRFdmVudExpc3RlbmVyKFwiZW5kZWRcIix0KX19c3RvcCh0PTApe3RoaXMuX25hdGl2ZUF1ZGlvQnVmZmVyU291cmNlTm9kZS5zdG9wKHQpLG51bGwhPT10aGlzLl9hdWRpb0J1ZmZlclNvdXJjZU5vZGVSZW5kZXJlciYmKHRoaXMuX2F1ZGlvQnVmZmVyU291cmNlTm9kZVJlbmRlcmVyLnN0b3A9dCl9fSkoWmUsbHMscHMsQXQsY3MsRmUsTmUsZGUpLF9zPSgodCxlLHMsbixpLG8scixhKT0+Y2xhc3MgZXh0ZW5kcyB0e2NvbnN0cnVjdG9yKHQscyl7Y29uc3Qgbj1vKHQpLGM9cihuKSxoPWkobixzLGMpO3N1cGVyKHQsITEsaCxjP2UoYSk6bnVsbCksdGhpcy5faXNOb2RlT2ZOYXRpdmVPZmZsaW5lQXVkaW9Db250ZXh0PWMsdGhpcy5fbmF0aXZlQXVkaW9EZXN0aW5hdGlvbk5vZGU9aH1nZXQgY2hhbm5lbENvdW50KCl7cmV0dXJuIHRoaXMuX25hdGl2ZUF1ZGlvRGVzdGluYXRpb25Ob2RlLmNoYW5uZWxDb3VudH1zZXQgY2hhbm5lbENvdW50KHQpe2lmKHRoaXMuX2lzTm9kZU9mTmF0aXZlT2ZmbGluZUF1ZGlvQ29udGV4dCl0aHJvdyBuKCk7aWYodD50aGlzLl9uYXRpdmVBdWRpb0Rlc3RpbmF0aW9uTm9kZS5tYXhDaGFubmVsQ291bnQpdGhyb3cgcygpO3RoaXMuX25hdGl2ZUF1ZGlvRGVzdGluYXRpb25Ob2RlLmNoYW5uZWxDb3VudD10fWdldCBjaGFubmVsQ291bnRNb2RlKCl7cmV0dXJuIHRoaXMuX25hdGl2ZUF1ZGlvRGVzdGluYXRpb25Ob2RlLmNoYW5uZWxDb3VudE1vZGV9c2V0IGNoYW5uZWxDb3VudE1vZGUodCl7aWYodGhpcy5faXNOb2RlT2ZOYXRpdmVPZmZsaW5lQXVkaW9Db250ZXh0KXRocm93IG4oKTt0aGlzLl9uYXRpdmVBdWRpb0Rlc3RpbmF0aW9uTm9kZS5jaGFubmVsQ291bnRNb2RlPXR9Z2V0IG1heENoYW5uZWxDb3VudCgpe3JldHVybiB0aGlzLl9uYXRpdmVBdWRpb0Rlc3RpbmF0aW9uTm9kZS5tYXhDaGFubmVsQ291bnR9fSkoWmUsdD0+e2xldCBlPW51bGw7cmV0dXJue3JlbmRlcjoocyxuLGkpPT4obnVsbD09PWUmJihlPShhc3luYyhlLHMsbik9Pntjb25zdCBpPXMuZGVzdGluYXRpb247cmV0dXJuIGF3YWl0IHQoZSxzLGksbiksaX0pKHMsbixpKSksZSl9fSxxLEF0LCgodCxlKT0+KHMsbixpKT0+e2NvbnN0IG89cy5kZXN0aW5hdGlvbjtpZihvLmNoYW5uZWxDb3VudCE9PW4pdHJ5e28uY2hhbm5lbENvdW50PW59Y2F0Y2h7fWkmJlwiZXhwbGljaXRcIiE9PW8uY2hhbm5lbENvdW50TW9kZSYmKG8uY2hhbm5lbENvdW50TW9kZT1cImV4cGxpY2l0XCIpLDA9PT1vLm1heENoYW5uZWxDb3VudCYmT2JqZWN0LmRlZmluZVByb3BlcnR5KG8sXCJtYXhDaGFubmVsQ291bnRcIix7dmFsdWU6bn0pO2NvbnN0IHI9dChzLHtjaGFubmVsQ291bnQ6bixjaGFubmVsQ291bnRNb2RlOm8uY2hhbm5lbENvdW50TW9kZSxjaGFubmVsSW50ZXJwcmV0YXRpb246by5jaGFubmVsSW50ZXJwcmV0YXRpb24sZ2FpbjoxfSk7cmV0dXJuIGUocixcImNoYW5uZWxDb3VudFwiLHQ9PigpPT50LmNhbGwociksdD0+ZT0+e3QuY2FsbChyLGUpO3RyeXtvLmNoYW5uZWxDb3VudD1lfWNhdGNoKHQpe2lmKGU+by5tYXhDaGFubmVsQ291bnQpdGhyb3cgdH19KSxlKHIsXCJjaGFubmVsQ291bnRNb2RlXCIsdD0+KCk9PnQuY2FsbChyKSx0PT5lPT57dC5jYWxsKHIsZSksby5jaGFubmVsQ291bnRNb2RlPWV9KSxlKHIsXCJjaGFubmVsSW50ZXJwcmV0YXRpb25cIix0PT4oKT0+dC5jYWxsKHIpLHQ9PmU9Pnt0LmNhbGwocixlKSxvLmNoYW5uZWxJbnRlcnByZXRhdGlvbj1lfSksT2JqZWN0LmRlZmluZVByb3BlcnR5KHIsXCJtYXhDaGFubmVsQ291bnRcIix7Z2V0OigpPT5vLm1heENoYW5uZWxDb3VudH0pLHIuY29ubmVjdChvKSxyfSkoUXQsb2UpLEZlLE5lLE9lKSxtcz0oKHQsZSxzLG4saSk9PigpPT57Y29uc3Qgbz1uZXcgV2Vha01hcDtyZXR1cm57cmVuZGVyKHIsYSxjKXtjb25zdCBoPW8uZ2V0KGEpO3JldHVybiB2b2lkIDAhPT1oP1Byb21pc2UucmVzb2x2ZShoKTooYXN5bmMocixhLGMpPT57bGV0IGg9cyhyKTtjb25zdCB1PUUoaCxhKTtpZighdSl7Y29uc3QgdD17UTpoLlEudmFsdWUsY2hhbm5lbENvdW50OmguY2hhbm5lbENvdW50LGNoYW5uZWxDb3VudE1vZGU6aC5jaGFubmVsQ291bnRNb2RlLGNoYW5uZWxJbnRlcnByZXRhdGlvbjpoLmNoYW5uZWxJbnRlcnByZXRhdGlvbixkZXR1bmU6aC5kZXR1bmUudmFsdWUsZnJlcXVlbmN5OmguZnJlcXVlbmN5LnZhbHVlLGdhaW46aC5nYWluLnZhbHVlLHR5cGU6aC50eXBlfTtoPWUoYSx0KX1yZXR1cm4gby5zZXQoYSxoKSx1Pyhhd2FpdCB0KGEsci5RLGguUSxjKSxhd2FpdCB0KGEsci5kZXR1bmUsaC5kZXR1bmUsYyksYXdhaXQgdChhLHIuZnJlcXVlbmN5LGguZnJlcXVlbmN5LGMpLGF3YWl0IHQoYSxyLmdhaW4saC5nYWluLGMpKTooYXdhaXQgbihhLHIuUSxoLlEsYyksYXdhaXQgbihhLHIuZGV0dW5lLGguZGV0dW5lLGMpLGF3YWl0IG4oYSxyLmZyZXF1ZW5jeSxoLmZyZXF1ZW5jeSxjKSxhd2FpdCBuKGEsci5nYWluLGguZ2FpbixjKSksYXdhaXQgaShyLGEsaCxjKSxofSkocixhLGMpfX19KShhcyxCdCxzdCx1cyxPZSksZ3M9KHQ9PihlLHMpPT50LnNldChlLHMpKSh2ZSksdnM9KHlzPVplLHhzPXBzLHdzPW1zLGJzPUR0LFRzPUJ0LFNzPUZlLGtzPU5lLENzPWdzLGNsYXNzIGV4dGVuZHMgeXN7Y29uc3RydWN0b3IodCxlKXtjb25zdCBzPVNzKHQpLG49ey4uLnZ0LC4uLmV9LGk9VHMocyxuKSxvPWtzKHMpO3N1cGVyKHQsITEsaSxvP3dzKCk6bnVsbCksdGhpcy5fUT14cyh0aGlzLG8saS5RLE4sViksdGhpcy5fZGV0dW5lPXhzKHRoaXMsbyxpLmRldHVuZSwxMjAwKk1hdGgubG9nMihOKSwtMTIwMCpNYXRoLmxvZzIoTikpLHRoaXMuX2ZyZXF1ZW5jeT14cyh0aGlzLG8saS5mcmVxdWVuY3ksdC5zYW1wbGVSYXRlLzIsMCksdGhpcy5fZ2Fpbj14cyh0aGlzLG8saS5nYWluLDQwKk1hdGgubG9nMTAoTiksViksdGhpcy5fbmF0aXZlQmlxdWFkRmlsdGVyTm9kZT1pLENzKHRoaXMsMSl9Z2V0IGRldHVuZSgpe3JldHVybiB0aGlzLl9kZXR1bmV9Z2V0IGZyZXF1ZW5jeSgpe3JldHVybiB0aGlzLl9mcmVxdWVuY3l9Z2V0IGdhaW4oKXtyZXR1cm4gdGhpcy5fZ2Fpbn1nZXQgUSgpe3JldHVybiB0aGlzLl9RfWdldCB0eXBlKCl7cmV0dXJuIHRoaXMuX25hdGl2ZUJpcXVhZEZpbHRlck5vZGUudHlwZX1zZXQgdHlwZSh0KXt0aGlzLl9uYXRpdmVCaXF1YWRGaWx0ZXJOb2RlLnR5cGU9dH1nZXRGcmVxdWVuY3lSZXNwb25zZSh0LGUscyl7dHJ5e3RoaXMuX25hdGl2ZUJpcXVhZEZpbHRlck5vZGUuZ2V0RnJlcXVlbmN5UmVzcG9uc2UodCxlLHMpfWNhdGNoKHQpe2lmKDExPT09dC5jb2RlKXRocm93IGJzKCk7dGhyb3cgdH1pZih0Lmxlbmd0aCE9PWUubGVuZ3RofHxlLmxlbmd0aCE9PXMubGVuZ3RoKXRocm93IGJzKCl9fSk7dmFyIHlzLHhzLHdzLGJzLFRzLFNzLGtzLENzO2NvbnN0IEFzPSgodCxlKT0+KHMsbixpKT0+e2NvbnN0IG89bmV3IFNldDt2YXIgcixhO3JldHVybiBzLmNvbm5lY3Q9KHI9cy5jb25uZWN0LChpLGE9MCxjPTApPT57Y29uc3QgaD0wPT09by5zaXplO2lmKGUoaSkpcmV0dXJuIHIuY2FsbChzLGksYSxjKSx0KG8sW2ksYSxjXSx0PT50WzBdPT09aSYmdFsxXT09PWEmJnRbMl09PT1jLCEwKSxoJiZuKCksaTtyLmNhbGwocyxpLGEpLHQobyxbaSxhXSx0PT50WzBdPT09aSYmdFsxXT09PWEsITApLGgmJm4oKX0pLHMuZGlzY29ubmVjdD0oYT1zLmRpc2Nvbm5lY3QsKHQsbixyKT0+e2NvbnN0IGM9by5zaXplPjA7aWYodm9pZCAwPT09dClhLmFwcGx5KHMpLG8uY2xlYXIoKTtlbHNlIGlmKFwibnVtYmVyXCI9PXR5cGVvZiB0KXthLmNhbGwocyx0KTtmb3IoY29uc3QgZSBvZiBvKWVbMV09PT10JiZvLmRlbGV0ZShlKX1lbHNle2UodCk/YS5jYWxsKHMsdCxuLHIpOmEuY2FsbChzLHQsbik7Zm9yKGNvbnN0IGUgb2YgbyllWzBdIT09dHx8dm9pZCAwIT09biYmZVsxXSE9PW58fHZvaWQgMCE9PXImJmVbMl0hPT1yfHxvLmRlbGV0ZShlKX1jb25zdCBoPTA9PT1vLnNpemU7YyYmaCYmaSgpfSksc30pKFosVWUpLERzPShPcz1BdCxNcz1BcywodCxlKT0+e2UuY2hhbm5lbENvdW50PTEsZS5jaGFubmVsQ291bnRNb2RlPVwiZXhwbGljaXRcIixPYmplY3QuZGVmaW5lUHJvcGVydHkoZSxcImNoYW5uZWxDb3VudFwiLHtnZXQ6KCk9PjEsc2V0OigpPT57dGhyb3cgT3MoKX19KSxPYmplY3QuZGVmaW5lUHJvcGVydHkoZSxcImNoYW5uZWxDb3VudE1vZGVcIix7Z2V0OigpPT5cImV4cGxpY2l0XCIsc2V0OigpPT57dGhyb3cgT3MoKX19KTtjb25zdCBzPXQuY3JlYXRlQnVmZmVyU291cmNlKCk7TXMoZSwoKT0+e2NvbnN0IHQ9ZS5udW1iZXJPZklucHV0cztmb3IobGV0IG49MDtuPHQ7bis9MSlzLmNvbm5lY3QoZSwwLG4pfSwoKT0+cy5kaXNjb25uZWN0KGUpKX0pO3ZhciBPcyxNcztjb25zdCBFcz0oKHQsZSk9PihzLG4pPT57Y29uc3QgaT1zLmNyZWF0ZUNoYW5uZWxNZXJnZXIobi5udW1iZXJPZklucHV0cyk7cmV0dXJuIG51bGwhPT10JiZcIndlYmtpdEF1ZGlvQ29udGV4dFwiPT09dC5uYW1lJiZlKHMsaSksSXQoaSxuKSxpfSkoQmUsRHMpLFJzPSgodCxlLHMsbixpKT0+Y2xhc3MgZXh0ZW5kcyB0e2NvbnN0cnVjdG9yKHQsbyl7Y29uc3Qgcj1uKHQpLGE9ey4uLnl0LC4uLm99O3N1cGVyKHQsITEscyhyLGEpLGkocik/ZSgpOm51bGwpfX0pKFplLCgodCxlLHMpPT4oKT0+e2NvbnN0IG49bmV3IFdlYWtNYXA7cmV0dXJue3JlbmRlcihpLG8scil7Y29uc3QgYT1uLmdldChvKTtyZXR1cm4gdm9pZCAwIT09YT9Qcm9taXNlLnJlc29sdmUoYSk6KGFzeW5jKGksbyxyKT0+e2xldCBhPWUoaSk7aWYoIUUoYSxvKSl7Y29uc3QgZT17Y2hhbm5lbENvdW50OmEuY2hhbm5lbENvdW50LGNoYW5uZWxDb3VudE1vZGU6YS5jaGFubmVsQ291bnRNb2RlLGNoYW5uZWxJbnRlcnByZXRhdGlvbjphLmNoYW5uZWxJbnRlcnByZXRhdGlvbixudW1iZXJPZklucHV0czphLm51bWJlck9mSW5wdXRzfTthPXQobyxlKX1yZXR1cm4gbi5zZXQobyxhKSxhd2FpdCBzKGksbyxhLHIpLGF9KShpLG8scil9fX0pKEVzLHN0LE9lKSxFcyxGZSxOZSkscXM9KCh0LGUscyxuLGksbyk9PmNsYXNzIGV4dGVuZHMgdHtjb25zdHJ1Y3Rvcih0LHIpe2NvbnN0IGE9bih0KSxjPW8oey4uLnh0LC4uLnJ9KTtzdXBlcih0LCExLHMoYSxjKSxpKGEpP2UoKTpudWxsKX19KShaZSwoKHQsZSxzKT0+KCk9Pntjb25zdCBuPW5ldyBXZWFrTWFwO3JldHVybntyZW5kZXIoaSxvLHIpe2NvbnN0IGE9bi5nZXQobyk7cmV0dXJuIHZvaWQgMCE9PWE/UHJvbWlzZS5yZXNvbHZlKGEpOihhc3luYyhpLG8scik9PntsZXQgYT1lKGkpO2lmKCFFKGEsbykpe2NvbnN0IGU9e2NoYW5uZWxDb3VudDphLmNoYW5uZWxDb3VudCxjaGFubmVsQ291bnRNb2RlOmEuY2hhbm5lbENvdW50TW9kZSxjaGFubmVsSW50ZXJwcmV0YXRpb246YS5jaGFubmVsSW50ZXJwcmV0YXRpb24sbnVtYmVyT2ZPdXRwdXRzOmEubnVtYmVyT2ZPdXRwdXRzfTthPXQobyxlKX1yZXR1cm4gbi5zZXQobyxhKSxhd2FpdCBzKGksbyxhLHIpLGF9KShpLG8scil9fX0pKFd0LHN0LE9lKSxXdCxGZSxOZSx0PT4oey4uLnQsY2hhbm5lbENvdW50OnQubnVtYmVyT2ZPdXRwdXRzfSkpLEZzPSgodCxlLHMsbik9PihpLHtvZmZzZXQ6bywuLi5yfSk9Pntjb25zdCBhPWkuY3JlYXRlQnVmZmVyKDEsMiw0NDEwMCksYz1lKGkse2J1ZmZlcjpudWxsLGNoYW5uZWxDb3VudDoyLGNoYW5uZWxDb3VudE1vZGU6XCJtYXhcIixjaGFubmVsSW50ZXJwcmV0YXRpb246XCJzcGVha2Vyc1wiLGxvb3A6ITEsbG9vcEVuZDowLGxvb3BTdGFydDowLHBsYXliYWNrUmF0ZToxfSksaD1zKGksey4uLnIsZ2FpbjpvfSksdT1hLmdldENoYW5uZWxEYXRhKDApO3VbMF09MSx1WzFdPTEsYy5idWZmZXI9YSxjLmxvb3A9ITA7Y29uc3QgbD17Z2V0IGJ1ZmZlclNpemUoKXt9LGdldCBjaGFubmVsQ291bnQoKXtyZXR1cm4gaC5jaGFubmVsQ291bnR9LHNldCBjaGFubmVsQ291bnQodCl7aC5jaGFubmVsQ291bnQ9dH0sZ2V0IGNoYW5uZWxDb3VudE1vZGUoKXtyZXR1cm4gaC5jaGFubmVsQ291bnRNb2RlfSxzZXQgY2hhbm5lbENvdW50TW9kZSh0KXtoLmNoYW5uZWxDb3VudE1vZGU9dH0sZ2V0IGNoYW5uZWxJbnRlcnByZXRhdGlvbigpe3JldHVybiBoLmNoYW5uZWxJbnRlcnByZXRhdGlvbn0sc2V0IGNoYW5uZWxJbnRlcnByZXRhdGlvbih0KXtoLmNoYW5uZWxJbnRlcnByZXRhdGlvbj10fSxnZXQgY29udGV4dCgpe3JldHVybiBoLmNvbnRleHR9LGdldCBpbnB1dHMoKXtyZXR1cm5bXX0sZ2V0IG51bWJlck9mSW5wdXRzKCl7cmV0dXJuIGMubnVtYmVyT2ZJbnB1dHN9LGdldCBudW1iZXJPZk91dHB1dHMoKXtyZXR1cm4gaC5udW1iZXJPZk91dHB1dHN9LGdldCBvZmZzZXQoKXtyZXR1cm4gaC5nYWlufSxnZXQgb25lbmRlZCgpe3JldHVybiBjLm9uZW5kZWR9LHNldCBvbmVuZGVkKHQpe2Mub25lbmRlZD10fSxhZGRFdmVudExpc3RlbmVyOiguLi50KT0+Yy5hZGRFdmVudExpc3RlbmVyKHRbMF0sdFsxXSx0WzJdKSxkaXNwYXRjaEV2ZW50OiguLi50KT0+Yy5kaXNwYXRjaEV2ZW50KHRbMF0pLHJlbW92ZUV2ZW50TGlzdGVuZXI6KC4uLnQpPT5jLnJlbW92ZUV2ZW50TGlzdGVuZXIodFswXSx0WzFdLHRbMl0pLHN0YXJ0KHQ9MCl7Yy5zdGFydC5jYWxsKGMsdCl9LHN0b3AodD0wKXtjLnN0b3AuY2FsbChjLHQpfX07cmV0dXJuIHQoaSxjKSxuKEd0KGwsaCksKCk9PmMuY29ubmVjdChoKSwoKT0+Yy5kaXNjb25uZWN0KGgpKX0pKGlzLGNzLFF0LEFzKSxJcz0oKHQsZSxzLG4saSk9PihvLHIpPT57aWYodm9pZCAwPT09by5jcmVhdGVDb25zdGFudFNvdXJjZSlyZXR1cm4gcyhvLHIpO2NvbnN0IGE9by5jcmVhdGVDb25zdGFudFNvdXJjZSgpO3JldHVybiBJdChhLHIpLE50KGEscixcIm9mZnNldFwiKSxlKG4sKCk9Pm4obykpfHxQdChhKSxlKGksKCk9PmkobykpfHxqdChhKSx0KG8sYSksYX0pKGlzLHhlLEZzLGFlLGhlKSxWcz0oKHQsZSxzLG4saSxvLHIpPT5jbGFzcyBleHRlbmRzIHR7Y29uc3RydWN0b3IodCxyKXtjb25zdCBhPWkodCksYz17Li4ud3QsLi4ucn0saD1uKGEsYyksdT1vKGEpLGw9dT9zKCk6bnVsbDtzdXBlcih0LCExLGgsbCksdGhpcy5fY29uc3RhbnRTb3VyY2VOb2RlUmVuZGVyZXI9bCx0aGlzLl9uYXRpdmVDb25zdGFudFNvdXJjZU5vZGU9aCx0aGlzLl9vZmZzZXQ9ZSh0aGlzLHUsaC5vZmZzZXQsTixWKSx0aGlzLl9vbmVuZGVkPW51bGx9Z2V0IG9mZnNldCgpe3JldHVybiB0aGlzLl9vZmZzZXR9Z2V0IG9uZW5kZWQoKXtyZXR1cm4gdGhpcy5fb25lbmRlZH1zZXQgb25lbmRlZCh0KXtjb25zdCBlPVwiZnVuY3Rpb25cIj09dHlwZW9mIHQ/cih0aGlzLHQpOm51bGw7dGhpcy5fbmF0aXZlQ29uc3RhbnRTb3VyY2VOb2RlLm9uZW5kZWQ9ZTtjb25zdCBzPXRoaXMuX25hdGl2ZUNvbnN0YW50U291cmNlTm9kZS5vbmVuZGVkO3RoaXMuX29uZW5kZWQ9bnVsbCE9PXMmJnM9PT1lP3Q6c31zdGFydCh0PTApe2lmKHRoaXMuX25hdGl2ZUNvbnN0YW50U291cmNlTm9kZS5zdGFydCh0KSxudWxsIT09dGhpcy5fY29uc3RhbnRTb3VyY2VOb2RlUmVuZGVyZXImJih0aGlzLl9jb25zdGFudFNvdXJjZU5vZGVSZW5kZXJlci5zdGFydD10KSxcImNsb3NlZFwiIT09dGhpcy5jb250ZXh0LnN0YXRlKXtDKHRoaXMpO2NvbnN0IHQ9KCk9Pnt0aGlzLl9uYXRpdmVDb25zdGFudFNvdXJjZU5vZGUucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImVuZGVkXCIsdCksUCh0aGlzKSYmRCh0aGlzKX07dGhpcy5fbmF0aXZlQ29uc3RhbnRTb3VyY2VOb2RlLmFkZEV2ZW50TGlzdGVuZXIoXCJlbmRlZFwiLHQpfX1zdG9wKHQ9MCl7dGhpcy5fbmF0aXZlQ29uc3RhbnRTb3VyY2VOb2RlLnN0b3AodCksbnVsbCE9PXRoaXMuX2NvbnN0YW50U291cmNlTm9kZVJlbmRlcmVyJiYodGhpcy5fY29uc3RhbnRTb3VyY2VOb2RlUmVuZGVyZXIuc3RvcD10KX19KShaZSxwcywoKHQsZSxzLG4saSk9PigpPT57Y29uc3Qgbz1uZXcgV2Vha01hcDtsZXQgcj1udWxsLGE9bnVsbDtyZXR1cm57c2V0IHN0YXJ0KHQpe3I9dH0sc2V0IHN0b3AodCl7YT10fSxyZW5kZXIoYyxoLHUpe2NvbnN0IGw9by5nZXQoaCk7cmV0dXJuIHZvaWQgMCE9PWw/UHJvbWlzZS5yZXNvbHZlKGwpOihhc3luYyhjLGgsdSk9PntsZXQgbD1zKGMpO2NvbnN0IHA9RShsLGgpO2lmKCFwKXtjb25zdCB0PXtjaGFubmVsQ291bnQ6bC5jaGFubmVsQ291bnQsY2hhbm5lbENvdW50TW9kZTpsLmNoYW5uZWxDb3VudE1vZGUsY2hhbm5lbEludGVycHJldGF0aW9uOmwuY2hhbm5lbEludGVycHJldGF0aW9uLG9mZnNldDpsLm9mZnNldC52YWx1ZX07bD1lKGgsdCksbnVsbCE9PXImJmwuc3RhcnQociksbnVsbCE9PWEmJmwuc3RvcChhKX1yZXR1cm4gby5zZXQoaCxsKSxwP2F3YWl0IHQoaCxjLm9mZnNldCxsLm9mZnNldCx1KTphd2FpdCBuKGgsYy5vZmZzZXQsbC5vZmZzZXQsdSksYXdhaXQgaShjLGgsbCx1KSxsfSkoYyxoLHUpfX19KShhcyxJcyxzdCx1cyxPZSksSXMsRmUsTmUsZGUpLE5zPSgodCxlKT0+KHMsbik9Pntjb25zdCBpPXMuY3JlYXRlQ29udm9sdmVyKCk7aWYoSXQoaSxuKSxuLmRpc2FibGVOb3JtYWxpemF0aW9uPT09aS5ub3JtYWxpemUmJihpLm5vcm1hbGl6ZT0hbi5kaXNhYmxlTm9ybWFsaXphdGlvbiksRnQoaSxuLFwiYnVmZmVyXCIpLG4uY2hhbm5lbENvdW50PjIpdGhyb3cgdCgpO2lmKGUoaSxcImNoYW5uZWxDb3VudFwiLHQ9PigpPT50LmNhbGwoaSksZT0+cz0+e2lmKHM+Mil0aHJvdyB0KCk7cmV0dXJuIGUuY2FsbChpLHMpfSksXCJtYXhcIj09PW4uY2hhbm5lbENvdW50TW9kZSl0aHJvdyB0KCk7cmV0dXJuIGUoaSxcImNoYW5uZWxDb3VudE1vZGVcIix0PT4oKT0+dC5jYWxsKGkpLGU9PnM9PntpZihcIm1heFwiPT09cyl0aHJvdyB0KCk7cmV0dXJuIGUuY2FsbChpLHMpfSksaX0pKEh0LG9lKSxQcz0oKHQsZSxzLG4saSxvKT0+Y2xhc3MgZXh0ZW5kcyB0e2NvbnN0cnVjdG9yKHQscil7Y29uc3QgYT1uKHQpLGM9ey4uLmJ0LC4uLnJ9LGg9cyhhLGMpO3N1cGVyKHQsITEsaCxpKGEpP2UoKTpudWxsKSx0aGlzLl9pc0J1ZmZlck51bGxpZmllZD0hMSx0aGlzLl9uYXRpdmVDb252b2x2ZXJOb2RlPWgsbnVsbCE9PWMuYnVmZmVyJiZvKHRoaXMsYy5idWZmZXIuZHVyYXRpb24pfWdldCBidWZmZXIoKXtyZXR1cm4gdGhpcy5faXNCdWZmZXJOdWxsaWZpZWQ/bnVsbDp0aGlzLl9uYXRpdmVDb252b2x2ZXJOb2RlLmJ1ZmZlcn1zZXQgYnVmZmVyKHQpe2lmKHRoaXMuX25hdGl2ZUNvbnZvbHZlck5vZGUuYnVmZmVyPXQsbnVsbD09PXQmJm51bGwhPT10aGlzLl9uYXRpdmVDb252b2x2ZXJOb2RlLmJ1ZmZlcil7Y29uc3QgdD10aGlzLl9uYXRpdmVDb252b2x2ZXJOb2RlLmNvbnRleHQ7dGhpcy5fbmF0aXZlQ29udm9sdmVyTm9kZS5idWZmZXI9dC5jcmVhdGVCdWZmZXIoMSwxLDQ0MTAwKSx0aGlzLl9pc0J1ZmZlck51bGxpZmllZD0hMCxvKHRoaXMsMCl9ZWxzZSB0aGlzLl9pc0J1ZmZlck51bGxpZmllZD0hMSxvKHRoaXMsbnVsbD09PXRoaXMuX25hdGl2ZUNvbnZvbHZlck5vZGUuYnVmZmVyPzA6dGhpcy5fbmF0aXZlQ29udm9sdmVyTm9kZS5idWZmZXIuZHVyYXRpb24pfWdldCBub3JtYWxpemUoKXtyZXR1cm4gdGhpcy5fbmF0aXZlQ29udm9sdmVyTm9kZS5ub3JtYWxpemV9c2V0IG5vcm1hbGl6ZSh0KXt0aGlzLl9uYXRpdmVDb252b2x2ZXJOb2RlLm5vcm1hbGl6ZT10fX0pKFplLCgodCxlLHMpPT4oKT0+e2NvbnN0IG49bmV3IFdlYWtNYXA7cmV0dXJue3JlbmRlcihpLG8scil7Y29uc3QgYT1uLmdldChvKTtyZXR1cm4gdm9pZCAwIT09YT9Qcm9taXNlLnJlc29sdmUoYSk6KGFzeW5jKGksbyxyKT0+e2xldCBhPWUoaSk7aWYoIUUoYSxvKSl7Y29uc3QgZT17YnVmZmVyOmEuYnVmZmVyLGNoYW5uZWxDb3VudDphLmNoYW5uZWxDb3VudCxjaGFubmVsQ291bnRNb2RlOmEuY2hhbm5lbENvdW50TW9kZSxjaGFubmVsSW50ZXJwcmV0YXRpb246YS5jaGFubmVsSW50ZXJwcmV0YXRpb24sZGlzYWJsZU5vcm1hbGl6YXRpb246IWEubm9ybWFsaXplfTthPXQobyxlKX1yZXR1cm4gbi5zZXQobyxhKSxIKGEpP2F3YWl0IHMoaSxvLGEuaW5wdXRzWzBdLHIpOmF3YWl0IHMoaSxvLGEsciksYX0pKGksbyxyKX19fSkoTnMsc3QsT2UpLE5zLEZlLE5lLGdzKSxqcz0oKHQsZSxzLG4saSxvLHIpPT5jbGFzcyBleHRlbmRzIHR7Y29uc3RydWN0b3IodCxhKXtjb25zdCBjPWkodCksaD17Li4uVHQsLi4uYX0sdT1uKGMsaCksbD1vKGMpO3N1cGVyKHQsITEsdSxsP3MoaC5tYXhEZWxheVRpbWUpOm51bGwpLHRoaXMuX2RlbGF5VGltZT1lKHRoaXMsbCx1LmRlbGF5VGltZSkscih0aGlzLGgubWF4RGVsYXlUaW1lKX1nZXQgZGVsYXlUaW1lKCl7cmV0dXJuIHRoaXMuX2RlbGF5VGltZX19KShaZSxwcywoKHQsZSxzLG4saSk9Pm89Pntjb25zdCByPW5ldyBXZWFrTWFwO3JldHVybntyZW5kZXIoYSxjLGgpe2NvbnN0IHU9ci5nZXQoYyk7cmV0dXJuIHZvaWQgMCE9PXU/UHJvbWlzZS5yZXNvbHZlKHUpOihhc3luYyhhLGMsaCk9PntsZXQgdT1zKGEpO2NvbnN0IGw9RSh1LGMpO2lmKCFsKXtjb25zdCB0PXtjaGFubmVsQ291bnQ6dS5jaGFubmVsQ291bnQsY2hhbm5lbENvdW50TW9kZTp1LmNoYW5uZWxDb3VudE1vZGUsY2hhbm5lbEludGVycHJldGF0aW9uOnUuY2hhbm5lbEludGVycHJldGF0aW9uLGRlbGF5VGltZTp1LmRlbGF5VGltZS52YWx1ZSxtYXhEZWxheVRpbWU6b307dT1lKGMsdCl9cmV0dXJuIHIuc2V0KGMsdSksbD9hd2FpdCB0KGMsYS5kZWxheVRpbWUsdS5kZWxheVRpbWUsaCk6YXdhaXQgbihjLGEuZGVsYXlUaW1lLHUuZGVsYXlUaW1lLGgpLGF3YWl0IGkoYSxjLHUsaCksdX0pKGEsYyxoKX19fSkoYXMsVXQsc3QsdXMsT2UpLFV0LEZlLE5lLGdzKSxMcz0oenM9SHQsKHQsZSk9Pntjb25zdCBzPXQuY3JlYXRlRHluYW1pY3NDb21wcmVzc29yKCk7aWYoSXQocyxlKSxlLmNoYW5uZWxDb3VudD4yKXRocm93IHpzKCk7aWYoXCJtYXhcIj09PWUuY2hhbm5lbENvdW50TW9kZSl0aHJvdyB6cygpO3JldHVybiBOdChzLGUsXCJhdHRhY2tcIiksTnQocyxlLFwia25lZVwiKSxOdChzLGUsXCJyYXRpb1wiKSxOdChzLGUsXCJyZWxlYXNlXCIpLE50KHMsZSxcInRocmVzaG9sZFwiKSxzfSk7dmFyIHpzO2NvbnN0IEJzPSgodCxlLHMsbixpLG8scixhKT0+Y2xhc3MgZXh0ZW5kcyB0e2NvbnN0cnVjdG9yKHQsaSl7Y29uc3QgYz1vKHQpLGg9ey4uLmt0LC4uLml9LHU9bihjLGgpLGw9cihjKTtzdXBlcih0LCExLHUsbD9zKCk6bnVsbCksdGhpcy5fYXR0YWNrPWUodGhpcyxsLHUuYXR0YWNrKSx0aGlzLl9rbmVlPWUodGhpcyxsLHUua25lZSksdGhpcy5fbmF0aXZlRHluYW1pY3NDb21wcmVzc29yTm9kZT11LHRoaXMuX3JhdGlvPWUodGhpcyxsLHUucmF0aW8pLHRoaXMuX3JlbGVhc2U9ZSh0aGlzLGwsdS5yZWxlYXNlKSx0aGlzLl90aHJlc2hvbGQ9ZSh0aGlzLGwsdS50aHJlc2hvbGQpLGEodGhpcywuMDA2KX1nZXQgYXR0YWNrKCl7cmV0dXJuIHRoaXMuX2F0dGFja31nZXQgY2hhbm5lbENvdW50KCl7cmV0dXJuIHRoaXMuX25hdGl2ZUR5bmFtaWNzQ29tcHJlc3Nvck5vZGUuY2hhbm5lbENvdW50fXNldCBjaGFubmVsQ291bnQodCl7Y29uc3QgZT10aGlzLl9uYXRpdmVEeW5hbWljc0NvbXByZXNzb3JOb2RlLmNoYW5uZWxDb3VudDtpZih0aGlzLl9uYXRpdmVEeW5hbWljc0NvbXByZXNzb3JOb2RlLmNoYW5uZWxDb3VudD10LHQ+Mil0aHJvdyB0aGlzLl9uYXRpdmVEeW5hbWljc0NvbXByZXNzb3JOb2RlLmNoYW5uZWxDb3VudD1lLGkoKX1nZXQgY2hhbm5lbENvdW50TW9kZSgpe3JldHVybiB0aGlzLl9uYXRpdmVEeW5hbWljc0NvbXByZXNzb3JOb2RlLmNoYW5uZWxDb3VudE1vZGV9c2V0IGNoYW5uZWxDb3VudE1vZGUodCl7Y29uc3QgZT10aGlzLl9uYXRpdmVEeW5hbWljc0NvbXByZXNzb3JOb2RlLmNoYW5uZWxDb3VudE1vZGU7aWYodGhpcy5fbmF0aXZlRHluYW1pY3NDb21wcmVzc29yTm9kZS5jaGFubmVsQ291bnRNb2RlPXQsXCJtYXhcIj09PXQpdGhyb3cgdGhpcy5fbmF0aXZlRHluYW1pY3NDb21wcmVzc29yTm9kZS5jaGFubmVsQ291bnRNb2RlPWUsaSgpfWdldCBrbmVlKCl7cmV0dXJuIHRoaXMuX2tuZWV9Z2V0IHJhdGlvKCl7cmV0dXJuIHRoaXMuX3JhdGlvfWdldCByZWR1Y3Rpb24oKXtyZXR1cm5cIm51bWJlclwiPT10eXBlb2YgdGhpcy5fbmF0aXZlRHluYW1pY3NDb21wcmVzc29yTm9kZS5yZWR1Y3Rpb24udmFsdWU/dGhpcy5fbmF0aXZlRHluYW1pY3NDb21wcmVzc29yTm9kZS5yZWR1Y3Rpb24udmFsdWU6dGhpcy5fbmF0aXZlRHluYW1pY3NDb21wcmVzc29yTm9kZS5yZWR1Y3Rpb259Z2V0IHJlbGVhc2UoKXtyZXR1cm4gdGhpcy5fcmVsZWFzZX1nZXQgdGhyZXNob2xkKCl7cmV0dXJuIHRoaXMuX3RocmVzaG9sZH19KShaZSxwcywoKHQsZSxzLG4saSk9PigpPT57Y29uc3Qgbz1uZXcgV2Vha01hcDtyZXR1cm57cmVuZGVyKHIsYSxjKXtjb25zdCBoPW8uZ2V0KGEpO3JldHVybiB2b2lkIDAhPT1oP1Byb21pc2UucmVzb2x2ZShoKTooYXN5bmMocixhLGMpPT57bGV0IGg9cyhyKTtjb25zdCB1PUUoaCxhKTtpZighdSl7Y29uc3QgdD17YXR0YWNrOmguYXR0YWNrLnZhbHVlLGNoYW5uZWxDb3VudDpoLmNoYW5uZWxDb3VudCxjaGFubmVsQ291bnRNb2RlOmguY2hhbm5lbENvdW50TW9kZSxjaGFubmVsSW50ZXJwcmV0YXRpb246aC5jaGFubmVsSW50ZXJwcmV0YXRpb24sa25lZTpoLmtuZWUudmFsdWUscmF0aW86aC5yYXRpby52YWx1ZSxyZWxlYXNlOmgucmVsZWFzZS52YWx1ZSx0aHJlc2hvbGQ6aC50aHJlc2hvbGQudmFsdWV9O2g9ZShhLHQpfXJldHVybiBvLnNldChhLGgpLHU/KGF3YWl0IHQoYSxyLmF0dGFjayxoLmF0dGFjayxjKSxhd2FpdCB0KGEsci5rbmVlLGgua25lZSxjKSxhd2FpdCB0KGEsci5yYXRpbyxoLnJhdGlvLGMpLGF3YWl0IHQoYSxyLnJlbGVhc2UsaC5yZWxlYXNlLGMpLGF3YWl0IHQoYSxyLnRocmVzaG9sZCxoLnRocmVzaG9sZCxjKSk6KGF3YWl0IG4oYSxyLmF0dGFjayxoLmF0dGFjayxjKSxhd2FpdCBuKGEsci5rbmVlLGgua25lZSxjKSxhd2FpdCBuKGEsci5yYXRpbyxoLnJhdGlvLGMpLGF3YWl0IG4oYSxyLnJlbGVhc2UsaC5yZWxlYXNlLGMpLGF3YWl0IG4oYSxyLnRocmVzaG9sZCxoLnRocmVzaG9sZCxjKSksYXdhaXQgaShyLGEsaCxjKSxofSkocixhLGMpfX19KShhcyxMcyxzdCx1cyxPZSksTHMsSHQsRmUsTmUsZ3MpLFdzPSgodCxlLHMsbixpLG8pPT5jbGFzcyBleHRlbmRzIHR7Y29uc3RydWN0b3IodCxyKXtjb25zdCBhPWkodCksYz17Li4uQ3QsLi4ucn0saD1uKGEsYyksdT1vKGEpO3N1cGVyKHQsITEsaCx1P3MoKTpudWxsKSx0aGlzLl9nYWluPWUodGhpcyx1LGguZ2FpbixOLFYpfWdldCBnYWluKCl7cmV0dXJuIHRoaXMuX2dhaW59fSkoWmUscHMsKCh0LGUscyxuLGkpPT4oKT0+e2NvbnN0IG89bmV3IFdlYWtNYXA7cmV0dXJue3JlbmRlcihyLGEsYyl7Y29uc3QgaD1vLmdldChhKTtyZXR1cm4gdm9pZCAwIT09aD9Qcm9taXNlLnJlc29sdmUoaCk6KGFzeW5jKHIsYSxjKT0+e2xldCBoPXMocik7Y29uc3QgdT1FKGgsYSk7aWYoIXUpe2NvbnN0IHQ9e2NoYW5uZWxDb3VudDpoLmNoYW5uZWxDb3VudCxjaGFubmVsQ291bnRNb2RlOmguY2hhbm5lbENvdW50TW9kZSxjaGFubmVsSW50ZXJwcmV0YXRpb246aC5jaGFubmVsSW50ZXJwcmV0YXRpb24sZ2FpbjpoLmdhaW4udmFsdWV9O2g9ZShhLHQpfXJldHVybiBvLnNldChhLGgpLHU/YXdhaXQgdChhLHIuZ2FpbixoLmdhaW4sYyk6YXdhaXQgbihhLHIuZ2FpbixoLmdhaW4sYyksYXdhaXQgaShyLGEsaCxjKSxofSkocixhLGMpfX19KShhcyxRdCxzdCx1cyxPZSksUXQsRmUsTmUpLEdzPSgodCxlLHMsbik9PihpLG8se2NoYW5uZWxDb3VudDpyLGNoYW5uZWxDb3VudE1vZGU6YSxjaGFubmVsSW50ZXJwcmV0YXRpb246YyxmZWVkYmFjazpoLGZlZWRmb3J3YXJkOnV9KT0+e2NvbnN0IGw9THQobyxpLnNhbXBsZVJhdGUpLHA9aCBpbnN0YW5jZW9mIEZsb2F0NjRBcnJheT9oOm5ldyBGbG9hdDY0QXJyYXkoaCksZD11IGluc3RhbmNlb2YgRmxvYXQ2NEFycmF5P3U6bmV3IEZsb2F0NjRBcnJheSh1KSxmPXAubGVuZ3RoLF89ZC5sZW5ndGgsbT1NYXRoLm1pbihmLF8pO2lmKDA9PT1mfHxmPjIwKXRocm93IG4oKTtpZigwPT09cFswXSl0aHJvdyBlKCk7aWYoMD09PV98fF8+MjApdGhyb3cgbigpO2lmKDA9PT1kWzBdKXRocm93IGUoKTtpZigxIT09cFswXSl7Zm9yKGxldCB0PTA7dDxfO3QrPTEpZFt0XS89cFswXTtmb3IobGV0IHQ9MTt0PGY7dCs9MSlwW3RdLz1wWzBdfWNvbnN0IGc9cyhpLGwscixyKTtnLmNoYW5uZWxDb3VudD1yLGcuY2hhbm5lbENvdW50TW9kZT1hLGcuY2hhbm5lbEludGVycHJldGF0aW9uPWM7Y29uc3Qgdj1bXSx5PVtdLHg9W107Zm9yKGxldCB0PTA7dDxyO3QrPTEpe3YucHVzaCgwKTtjb25zdCB0PW5ldyBGbG9hdDMyQXJyYXkoMzIpLGU9bmV3IEZsb2F0MzJBcnJheSgzMik7dC5maWxsKDApLGUuZmlsbCgwKSx5LnB1c2godCkseC5wdXNoKGUpfWcub25hdWRpb3Byb2Nlc3M9dD0+e2NvbnN0IGU9dC5pbnB1dEJ1ZmZlcixzPXQub3V0cHV0QnVmZmVyLG49ZS5udW1iZXJPZkNoYW5uZWxzO2ZvcihsZXQgdD0wO3Q8bjt0Kz0xKXtjb25zdCBuPWUuZ2V0Q2hhbm5lbERhdGEodCksaT1zLmdldENoYW5uZWxEYXRhKHQpO3ZbdF09TXQocCxmLGQsXyxtLHlbdF0seFt0XSx2W3RdLDMyLG4saSl9fTtjb25zdCB3PWkuc2FtcGxlUmF0ZS8yO3JldHVybiBHdCh7Z2V0IGJ1ZmZlclNpemUoKXtyZXR1cm4gbH0sZ2V0IGNoYW5uZWxDb3VudCgpe3JldHVybiBnLmNoYW5uZWxDb3VudH0sc2V0IGNoYW5uZWxDb3VudCh0KXtnLmNoYW5uZWxDb3VudD10fSxnZXQgY2hhbm5lbENvdW50TW9kZSgpe3JldHVybiBnLmNoYW5uZWxDb3VudE1vZGV9LHNldCBjaGFubmVsQ291bnRNb2RlKHQpe2cuY2hhbm5lbENvdW50TW9kZT10fSxnZXQgY2hhbm5lbEludGVycHJldGF0aW9uKCl7cmV0dXJuIGcuY2hhbm5lbEludGVycHJldGF0aW9ufSxzZXQgY2hhbm5lbEludGVycHJldGF0aW9uKHQpe2cuY2hhbm5lbEludGVycHJldGF0aW9uPXR9LGdldCBjb250ZXh0KCl7cmV0dXJuIGcuY29udGV4dH0sZ2V0IGlucHV0cygpe3JldHVybltnXX0sZ2V0IG51bWJlck9mSW5wdXRzKCl7cmV0dXJuIGcubnVtYmVyT2ZJbnB1dHN9LGdldCBudW1iZXJPZk91dHB1dHMoKXtyZXR1cm4gZy5udW1iZXJPZk91dHB1dHN9LGFkZEV2ZW50TGlzdGVuZXI6KC4uLnQpPT5nLmFkZEV2ZW50TGlzdGVuZXIodFswXSx0WzFdLHRbMl0pLGRpc3BhdGNoRXZlbnQ6KC4uLnQpPT5nLmRpc3BhdGNoRXZlbnQodFswXSksZ2V0RnJlcXVlbmN5UmVzcG9uc2UoZSxzLG4pe2lmKGUubGVuZ3RoIT09cy5sZW5ndGh8fHMubGVuZ3RoIT09bi5sZW5ndGgpdGhyb3cgdCgpO2NvbnN0IGk9ZS5sZW5ndGg7Zm9yKGxldCB0PTA7dDxpO3QrPTEpe2NvbnN0IGk9LU1hdGguUEkqKGVbdF0vdyksbz1bTWF0aC5jb3MoaSksTWF0aC5zaW4oaSldLHI9WnQoWHQoZCxvKSxYdChwLG8pKTtzW3RdPU1hdGguc3FydChyWzBdKnJbMF0rclsxXSpyWzFdKSxuW3RdPU1hdGguYXRhbjIoclsxXSxyWzBdKX19LHJlbW92ZUV2ZW50TGlzdGVuZXI6KC4uLnQpPT5nLnJlbW92ZUV2ZW50TGlzdGVuZXIodFswXSx0WzFdLHRbMl0pfSxnKX0pKER0LEF0LFl0LEh0KSxVcz0oKHQsZSxzLG4pPT5pPT50KFJ0LCgpPT5SdChpKSk/UHJvbWlzZS5yZXNvbHZlKHQobixuKSkudGhlbih0PT57aWYoIXQpe2NvbnN0IHQ9cyhpLDUxMiwwLDEpO2kub25jb21wbGV0ZT0oKT0+e3Qub25hdWRpb3Byb2Nlc3M9bnVsbCx0LmRpc2Nvbm5lY3QoKX0sdC5vbmF1ZGlvcHJvY2Vzcz0oKT0+aS5jdXJyZW50VGltZSx0LmNvbm5lY3QoaS5kZXN0aW5hdGlvbil9cmV0dXJuIGkuc3RhcnRSZW5kZXJpbmcoKX0pOm5ldyBQcm9taXNlKHQ9Pntjb25zdCBzPWUoaSx7Y2hhbm5lbENvdW50OjEsY2hhbm5lbENvdW50TW9kZTpcImV4cGxpY2l0XCIsY2hhbm5lbEludGVycHJldGF0aW9uOlwiZGlzY3JldGVcIixnYWluOjB9KTtpLm9uY29tcGxldGU9ZT0+e3MuZGlzY29ubmVjdCgpLHQoZS5yZW5kZXJlZEJ1ZmZlcil9LHMuY29ubmVjdChpLmRlc3RpbmF0aW9uKSxpLnN0YXJ0UmVuZGVyaW5nKCl9KSkoeGUsUXQsWXQsKCh0LGUpPT4oKT0+e2lmKG51bGw9PT1lKXJldHVybiBQcm9taXNlLnJlc29sdmUoITEpO2NvbnN0IHM9bmV3IGUoMSwxLDQ0MTAwKSxuPXQocyx7Y2hhbm5lbENvdW50OjEsY2hhbm5lbENvdW50TW9kZTpcImV4cGxpY2l0XCIsY2hhbm5lbEludGVycHJldGF0aW9uOlwiZGlzY3JldGVcIixnYWluOjB9KTtyZXR1cm4gbmV3IFByb21pc2UodD0+e3Mub25jb21wbGV0ZT0oKT0+e24uZGlzY29ubmVjdCgpLHQoMCE9PXMuY3VycmVudFRpbWUpfSxzLnN0YXJ0UmVuZGVyaW5nKCl9KX0pKFF0LFZlKSksUXM9KCh0LGUscyxuLGkpPT4obyxyKT0+e2NvbnN0IGE9bmV3IFdlYWtNYXA7bGV0IGM9bnVsbDtjb25zdCBoPWFzeW5jKGgsdSxsKT0+e2xldCBwPW51bGwsZD1lKGgpO2NvbnN0IGY9RShkLHUpO2lmKHZvaWQgMD09PXUuY3JlYXRlSUlSRmlsdGVyP3A9dCh1LHtidWZmZXI6bnVsbCxjaGFubmVsQ291bnQ6MixjaGFubmVsQ291bnRNb2RlOlwibWF4XCIsY2hhbm5lbEludGVycHJldGF0aW9uOlwic3BlYWtlcnNcIixsb29wOiExLGxvb3BFbmQ6MCxsb29wU3RhcnQ6MCxwbGF5YmFja1JhdGU6MX0pOmZ8fChkPXUuY3JlYXRlSUlSRmlsdGVyKHIsbykpLGEuc2V0KHUsbnVsbD09PXA/ZDpwKSxudWxsIT09cCl7aWYobnVsbD09PWMpe2lmKG51bGw9PT1zKXRocm93IG5ldyBFcnJvcihcIk1pc3NpbmcgdGhlIG5hdGl2ZSBPZmZsaW5lQXVkaW9Db250ZXh0IGNvbnN0cnVjdG9yLlwiKTtjb25zdCB0PW5ldyBzKGguY29udGV4dC5kZXN0aW5hdGlvbi5jaGFubmVsQ291bnQsaC5jb250ZXh0Lmxlbmd0aCx1LnNhbXBsZVJhdGUpO2M9KGFzeW5jKCk9Pnthd2FpdCBuKGgsdCx0LmRlc3RpbmF0aW9uLGwpO3JldHVybigodCxlLHMsbik9Pntjb25zdCBpPXMgaW5zdGFuY2VvZiBGbG9hdDY0QXJyYXk/czpuZXcgRmxvYXQ2NEFycmF5KHMpLG89biBpbnN0YW5jZW9mIEZsb2F0NjRBcnJheT9uOm5ldyBGbG9hdDY0QXJyYXkobikscj1pLmxlbmd0aCxhPW8ubGVuZ3RoLGM9TWF0aC5taW4ocixhKTtpZigxIT09aVswXSl7Zm9yKGxldCB0PTA7dDxyO3QrPTEpb1t0XS89aVswXTtmb3IobGV0IHQ9MTt0PGE7dCs9MSlpW3RdLz1pWzBdfWNvbnN0IGg9bmV3IEZsb2F0MzJBcnJheSgzMiksdT1uZXcgRmxvYXQzMkFycmF5KDMyKSxsPWUuY3JlYXRlQnVmZmVyKHQubnVtYmVyT2ZDaGFubmVscyx0Lmxlbmd0aCx0LnNhbXBsZVJhdGUpLHA9dC5udW1iZXJPZkNoYW5uZWxzO2ZvcihsZXQgZT0wO2U8cDtlKz0xKXtjb25zdCBzPXQuZ2V0Q2hhbm5lbERhdGEoZSksbj1sLmdldENoYW5uZWxEYXRhKGUpO2guZmlsbCgwKSx1LmZpbGwoMCksTXQoaSxyLG8sYSxjLGgsdSwwLDMyLHMsbil9cmV0dXJuIGx9KShhd2FpdCBpKHQpLHUsbyxyKX0pKCl9Y29uc3QgdD1hd2FpdCBjO3JldHVybiBwLmJ1ZmZlcj10LHAuc3RhcnQoMCkscH1yZXR1cm4gYXdhaXQgbihoLHUsZCxsKSxkfTtyZXR1cm57cmVuZGVyKHQsZSxzKXtjb25zdCBuPWEuZ2V0KGUpO3JldHVybiB2b2lkIDAhPT1uP1Byb21pc2UucmVzb2x2ZShuKTpoKHQsZSxzKX19fSkoY3Msc3QsVmUsT2UsVXMpO3ZhciBacztjb25zdCBYcz0oKHQsZSxzLG4saSxvKT0+Y2xhc3MgZXh0ZW5kcyB0e2NvbnN0cnVjdG9yKHQscil7Y29uc3QgYT1uKHQpLGM9aShhKSxoPXsuLi5PdCwuLi5yfSx1PWUoYSxjP251bGw6dC5iYXNlTGF0ZW5jeSxoKTtzdXBlcih0LCExLHUsYz9zKGguZmVlZGJhY2ssaC5mZWVkZm9yd2FyZCk6bnVsbCksKHQ9Pnt2YXIgZTt0LmdldEZyZXF1ZW5jeVJlc3BvbnNlPShlPXQuZ2V0RnJlcXVlbmN5UmVzcG9uc2UsKHMsbixpKT0+e2lmKHMubGVuZ3RoIT09bi5sZW5ndGh8fG4ubGVuZ3RoIT09aS5sZW5ndGgpdGhyb3cgRHQoKTtyZXR1cm4gZS5jYWxsKHQscyxuLGkpfSl9KSh1KSx0aGlzLl9uYXRpdmVJSVJGaWx0ZXJOb2RlPXUsbyh0aGlzLDEpfWdldEZyZXF1ZW5jeVJlc3BvbnNlKHQsZSxzKXtyZXR1cm4gdGhpcy5fbmF0aXZlSUlSRmlsdGVyTm9kZS5nZXRGcmVxdWVuY3lSZXNwb25zZSh0LGUscyl9fSkoWmUsKFpzPUdzLCh0LGUscyk9PntpZih2b2lkIDA9PT10LmNyZWF0ZUlJUkZpbHRlcilyZXR1cm4gWnModCxlLHMpO2NvbnN0IG49dC5jcmVhdGVJSVJGaWx0ZXIocy5mZWVkZm9yd2FyZCxzLmZlZWRiYWNrKTtyZXR1cm4gSXQobixzKSxufSksUXMsRmUsTmUsZ3MpLFlzPSgodCxlLHMsbixpKT0+KG8scik9Pntjb25zdCBhPXIubGlzdGVuZXIse2ZvcndhcmRYOmMsZm9yd2FyZFk6aCxmb3J3YXJkWjp1LHBvc2l0aW9uWDpsLHBvc2l0aW9uWTpwLHBvc2l0aW9uWjpkLHVwWDpmLHVwWTpfLHVwWjptfT12b2lkIDA9PT1hLmZvcndhcmRYPygoKT0+e2NvbnN0IGM9ZShyLHtjaGFubmVsQ291bnQ6MSxjaGFubmVsQ291bnRNb2RlOlwiZXhwbGljaXRcIixjaGFubmVsSW50ZXJwcmV0YXRpb246XCJzcGVha2Vyc1wiLG51bWJlck9mSW5wdXRzOjl9KSxoPWkociksdT1uKHIsMjU2LDksMCksbD0oZSxuKT0+e2NvbnN0IGk9cyhyLHtjaGFubmVsQ291bnQ6MSxjaGFubmVsQ291bnRNb2RlOlwiZXhwbGljaXRcIixjaGFubmVsSW50ZXJwcmV0YXRpb246XCJkaXNjcmV0ZVwiLG9mZnNldDpufSk7cmV0dXJuIGkuY29ubmVjdChjLDAsZSksaS5zdGFydCgpLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShpLm9mZnNldCxcImRlZmF1bHRWYWx1ZVwiLHtnZXQ6KCk9Pm59KSx0KHtjb250ZXh0Om99LGgsaS5vZmZzZXQsTixWKX07bGV0IHA9WzAsMCwtMSwwLDEsMF0sZD1bMCwwLDBdO3JldHVybiB1Lm9uYXVkaW9wcm9jZXNzPSh7aW5wdXRCdWZmZXI6dH0pPT57Y29uc3QgZT1bdC5nZXRDaGFubmVsRGF0YSgwKVswXSx0LmdldENoYW5uZWxEYXRhKDEpWzBdLHQuZ2V0Q2hhbm5lbERhdGEoMilbMF0sdC5nZXRDaGFubmVsRGF0YSgzKVswXSx0LmdldENoYW5uZWxEYXRhKDQpWzBdLHQuZ2V0Q2hhbm5lbERhdGEoNSlbMF1dO2Uuc29tZSgodCxlKT0+dCE9PXBbZV0pJiYoYS5zZXRPcmllbnRhdGlvbiguLi5lKSxwPWUpO2NvbnN0IHM9W3QuZ2V0Q2hhbm5lbERhdGEoNilbMF0sdC5nZXRDaGFubmVsRGF0YSg3KVswXSx0LmdldENoYW5uZWxEYXRhKDgpWzBdXTtzLnNvbWUoKHQsZSk9PnQhPT1kW2VdKSYmKGEuc2V0UG9zaXRpb24oLi4ucyksZD1zKX0sYy5jb25uZWN0KHUpLHtmb3J3YXJkWDpsKDAsMCksZm9yd2FyZFk6bCgxLDApLGZvcndhcmRaOmwoMiwtMSkscG9zaXRpb25YOmwoNiwwKSxwb3NpdGlvblk6bCg3LDApLHBvc2l0aW9uWjpsKDgsMCksdXBYOmwoMywwKSx1cFk6bCg0LDEpLHVwWjpsKDUsMCl9fSkoKTphO3JldHVybntnZXQgZm9yd2FyZFgoKXtyZXR1cm4gY30sZ2V0IGZvcndhcmRZKCl7cmV0dXJuIGh9LGdldCBmb3J3YXJkWigpe3JldHVybiB1fSxnZXQgcG9zaXRpb25YKCl7cmV0dXJuIGx9LGdldCBwb3NpdGlvblkoKXtyZXR1cm4gcH0sZ2V0IHBvc2l0aW9uWigpe3JldHVybiBkfSxnZXQgdXBYKCl7cmV0dXJuIGZ9LGdldCB1cFkoKXtyZXR1cm4gX30sZ2V0IHVwWigpe3JldHVybiBtfX19KShwcyxFcyxJcyxZdCxOZSksSHM9bmV3IFdlYWtNYXAsJHM9KCh0LGUscyxuLGksbyk9PmNsYXNzIGV4dGVuZHMgc3tjb25zdHJ1Y3RvcihzLG8pe3N1cGVyKHMpLHRoaXMuX25hdGl2ZUNvbnRleHQ9cyxwLnNldCh0aGlzLHMpLG4ocykmJmkuc2V0KHMsbmV3IFNldCksdGhpcy5fZGVzdGluYXRpb249bmV3IHQodGhpcyxvKSx0aGlzLl9saXN0ZW5lcj1lKHRoaXMscyksdGhpcy5fb25zdGF0ZWNoYW5nZT1udWxsfWdldCBjdXJyZW50VGltZSgpe3JldHVybiB0aGlzLl9uYXRpdmVDb250ZXh0LmN1cnJlbnRUaW1lfWdldCBkZXN0aW5hdGlvbigpe3JldHVybiB0aGlzLl9kZXN0aW5hdGlvbn1nZXQgbGlzdGVuZXIoKXtyZXR1cm4gdGhpcy5fbGlzdGVuZXJ9Z2V0IG9uc3RhdGVjaGFuZ2UoKXtyZXR1cm4gdGhpcy5fb25zdGF0ZWNoYW5nZX1zZXQgb25zdGF0ZWNoYW5nZSh0KXtjb25zdCBlPVwiZnVuY3Rpb25cIj09dHlwZW9mIHQ/byh0aGlzLHQpOm51bGw7dGhpcy5fbmF0aXZlQ29udGV4dC5vbnN0YXRlY2hhbmdlPWU7Y29uc3Qgcz10aGlzLl9uYXRpdmVDb250ZXh0Lm9uc3RhdGVjaGFuZ2U7dGhpcy5fb25zdGF0ZWNoYW5nZT1udWxsIT09cyYmcz09PWU/dDpzfWdldCBzYW1wbGVSYXRlKCl7cmV0dXJuIHRoaXMuX25hdGl2ZUNvbnRleHQuc2FtcGxlUmF0ZX1nZXQgc3RhdGUoKXtyZXR1cm4gdGhpcy5fbmF0aXZlQ29udGV4dC5zdGF0ZX19KShfcyxZcyxMZSxOZSxIcyxkZSksSnM9KCh0LGUscyxuLGksbyk9PihyLGEpPT57Y29uc3QgYz1yLmNyZWF0ZU9zY2lsbGF0b3IoKTtyZXR1cm4gSXQoYyxhKSxOdChjLGEsXCJkZXR1bmVcIiksTnQoYyxhLFwiZnJlcXVlbmN5XCIpLHZvaWQgMCE9PWEucGVyaW9kaWNXYXZlP2Muc2V0UGVyaW9kaWNXYXZlKGEucGVyaW9kaWNXYXZlKTpGdChjLGEsXCJ0eXBlXCIpLGUocywoKT0+cyhyKSl8fFB0KGMpLGUobiwoKT0+bihyKSl8fG8oYyxyKSxlKGksKCk9PmkocikpfHxqdChjKSx0KHIsYyksY30pKGlzLHhlLGFlLGNlLGhlLHBlKSxLcz0oKHQsZSxzLG4saSxvLHIpPT5jbGFzcyBleHRlbmRzIHR7Y29uc3RydWN0b3IodCxyKXtjb25zdCBhPWkodCksYz17Li4uSnQsLi4ucn0saD1zKGEsYyksdT1vKGEpLGw9dT9uKCk6bnVsbCxwPXQuc2FtcGxlUmF0ZS8yO3N1cGVyKHQsITEsaCxsKSx0aGlzLl9kZXR1bmU9ZSh0aGlzLHUsaC5kZXR1bmUsMTUzNjAwLC0xNTM2MDApLHRoaXMuX2ZyZXF1ZW5jeT1lKHRoaXMsdSxoLmZyZXF1ZW5jeSxwLC1wKSx0aGlzLl9uYXRpdmVPc2NpbGxhdG9yTm9kZT1oLHRoaXMuX29uZW5kZWQ9bnVsbCx0aGlzLl9vc2NpbGxhdG9yTm9kZVJlbmRlcmVyPWwsbnVsbCE9PXRoaXMuX29zY2lsbGF0b3JOb2RlUmVuZGVyZXImJnZvaWQgMCE9PWMucGVyaW9kaWNXYXZlJiYodGhpcy5fb3NjaWxsYXRvck5vZGVSZW5kZXJlci5wZXJpb2RpY1dhdmU9Yy5wZXJpb2RpY1dhdmUpfWdldCBkZXR1bmUoKXtyZXR1cm4gdGhpcy5fZGV0dW5lfWdldCBmcmVxdWVuY3koKXtyZXR1cm4gdGhpcy5fZnJlcXVlbmN5fWdldCBvbmVuZGVkKCl7cmV0dXJuIHRoaXMuX29uZW5kZWR9c2V0IG9uZW5kZWQodCl7Y29uc3QgZT1cImZ1bmN0aW9uXCI9PXR5cGVvZiB0P3IodGhpcyx0KTpudWxsO3RoaXMuX25hdGl2ZU9zY2lsbGF0b3JOb2RlLm9uZW5kZWQ9ZTtjb25zdCBzPXRoaXMuX25hdGl2ZU9zY2lsbGF0b3JOb2RlLm9uZW5kZWQ7dGhpcy5fb25lbmRlZD1udWxsIT09cyYmcz09PWU/dDpzfWdldCB0eXBlKCl7cmV0dXJuIHRoaXMuX25hdGl2ZU9zY2lsbGF0b3JOb2RlLnR5cGV9c2V0IHR5cGUodCl7dGhpcy5fbmF0aXZlT3NjaWxsYXRvck5vZGUudHlwZT10LG51bGwhPT10aGlzLl9vc2NpbGxhdG9yTm9kZVJlbmRlcmVyJiYodGhpcy5fb3NjaWxsYXRvck5vZGVSZW5kZXJlci5wZXJpb2RpY1dhdmU9bnVsbCl9c2V0UGVyaW9kaWNXYXZlKHQpe3RoaXMuX25hdGl2ZU9zY2lsbGF0b3JOb2RlLnNldFBlcmlvZGljV2F2ZSh0KSxudWxsIT09dGhpcy5fb3NjaWxsYXRvck5vZGVSZW5kZXJlciYmKHRoaXMuX29zY2lsbGF0b3JOb2RlUmVuZGVyZXIucGVyaW9kaWNXYXZlPXQpfXN0YXJ0KHQ9MCl7aWYodGhpcy5fbmF0aXZlT3NjaWxsYXRvck5vZGUuc3RhcnQodCksbnVsbCE9PXRoaXMuX29zY2lsbGF0b3JOb2RlUmVuZGVyZXImJih0aGlzLl9vc2NpbGxhdG9yTm9kZVJlbmRlcmVyLnN0YXJ0PXQpLFwiY2xvc2VkXCIhPT10aGlzLmNvbnRleHQuc3RhdGUpe0ModGhpcyk7Y29uc3QgdD0oKT0+e3RoaXMuX25hdGl2ZU9zY2lsbGF0b3JOb2RlLnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJlbmRlZFwiLHQpLFAodGhpcykmJkQodGhpcyl9O3RoaXMuX25hdGl2ZU9zY2lsbGF0b3JOb2RlLmFkZEV2ZW50TGlzdGVuZXIoXCJlbmRlZFwiLHQpfX1zdG9wKHQ9MCl7dGhpcy5fbmF0aXZlT3NjaWxsYXRvck5vZGUuc3RvcCh0KSxudWxsIT09dGhpcy5fb3NjaWxsYXRvck5vZGVSZW5kZXJlciYmKHRoaXMuX29zY2lsbGF0b3JOb2RlUmVuZGVyZXIuc3RvcD10KX19KShaZSxwcyxKcywoKHQsZSxzLG4saSk9PigpPT57Y29uc3Qgbz1uZXcgV2Vha01hcDtsZXQgcj1udWxsLGE9bnVsbCxjPW51bGw7cmV0dXJue3NldCBwZXJpb2RpY1dhdmUodCl7cj10fSxzZXQgc3RhcnQodCl7YT10fSxzZXQgc3RvcCh0KXtjPXR9LHJlbmRlcihoLHUsbCl7Y29uc3QgcD1vLmdldCh1KTtyZXR1cm4gdm9pZCAwIT09cD9Qcm9taXNlLnJlc29sdmUocCk6KGFzeW5jKGgsdSxsKT0+e2xldCBwPXMoaCk7Y29uc3QgZD1FKHAsdSk7aWYoIWQpe2NvbnN0IHQ9e2NoYW5uZWxDb3VudDpwLmNoYW5uZWxDb3VudCxjaGFubmVsQ291bnRNb2RlOnAuY2hhbm5lbENvdW50TW9kZSxjaGFubmVsSW50ZXJwcmV0YXRpb246cC5jaGFubmVsSW50ZXJwcmV0YXRpb24sZGV0dW5lOnAuZGV0dW5lLnZhbHVlLGZyZXF1ZW5jeTpwLmZyZXF1ZW5jeS52YWx1ZSxwZXJpb2RpY1dhdmU6bnVsbD09PXI/dm9pZCAwOnIsdHlwZTpwLnR5cGV9O3A9ZSh1LHQpLG51bGwhPT1hJiZwLnN0YXJ0KGEpLG51bGwhPT1jJiZwLnN0b3AoYyl9cmV0dXJuIG8uc2V0KHUscCksZD8oYXdhaXQgdCh1LGguZGV0dW5lLHAuZGV0dW5lLGwpLGF3YWl0IHQodSxoLmZyZXF1ZW5jeSxwLmZyZXF1ZW5jeSxsKSk6KGF3YWl0IG4odSxoLmRldHVuZSxwLmRldHVuZSxsKSxhd2FpdCBuKHUsaC5mcmVxdWVuY3kscC5mcmVxdWVuY3ksbCkpLGF3YWl0IGkoaCx1LHAsbCkscH0pKGgsdSxsKX19fSkoYXMsSnMsc3QsdXMsT2UpLEZlLE5lLGRlKSx0bj0oZW49Y3MsKHQsZSk9Pntjb25zdCBzPWVuKHQse2J1ZmZlcjpudWxsLGNoYW5uZWxDb3VudDoyLGNoYW5uZWxDb3VudE1vZGU6XCJtYXhcIixjaGFubmVsSW50ZXJwcmV0YXRpb246XCJzcGVha2Vyc1wiLGxvb3A6ITEsbG9vcEVuZDowLGxvb3BTdGFydDowLHBsYXliYWNrUmF0ZToxfSksbj10LmNyZWF0ZUJ1ZmZlcigxLDIsNDQxMDApO3JldHVybiBzLmJ1ZmZlcj1uLHMubG9vcD0hMCxzLmNvbm5lY3QoZSkscy5zdGFydCgpLCgpPT57cy5zdG9wKCkscy5kaXNjb25uZWN0KGUpfX0pO3ZhciBlbjtjb25zdCBzbj0oKHQsZSxzLG4saSk9PihvLHtjdXJ2ZTpyLG92ZXJzYW1wbGU6YSwuLi5jfSk9Pntjb25zdCBoPW8uY3JlYXRlV2F2ZVNoYXBlcigpLHU9by5jcmVhdGVXYXZlU2hhcGVyKCk7SXQoaCxjKSxJdCh1LGMpO2NvbnN0IGw9cyhvLHsuLi5jLGdhaW46MX0pLHA9cyhvLHsuLi5jLGdhaW46LTF9KSxkPXMobyx7Li4uYyxnYWluOjF9KSxmPXMobyx7Li4uYyxnYWluOi0xfSk7bGV0IF89bnVsbCxtPSExLGc9bnVsbDtjb25zdCB2PXtnZXQgYnVmZmVyU2l6ZSgpe30sZ2V0IGNoYW5uZWxDb3VudCgpe3JldHVybiBoLmNoYW5uZWxDb3VudH0sc2V0IGNoYW5uZWxDb3VudCh0KXtsLmNoYW5uZWxDb3VudD10LHAuY2hhbm5lbENvdW50PXQsaC5jaGFubmVsQ291bnQ9dCxkLmNoYW5uZWxDb3VudD10LHUuY2hhbm5lbENvdW50PXQsZi5jaGFubmVsQ291bnQ9dH0sZ2V0IGNoYW5uZWxDb3VudE1vZGUoKXtyZXR1cm4gaC5jaGFubmVsQ291bnRNb2RlfSxzZXQgY2hhbm5lbENvdW50TW9kZSh0KXtsLmNoYW5uZWxDb3VudE1vZGU9dCxwLmNoYW5uZWxDb3VudE1vZGU9dCxoLmNoYW5uZWxDb3VudE1vZGU9dCxkLmNoYW5uZWxDb3VudE1vZGU9dCx1LmNoYW5uZWxDb3VudE1vZGU9dCxmLmNoYW5uZWxDb3VudE1vZGU9dH0sZ2V0IGNoYW5uZWxJbnRlcnByZXRhdGlvbigpe3JldHVybiBoLmNoYW5uZWxJbnRlcnByZXRhdGlvbn0sc2V0IGNoYW5uZWxJbnRlcnByZXRhdGlvbih0KXtsLmNoYW5uZWxJbnRlcnByZXRhdGlvbj10LHAuY2hhbm5lbEludGVycHJldGF0aW9uPXQsaC5jaGFubmVsSW50ZXJwcmV0YXRpb249dCxkLmNoYW5uZWxJbnRlcnByZXRhdGlvbj10LHUuY2hhbm5lbEludGVycHJldGF0aW9uPXQsZi5jaGFubmVsSW50ZXJwcmV0YXRpb249dH0sZ2V0IGNvbnRleHQoKXtyZXR1cm4gaC5jb250ZXh0fSxnZXQgY3VydmUoKXtyZXR1cm4gZ30sc2V0IGN1cnZlKHMpe2lmKG51bGwhPT1zJiZzLmxlbmd0aDwyKXRocm93IGUoKTtpZihudWxsPT09cyloLmN1cnZlPXMsdS5jdXJ2ZT1zO2Vsc2V7Y29uc3QgdD1zLmxlbmd0aCxlPW5ldyBGbG9hdDMyQXJyYXkodCsyLXQlMiksbj1uZXcgRmxvYXQzMkFycmF5KHQrMi10JTIpO2VbMF09c1swXSxuWzBdPS1zW3QtMV07Y29uc3QgaT1NYXRoLmNlaWwoKHQrMSkvMiksbz0odCsxKS8yLTE7Zm9yKGxldCByPTE7cjxpO3IrPTEpe2NvbnN0IGE9ci9pKm8sYz1NYXRoLmZsb29yKGEpLGg9TWF0aC5jZWlsKGEpO2Vbcl09Yz09PWg/c1tjXTooMS0oYS1jKSkqc1tjXSsoMS0oaC1hKSkqc1toXSxuW3JdPWM9PT1oPy1zW3QtMS1jXTotKDEtKGEtYykpKnNbdC0xLWNdLSgxLShoLWEpKSpzW3QtMS1oXX1lW2ldPXQlMj09MT9zW2ktMV06KHNbaS0yXStzW2ktMV0pLzIsaC5jdXJ2ZT1lLHUuY3VydmU9bn1nPXMsbSYmKG4oZykmJm51bGw9PT1fP189dChvLGwpOm51bGwhPT1fJiYoXygpLF89bnVsbCkpfSxnZXQgaW5wdXRzKCl7cmV0dXJuW2xdfSxnZXQgbnVtYmVyT2ZJbnB1dHMoKXtyZXR1cm4gaC5udW1iZXJPZklucHV0c30sZ2V0IG51bWJlck9mT3V0cHV0cygpe3JldHVybiBoLm51bWJlck9mT3V0cHV0c30sZ2V0IG92ZXJzYW1wbGUoKXtyZXR1cm4gaC5vdmVyc2FtcGxlfSxzZXQgb3ZlcnNhbXBsZSh0KXtoLm92ZXJzYW1wbGU9dCx1Lm92ZXJzYW1wbGU9dH0sYWRkRXZlbnRMaXN0ZW5lcjooLi4udCk9PmwuYWRkRXZlbnRMaXN0ZW5lcih0WzBdLHRbMV0sdFsyXSksZGlzcGF0Y2hFdmVudDooLi4udCk9PmwuZGlzcGF0Y2hFdmVudCh0WzBdKSxyZW1vdmVFdmVudExpc3RlbmVyOiguLi50KT0+bC5yZW1vdmVFdmVudExpc3RlbmVyKHRbMF0sdFsxXSx0WzJdKX07bnVsbCE9PXImJih2LmN1cnZlPXIgaW5zdGFuY2VvZiBGbG9hdDMyQXJyYXk/cjpuZXcgRmxvYXQzMkFycmF5KHIpKSxhIT09di5vdmVyc2FtcGxlJiYodi5vdmVyc2FtcGxlPWEpO3JldHVybiBpKEd0KHYsZCksKCk9PntsLmNvbm5lY3QoaCkuY29ubmVjdChkKSxsLmNvbm5lY3QocCkuY29ubmVjdCh1KS5jb25uZWN0KGYpLmNvbm5lY3QoZCksbT0hMCxuKGcpJiYoXz10KG8sbCkpfSwoKT0+e2wuZGlzY29ubmVjdChoKSxoLmRpc2Nvbm5lY3QoZCksbC5kaXNjb25uZWN0KHApLHAuZGlzY29ubmVjdCh1KSx1LmRpc2Nvbm5lY3QoZiksZi5kaXNjb25uZWN0KGQpLG09ITEsbnVsbCE9PV8mJihfKCksXz1udWxsKX0pfSkodG4sQXQsUXQsaWUsQXMpLG5uPSgodCxlLHMsbixpLG8scik9PihhLGMpPT57Y29uc3QgaD1hLmNyZWF0ZVdhdmVTaGFwZXIoKTtpZihudWxsIT09byYmXCJ3ZWJraXRBdWRpb0NvbnRleHRcIj09PW8ubmFtZSYmdm9pZCAwPT09YS5jcmVhdGVHYWluKCkuZ2Fpbi5hdXRvbWF0aW9uUmF0ZSlyZXR1cm4gcyhhLGMpO0l0KGgsYyk7Y29uc3QgdT1udWxsPT09Yy5jdXJ2ZXx8Yy5jdXJ2ZSBpbnN0YW5jZW9mIEZsb2F0MzJBcnJheT9jLmN1cnZlOm5ldyBGbG9hdDMyQXJyYXkoYy5jdXJ2ZSk7aWYobnVsbCE9PXUmJnUubGVuZ3RoPDIpdGhyb3cgZSgpO0Z0KGgse2N1cnZlOnV9LFwiY3VydmVcIiksRnQoaCxjLFwib3ZlcnNhbXBsZVwiKTtsZXQgbD1udWxsLHA9ITE7cihoLFwiY3VydmVcIix0PT4oKT0+dC5jYWxsKGgpLGU9PnM9PihlLmNhbGwoaCxzKSxwJiYobihzKSYmbnVsbD09PWw/bD10KGEsaCk6bihzKXx8bnVsbD09PWx8fChsKCksbD1udWxsKSkscykpO3JldHVybiBpKGgsKCk9PntwPSEwLG4oaC5jdXJ2ZSkmJihsPXQoYSxoKSl9LCgpPT57cD0hMSxudWxsIT09bCYmKGwoKSxsPW51bGwpfSl9KSh0bixBdCxzbixpZSxBcyxCZSxvZSksb249KCh0LGUscyxuLGksbyxyLGEsYyk9PihoLHtjb25lSW5uZXJBbmdsZTp1LGNvbmVPdXRlckFuZ2xlOmwsY29uZU91dGVyR2FpbjpwLGRpc3RhbmNlTW9kZWw6ZCxtYXhEaXN0YW5jZTpmLG9yaWVudGF0aW9uWDpfLG9yaWVudGF0aW9uWTptLG9yaWVudGF0aW9uWjpnLHBhbm5pbmdNb2RlbDp2LHBvc2l0aW9uWDp5LHBvc2l0aW9uWTp4LHBvc2l0aW9uWjp3LHJlZkRpc3RhbmNlOmIscm9sbG9mZkZhY3RvcjpULC4uLlN9KT0+e2NvbnN0IGs9aC5jcmVhdGVQYW5uZXIoKTtpZihTLmNoYW5uZWxDb3VudD4yKXRocm93IHIoKTtpZihcIm1heFwiPT09Uy5jaGFubmVsQ291bnRNb2RlKXRocm93IHIoKTtJdChrLFMpO2NvbnN0IEM9e2NoYW5uZWxDb3VudDoxLGNoYW5uZWxDb3VudE1vZGU6XCJleHBsaWNpdFwiLGNoYW5uZWxJbnRlcnByZXRhdGlvbjpcImRpc2NyZXRlXCJ9LEE9cyhoLHsuLi5DLGNoYW5uZWxJbnRlcnByZXRhdGlvbjpcInNwZWFrZXJzXCIsbnVtYmVyT2ZJbnB1dHM6Nn0pLEQ9bihoLHsuLi5TLGdhaW46MX0pLE89bihoLHsuLi5DLGdhaW46MX0pLE09bihoLHsuLi5DLGdhaW46MH0pLEU9bihoLHsuLi5DLGdhaW46MH0pLFI9bihoLHsuLi5DLGdhaW46MH0pLHE9bihoLHsuLi5DLGdhaW46MH0pLEY9bihoLHsuLi5DLGdhaW46MH0pLEk9aShoLDI1Niw2LDEpLFY9byhoLHsuLi5DLGN1cnZlOm5ldyBGbG9hdDMyQXJyYXkoWzEsMV0pLG92ZXJzYW1wbGU6XCJub25lXCJ9KTtsZXQgTj1bXyxtLGddLFA9W3kseCx3XTtJLm9uYXVkaW9wcm9jZXNzPSh7aW5wdXRCdWZmZXI6dH0pPT57Y29uc3QgZT1bdC5nZXRDaGFubmVsRGF0YSgwKVswXSx0LmdldENoYW5uZWxEYXRhKDEpWzBdLHQuZ2V0Q2hhbm5lbERhdGEoMilbMF1dO2Uuc29tZSgodCxlKT0+dCE9PU5bZV0pJiYoay5zZXRPcmllbnRhdGlvbiguLi5lKSxOPWUpO2NvbnN0IHM9W3QuZ2V0Q2hhbm5lbERhdGEoMylbMF0sdC5nZXRDaGFubmVsRGF0YSg0KVswXSx0LmdldENoYW5uZWxEYXRhKDUpWzBdXTtzLnNvbWUoKHQsZSk9PnQhPT1QW2VdKSYmKGsuc2V0UG9zaXRpb24oLi4ucyksUD1zKX0sT2JqZWN0LmRlZmluZVByb3BlcnR5KE0uZ2FpbixcImRlZmF1bHRWYWx1ZVwiLHtnZXQ6KCk9PjB9KSxPYmplY3QuZGVmaW5lUHJvcGVydHkoRS5nYWluLFwiZGVmYXVsdFZhbHVlXCIse2dldDooKT0+MH0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShSLmdhaW4sXCJkZWZhdWx0VmFsdWVcIix7Z2V0OigpPT4wfSksT2JqZWN0LmRlZmluZVByb3BlcnR5KHEuZ2FpbixcImRlZmF1bHRWYWx1ZVwiLHtnZXQ6KCk9PjB9KSxPYmplY3QuZGVmaW5lUHJvcGVydHkoRi5nYWluLFwiZGVmYXVsdFZhbHVlXCIse2dldDooKT0+MH0pO2NvbnN0IGo9e2dldCBidWZmZXJTaXplKCl7fSxnZXQgY2hhbm5lbENvdW50KCl7cmV0dXJuIGsuY2hhbm5lbENvdW50fSxzZXQgY2hhbm5lbENvdW50KHQpe2lmKHQ+Mil0aHJvdyByKCk7RC5jaGFubmVsQ291bnQ9dCxrLmNoYW5uZWxDb3VudD10fSxnZXQgY2hhbm5lbENvdW50TW9kZSgpe3JldHVybiBrLmNoYW5uZWxDb3VudE1vZGV9LHNldCBjaGFubmVsQ291bnRNb2RlKHQpe2lmKFwibWF4XCI9PT10KXRocm93IHIoKTtELmNoYW5uZWxDb3VudE1vZGU9dCxrLmNoYW5uZWxDb3VudE1vZGU9dH0sZ2V0IGNoYW5uZWxJbnRlcnByZXRhdGlvbigpe3JldHVybiBrLmNoYW5uZWxJbnRlcnByZXRhdGlvbn0sc2V0IGNoYW5uZWxJbnRlcnByZXRhdGlvbih0KXtELmNoYW5uZWxJbnRlcnByZXRhdGlvbj10LGsuY2hhbm5lbEludGVycHJldGF0aW9uPXR9LGdldCBjb25lSW5uZXJBbmdsZSgpe3JldHVybiBrLmNvbmVJbm5lckFuZ2xlfSxzZXQgY29uZUlubmVyQW5nbGUodCl7ay5jb25lSW5uZXJBbmdsZT10fSxnZXQgY29uZU91dGVyQW5nbGUoKXtyZXR1cm4gay5jb25lT3V0ZXJBbmdsZX0sc2V0IGNvbmVPdXRlckFuZ2xlKHQpe2suY29uZU91dGVyQW5nbGU9dH0sZ2V0IGNvbmVPdXRlckdhaW4oKXtyZXR1cm4gay5jb25lT3V0ZXJHYWlufSxzZXQgY29uZU91dGVyR2Fpbih0KXtpZih0PDB8fHQ+MSl0aHJvdyBlKCk7ay5jb25lT3V0ZXJHYWluPXR9LGdldCBjb250ZXh0KCl7cmV0dXJuIGsuY29udGV4dH0sZ2V0IGRpc3RhbmNlTW9kZWwoKXtyZXR1cm4gay5kaXN0YW5jZU1vZGVsfSxzZXQgZGlzdGFuY2VNb2RlbCh0KXtrLmRpc3RhbmNlTW9kZWw9dH0sZ2V0IGlucHV0cygpe3JldHVybltEXX0sZ2V0IG1heERpc3RhbmNlKCl7cmV0dXJuIGsubWF4RGlzdGFuY2V9LHNldCBtYXhEaXN0YW5jZSh0KXtpZih0PDApdGhyb3cgbmV3IFJhbmdlRXJyb3I7ay5tYXhEaXN0YW5jZT10fSxnZXQgbnVtYmVyT2ZJbnB1dHMoKXtyZXR1cm4gay5udW1iZXJPZklucHV0c30sZ2V0IG51bWJlck9mT3V0cHV0cygpe3JldHVybiBrLm51bWJlck9mT3V0cHV0c30sZ2V0IG9yaWVudGF0aW9uWCgpe3JldHVybiBPLmdhaW59LGdldCBvcmllbnRhdGlvblkoKXtyZXR1cm4gTS5nYWlufSxnZXQgb3JpZW50YXRpb25aKCl7cmV0dXJuIEUuZ2Fpbn0sZ2V0IHBhbm5pbmdNb2RlbCgpe3JldHVybiBrLnBhbm5pbmdNb2RlbH0sc2V0IHBhbm5pbmdNb2RlbCh0KXtrLnBhbm5pbmdNb2RlbD10fSxnZXQgcG9zaXRpb25YKCl7cmV0dXJuIFIuZ2Fpbn0sZ2V0IHBvc2l0aW9uWSgpe3JldHVybiBxLmdhaW59LGdldCBwb3NpdGlvblooKXtyZXR1cm4gRi5nYWlufSxnZXQgcmVmRGlzdGFuY2UoKXtyZXR1cm4gay5yZWZEaXN0YW5jZX0sc2V0IHJlZkRpc3RhbmNlKHQpe2lmKHQ8MCl0aHJvdyBuZXcgUmFuZ2VFcnJvcjtrLnJlZkRpc3RhbmNlPXR9LGdldCByb2xsb2ZmRmFjdG9yKCl7cmV0dXJuIGsucm9sbG9mZkZhY3Rvcn0sc2V0IHJvbGxvZmZGYWN0b3IodCl7aWYodDwwKXRocm93IG5ldyBSYW5nZUVycm9yO2sucm9sbG9mZkZhY3Rvcj10fSxhZGRFdmVudExpc3RlbmVyOiguLi50KT0+RC5hZGRFdmVudExpc3RlbmVyKHRbMF0sdFsxXSx0WzJdKSxkaXNwYXRjaEV2ZW50OiguLi50KT0+RC5kaXNwYXRjaEV2ZW50KHRbMF0pLHJlbW92ZUV2ZW50TGlzdGVuZXI6KC4uLnQpPT5ELnJlbW92ZUV2ZW50TGlzdGVuZXIodFswXSx0WzFdLHRbMl0pfTt1IT09ai5jb25lSW5uZXJBbmdsZSYmKGouY29uZUlubmVyQW5nbGU9dSksbCE9PWouY29uZU91dGVyQW5nbGUmJihqLmNvbmVPdXRlckFuZ2xlPWwpLHAhPT1qLmNvbmVPdXRlckdhaW4mJihqLmNvbmVPdXRlckdhaW49cCksZCE9PWouZGlzdGFuY2VNb2RlbCYmKGouZGlzdGFuY2VNb2RlbD1kKSxmIT09ai5tYXhEaXN0YW5jZSYmKGoubWF4RGlzdGFuY2U9ZiksXyE9PWoub3JpZW50YXRpb25YLnZhbHVlJiYoai5vcmllbnRhdGlvblgudmFsdWU9XyksbSE9PWoub3JpZW50YXRpb25ZLnZhbHVlJiYoai5vcmllbnRhdGlvblkudmFsdWU9bSksZyE9PWoub3JpZW50YXRpb25aLnZhbHVlJiYoai5vcmllbnRhdGlvbloudmFsdWU9ZyksdiE9PWoucGFubmluZ01vZGVsJiYoai5wYW5uaW5nTW9kZWw9dikseSE9PWoucG9zaXRpb25YLnZhbHVlJiYoai5wb3NpdGlvblgudmFsdWU9eSkseCE9PWoucG9zaXRpb25ZLnZhbHVlJiYoai5wb3NpdGlvblkudmFsdWU9eCksdyE9PWoucG9zaXRpb25aLnZhbHVlJiYoai5wb3NpdGlvbloudmFsdWU9dyksYiE9PWoucmVmRGlzdGFuY2UmJihqLnJlZkRpc3RhbmNlPWIpLFQhPT1qLnJvbGxvZmZGYWN0b3ImJihqLnJvbGxvZmZGYWN0b3I9VCksMT09PU5bMF0mJjA9PT1OWzFdJiYwPT09TlsyXXx8ay5zZXRPcmllbnRhdGlvbiguLi5OKSwwPT09UFswXSYmMD09PVBbMV0mJjA9PT1QWzJdfHxrLnNldFBvc2l0aW9uKC4uLlApO3JldHVybiBjKEd0KGosayksKCk9PntELmNvbm5lY3QoayksdChELFYsMCwwKSxWLmNvbm5lY3QoTykuY29ubmVjdChBLDAsMCksVi5jb25uZWN0KE0pLmNvbm5lY3QoQSwwLDEpLFYuY29ubmVjdChFKS5jb25uZWN0KEEsMCwyKSxWLmNvbm5lY3QoUikuY29ubmVjdChBLDAsMyksVi5jb25uZWN0KHEpLmNvbm5lY3QoQSwwLDQpLFYuY29ubmVjdChGKS5jb25uZWN0KEEsMCw1KSxBLmNvbm5lY3QoSSkuY29ubmVjdChoLmRlc3RpbmF0aW9uKX0sKCk9PntELmRpc2Nvbm5lY3QoayksYShELFYsMCwwKSxWLmRpc2Nvbm5lY3QoTyksTy5kaXNjb25uZWN0KEEpLFYuZGlzY29ubmVjdChNKSxNLmRpc2Nvbm5lY3QoQSksVi5kaXNjb25uZWN0KEUpLEUuZGlzY29ubmVjdChBKSxWLmRpc2Nvbm5lY3QoUiksUi5kaXNjb25uZWN0KEEpLFYuZGlzY29ubmVjdChxKSxxLmRpc2Nvbm5lY3QoQSksVi5kaXNjb25uZWN0KEYpLEYuZGlzY29ubmVjdChBKSxBLmRpc2Nvbm5lY3QoSSksSS5kaXNjb25uZWN0KGguZGVzdGluYXRpb24pfSl9KSgkLEF0LEVzLFF0LFl0LG5uLEh0LGV0LEFzKSxybj0oYW49b24sKHQsZSk9Pntjb25zdCBzPXQuY3JlYXRlUGFubmVyKCk7cmV0dXJuIHZvaWQgMD09PXMub3JpZW50YXRpb25YP2FuKHQsZSk6KEl0KHMsZSksTnQocyxlLFwib3JpZW50YXRpb25YXCIpLE50KHMsZSxcIm9yaWVudGF0aW9uWVwiKSxOdChzLGUsXCJvcmllbnRhdGlvblpcIiksTnQocyxlLFwicG9zaXRpb25YXCIpLE50KHMsZSxcInBvc2l0aW9uWVwiKSxOdChzLGUsXCJwb3NpdGlvblpcIiksRnQocyxlLFwiY29uZUlubmVyQW5nbGVcIiksRnQocyxlLFwiY29uZU91dGVyQW5nbGVcIiksRnQocyxlLFwiY29uZU91dGVyR2FpblwiKSxGdChzLGUsXCJkaXN0YW5jZU1vZGVsXCIpLEZ0KHMsZSxcIm1heERpc3RhbmNlXCIpLEZ0KHMsZSxcInBhbm5pbmdNb2RlbFwiKSxGdChzLGUsXCJyZWZEaXN0YW5jZVwiKSxGdChzLGUsXCJyb2xsb2ZmRmFjdG9yXCIpLHMpfSk7dmFyIGFuO2NvbnN0IGNuPSgodCxlLHMsbixpLG8scik9PmNsYXNzIGV4dGVuZHMgdHtjb25zdHJ1Y3Rvcih0LGEpe2NvbnN0IGM9aSh0KSxoPXsuLi5LdCwuLi5hfSx1PXMoYyxoKSxsPW8oYyk7c3VwZXIodCwhMSx1LGw/bigpOm51bGwpLHRoaXMuX25hdGl2ZVBhbm5lck5vZGU9dSx0aGlzLl9vcmllbnRhdGlvblg9ZSh0aGlzLGwsdS5vcmllbnRhdGlvblgsTixWKSx0aGlzLl9vcmllbnRhdGlvblk9ZSh0aGlzLGwsdS5vcmllbnRhdGlvblksTixWKSx0aGlzLl9vcmllbnRhdGlvblo9ZSh0aGlzLGwsdS5vcmllbnRhdGlvblosTixWKSx0aGlzLl9wb3NpdGlvblg9ZSh0aGlzLGwsdS5wb3NpdGlvblgsTixWKSx0aGlzLl9wb3NpdGlvblk9ZSh0aGlzLGwsdS5wb3NpdGlvblksTixWKSx0aGlzLl9wb3NpdGlvblo9ZSh0aGlzLGwsdS5wb3NpdGlvblosTixWKSxyKHRoaXMsMSl9Z2V0IGNvbmVJbm5lckFuZ2xlKCl7cmV0dXJuIHRoaXMuX25hdGl2ZVBhbm5lck5vZGUuY29uZUlubmVyQW5nbGV9c2V0IGNvbmVJbm5lckFuZ2xlKHQpe3RoaXMuX25hdGl2ZVBhbm5lck5vZGUuY29uZUlubmVyQW5nbGU9dH1nZXQgY29uZU91dGVyQW5nbGUoKXtyZXR1cm4gdGhpcy5fbmF0aXZlUGFubmVyTm9kZS5jb25lT3V0ZXJBbmdsZX1zZXQgY29uZU91dGVyQW5nbGUodCl7dGhpcy5fbmF0aXZlUGFubmVyTm9kZS5jb25lT3V0ZXJBbmdsZT10fWdldCBjb25lT3V0ZXJHYWluKCl7cmV0dXJuIHRoaXMuX25hdGl2ZVBhbm5lck5vZGUuY29uZU91dGVyR2Fpbn1zZXQgY29uZU91dGVyR2Fpbih0KXt0aGlzLl9uYXRpdmVQYW5uZXJOb2RlLmNvbmVPdXRlckdhaW49dH1nZXQgZGlzdGFuY2VNb2RlbCgpe3JldHVybiB0aGlzLl9uYXRpdmVQYW5uZXJOb2RlLmRpc3RhbmNlTW9kZWx9c2V0IGRpc3RhbmNlTW9kZWwodCl7dGhpcy5fbmF0aXZlUGFubmVyTm9kZS5kaXN0YW5jZU1vZGVsPXR9Z2V0IG1heERpc3RhbmNlKCl7cmV0dXJuIHRoaXMuX25hdGl2ZVBhbm5lck5vZGUubWF4RGlzdGFuY2V9c2V0IG1heERpc3RhbmNlKHQpe3RoaXMuX25hdGl2ZVBhbm5lck5vZGUubWF4RGlzdGFuY2U9dH1nZXQgb3JpZW50YXRpb25YKCl7cmV0dXJuIHRoaXMuX29yaWVudGF0aW9uWH1nZXQgb3JpZW50YXRpb25ZKCl7cmV0dXJuIHRoaXMuX29yaWVudGF0aW9uWX1nZXQgb3JpZW50YXRpb25aKCl7cmV0dXJuIHRoaXMuX29yaWVudGF0aW9uWn1nZXQgcGFubmluZ01vZGVsKCl7cmV0dXJuIHRoaXMuX25hdGl2ZVBhbm5lck5vZGUucGFubmluZ01vZGVsfXNldCBwYW5uaW5nTW9kZWwodCl7dGhpcy5fbmF0aXZlUGFubmVyTm9kZS5wYW5uaW5nTW9kZWw9dH1nZXQgcG9zaXRpb25YKCl7cmV0dXJuIHRoaXMuX3Bvc2l0aW9uWH1nZXQgcG9zaXRpb25ZKCl7cmV0dXJuIHRoaXMuX3Bvc2l0aW9uWX1nZXQgcG9zaXRpb25aKCl7cmV0dXJuIHRoaXMuX3Bvc2l0aW9uWn1nZXQgcmVmRGlzdGFuY2UoKXtyZXR1cm4gdGhpcy5fbmF0aXZlUGFubmVyTm9kZS5yZWZEaXN0YW5jZX1zZXQgcmVmRGlzdGFuY2UodCl7dGhpcy5fbmF0aXZlUGFubmVyTm9kZS5yZWZEaXN0YW5jZT10fWdldCByb2xsb2ZmRmFjdG9yKCl7cmV0dXJuIHRoaXMuX25hdGl2ZVBhbm5lck5vZGUucm9sbG9mZkZhY3Rvcn1zZXQgcm9sbG9mZkZhY3Rvcih0KXt0aGlzLl9uYXRpdmVQYW5uZXJOb2RlLnJvbGxvZmZGYWN0b3I9dH19KShaZSxwcyxybiwoKHQsZSxzLG4saSxvLHIsYSxjLGgpPT4oKT0+e2NvbnN0IHU9bmV3IFdlYWtNYXA7bGV0IGw9bnVsbDtyZXR1cm57cmVuZGVyKHAsZCxmKXtjb25zdCBfPXUuZ2V0KGQpO3JldHVybiB2b2lkIDAhPT1fP1Byb21pc2UucmVzb2x2ZShfKTooYXN5bmMocCxkLGYpPT57bGV0IF89bnVsbCxtPW8ocCk7Y29uc3QgZz17Y2hhbm5lbENvdW50Om0uY2hhbm5lbENvdW50LGNoYW5uZWxDb3VudE1vZGU6bS5jaGFubmVsQ291bnRNb2RlLGNoYW5uZWxJbnRlcnByZXRhdGlvbjptLmNoYW5uZWxJbnRlcnByZXRhdGlvbn0sdj17Li4uZyxjb25lSW5uZXJBbmdsZTptLmNvbmVJbm5lckFuZ2xlLGNvbmVPdXRlckFuZ2xlOm0uY29uZU91dGVyQW5nbGUsY29uZU91dGVyR2FpbjptLmNvbmVPdXRlckdhaW4sZGlzdGFuY2VNb2RlbDptLmRpc3RhbmNlTW9kZWwsbWF4RGlzdGFuY2U6bS5tYXhEaXN0YW5jZSxwYW5uaW5nTW9kZWw6bS5wYW5uaW5nTW9kZWwscmVmRGlzdGFuY2U6bS5yZWZEaXN0YW5jZSxyb2xsb2ZmRmFjdG9yOm0ucm9sbG9mZkZhY3Rvcn0seT1FKG0sZCk7aWYoXCJidWZmZXJTaXplXCJpbiBtKV89bihkLHsuLi5nLGdhaW46MX0pO2Vsc2UgaWYoIXkpe2NvbnN0IHQ9ey4uLnYsb3JpZW50YXRpb25YOm0ub3JpZW50YXRpb25YLnZhbHVlLG9yaWVudGF0aW9uWTptLm9yaWVudGF0aW9uWS52YWx1ZSxvcmllbnRhdGlvblo6bS5vcmllbnRhdGlvbloudmFsdWUscG9zaXRpb25YOm0ucG9zaXRpb25YLnZhbHVlLHBvc2l0aW9uWTptLnBvc2l0aW9uWS52YWx1ZSxwb3NpdGlvblo6bS5wb3NpdGlvbloudmFsdWV9O209aShkLHQpfWlmKHUuc2V0KGQsbnVsbD09PV8/bTpfKSxudWxsIT09Xyl7aWYobnVsbD09PWwpe2lmKG51bGw9PT1yKXRocm93IG5ldyBFcnJvcihcIk1pc3NpbmcgdGhlIG5hdGl2ZSBPZmZsaW5lQXVkaW9Db250ZXh0IGNvbnN0cnVjdG9yLlwiKTtjb25zdCB0PW5ldyByKDYscC5jb250ZXh0Lmxlbmd0aCxkLnNhbXBsZVJhdGUpLG49ZSh0LHtjaGFubmVsQ291bnQ6MSxjaGFubmVsQ291bnRNb2RlOlwiZXhwbGljaXRcIixjaGFubmVsSW50ZXJwcmV0YXRpb246XCJzcGVha2Vyc1wiLG51bWJlck9mSW5wdXRzOjZ9KTtuLmNvbm5lY3QodC5kZXN0aW5hdGlvbiksbD0oYXN5bmMoKT0+e2NvbnN0IGU9YXdhaXQgUHJvbWlzZS5hbGwoW3Aub3JpZW50YXRpb25YLHAub3JpZW50YXRpb25ZLHAub3JpZW50YXRpb25aLHAucG9zaXRpb25YLHAucG9zaXRpb25ZLHAucG9zaXRpb25aXS5tYXAoYXN5bmMoZSxuKT0+e2NvbnN0IGk9cyh0LHtjaGFubmVsQ291bnQ6MSxjaGFubmVsQ291bnRNb2RlOlwiZXhwbGljaXRcIixjaGFubmVsSW50ZXJwcmV0YXRpb246XCJkaXNjcmV0ZVwiLG9mZnNldDowPT09bj8xOjB9KTtyZXR1cm4gYXdhaXQgYSh0LGUsaS5vZmZzZXQsZiksaX0pKTtmb3IobGV0IHQ9MDt0PDY7dCs9MSllW3RdLmNvbm5lY3QobiwwLHQpLGVbdF0uc3RhcnQoMCk7cmV0dXJuIGgodCl9KSgpfWNvbnN0IHQ9YXdhaXQgbCxvPW4oZCx7Li4uZyxnYWluOjF9KTthd2FpdCBjKHAsZCxvLGYpO2NvbnN0IHU9W107Zm9yKGxldCBlPTA7ZTx0Lm51bWJlck9mQ2hhbm5lbHM7ZSs9MSl1LnB1c2godC5nZXRDaGFubmVsRGF0YShlKSk7bGV0IG09W3VbMF1bMF0sdVsxXVswXSx1WzJdWzBdXSx5PVt1WzNdWzBdLHVbNF1bMF0sdVs1XVswXV0seD1uKGQsey4uLmcsZ2FpbjoxfSksdz1pKGQsey4uLnYsb3JpZW50YXRpb25YOm1bMF0sb3JpZW50YXRpb25ZOm1bMV0sb3JpZW50YXRpb25aOm1bMl0scG9zaXRpb25YOnlbMF0scG9zaXRpb25ZOnlbMV0scG9zaXRpb25aOnlbMl19KTtvLmNvbm5lY3QoeCkuY29ubmVjdCh3LmlucHV0c1swXSksdy5jb25uZWN0KF8pO2ZvcihsZXQgZT0xMjg7ZTx0Lmxlbmd0aDtlKz0xMjgpe2NvbnN0IHQ9W3VbMF1bZV0sdVsxXVtlXSx1WzJdW2VdXSxzPVt1WzNdW2VdLHVbNF1bZV0sdVs1XVtlXV07aWYodC5zb21lKCh0LGUpPT50IT09bVtlXSl8fHMuc29tZSgodCxlKT0+dCE9PXlbZV0pKXttPXQseT1zO2NvbnN0IHI9ZS9kLnNhbXBsZVJhdGU7eC5nYWluLnNldFZhbHVlQXRUaW1lKDAscikseD1uKGQsey4uLmcsZ2FpbjowfSksdz1pKGQsey4uLnYsb3JpZW50YXRpb25YOm1bMF0sb3JpZW50YXRpb25ZOm1bMV0sb3JpZW50YXRpb25aOm1bMl0scG9zaXRpb25YOnlbMF0scG9zaXRpb25ZOnlbMV0scG9zaXRpb25aOnlbMl19KSx4LmdhaW4uc2V0VmFsdWVBdFRpbWUoMSxyKSxvLmNvbm5lY3QoeCkuY29ubmVjdCh3LmlucHV0c1swXSksdy5jb25uZWN0KF8pfX1yZXR1cm4gX31yZXR1cm4geT8oYXdhaXQgdChkLHAub3JpZW50YXRpb25YLG0ub3JpZW50YXRpb25YLGYpLGF3YWl0IHQoZCxwLm9yaWVudGF0aW9uWSxtLm9yaWVudGF0aW9uWSxmKSxhd2FpdCB0KGQscC5vcmllbnRhdGlvblosbS5vcmllbnRhdGlvblosZiksYXdhaXQgdChkLHAucG9zaXRpb25YLG0ucG9zaXRpb25YLGYpLGF3YWl0IHQoZCxwLnBvc2l0aW9uWSxtLnBvc2l0aW9uWSxmKSxhd2FpdCB0KGQscC5wb3NpdGlvblosbS5wb3NpdGlvblosZikpOihhd2FpdCBhKGQscC5vcmllbnRhdGlvblgsbS5vcmllbnRhdGlvblgsZiksYXdhaXQgYShkLHAub3JpZW50YXRpb25ZLG0ub3JpZW50YXRpb25ZLGYpLGF3YWl0IGEoZCxwLm9yaWVudGF0aW9uWixtLm9yaWVudGF0aW9uWixmKSxhd2FpdCBhKGQscC5wb3NpdGlvblgsbS5wb3NpdGlvblgsZiksYXdhaXQgYShkLHAucG9zaXRpb25ZLG0ucG9zaXRpb25ZLGYpLGF3YWl0IGEoZCxwLnBvc2l0aW9uWixtLnBvc2l0aW9uWixmKSksSChtKT9hd2FpdCBjKHAsZCxtLmlucHV0c1swXSxmKTphd2FpdCBjKHAsZCxtLGYpLG19KShwLGQsZil9fX0pKGFzLEVzLElzLFF0LHJuLHN0LFZlLHVzLE9lLFVzKSxGZSxOZSxncyksaG49KCh0LGUscyxuKT0+Y2xhc3MgaXtjb25zdHJ1Y3RvcihpLG8pe2NvbnN0IHI9ZShpKSxhPW4oey4uLnRlLC4uLm99KSxjPXQocixhKTtyZXR1cm4gcy5hZGQoYyksY31zdGF0aWNbU3ltYm9sLmhhc0luc3RhbmNlXSh0KXtyZXR1cm4gbnVsbCE9PXQmJlwib2JqZWN0XCI9PXR5cGVvZiB0JiZPYmplY3QuZ2V0UHJvdG90eXBlT2YodCk9PT1pLnByb3RvdHlwZXx8cy5oYXModCl9fSkoKHQ9PihlLHtkaXNhYmxlTm9ybWFsaXphdGlvbjpzLGltYWc6bixyZWFsOml9KT0+e2NvbnN0IG89biBpbnN0YW5jZW9mIEZsb2F0MzJBcnJheT9uOm5ldyBGbG9hdDMyQXJyYXkobikscj1pIGluc3RhbmNlb2YgRmxvYXQzMkFycmF5P2k6bmV3IEZsb2F0MzJBcnJheShpKSxhPWUuY3JlYXRlUGVyaW9kaWNXYXZlKHIsbyx7ZGlzYWJsZU5vcm1hbGl6YXRpb246c30pO2lmKEFycmF5LmZyb20obikubGVuZ3RoPDIpdGhyb3cgdCgpO3JldHVybiBhfSkocSksRmUsbmV3IFdlYWtTZXQsdD0+e2NvbnN0e2ltYWc6ZSxyZWFsOnN9PXQ7cmV0dXJuIHZvaWQgMD09PWU/dm9pZCAwPT09cz97Li4udCxpbWFnOlswLDBdLHJlYWw6WzAsMF19OnsuLi50LGltYWc6QXJyYXkuZnJvbShzLCgpPT4wKSxyZWFsOnN9OnZvaWQgMD09PXM/ey4uLnQsaW1hZzplLHJlYWw6QXJyYXkuZnJvbShlLCgpPT4wKX06ey4uLnQsaW1hZzplLHJlYWw6c319KSx1bj0oKHQsZSk9PihzLG4pPT57Y29uc3QgaT1uLmNoYW5uZWxDb3VudE1vZGU7aWYoXCJjbGFtcGVkLW1heFwiPT09aSl0aHJvdyBlKCk7aWYodm9pZCAwPT09cy5jcmVhdGVTdGVyZW9QYW5uZXIpcmV0dXJuIHQocyxuKTtjb25zdCBvPXMuY3JlYXRlU3RlcmVvUGFubmVyKCk7cmV0dXJuIEl0KG8sbiksTnQobyxuLFwicGFuXCIpLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShvLFwiY2hhbm5lbENvdW50TW9kZVwiLHtnZXQ6KCk9Pmksc2V0OnQ9PntpZih0IT09aSl0aHJvdyBlKCl9fSksb30pKCgodCxlLHMsbixpLG8pPT57Y29uc3Qgcj1uZXcgRmxvYXQzMkFycmF5KFsxLDFdKSxhPU1hdGguUEkvMixjPXtjaGFubmVsQ291bnQ6MSxjaGFubmVsQ291bnRNb2RlOlwiZXhwbGljaXRcIixjaGFubmVsSW50ZXJwcmV0YXRpb246XCJkaXNjcmV0ZVwifSxoPXsuLi5jLG92ZXJzYW1wbGU6XCJub25lXCJ9LHU9KHQsbyx1LGwscCk9PntpZigxPT09bylyZXR1cm4oKHQsZSxpLG8pPT57Y29uc3QgdT1uZXcgRmxvYXQzMkFycmF5KDE2Mzg1KSxsPW5ldyBGbG9hdDMyQXJyYXkoMTYzODUpO2ZvcihsZXQgdD0wO3Q8MTYzODU7dCs9MSl7Y29uc3QgZT10LzE2Mzg0KmE7dVt0XT1NYXRoLmNvcyhlKSxsW3RdPU1hdGguc2luKGUpfWNvbnN0IHA9cyh0LHsuLi5jLGdhaW46MH0pLGQ9bih0LHsuLi5oLGN1cnZlOnV9KSxmPW4odCx7Li4uaCxjdXJ2ZTpyfSksXz1zKHQsey4uLmMsZ2FpbjowfSksbT1uKHQsey4uLmgsY3VydmU6bH0pO3JldHVybntjb25uZWN0R3JhcGgoKXtlLmNvbm5lY3QocCksZS5jb25uZWN0KHZvaWQgMD09PWYuaW5wdXRzP2Y6Zi5pbnB1dHNbMF0pLGUuY29ubmVjdChfKSxmLmNvbm5lY3QoaSksaS5jb25uZWN0KHZvaWQgMD09PWQuaW5wdXRzP2Q6ZC5pbnB1dHNbMF0pLGkuY29ubmVjdCh2b2lkIDA9PT1tLmlucHV0cz9tOm0uaW5wdXRzWzBdKSxkLmNvbm5lY3QocC5nYWluKSxtLmNvbm5lY3QoXy5nYWluKSxwLmNvbm5lY3QobywwLDApLF8uY29ubmVjdChvLDAsMSl9LGRpc2Nvbm5lY3RHcmFwaCgpe2UuZGlzY29ubmVjdChwKSxlLmRpc2Nvbm5lY3Qodm9pZCAwPT09Zi5pbnB1dHM/ZjpmLmlucHV0c1swXSksZS5kaXNjb25uZWN0KF8pLGYuZGlzY29ubmVjdChpKSxpLmRpc2Nvbm5lY3Qodm9pZCAwPT09ZC5pbnB1dHM/ZDpkLmlucHV0c1swXSksaS5kaXNjb25uZWN0KHZvaWQgMD09PW0uaW5wdXRzP206bS5pbnB1dHNbMF0pLGQuZGlzY29ubmVjdChwLmdhaW4pLG0uZGlzY29ubmVjdChfLmdhaW4pLHAuZGlzY29ubmVjdChvLDAsMCksXy5kaXNjb25uZWN0KG8sMCwxKX19fSkodCx1LGwscCk7aWYoMj09PW8pcmV0dXJuKCh0LGksbyx1KT0+e2NvbnN0IGw9bmV3IEZsb2F0MzJBcnJheSgxNjM4NSkscD1uZXcgRmxvYXQzMkFycmF5KDE2Mzg1KSxkPW5ldyBGbG9hdDMyQXJyYXkoMTYzODUpLGY9bmV3IEZsb2F0MzJBcnJheSgxNjM4NSksXz1NYXRoLmZsb29yKDgxOTIuNSk7Zm9yKGxldCB0PTA7dDwxNjM4NTt0Kz0xKWlmKHQ+Xyl7Y29uc3QgZT0odC1fKS8oMTYzODQtXykqYTtsW3RdPU1hdGguY29zKGUpLHBbdF09TWF0aC5zaW4oZSksZFt0XT0wLGZbdF09MX1lbHNle2NvbnN0IGU9dC8oMTYzODQtXykqYTtsW3RdPTEscFt0XT0wLGRbdF09TWF0aC5jb3MoZSksZlt0XT1NYXRoLnNpbihlKX1jb25zdCBtPWUodCx7Y2hhbm5lbENvdW50OjIsY2hhbm5lbENvdW50TW9kZTpcImV4cGxpY2l0XCIsY2hhbm5lbEludGVycHJldGF0aW9uOlwiZGlzY3JldGVcIixudW1iZXJPZk91dHB1dHM6Mn0pLGc9cyh0LHsuLi5jLGdhaW46MH0pLHY9bih0LHsuLi5oLGN1cnZlOmx9KSx5PXModCx7Li4uYyxnYWluOjB9KSx4PW4odCx7Li4uaCxjdXJ2ZTpwfSksdz1uKHQsey4uLmgsY3VydmU6cn0pLGI9cyh0LHsuLi5jLGdhaW46MH0pLFQ9bih0LHsuLi5oLGN1cnZlOmR9KSxTPXModCx7Li4uYyxnYWluOjB9KSxrPW4odCx7Li4uaCxjdXJ2ZTpmfSk7cmV0dXJue2Nvbm5lY3RHcmFwaCgpe2kuY29ubmVjdChtKSxpLmNvbm5lY3Qodm9pZCAwPT09dy5pbnB1dHM/dzp3LmlucHV0c1swXSksbS5jb25uZWN0KGcsMCksbS5jb25uZWN0KHksMCksbS5jb25uZWN0KGIsMSksbS5jb25uZWN0KFMsMSksdy5jb25uZWN0KG8pLG8uY29ubmVjdCh2b2lkIDA9PT12LmlucHV0cz92OnYuaW5wdXRzWzBdKSxvLmNvbm5lY3Qodm9pZCAwPT09eC5pbnB1dHM/eDp4LmlucHV0c1swXSksby5jb25uZWN0KHZvaWQgMD09PVQuaW5wdXRzP1Q6VC5pbnB1dHNbMF0pLG8uY29ubmVjdCh2b2lkIDA9PT1rLmlucHV0cz9rOmsuaW5wdXRzWzBdKSx2LmNvbm5lY3QoZy5nYWluKSx4LmNvbm5lY3QoeS5nYWluKSxULmNvbm5lY3QoYi5nYWluKSxrLmNvbm5lY3QoUy5nYWluKSxnLmNvbm5lY3QodSwwLDApLGIuY29ubmVjdCh1LDAsMCkseS5jb25uZWN0KHUsMCwxKSxTLmNvbm5lY3QodSwwLDEpfSxkaXNjb25uZWN0R3JhcGgoKXtpLmRpc2Nvbm5lY3QobSksaS5kaXNjb25uZWN0KHZvaWQgMD09PXcuaW5wdXRzP3c6dy5pbnB1dHNbMF0pLG0uZGlzY29ubmVjdChnLDApLG0uZGlzY29ubmVjdCh5LDApLG0uZGlzY29ubmVjdChiLDEpLG0uZGlzY29ubmVjdChTLDEpLHcuZGlzY29ubmVjdChvKSxvLmRpc2Nvbm5lY3Qodm9pZCAwPT09di5pbnB1dHM/djp2LmlucHV0c1swXSksby5kaXNjb25uZWN0KHZvaWQgMD09PXguaW5wdXRzP3g6eC5pbnB1dHNbMF0pLG8uZGlzY29ubmVjdCh2b2lkIDA9PT1ULmlucHV0cz9UOlQuaW5wdXRzWzBdKSxvLmRpc2Nvbm5lY3Qodm9pZCAwPT09ay5pbnB1dHM/azprLmlucHV0c1swXSksdi5kaXNjb25uZWN0KGcuZ2FpbikseC5kaXNjb25uZWN0KHkuZ2FpbiksVC5kaXNjb25uZWN0KGIuZ2Fpbiksay5kaXNjb25uZWN0KFMuZ2FpbiksZy5kaXNjb25uZWN0KHUsMCwwKSxiLmRpc2Nvbm5lY3QodSwwLDApLHkuZGlzY29ubmVjdCh1LDAsMSksUy5kaXNjb25uZWN0KHUsMCwxKX19fSkodCx1LGwscCk7dGhyb3cgaSgpfTtyZXR1cm4oZSx7Y2hhbm5lbENvdW50Om4sY2hhbm5lbENvdW50TW9kZTpyLHBhbjphLC4uLmN9KT0+e2lmKFwibWF4XCI9PT1yKXRocm93IGkoKTtjb25zdCBoPXQoZSx7Li4uYyxjaGFubmVsQ291bnQ6MSxjaGFubmVsQ291bnRNb2RlOnIsbnVtYmVyT2ZJbnB1dHM6Mn0pLGw9cyhlLHsuLi5jLGNoYW5uZWxDb3VudDpuLGNoYW5uZWxDb3VudE1vZGU6cixnYWluOjF9KSxwPXMoZSx7Y2hhbm5lbENvdW50OjEsY2hhbm5lbENvdW50TW9kZTpcImV4cGxpY2l0XCIsY2hhbm5lbEludGVycHJldGF0aW9uOlwiZGlzY3JldGVcIixnYWluOmF9KTtsZXR7Y29ubmVjdEdyYXBoOmQsZGlzY29ubmVjdEdyYXBoOmZ9PXUoZSxuLGwscCxoKTtPYmplY3QuZGVmaW5lUHJvcGVydHkocC5nYWluLFwiZGVmYXVsdFZhbHVlXCIse2dldDooKT0+MH0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShwLmdhaW4sXCJtYXhWYWx1ZVwiLHtnZXQ6KCk9PjF9KSxPYmplY3QuZGVmaW5lUHJvcGVydHkocC5nYWluLFwibWluVmFsdWVcIix7Z2V0OigpPT4tMX0pO2NvbnN0IF89e2dldCBidWZmZXJTaXplKCl7fSxnZXQgY2hhbm5lbENvdW50KCl7cmV0dXJuIGwuY2hhbm5lbENvdW50fSxzZXQgY2hhbm5lbENvdW50KHQpe2wuY2hhbm5lbENvdW50IT09dCYmKG0mJmYoKSwoe2Nvbm5lY3RHcmFwaDpkLGRpc2Nvbm5lY3RHcmFwaDpmfT11KGUsdCxsLHAsaCkpLG0mJmQoKSksbC5jaGFubmVsQ291bnQ9dH0sZ2V0IGNoYW5uZWxDb3VudE1vZGUoKXtyZXR1cm4gbC5jaGFubmVsQ291bnRNb2RlfSxzZXQgY2hhbm5lbENvdW50TW9kZSh0KXtpZihcImNsYW1wZWQtbWF4XCI9PT10fHxcIm1heFwiPT09dCl0aHJvdyBpKCk7bC5jaGFubmVsQ291bnRNb2RlPXR9LGdldCBjaGFubmVsSW50ZXJwcmV0YXRpb24oKXtyZXR1cm4gbC5jaGFubmVsSW50ZXJwcmV0YXRpb259LHNldCBjaGFubmVsSW50ZXJwcmV0YXRpb24odCl7bC5jaGFubmVsSW50ZXJwcmV0YXRpb249dH0sZ2V0IGNvbnRleHQoKXtyZXR1cm4gbC5jb250ZXh0fSxnZXQgaW5wdXRzKCl7cmV0dXJuW2xdfSxnZXQgbnVtYmVyT2ZJbnB1dHMoKXtyZXR1cm4gbC5udW1iZXJPZklucHV0c30sZ2V0IG51bWJlck9mT3V0cHV0cygpe3JldHVybiBsLm51bWJlck9mT3V0cHV0c30sZ2V0IHBhbigpe3JldHVybiBwLmdhaW59LGFkZEV2ZW50TGlzdGVuZXI6KC4uLnQpPT5sLmFkZEV2ZW50TGlzdGVuZXIodFswXSx0WzFdLHRbMl0pLGRpc3BhdGNoRXZlbnQ6KC4uLnQpPT5sLmRpc3BhdGNoRXZlbnQodFswXSkscmVtb3ZlRXZlbnRMaXN0ZW5lcjooLi4udCk9PmwucmVtb3ZlRXZlbnRMaXN0ZW5lcih0WzBdLHRbMV0sdFsyXSl9O2xldCBtPSExO3JldHVybiBvKEd0KF8saCksKCk9PntkKCksbT0hMH0sKCk9PntmKCksbT0hMX0pfX0pKEVzLFd0LFF0LG5uLEh0LEFzKSxIdCksbG49KCh0LGUscyxuLGksbyk9PmNsYXNzIGV4dGVuZHMgdHtjb25zdHJ1Y3Rvcih0LHIpe2NvbnN0IGE9aSh0KSxjPXsuLi5lZSwuLi5yfSxoPXMoYSxjKSx1PW8oYSk7c3VwZXIodCwhMSxoLHU/bigpOm51bGwpLHRoaXMuX3Bhbj1lKHRoaXMsdSxoLnBhbil9Z2V0IHBhbigpe3JldHVybiB0aGlzLl9wYW59fSkoWmUscHMsdW4sKCh0LGUscyxuLGkpPT4oKT0+e2NvbnN0IG89bmV3IFdlYWtNYXA7cmV0dXJue3JlbmRlcihyLGEsYyl7Y29uc3QgaD1vLmdldChhKTtyZXR1cm4gdm9pZCAwIT09aD9Qcm9taXNlLnJlc29sdmUoaCk6KGFzeW5jKHIsYSxjKT0+e2xldCBoPXMocik7Y29uc3QgdT1FKGgsYSk7aWYoIXUpe2NvbnN0IHQ9e2NoYW5uZWxDb3VudDpoLmNoYW5uZWxDb3VudCxjaGFubmVsQ291bnRNb2RlOmguY2hhbm5lbENvdW50TW9kZSxjaGFubmVsSW50ZXJwcmV0YXRpb246aC5jaGFubmVsSW50ZXJwcmV0YXRpb24scGFuOmgucGFuLnZhbHVlfTtoPWUoYSx0KX1yZXR1cm4gby5zZXQoYSxoKSx1P2F3YWl0IHQoYSxyLnBhbixoLnBhbixjKTphd2FpdCBuKGEsci5wYW4saC5wYW4sYyksSChoKT9hd2FpdCBpKHIsYSxoLmlucHV0c1swXSxjKTphd2FpdCBpKHIsYSxoLGMpLGh9KShyLGEsYyl9fX0pKGFzLHVuLHN0LHVzLE9lKSxGZSxOZSkscG49KCh0LGUscyk9PigpPT57Y29uc3Qgbj1uZXcgV2Vha01hcDtyZXR1cm57cmVuZGVyKGksbyxyKXtjb25zdCBhPW4uZ2V0KG8pO3JldHVybiB2b2lkIDAhPT1hP1Byb21pc2UucmVzb2x2ZShhKTooYXN5bmMoaSxvLHIpPT57bGV0IGE9ZShpKTtpZighRShhLG8pKXtjb25zdCBlPXtjaGFubmVsQ291bnQ6YS5jaGFubmVsQ291bnQsY2hhbm5lbENvdW50TW9kZTphLmNoYW5uZWxDb3VudE1vZGUsY2hhbm5lbEludGVycHJldGF0aW9uOmEuY2hhbm5lbEludGVycHJldGF0aW9uLGN1cnZlOmEuY3VydmUsb3ZlcnNhbXBsZTphLm92ZXJzYW1wbGV9O2E9dChvLGUpfXJldHVybiBuLnNldChvLGEpLEgoYSk/YXdhaXQgcyhpLG8sYS5pbnB1dHNbMF0scik6YXdhaXQgcyhpLG8sYSxyKSxhfSkoaSxvLHIpfX19KShubixzdCxPZSksZG49KCh0LGUscyxuLGksbyxyKT0+Y2xhc3MgZXh0ZW5kcyB0e2NvbnN0cnVjdG9yKHQsZSl7Y29uc3QgYT1pKHQpLGM9ey4uLm5lLC4uLmV9LGg9cyhhLGMpO3N1cGVyKHQsITAsaCxvKGEpP24oKTpudWxsKSx0aGlzLl9pc0N1cnZlTnVsbGlmaWVkPSExLHRoaXMuX25hdGl2ZVdhdmVTaGFwZXJOb2RlPWgscih0aGlzLDEpfWdldCBjdXJ2ZSgpe3JldHVybiB0aGlzLl9pc0N1cnZlTnVsbGlmaWVkP251bGw6dGhpcy5fbmF0aXZlV2F2ZVNoYXBlck5vZGUuY3VydmV9c2V0IGN1cnZlKHQpe2lmKG51bGw9PT10KXRoaXMuX2lzQ3VydmVOdWxsaWZpZWQ9ITAsdGhpcy5fbmF0aXZlV2F2ZVNoYXBlck5vZGUuY3VydmU9bmV3IEZsb2F0MzJBcnJheShbMCwwXSk7ZWxzZXtpZih0Lmxlbmd0aDwyKXRocm93IGUoKTt0aGlzLl9pc0N1cnZlTnVsbGlmaWVkPSExLHRoaXMuX25hdGl2ZVdhdmVTaGFwZXJOb2RlLmN1cnZlPXR9fWdldCBvdmVyc2FtcGxlKCl7cmV0dXJuIHRoaXMuX25hdGl2ZVdhdmVTaGFwZXJOb2RlLm92ZXJzYW1wbGV9c2V0IG92ZXJzYW1wbGUodCl7dGhpcy5fbmF0aXZlV2F2ZVNoYXBlck5vZGUub3ZlcnNhbXBsZT10fX0pKFplLEF0LG5uLHBuLEZlLE5lLGdzKSxmbj0odD0+bnVsbCE9PXQmJnQuaXNTZWN1cmVDb250ZXh0KShUZSksX249KHQ9PihlLHMsbik9PntPYmplY3QuZGVmaW5lUHJvcGVydGllcyh0LHtjdXJyZW50RnJhbWU6e2NvbmZpZ3VyYWJsZTohMCxnZXQ6KCk9Pk1hdGgucm91bmQoZSpzKX0sY3VycmVudFRpbWU6e2NvbmZpZ3VyYWJsZTohMCxnZXQ6KCk9PmV9fSk7dHJ5e3JldHVybiBuKCl9ZmluYWxseXtudWxsIT09dCYmKGRlbGV0ZSB0LmN1cnJlbnRGcmFtZSxkZWxldGUgdC5jdXJyZW50VGltZSl9fSkoVGUpLG1uPW5ldyBXZWFrTWFwLGduPSgodCxlKT0+cz0+e2xldCBuPXQuZ2V0KHMpO2lmKHZvaWQgMCE9PW4pcmV0dXJuIG47aWYobnVsbD09PWUpdGhyb3cgbmV3IEVycm9yKFwiTWlzc2luZyB0aGUgbmF0aXZlIE9mZmxpbmVBdWRpb0NvbnRleHQgY29uc3RydWN0b3IuXCIpO3JldHVybiBuPW5ldyBlKDEsMSw4ZTMpLHQuc2V0KHMsbiksbn0pKG1uLFZlKSx2bj0odD0+bnVsbD09PXQ/bnVsbDp0Lmhhc093blByb3BlcnR5KFwiQXVkaW9Xb3JrbGV0Tm9kZVwiKT90LkF1ZGlvV29ya2xldE5vZGU6bnVsbCkoVGUpLHluPWZuPygodCxlLHMsbixpLG8scixhLGMsaCx1LGwpPT4ocCxkLGY9e2NyZWRlbnRpYWxzOlwib21pdFwifSk9Pntjb25zdCBtPW8ocCk7aWYodm9pZCAwIT09bS5hdWRpb1dvcmtsZXQpcmV0dXJuIFByb21pc2UuYWxsKFtpKGQpLFByb21pc2UucmVzb2x2ZSh0KHUsdSkpXSkudGhlbigoW1t0LGVdLHNdKT0+e2NvbnN0W24saV09eSh0LGUpLG89cz9pOmkucmVwbGFjZSgvXFxzK2V4dGVuZHNcXHMrQXVkaW9Xb3JrbGV0UHJvY2Vzc29yXFxzKnsvLFwiIGV4dGVuZHMgKGNsYXNzIGV4dGVuZHMgQXVkaW9Xb3JrbGV0UHJvY2Vzc29yIHtfX2I9bmV3IFdlYWtTZXQoKTtjb25zdHJ1Y3Rvcigpe3N1cGVyKCk7KHA9PnAucG9zdE1lc3NhZ2U9KHE9PihtLHQpPT5xLmNhbGwocCxtLHQ/dC5maWx0ZXIodT0+IXRoaXMuX19iLmhhcyh1KSk6dCkpKHAucG9zdE1lc3NhZ2UpKSh0aGlzLnBvcnQpfX0pe1wiKSxjPW5ldyBCbG9iKFtgJHtufTsocmVnaXN0ZXJQcm9jZXNzb3I9Pnske299XFxufSkoKG4scCk9PnJlZ2lzdGVyUHJvY2Vzc29yKG4sY2xhc3MgZXh0ZW5kcyBweyR7cz9cIlwiOlwiX19jID0gKGEpID0+IGEuZm9yRWFjaChlPT50aGlzLl9fYi5hZGQoZS5idWZmZXIpKTtcIn1wcm9jZXNzKGksbyxwKXske3M/XCJcIjpcImkuZm9yRWFjaCh0aGlzLl9fYyk7by5mb3JFYWNoKHRoaXMuX19jKTt0aGlzLl9fYyhPYmplY3QudmFsdWVzKHApKTtcIn1yZXR1cm4gc3VwZXIucHJvY2VzcyhpLm1hcChqPT5qLnNvbWUoaz0+ay5sZW5ndGg9PT0wKT9bXTpqKSxvLHApfX0pKWBdLHt0eXBlOlwiYXBwbGljYXRpb24vamF2YXNjcmlwdDsgY2hhcnNldD11dGYtOFwifSksaD1VUkwuY3JlYXRlT2JqZWN0VVJMKGMpO3JldHVybiBtLmF1ZGlvV29ya2xldC5hZGRNb2R1bGUoaCxmKS50aGVuKCgpPT57aWYoYShtKSlyZXR1cm47cmV0dXJuIHIobSkuYXVkaW9Xb3JrbGV0LmFkZE1vZHVsZShoLGYpfSkuZmluYWxseSgoKT0+VVJMLnJldm9rZU9iamVjdFVSTChoKSl9KTtjb25zdCBnPWguZ2V0KHApO2lmKHZvaWQgMCE9PWcmJmcuaGFzKGQpKXJldHVybiBQcm9taXNlLnJlc29sdmUoKTtjb25zdCB2PWMuZ2V0KHApO2lmKHZvaWQgMCE9PXYpe2NvbnN0IHQ9di5nZXQoZCk7aWYodm9pZCAwIT09dClyZXR1cm4gdH1jb25zdCBiPWkoZCkudGhlbigoW3QsZV0pPT57Y29uc3RbbixpXT15KHQsZSk7cmV0dXJuIHMoYCR7bn07KChhLGIpPT57KGFbYl09YVtiXXx8W10pLnB1c2goKEF1ZGlvV29ya2xldFByb2Nlc3NvcixnbG9iYWwscmVnaXN0ZXJQcm9jZXNzb3Isc2FtcGxlUmF0ZSxzZWxmLHdpbmRvdyk9Pnske2l9XFxufSl9KSh3aW5kb3csJ19BV0dTJylgKX0pLnRoZW4oKCk9Pntjb25zdCB0PWwuX0FXR1MucG9wKCk7aWYodm9pZCAwPT09dCl0aHJvdyBuZXcgU3ludGF4RXJyb3I7bihtLmN1cnJlbnRUaW1lLG0uc2FtcGxlUmF0ZSwoKT0+dChjbGFzc3t9LHZvaWQgMCwodCxzKT0+e2lmKFwiXCI9PT10LnRyaW0oKSl0aHJvdyBlKCk7Y29uc3Qgbj1fLmdldChtKTtpZih2b2lkIDAhPT1uKXtpZihuLmhhcyh0KSl0aHJvdyBlKCk7dyhzKSx4KHMucGFyYW1ldGVyRGVzY3JpcHRvcnMpLG4uc2V0KHQscyl9ZWxzZSB3KHMpLHgocy5wYXJhbWV0ZXJEZXNjcmlwdG9ycyksXy5zZXQobSxuZXcgTWFwKFtbdCxzXV0pKX0sbS5zYW1wbGVSYXRlLHZvaWQgMCx2b2lkIDApKX0pO3JldHVybiB2b2lkIDA9PT12P2Muc2V0KHAsbmV3IE1hcChbW2QsYl1dKSk6di5zZXQoZCxiKSxiLnRoZW4oKCk9Pntjb25zdCB0PWguZ2V0KHApO3ZvaWQgMD09PXQ/aC5zZXQocCxuZXcgU2V0KFtkXSkpOnQuYWRkKGQpfSkuZmluYWxseSgoKT0+e2NvbnN0IHQ9Yy5nZXQocCk7dm9pZCAwIT09dCYmdC5kZWxldGUoZCl9KSxifSkoeGUsSHQsKHQ9PmU9Pm5ldyBQcm9taXNlKChzLG4pPT57aWYobnVsbD09PXQpcmV0dXJuIHZvaWQgbihuZXcgU3ludGF4RXJyb3IpO2NvbnN0IGk9dC5kb2N1bWVudC5oZWFkO2lmKG51bGw9PT1pKW4obmV3IFN5bnRheEVycm9yKTtlbHNle2NvbnN0IG89dC5kb2N1bWVudC5jcmVhdGVFbGVtZW50KFwic2NyaXB0XCIpLHI9bmV3IEJsb2IoW2VdLHt0eXBlOlwiYXBwbGljYXRpb24vamF2YXNjcmlwdFwifSksYT1VUkwuY3JlYXRlT2JqZWN0VVJMKHIpLGM9dC5vbmVycm9yLGg9KCk9Pnt0Lm9uZXJyb3I9YyxVUkwucmV2b2tlT2JqZWN0VVJMKGEpfTt0Lm9uZXJyb3I9KGUscyxpLG8scik9PnM9PT1hfHxzPT09dC5sb2NhdGlvbi5ocmVmJiYxPT09aSYmMT09PW8/KGgoKSxuKHIpLCExKTpudWxsIT09Yz9jKGUscyxpLG8scik6dm9pZCAwLG8ub25lcnJvcj0oKT0+e2goKSxuKG5ldyBTeW50YXhFcnJvcil9LG8ub25sb2FkPSgpPT57aCgpLHMoKX0sby5zcmM9YSxvLnR5cGU9XCJtb2R1bGVcIixpLmFwcGVuZENoaWxkKG8pfX0pKShUZSksX24sKHQ9PmFzeW5jIGU9Pnt0cnl7Y29uc3QgdD1hd2FpdCBmZXRjaChlKTtpZih0Lm9rKXJldHVyblthd2FpdCB0LnRleHQoKSx0LnVybF19Y2F0Y2h7fXRocm93IHQoKX0pKCgpPT5uZXcgRE9NRXhjZXB0aW9uKFwiXCIsXCJBYm9ydEVycm9yXCIpKSxGZSxnbixOZSxuZXcgV2Vha01hcCxuZXcgV2Vha01hcCwoKHQsZSk9PmFzeW5jKCk9PntpZihudWxsPT09dClyZXR1cm4hMDtpZihudWxsPT09ZSlyZXR1cm4hMTtjb25zdCBzPW5ldyBCbG9iKFsnY2xhc3MgQSBleHRlbmRzIEF1ZGlvV29ya2xldFByb2Nlc3Nvcntwcm9jZXNzKGkpe3RoaXMucG9ydC5wb3N0TWVzc2FnZShpLFtpWzBdWzBdLmJ1ZmZlcl0pfX1yZWdpc3RlclByb2Nlc3NvcihcImFcIixBKSddLHt0eXBlOlwiYXBwbGljYXRpb24vamF2YXNjcmlwdDsgY2hhcnNldD11dGYtOFwifSksbj1uZXcgZSgxLDEyOCw4ZTMpLGk9VVJMLmNyZWF0ZU9iamVjdFVSTChzKTtsZXQgbz0hMSxyPSExO3RyeXthd2FpdCBuLmF1ZGlvV29ya2xldC5hZGRNb2R1bGUoaSk7Y29uc3QgZT1uZXcgdChuLFwiYVwiLHtudW1iZXJPZk91dHB1dHM6MH0pLHM9bi5jcmVhdGVPc2NpbGxhdG9yKCk7ZS5wb3J0Lm9ubWVzc2FnZT0oKT0+bz0hMCxlLm9ucHJvY2Vzc29yZXJyb3I9KCk9PnI9ITAscy5jb25uZWN0KGUpLGF3YWl0IG4uc3RhcnRSZW5kZXJpbmcoKX1jYXRjaHt9ZmluYWxseXtVUkwucmV2b2tlT2JqZWN0VVJMKGkpfXJldHVybiBvJiYhcn0pKHZuLFZlKSxUZSk6dm9pZCAwLHhuPSgodCxlKT0+cz0+dChzKXx8ZShzKSkoV2UsTmUpLHduPSgodCxlLHMsbixpLG8scixhLGMsaCx1LGwscCxkLGYsXyxtLGcsdix5KT0+Y2xhc3MgZXh0ZW5kcyBme2NvbnN0cnVjdG9yKGUscyl7c3VwZXIoZSxzKSx0aGlzLl9uYXRpdmVDb250ZXh0PWUsdGhpcy5fYXVkaW9Xb3JrbGV0PXZvaWQgMD09PXQ/dm9pZCAwOnthZGRNb2R1bGU6KGUscyk9PnQodGhpcyxlLHMpfX1nZXQgYXVkaW9Xb3JrbGV0KCl7cmV0dXJuIHRoaXMuX2F1ZGlvV29ya2xldH1jcmVhdGVBbmFseXNlcigpe3JldHVybiBuZXcgZSh0aGlzKX1jcmVhdGVCaXF1YWRGaWx0ZXIoKXtyZXR1cm4gbmV3IGkodGhpcyl9Y3JlYXRlQnVmZmVyKHQsZSxuKXtyZXR1cm4gbmV3IHMoe2xlbmd0aDplLG51bWJlck9mQ2hhbm5lbHM6dCxzYW1wbGVSYXRlOm59KX1jcmVhdGVCdWZmZXJTb3VyY2UoKXtyZXR1cm4gbmV3IG4odGhpcyl9Y3JlYXRlQ2hhbm5lbE1lcmdlcih0PTYpe3JldHVybiBuZXcgbyh0aGlzLHtudW1iZXJPZklucHV0czp0fSl9Y3JlYXRlQ2hhbm5lbFNwbGl0dGVyKHQ9Nil7cmV0dXJuIG5ldyByKHRoaXMse251bWJlck9mT3V0cHV0czp0fSl9Y3JlYXRlQ29uc3RhbnRTb3VyY2UoKXtyZXR1cm4gbmV3IGEodGhpcyl9Y3JlYXRlQ29udm9sdmVyKCl7cmV0dXJuIG5ldyBjKHRoaXMpfWNyZWF0ZURlbGF5KHQ9MSl7cmV0dXJuIG5ldyB1KHRoaXMse21heERlbGF5VGltZTp0fSl9Y3JlYXRlRHluYW1pY3NDb21wcmVzc29yKCl7cmV0dXJuIG5ldyBsKHRoaXMpfWNyZWF0ZUdhaW4oKXtyZXR1cm4gbmV3IHAodGhpcyl9Y3JlYXRlSUlSRmlsdGVyKHQsZSl7cmV0dXJuIG5ldyBkKHRoaXMse2ZlZWRiYWNrOmUsZmVlZGZvcndhcmQ6dH0pfWNyZWF0ZU9zY2lsbGF0b3IoKXtyZXR1cm4gbmV3IF8odGhpcyl9Y3JlYXRlUGFubmVyKCl7cmV0dXJuIG5ldyBtKHRoaXMpfWNyZWF0ZVBlcmlvZGljV2F2ZSh0LGUscz17ZGlzYWJsZU5vcm1hbGl6YXRpb246ITF9KXtyZXR1cm4gbmV3IGcodGhpcyx7Li4ucyxpbWFnOmUscmVhbDp0fSl9Y3JlYXRlU3RlcmVvUGFubmVyKCl7cmV0dXJuIG5ldyB2KHRoaXMpfWNyZWF0ZVdhdmVTaGFwZXIoKXtyZXR1cm4gbmV3IHkodGhpcyl9ZGVjb2RlQXVkaW9EYXRhKHQsZSxzKXtyZXR1cm4gaCh0aGlzLl9uYXRpdmVDb250ZXh0LHQpLnRoZW4odD0+KFwiZnVuY3Rpb25cIj09dHlwZW9mIGUmJmUodCksdCkpLmNhdGNoKHQ9Pnt0aHJvd1wiZnVuY3Rpb25cIj09dHlwZW9mIHMmJnModCksdH0pfX0pKHluLFllLHNzLGZzLHZzLFJzLHFzLFZzLFBzLCgodCxlLHMsbixpLG8scixhLGMsaCx1KT0+KGwscCk9Pntjb25zdCBkPXIobCk/bDpvKGwpO2lmKGkuaGFzKHApKXtjb25zdCB0PXMoKTtyZXR1cm4gUHJvbWlzZS5yZWplY3QodCl9dHJ5e2kuYWRkKHApfWNhdGNoe31yZXR1cm4gZShjLCgpPT5jKGQpKT9kLmRlY29kZUF1ZGlvRGF0YShwKS50aGVuKHM9PihlKGEsKCk9PmEocykpfHx1KHMpLHQuYWRkKHMpLHMpKTpuZXcgUHJvbWlzZSgoZSxzKT0+e2NvbnN0IGk9KCk9Pnt0cnl7KHQ9Pntjb25zdHtwb3J0MTplfT1uZXcgTWVzc2FnZUNoYW5uZWw7ZS5wb3N0TWVzc2FnZSh0LFt0XSl9KShwKX1jYXRjaHt9fSxvPXQ9PntzKHQpLGkoKX07dHJ5e2QuZGVjb2RlQXVkaW9EYXRhKHAscz0+e1wiZnVuY3Rpb25cIiE9dHlwZW9mIHMuY29weUZyb21DaGFubmVsJiYoaChzKSxGKHMpKSx0LmFkZChzKSxpKCksZShzKX0sdD0+e28obnVsbD09PXQ/bigpOnQpfSl9Y2F0Y2godCl7byh0KX19KX0pKEhlLHhlLCgpPT5uZXcgRE9NRXhjZXB0aW9uKFwiXCIsXCJEYXRhQ2xvbmVFcnJvclwiKSwoKT0+bmV3IERPTUV4Y2VwdGlvbihcIlwiLFwiRW5jb2RpbmdFcnJvclwiKSxuZXcgV2Vha1NldCxGZSx4bixSLFJ0LHRzLGVzKSxqcyxCcyxXcyxYcywkcyxLcyxjbixobixsbixkbiksYm49KCh0LGUscyxuKT0+Y2xhc3MgZXh0ZW5kcyB0e2NvbnN0cnVjdG9yKHQsaSl7Y29uc3Qgbz1zKHQpLHI9ZShvLGkpO2lmKG4obykpdGhyb3cgVHlwZUVycm9yKCk7c3VwZXIodCwhMCxyLG51bGwpLHRoaXMuX25hdGl2ZU1lZGlhRWxlbWVudEF1ZGlvU291cmNlTm9kZT1yfWdldCBtZWRpYUVsZW1lbnQoKXtyZXR1cm4gdGhpcy5fbmF0aXZlTWVkaWFFbGVtZW50QXVkaW9Tb3VyY2VOb2RlLm1lZGlhRWxlbWVudH19KShaZSwodCxlKT0+dC5jcmVhdGVNZWRpYUVsZW1lbnRTb3VyY2UoZS5tZWRpYUVsZW1lbnQpLEZlLE5lKSxUbj0oKHQsZSxzLG4pPT5jbGFzcyBleHRlbmRzIHR7Y29uc3RydWN0b3IodCxpKXtjb25zdCBvPXModCk7aWYobihvKSl0aHJvdyBuZXcgVHlwZUVycm9yO2NvbnN0IHI9ey4uLkV0LC4uLml9LGE9ZShvLHIpO3N1cGVyKHQsITEsYSxudWxsKSx0aGlzLl9uYXRpdmVNZWRpYVN0cmVhbUF1ZGlvRGVzdGluYXRpb25Ob2RlPWF9Z2V0IHN0cmVhbSgpe3JldHVybiB0aGlzLl9uYXRpdmVNZWRpYVN0cmVhbUF1ZGlvRGVzdGluYXRpb25Ob2RlLnN0cmVhbX19KShaZSwodCxlKT0+e2NvbnN0IHM9dC5jcmVhdGVNZWRpYVN0cmVhbURlc3RpbmF0aW9uKCk7cmV0dXJuIEl0KHMsZSksMT09PXMubnVtYmVyT2ZPdXRwdXRzJiZPYmplY3QuZGVmaW5lUHJvcGVydHkocyxcIm51bWJlck9mT3V0cHV0c1wiLHtnZXQ6KCk9PjB9KSxzfSxGZSxOZSksU249KCh0LGUscyxuKT0+Y2xhc3MgZXh0ZW5kcyB0e2NvbnN0cnVjdG9yKHQsaSl7Y29uc3Qgbz1zKHQpLHI9ZShvLGkpO2lmKG4obykpdGhyb3cgbmV3IFR5cGVFcnJvcjtzdXBlcih0LCEwLHIsbnVsbCksdGhpcy5fbmF0aXZlTWVkaWFTdHJlYW1BdWRpb1NvdXJjZU5vZGU9cn1nZXQgbWVkaWFTdHJlYW0oKXtyZXR1cm4gdGhpcy5fbmF0aXZlTWVkaWFTdHJlYW1BdWRpb1NvdXJjZU5vZGUubWVkaWFTdHJlYW19fSkoWmUsKHQse21lZGlhU3RyZWFtOmV9KT0+e2NvbnN0IHM9ZS5nZXRBdWRpb1RyYWNrcygpO3Muc29ydCgodCxlKT0+dC5pZDxlLmlkPy0xOnQuaWQ+ZS5pZD8xOjApO2NvbnN0IG49cy5zbGljZSgwLDEpLGk9dC5jcmVhdGVNZWRpYVN0cmVhbVNvdXJjZShuZXcgTWVkaWFTdHJlYW0obikpO3JldHVybiBPYmplY3QuZGVmaW5lUHJvcGVydHkoaSxcIm1lZGlhU3RyZWFtXCIse3ZhbHVlOmV9KSxpfSxGZSxOZSksa249KCh0LGUscyk9PmNsYXNzIGV4dGVuZHMgdHtjb25zdHJ1Y3Rvcih0LG4pe2NvbnN0IGk9cyh0KTtzdXBlcih0LCEwLGUoaSxuKSxudWxsKX19KShaZSwoKHQsZSk9PihzLHttZWRpYVN0cmVhbVRyYWNrOm59KT0+e2lmKFwiZnVuY3Rpb25cIj09dHlwZW9mIHMuY3JlYXRlTWVkaWFTdHJlYW1UcmFja1NvdXJjZSlyZXR1cm4gcy5jcmVhdGVNZWRpYVN0cmVhbVRyYWNrU291cmNlKG4pO2NvbnN0IGk9bmV3IE1lZGlhU3RyZWFtKFtuXSksbz1zLmNyZWF0ZU1lZGlhU3RyZWFtU291cmNlKGkpO2lmKFwiYXVkaW9cIiE9PW4ua2luZCl0aHJvdyB0KCk7aWYoZShzKSl0aHJvdyBuZXcgVHlwZUVycm9yO3JldHVybiBvfSkoQXQsTmUpLEZlKSxDbj0oKHQsZSxzLG4saSxvLHIsYSxjKT0+Y2xhc3MgZXh0ZW5kcyB0e2NvbnN0cnVjdG9yKHQ9e30pe2lmKG51bGw9PT1jKXRocm93IG5ldyBFcnJvcihcIk1pc3NpbmcgdGhlIG5hdGl2ZSBBdWRpb0NvbnRleHQgY29uc3RydWN0b3IuXCIpO2NvbnN0IGU9bmV3IGModCk7aWYobnVsbD09PWUpdGhyb3cgbigpO2lmKCFHKHQubGF0ZW5jeUhpbnQpKXRocm93IG5ldyBUeXBlRXJyb3IoYFRoZSBwcm92aWRlZCB2YWx1ZSAnJHt0LmxhdGVuY3lIaW50fScgaXMgbm90IGEgdmFsaWQgZW51bSB2YWx1ZSBvZiB0eXBlIEF1ZGlvQ29udGV4dExhdGVuY3lDYXRlZ29yeS5gKTtpZih2b2lkIDAhPT10LnNhbXBsZVJhdGUmJmUuc2FtcGxlUmF0ZSE9PXQuc2FtcGxlUmF0ZSl0aHJvdyBzKCk7c3VwZXIoZSwyKTtjb25zdHtsYXRlbmN5SGludDppfT10LHtzYW1wbGVSYXRlOm99PWU7aWYodGhpcy5fYmFzZUxhdGVuY3k9XCJudW1iZXJcIj09dHlwZW9mIGUuYmFzZUxhdGVuY3k/ZS5iYXNlTGF0ZW5jeTpcImJhbGFuY2VkXCI9PT1pPzUxMi9vOlwiaW50ZXJhY3RpdmVcIj09PWl8fHZvaWQgMD09PWk/MjU2L286XCJwbGF5YmFja1wiPT09aT8xMDI0L286MTI4Kk1hdGgubWF4KDIsTWF0aC5taW4oMTI4LE1hdGgucm91bmQoaSpvLzEyOCkpKS9vLHRoaXMuX25hdGl2ZUF1ZGlvQ29udGV4dD1lLFwid2Via2l0QXVkaW9Db250ZXh0XCI9PT1jLm5hbWU/KHRoaXMuX25hdGl2ZUdhaW5Ob2RlPWUuY3JlYXRlR2FpbigpLHRoaXMuX25hdGl2ZU9zY2lsbGF0b3JOb2RlPWUuY3JlYXRlT3NjaWxsYXRvcigpLHRoaXMuX25hdGl2ZUdhaW5Ob2RlLmdhaW4udmFsdWU9MWUtMzcsdGhpcy5fbmF0aXZlT3NjaWxsYXRvck5vZGUuY29ubmVjdCh0aGlzLl9uYXRpdmVHYWluTm9kZSkuY29ubmVjdChlLmRlc3RpbmF0aW9uKSx0aGlzLl9uYXRpdmVPc2NpbGxhdG9yTm9kZS5zdGFydCgpKToodGhpcy5fbmF0aXZlR2Fpbk5vZGU9bnVsbCx0aGlzLl9uYXRpdmVPc2NpbGxhdG9yTm9kZT1udWxsKSx0aGlzLl9zdGF0ZT1udWxsLFwicnVubmluZ1wiPT09ZS5zdGF0ZSl7dGhpcy5fc3RhdGU9XCJzdXNwZW5kZWRcIjtjb25zdCB0PSgpPT57XCJzdXNwZW5kZWRcIj09PXRoaXMuX3N0YXRlJiYodGhpcy5fc3RhdGU9bnVsbCksZS5yZW1vdmVFdmVudExpc3RlbmVyKFwic3RhdGVjaGFuZ2VcIix0KX07ZS5hZGRFdmVudExpc3RlbmVyKFwic3RhdGVjaGFuZ2VcIix0KX19Z2V0IGJhc2VMYXRlbmN5KCl7cmV0dXJuIHRoaXMuX2Jhc2VMYXRlbmN5fWdldCBzdGF0ZSgpe3JldHVybiBudWxsIT09dGhpcy5fc3RhdGU/dGhpcy5fc3RhdGU6dGhpcy5fbmF0aXZlQXVkaW9Db250ZXh0LnN0YXRlfWNsb3NlKCl7cmV0dXJuXCJjbG9zZWRcIj09PXRoaXMuc3RhdGU/dGhpcy5fbmF0aXZlQXVkaW9Db250ZXh0LmNsb3NlKCkudGhlbigoKT0+e3Rocm93IGUoKX0pOihcInN1c3BlbmRlZFwiPT09dGhpcy5fc3RhdGUmJih0aGlzLl9zdGF0ZT1udWxsKSx0aGlzLl9uYXRpdmVBdWRpb0NvbnRleHQuY2xvc2UoKS50aGVuKCgpPT57bnVsbCE9PXRoaXMuX25hdGl2ZUdhaW5Ob2RlJiZudWxsIT09dGhpcy5fbmF0aXZlT3NjaWxsYXRvck5vZGUmJih0aGlzLl9uYXRpdmVPc2NpbGxhdG9yTm9kZS5zdG9wKCksdGhpcy5fbmF0aXZlR2Fpbk5vZGUuZGlzY29ubmVjdCgpLHRoaXMuX25hdGl2ZU9zY2lsbGF0b3JOb2RlLmRpc2Nvbm5lY3QoKSksVyh0aGlzKX0pKX1jcmVhdGVNZWRpYUVsZW1lbnRTb3VyY2UodCl7cmV0dXJuIG5ldyBpKHRoaXMse21lZGlhRWxlbWVudDp0fSl9Y3JlYXRlTWVkaWFTdHJlYW1EZXN0aW5hdGlvbigpe3JldHVybiBuZXcgbyh0aGlzKX1jcmVhdGVNZWRpYVN0cmVhbVNvdXJjZSh0KXtyZXR1cm4gbmV3IHIodGhpcyx7bWVkaWFTdHJlYW06dH0pfWNyZWF0ZU1lZGlhU3RyZWFtVHJhY2tTb3VyY2UodCl7cmV0dXJuIG5ldyBhKHRoaXMse21lZGlhU3RyZWFtVHJhY2s6dH0pfXJlc3VtZSgpe3JldHVyblwic3VzcGVuZGVkXCI9PT10aGlzLl9zdGF0ZT9uZXcgUHJvbWlzZSgodCxlKT0+e2NvbnN0IHM9KCk9Pnt0aGlzLl9uYXRpdmVBdWRpb0NvbnRleHQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcInN0YXRlY2hhbmdlXCIscyksXCJydW5uaW5nXCI9PT10aGlzLl9uYXRpdmVBdWRpb0NvbnRleHQuc3RhdGU/dCgpOnRoaXMucmVzdW1lKCkudGhlbih0LGUpfTt0aGlzLl9uYXRpdmVBdWRpb0NvbnRleHQuYWRkRXZlbnRMaXN0ZW5lcihcInN0YXRlY2hhbmdlXCIscyl9KTp0aGlzLl9uYXRpdmVBdWRpb0NvbnRleHQucmVzdW1lKCkuY2F0Y2godD0+e2lmKHZvaWQgMD09PXR8fDE1PT09dC5jb2RlKXRocm93IGUoKTt0aHJvdyB0fSl9c3VzcGVuZCgpe3JldHVybiB0aGlzLl9uYXRpdmVBdWRpb0NvbnRleHQuc3VzcGVuZCgpLmNhdGNoKHQ9PntpZih2b2lkIDA9PT10KXRocm93IGUoKTt0aHJvdyB0fSl9fSkod24sQXQsSHQsc2UsYm4sVG4sU24sa24sQmUpLEFuPShEbj1Icyx0PT57Y29uc3QgZT1Ebi5nZXQodCk7aWYodm9pZCAwPT09ZSl0aHJvdyBuZXcgRXJyb3IoXCJUaGUgY29udGV4dCBoYXMgbm8gc2V0IG9mIEF1ZGlvV29ya2xldE5vZGVzLlwiKTtyZXR1cm4gZX0pO3ZhciBEbjtjb25zdCBPbj0oTW49QW4sKHQsZSk9PntNbih0KS5hZGQoZSl9KTt2YXIgTW47Y29uc3QgRW49KHQ9PihlLHMsbj0wLGk9MCk9Pntjb25zdCBvPWVbbl07aWYodm9pZCAwPT09byl0aHJvdyB0KCk7cmV0dXJuIGN0KHMpP28uY29ubmVjdChzLDAsaSk6by5jb25uZWN0KHMsMCl9KShxKSxSbj0odD0+KGUscyk9Pnt0KGUpLmRlbGV0ZShzKX0pKEFuKSxxbj0odD0+KGUscyxuLGk9MCk9PnZvaWQgMD09PXM/ZS5mb3JFYWNoKHQ9PnQuZGlzY29ubmVjdCgpKTpcIm51bWJlclwiPT10eXBlb2Ygcz9TdCh0LGUscykuZGlzY29ubmVjdCgpOmN0KHMpP3ZvaWQgMD09PW4/ZS5mb3JFYWNoKHQ9PnQuZGlzY29ubmVjdChzKSk6dm9pZCAwPT09aT9TdCh0LGUsbikuZGlzY29ubmVjdChzLDApOlN0KHQsZSxuKS5kaXNjb25uZWN0KHMsMCxpKTp2b2lkIDA9PT1uP2UuZm9yRWFjaCh0PT50LmRpc2Nvbm5lY3QocykpOlN0KHQsZSxuKS5kaXNjb25uZWN0KHMsMCkpKHEpLEZuPW5ldyBXZWFrTWFwLEluPSgodCxlKT0+cz0+ZSh0LHMpKShGbixiKSxWbj0oKHQsZSxzLG4saSxvLHIsYSxjLGgsdSxsLHApPT4oZCxmLF8sZyk9PntpZigwPT09Zy5udW1iZXJPZklucHV0cyYmMD09PWcubnVtYmVyT2ZPdXRwdXRzKXRocm93IGMoKTtjb25zdCB2PUFycmF5LmlzQXJyYXkoZy5vdXRwdXRDaGFubmVsQ291bnQpP2cub3V0cHV0Q2hhbm5lbENvdW50OkFycmF5LmZyb20oZy5vdXRwdXRDaGFubmVsQ291bnQpO2lmKHYuc29tZSh0PT50PDEpKXRocm93IGMoKTtpZih2Lmxlbmd0aCE9PWcubnVtYmVyT2ZPdXRwdXRzKXRocm93IGUoKTtpZihcImV4cGxpY2l0XCIhPT1nLmNoYW5uZWxDb3VudE1vZGUpdGhyb3cgYygpO2NvbnN0IHk9Zy5jaGFubmVsQ291bnQqZy5udW1iZXJPZklucHV0cyx4PXYucmVkdWNlKCh0LGUpPT50K2UsMCksdz12b2lkIDA9PT1fLnBhcmFtZXRlckRlc2NyaXB0b3JzPzA6Xy5wYXJhbWV0ZXJEZXNjcmlwdG9ycy5sZW5ndGg7aWYoeSt3PjZ8fHg+Nil0aHJvdyBjKCk7Y29uc3QgYj1uZXcgTWVzc2FnZUNoYW5uZWwsVD1bXSxTPVtdO2ZvcihsZXQgdD0wO3Q8Zy5udW1iZXJPZklucHV0czt0Kz0xKVQucHVzaChyKGQse2NoYW5uZWxDb3VudDpnLmNoYW5uZWxDb3VudCxjaGFubmVsQ291bnRNb2RlOmcuY2hhbm5lbENvdW50TW9kZSxjaGFubmVsSW50ZXJwcmV0YXRpb246Zy5jaGFubmVsSW50ZXJwcmV0YXRpb24sZ2FpbjoxfSkpLFMucHVzaChpKGQse2NoYW5uZWxDb3VudDpnLmNoYW5uZWxDb3VudCxjaGFubmVsQ291bnRNb2RlOlwiZXhwbGljaXRcIixjaGFubmVsSW50ZXJwcmV0YXRpb246XCJkaXNjcmV0ZVwiLG51bWJlck9mT3V0cHV0czpnLmNoYW5uZWxDb3VudH0pKTtjb25zdCBrPVtdO2lmKHZvaWQgMCE9PV8ucGFyYW1ldGVyRGVzY3JpcHRvcnMpZm9yKGNvbnN0e2RlZmF1bHRWYWx1ZTp0LG1heFZhbHVlOmUsbWluVmFsdWU6cyxuYW1lOm59b2YgXy5wYXJhbWV0ZXJEZXNjcmlwdG9ycyl7Y29uc3QgaT1vKGQse2NoYW5uZWxDb3VudDoxLGNoYW5uZWxDb3VudE1vZGU6XCJleHBsaWNpdFwiLGNoYW5uZWxJbnRlcnByZXRhdGlvbjpcImRpc2NyZXRlXCIsb2Zmc2V0OnZvaWQgMCE9PWcucGFyYW1ldGVyRGF0YVtuXT9nLnBhcmFtZXRlckRhdGFbbl06dm9pZCAwPT09dD8wOnR9KTtPYmplY3QuZGVmaW5lUHJvcGVydGllcyhpLm9mZnNldCx7ZGVmYXVsdFZhbHVlOntnZXQ6KCk9PnZvaWQgMD09PXQ/MDp0fSxtYXhWYWx1ZTp7Z2V0OigpPT52b2lkIDA9PT1lP046ZX0sbWluVmFsdWU6e2dldDooKT0+dm9pZCAwPT09cz9WOnN9fSksay5wdXNoKGkpfWNvbnN0IEM9bihkLHtjaGFubmVsQ291bnQ6MSxjaGFubmVsQ291bnRNb2RlOlwiZXhwbGljaXRcIixjaGFubmVsSW50ZXJwcmV0YXRpb246XCJzcGVha2Vyc1wiLG51bWJlck9mSW5wdXRzOk1hdGgubWF4KDEseSt3KX0pLEE9THQoZixkLnNhbXBsZVJhdGUpLEQ9YShkLEEseSt3LE1hdGgubWF4KDEseCkpLE89aShkLHtjaGFubmVsQ291bnQ6TWF0aC5tYXgoMSx4KSxjaGFubmVsQ291bnRNb2RlOlwiZXhwbGljaXRcIixjaGFubmVsSW50ZXJwcmV0YXRpb246XCJkaXNjcmV0ZVwiLG51bWJlck9mT3V0cHV0czpNYXRoLm1heCgxLHgpfSksTT1bXTtmb3IobGV0IHQ9MDt0PGcubnVtYmVyT2ZPdXRwdXRzO3QrPTEpTS5wdXNoKG4oZCx7Y2hhbm5lbENvdW50OjEsY2hhbm5lbENvdW50TW9kZTpcImV4cGxpY2l0XCIsY2hhbm5lbEludGVycHJldGF0aW9uOlwic3BlYWtlcnNcIixudW1iZXJPZklucHV0czp2W3RdfSkpO2ZvcihsZXQgdD0wO3Q8Zy5udW1iZXJPZklucHV0czt0Kz0xKXtUW3RdLmNvbm5lY3QoU1t0XSk7Zm9yKGxldCBlPTA7ZTxnLmNoYW5uZWxDb3VudDtlKz0xKVNbdF0uY29ubmVjdChDLGUsdCpnLmNoYW5uZWxDb3VudCtlKX1jb25zdCBFPW5ldyBwdCh2b2lkIDA9PT1fLnBhcmFtZXRlckRlc2NyaXB0b3JzP1tdOl8ucGFyYW1ldGVyRGVzY3JpcHRvcnMubWFwKCh7bmFtZTp0fSxlKT0+e2NvbnN0IHM9a1tlXTtyZXR1cm4gcy5jb25uZWN0KEMsMCx5K2UpLHMuc3RhcnQoMCksW3Qscy5vZmZzZXRdfSkpO0MuY29ubmVjdChEKTtsZXQgUj1nLmNoYW5uZWxJbnRlcnByZXRhdGlvbixxPW51bGw7Y29uc3QgRj0wPT09Zy5udW1iZXJPZk91dHB1dHM/W0RdOk0sST17Z2V0IGJ1ZmZlclNpemUoKXtyZXR1cm4gQX0sZ2V0IGNoYW5uZWxDb3VudCgpe3JldHVybiBnLmNoYW5uZWxDb3VudH0sc2V0IGNoYW5uZWxDb3VudCh0KXt0aHJvdyBzKCl9LGdldCBjaGFubmVsQ291bnRNb2RlKCl7cmV0dXJuIGcuY2hhbm5lbENvdW50TW9kZX0sc2V0IGNoYW5uZWxDb3VudE1vZGUodCl7dGhyb3cgcygpfSxnZXQgY2hhbm5lbEludGVycHJldGF0aW9uKCl7cmV0dXJuIFJ9LHNldCBjaGFubmVsSW50ZXJwcmV0YXRpb24odCl7Zm9yKGNvbnN0IGUgb2YgVCllLmNoYW5uZWxJbnRlcnByZXRhdGlvbj10O1I9dH0sZ2V0IGNvbnRleHQoKXtyZXR1cm4gRC5jb250ZXh0fSxnZXQgaW5wdXRzKCl7cmV0dXJuIFR9LGdldCBudW1iZXJPZklucHV0cygpe3JldHVybiBnLm51bWJlck9mSW5wdXRzfSxnZXQgbnVtYmVyT2ZPdXRwdXRzKCl7cmV0dXJuIGcubnVtYmVyT2ZPdXRwdXRzfSxnZXQgb25wcm9jZXNzb3JlcnJvcigpe3JldHVybiBxfSxzZXQgb25wcm9jZXNzb3JlcnJvcih0KXtcImZ1bmN0aW9uXCI9PXR5cGVvZiBxJiZJLnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJwcm9jZXNzb3JlcnJvclwiLHEpLHE9XCJmdW5jdGlvblwiPT10eXBlb2YgdD90Om51bGwsXCJmdW5jdGlvblwiPT10eXBlb2YgcSYmSS5hZGRFdmVudExpc3RlbmVyKFwicHJvY2Vzc29yZXJyb3JcIixxKX0sZ2V0IHBhcmFtZXRlcnMoKXtyZXR1cm4gRX0sZ2V0IHBvcnQoKXtyZXR1cm4gYi5wb3J0Mn0sYWRkRXZlbnRMaXN0ZW5lcjooLi4udCk9PkQuYWRkRXZlbnRMaXN0ZW5lcih0WzBdLHRbMV0sdFsyXSksY29ubmVjdDp0LmJpbmQobnVsbCxGKSxkaXNjb25uZWN0OmguYmluZChudWxsLEYpLGRpc3BhdGNoRXZlbnQ6KC4uLnQpPT5ELmRpc3BhdGNoRXZlbnQodFswXSkscmVtb3ZlRXZlbnRMaXN0ZW5lcjooLi4udCk9PkQucmVtb3ZlRXZlbnRMaXN0ZW5lcih0WzBdLHRbMV0sdFsyXSl9LFA9bmV3IE1hcDt2YXIgaixMO2IucG9ydDEuYWRkRXZlbnRMaXN0ZW5lcj0oaj1iLnBvcnQxLmFkZEV2ZW50TGlzdGVuZXIsKC4uLnQpPT57aWYoXCJtZXNzYWdlXCI9PT10WzBdKXtjb25zdCBlPVwiZnVuY3Rpb25cIj09dHlwZW9mIHRbMV0/dFsxXTpcIm9iamVjdFwiPT10eXBlb2YgdFsxXSYmbnVsbCE9PXRbMV0mJlwiZnVuY3Rpb25cIj09dHlwZW9mIHRbMV0uaGFuZGxlRXZlbnQ/dFsxXS5oYW5kbGVFdmVudDpudWxsO2lmKG51bGwhPT1lKXtjb25zdCBzPVAuZ2V0KHRbMV0pO3ZvaWQgMCE9PXM/dFsxXT1zOih0WzFdPXQ9Pnt1KGQuY3VycmVudFRpbWUsZC5zYW1wbGVSYXRlLCgpPT5lKHQpKX0sUC5zZXQoZSx0WzFdKSl9fXJldHVybiBqLmNhbGwoYi5wb3J0MSx0WzBdLHRbMV0sdFsyXSl9KSxiLnBvcnQxLnJlbW92ZUV2ZW50TGlzdGVuZXI9KEw9Yi5wb3J0MS5yZW1vdmVFdmVudExpc3RlbmVyLCguLi50KT0+e2lmKFwibWVzc2FnZVwiPT09dFswXSl7Y29uc3QgZT1QLmdldCh0WzFdKTt2b2lkIDAhPT1lJiYoUC5kZWxldGUodFsxXSksdFsxXT1lKX1yZXR1cm4gTC5jYWxsKGIucG9ydDEsdFswXSx0WzFdLHRbMl0pfSk7bGV0IHo9bnVsbDtPYmplY3QuZGVmaW5lUHJvcGVydHkoYi5wb3J0MSxcIm9ubWVzc2FnZVwiLHtnZXQ6KCk9Pnosc2V0OnQ9PntcImZ1bmN0aW9uXCI9PXR5cGVvZiB6JiZiLnBvcnQxLnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJtZXNzYWdlXCIseiksej1cImZ1bmN0aW9uXCI9PXR5cGVvZiB0P3Q6bnVsbCxcImZ1bmN0aW9uXCI9PXR5cGVvZiB6JiYoYi5wb3J0MS5hZGRFdmVudExpc3RlbmVyKFwibWVzc2FnZVwiLHopLGIucG9ydDEuc3RhcnQoKSl9fSksXy5wcm90b3R5cGUucG9ydD1iLnBvcnQxO2xldCBCPW51bGw7KCh0LGUscyxuKT0+e2xldCBpPW0uZ2V0KHQpO3ZvaWQgMD09PWkmJihpPW5ldyBXZWFrTWFwLG0uc2V0KHQsaSkpO2NvbnN0IG89enQocyxuKTtyZXR1cm4gaS5zZXQoZSxvKSxvfSkoZCxJLF8sZykudGhlbih0PT5CPXQpO2NvbnN0IFc9bXQoZy5udW1iZXJPZklucHV0cyxnLmNoYW5uZWxDb3VudCksRz1tdChnLm51bWJlck9mT3V0cHV0cyx2KSxVPXZvaWQgMD09PV8ucGFyYW1ldGVyRGVzY3JpcHRvcnM/W106Xy5wYXJhbWV0ZXJEZXNjcmlwdG9ycy5yZWR1Y2UoKHQse25hbWU6ZX0pPT4oey4uLnQsW2VdOm5ldyBGbG9hdDMyQXJyYXkoMTI4KX0pLHt9KTtsZXQgUT0hMDtjb25zdCBaPSgpPT57Zy5udW1iZXJPZk91dHB1dHM+MCYmRC5kaXNjb25uZWN0KE8pO2ZvcihsZXQgdD0wLGU9MDt0PGcubnVtYmVyT2ZPdXRwdXRzO3QrPTEpe2NvbnN0IHM9TVt0XTtmb3IobGV0IG49MDtuPHZbdF07bis9MSlPLmRpc2Nvbm5lY3QocyxlK24sbik7ZSs9dlt0XX19LFg9bmV3IE1hcDtELm9uYXVkaW9wcm9jZXNzPSh7aW5wdXRCdWZmZXI6dCxvdXRwdXRCdWZmZXI6ZX0pPT57aWYobnVsbCE9PUIpe2NvbnN0IHM9bChJKTtmb3IobGV0IG49MDtuPEE7bis9MTI4KXtmb3IobGV0IGU9MDtlPGcubnVtYmVyT2ZJbnB1dHM7ZSs9MSlmb3IobGV0IHM9MDtzPGcuY2hhbm5lbENvdW50O3MrPTEpZnQodCxXW2VdLHMscyxuKTt2b2lkIDAhPT1fLnBhcmFtZXRlckRlc2NyaXB0b3JzJiZfLnBhcmFtZXRlckRlc2NyaXB0b3JzLmZvckVhY2goKHtuYW1lOmV9LHMpPT57ZnQodCxVLGUseStzLG4pfSk7Zm9yKGxldCB0PTA7dDxnLm51bWJlck9mSW5wdXRzO3QrPTEpZm9yKGxldCBlPTA7ZTx2W3RdO2UrPTEpMD09PUdbdF1bZV0uYnl0ZUxlbmd0aCYmKEdbdF1bZV09bmV3IEZsb2F0MzJBcnJheSgxMjgpKTt0cnl7Y29uc3QgdD1XLm1hcCgodCxlKT0+e2lmKHNbZV0uc2l6ZT4wKXJldHVybiBYLnNldChlLEEvMTI4KSx0O2NvbnN0IG49WC5nZXQoZSk7cmV0dXJuIHZvaWQgMD09PW4/W106KHQuZXZlcnkodD0+dC5ldmVyeSh0PT4wPT09dCkpJiYoMT09PW4/WC5kZWxldGUoZSk6WC5zZXQoZSxuLTEpKSx0KX0pLGk9dShkLmN1cnJlbnRUaW1lK24vZC5zYW1wbGVSYXRlLGQuc2FtcGxlUmF0ZSwoKT0+Qi5wcm9jZXNzKHQsRyxVKSk7UT1pO2ZvcihsZXQgdD0wLHM9MDt0PGcubnVtYmVyT2ZPdXRwdXRzO3QrPTEpe2ZvcihsZXQgaT0wO2k8dlt0XTtpKz0xKV90KGUsR1t0XSxpLHMraSxuKTtzKz12W3RdfX1jYXRjaCh0KXtRPSExLEkuZGlzcGF0Y2hFdmVudChuZXcgRXJyb3JFdmVudChcInByb2Nlc3NvcmVycm9yXCIse2NvbG5vOnQuY29sbm8sZmlsZW5hbWU6dC5maWxlbmFtZSxsaW5lbm86dC5saW5lbm8sbWVzc2FnZTp0Lm1lc3NhZ2V9KSl9aWYoIVEpe2ZvcihsZXQgdD0wO3Q8Zy5udW1iZXJPZklucHV0czt0Kz0xKXtUW3RdLmRpc2Nvbm5lY3QoU1t0XSk7Zm9yKGxldCBlPTA7ZTxnLmNoYW5uZWxDb3VudDtlKz0xKVNbbl0uZGlzY29ubmVjdChDLGUsdCpnLmNoYW5uZWxDb3VudCtlKX1pZih2b2lkIDAhPT1fLnBhcmFtZXRlckRlc2NyaXB0b3JzKXtjb25zdCB0PV8ucGFyYW1ldGVyRGVzY3JpcHRvcnMubGVuZ3RoO2ZvcihsZXQgZT0wO2U8dDtlKz0xKXtjb25zdCB0PWtbZV07dC5kaXNjb25uZWN0KEMsMCx5K2UpLHQuc3RvcCgpfX1DLmRpc2Nvbm5lY3QoRCksRC5vbmF1ZGlvcHJvY2Vzcz1udWxsLFk/WigpOkooKTticmVha319fX07bGV0IFk9ITE7Y29uc3QgSD1yKGQse2NoYW5uZWxDb3VudDoxLGNoYW5uZWxDb3VudE1vZGU6XCJleHBsaWNpdFwiLGNoYW5uZWxJbnRlcnByZXRhdGlvbjpcImRpc2NyZXRlXCIsZ2FpbjowfSksJD0oKT0+RC5jb25uZWN0KEgpLmNvbm5lY3QoZC5kZXN0aW5hdGlvbiksSj0oKT0+e0QuZGlzY29ubmVjdChIKSxILmRpc2Nvbm5lY3QoKX07cmV0dXJuICQoKSxwKEksKCk9PntpZihRKXtKKCksZy5udW1iZXJPZk91dHB1dHM+MCYmRC5jb25uZWN0KE8pO2ZvcihsZXQgdD0wLGU9MDt0PGcubnVtYmVyT2ZPdXRwdXRzO3QrPTEpe2NvbnN0IHM9TVt0XTtmb3IobGV0IG49MDtuPHZbdF07bis9MSlPLmNvbm5lY3QocyxlK24sbik7ZSs9dlt0XX19WT0hMH0sKCk9PntRJiYoJCgpLFooKSksWT0hMX0pfSkoRW4scSxBdCxFcyxXdCxJcyxRdCxZdCxIdCxxbixfbixJbixBcyksTm49KCh0LGUscyxuLGkpPT4obyxyLGEsYyxoLHUpPT57aWYobnVsbCE9PWEpdHJ5e2NvbnN0IGU9bmV3IGEobyxjLHUpLG49bmV3IE1hcDtsZXQgcj1udWxsO2lmKE9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKGUse2NoYW5uZWxDb3VudDp7Z2V0OigpPT51LmNoYW5uZWxDb3VudCxzZXQ6KCk9Pnt0aHJvdyB0KCl9fSxjaGFubmVsQ291bnRNb2RlOntnZXQ6KCk9PlwiZXhwbGljaXRcIixzZXQ6KCk9Pnt0aHJvdyB0KCl9fSxvbnByb2Nlc3NvcmVycm9yOntnZXQ6KCk9PnIsc2V0OnQ9PntcImZ1bmN0aW9uXCI9PXR5cGVvZiByJiZlLnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJwcm9jZXNzb3JlcnJvclwiLHIpLHI9XCJmdW5jdGlvblwiPT10eXBlb2YgdD90Om51bGwsXCJmdW5jdGlvblwiPT10eXBlb2YgciYmZS5hZGRFdmVudExpc3RlbmVyKFwicHJvY2Vzc29yZXJyb3JcIixyKX19fSksZS5hZGRFdmVudExpc3RlbmVyPShwPWUuYWRkRXZlbnRMaXN0ZW5lciwoLi4udCk9PntpZihcInByb2Nlc3NvcmVycm9yXCI9PT10WzBdKXtjb25zdCBlPVwiZnVuY3Rpb25cIj09dHlwZW9mIHRbMV0/dFsxXTpcIm9iamVjdFwiPT10eXBlb2YgdFsxXSYmbnVsbCE9PXRbMV0mJlwiZnVuY3Rpb25cIj09dHlwZW9mIHRbMV0uaGFuZGxlRXZlbnQ/dFsxXS5oYW5kbGVFdmVudDpudWxsO2lmKG51bGwhPT1lKXtjb25zdCBzPW4uZ2V0KHRbMV0pO3ZvaWQgMCE9PXM/dFsxXT1zOih0WzFdPXM9PntcImVycm9yXCI9PT1zLnR5cGU/KE9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKHMse3R5cGU6e3ZhbHVlOlwicHJvY2Vzc29yZXJyb3JcIn19KSxlKHMpKTplKG5ldyBFcnJvckV2ZW50KHRbMF0sey4uLnN9KSl9LG4uc2V0KGUsdFsxXSkpfX1yZXR1cm4gcC5jYWxsKGUsXCJlcnJvclwiLHRbMV0sdFsyXSkscC5jYWxsKGUsLi4udCl9KSxlLnJlbW92ZUV2ZW50TGlzdGVuZXI9KGw9ZS5yZW1vdmVFdmVudExpc3RlbmVyLCguLi50KT0+e2lmKFwicHJvY2Vzc29yZXJyb3JcIj09PXRbMF0pe2NvbnN0IGU9bi5nZXQodFsxXSk7dm9pZCAwIT09ZSYmKG4uZGVsZXRlKHRbMV0pLHRbMV09ZSl9cmV0dXJuIGwuY2FsbChlLFwiZXJyb3JcIix0WzFdLHRbMl0pLGwuY2FsbChlLHRbMF0sdFsxXSx0WzJdKX0pLDAhPT11Lm51bWJlck9mT3V0cHV0cyl7Y29uc3QgdD1zKG8se2NoYW5uZWxDb3VudDoxLGNoYW5uZWxDb3VudE1vZGU6XCJleHBsaWNpdFwiLGNoYW5uZWxJbnRlcnByZXRhdGlvbjpcImRpc2NyZXRlXCIsZ2FpbjowfSk7ZS5jb25uZWN0KHQpLmNvbm5lY3Qoby5kZXN0aW5hdGlvbik7cmV0dXJuIGkoZSwoKT0+dC5kaXNjb25uZWN0KCksKCk9PnQuY29ubmVjdChvLmRlc3RpbmF0aW9uKSl9cmV0dXJuIGV9Y2F0Y2godCl7aWYoMTE9PT10LmNvZGUpdGhyb3cgbigpO3Rocm93IHR9dmFyIGwscDtpZih2b2lkIDA9PT1oKXRocm93IG4oKTtyZXR1cm4odD0+e2NvbnN0e3BvcnQxOmV9PW5ldyBNZXNzYWdlQ2hhbm5lbDt0cnl7ZS5wb3N0TWVzc2FnZSh0KX1maW5hbGx5e2UuY2xvc2UoKX19KSh1KSxlKG8scixoLHUpfSkoQXQsVm4sUXQsSHQsQXMpLFBuPSgodCxlLHMsbixpLG8scixhLGMsaCx1LGwscCxkLGYsXyk9PihtLGcsdik9Pntjb25zdCB5PW5ldyBXZWFrTWFwO2xldCB4PW51bGw7cmV0dXJue3JlbmRlcih3LGIsVCl7YShiLHcpO2NvbnN0IFM9eS5nZXQoYik7cmV0dXJuIHZvaWQgMCE9PVM/UHJvbWlzZS5yZXNvbHZlKFMpOihhc3luYyhhLHcsYik9PntsZXQgVD11KGEpLFM9bnVsbDtjb25zdCBrPUUoVCx3KSxDPUFycmF5LmlzQXJyYXkoZy5vdXRwdXRDaGFubmVsQ291bnQpP2cub3V0cHV0Q2hhbm5lbENvdW50OkFycmF5LmZyb20oZy5vdXRwdXRDaGFubmVsQ291bnQpO2lmKG51bGw9PT1sKXtjb25zdCB0PUMucmVkdWNlKCh0LGUpPT50K2UsMCkscz1pKHcse2NoYW5uZWxDb3VudDpNYXRoLm1heCgxLHQpLGNoYW5uZWxDb3VudE1vZGU6XCJleHBsaWNpdFwiLGNoYW5uZWxJbnRlcnByZXRhdGlvbjpcImRpc2NyZXRlXCIsbnVtYmVyT2ZPdXRwdXRzOk1hdGgubWF4KDEsdCl9KSxvPVtdO2ZvcihsZXQgdD0wO3Q8YS5udW1iZXJPZk91dHB1dHM7dCs9MSlvLnB1c2gobih3LHtjaGFubmVsQ291bnQ6MSxjaGFubmVsQ291bnRNb2RlOlwiZXhwbGljaXRcIixjaGFubmVsSW50ZXJwcmV0YXRpb246XCJzcGVha2Vyc1wiLG51bWJlck9mSW5wdXRzOkNbdF19KSk7Y29uc3QgaD1yKHcse2NoYW5uZWxDb3VudDpnLmNoYW5uZWxDb3VudCxjaGFubmVsQ291bnRNb2RlOmcuY2hhbm5lbENvdW50TW9kZSxjaGFubmVsSW50ZXJwcmV0YXRpb246Zy5jaGFubmVsSW50ZXJwcmV0YXRpb24sZ2FpbjoxfSk7aC5jb25uZWN0PWUuYmluZChudWxsLG8pLGguZGlzY29ubmVjdD1jLmJpbmQobnVsbCxvKSxTPVtzLG8saF19ZWxzZSBrfHwoVD1uZXcgbCh3LG0pKTtpZih5LnNldCh3LG51bGw9PT1TP1Q6U1syXSksbnVsbCE9PVMpe2lmKG51bGw9PT14KXtpZih2b2lkIDA9PT12KXRocm93IG5ldyBFcnJvcihcIk1pc3NpbmcgdGhlIHByb2Nlc3NvciBjb25zdHJ1Y3Rvci5cIik7aWYobnVsbD09PXApdGhyb3cgbmV3IEVycm9yKFwiTWlzc2luZyB0aGUgbmF0aXZlIE9mZmxpbmVBdWRpb0NvbnRleHQgY29uc3RydWN0b3IuXCIpO2NvbnN0IHQ9YS5jaGFubmVsQ291bnQqYS5udW1iZXJPZklucHV0cyxlPXZvaWQgMD09PXYucGFyYW1ldGVyRGVzY3JpcHRvcnM/MDp2LnBhcmFtZXRlckRlc2NyaXB0b3JzLmxlbmd0aCxzPXQrZSxjPWFzeW5jKCk9Pntjb25zdCBjPW5ldyBwKHMsMTI4Kk1hdGguY2VpbChhLmNvbnRleHQubGVuZ3RoLzEyOCksdy5zYW1wbGVSYXRlKSxoPVtdLHU9W107Zm9yKGxldCB0PTA7dDxnLm51bWJlck9mSW5wdXRzO3QrPTEpaC5wdXNoKHIoYyx7Y2hhbm5lbENvdW50OmcuY2hhbm5lbENvdW50LGNoYW5uZWxDb3VudE1vZGU6Zy5jaGFubmVsQ291bnRNb2RlLGNoYW5uZWxJbnRlcnByZXRhdGlvbjpnLmNoYW5uZWxJbnRlcnByZXRhdGlvbixnYWluOjF9KSksdS5wdXNoKGkoYyx7Y2hhbm5lbENvdW50OmcuY2hhbm5lbENvdW50LGNoYW5uZWxDb3VudE1vZGU6XCJleHBsaWNpdFwiLGNoYW5uZWxJbnRlcnByZXRhdGlvbjpcImRpc2NyZXRlXCIsbnVtYmVyT2ZPdXRwdXRzOmcuY2hhbm5lbENvdW50fSkpO2NvbnN0IGw9YXdhaXQgUHJvbWlzZS5hbGwoQXJyYXkuZnJvbShhLnBhcmFtZXRlcnMudmFsdWVzKCkpLm1hcChhc3luYyB0PT57Y29uc3QgZT1vKGMse2NoYW5uZWxDb3VudDoxLGNoYW5uZWxDb3VudE1vZGU6XCJleHBsaWNpdFwiLGNoYW5uZWxJbnRlcnByZXRhdGlvbjpcImRpc2NyZXRlXCIsb2Zmc2V0OnQudmFsdWV9KTtyZXR1cm4gYXdhaXQgZChjLHQsZS5vZmZzZXQsYiksZX0pKSxtPW4oYyx7Y2hhbm5lbENvdW50OjEsY2hhbm5lbENvdW50TW9kZTpcImV4cGxpY2l0XCIsY2hhbm5lbEludGVycHJldGF0aW9uOlwic3BlYWtlcnNcIixudW1iZXJPZklucHV0czpNYXRoLm1heCgxLHQrZSl9KTtmb3IobGV0IHQ9MDt0PGcubnVtYmVyT2ZJbnB1dHM7dCs9MSl7aFt0XS5jb25uZWN0KHVbdF0pO2ZvcihsZXQgZT0wO2U8Zy5jaGFubmVsQ291bnQ7ZSs9MSl1W3RdLmNvbm5lY3QobSxlLHQqZy5jaGFubmVsQ291bnQrZSl9Zm9yKGNvbnN0W2Usc11vZiBsLmVudHJpZXMoKSlzLmNvbm5lY3QobSwwLHQrZSkscy5zdGFydCgwKTtyZXR1cm4gbS5jb25uZWN0KGMuZGVzdGluYXRpb24pLGF3YWl0IFByb21pc2UuYWxsKGgubWFwKHQ9PmYoYSxjLHQsYikpKSxfKGMpfTt4PWd0KGEsMD09PXM/bnVsbDphd2FpdCBjKCksdyxnLEMsdixoKX1jb25zdCB0PWF3YWl0IHgsZT1zKHcse2J1ZmZlcjpudWxsLGNoYW5uZWxDb3VudDoyLGNoYW5uZWxDb3VudE1vZGU6XCJtYXhcIixjaGFubmVsSW50ZXJwcmV0YXRpb246XCJzcGVha2Vyc1wiLGxvb3A6ITEsbG9vcEVuZDowLGxvb3BTdGFydDowLHBsYXliYWNrUmF0ZToxfSksW2MsdSxsXT1TO251bGwhPT10JiYoZS5idWZmZXI9dCxlLnN0YXJ0KDApKSxlLmNvbm5lY3QoYyk7Zm9yKGxldCB0PTAsZT0wO3Q8YS5udW1iZXJPZk91dHB1dHM7dCs9MSl7Y29uc3Qgcz11W3RdO2ZvcihsZXQgbj0wO248Q1t0XTtuKz0xKWMuY29ubmVjdChzLGUrbixuKTtlKz1DW3RdfXJldHVybiBsfWlmKGspZm9yKGNvbnN0W2Usc11vZiBhLnBhcmFtZXRlcnMuZW50cmllcygpKWF3YWl0IHQodyxzLFQucGFyYW1ldGVycy5nZXQoZSksYik7ZWxzZSBmb3IoY29uc3RbdCxlXW9mIGEucGFyYW1ldGVycy5lbnRyaWVzKCkpYXdhaXQgZCh3LGUsVC5wYXJhbWV0ZXJzLmdldCh0KSxiKTtyZXR1cm4gYXdhaXQgZihhLHcsVCxiKSxUfSkodyxiLFQpfX19KShhcyxFbixjcyxFcyxXdCxJcyxRdCxSbixxbixfbixzdCx2bixWZSx1cyxPZSxVcyksam49KHQ9PmU9PnQuZ2V0KGUpKShtbiksTG49KHQ9PihlLHMpPT57dC5zZXQoZSxzKX0pKEZuKSx6bj1mbj8oKHQsZSxzLG4saSxvLHIsYSxjLGgsdSxsLHApPT5jbGFzcyBleHRlbmRzIGV7Y29uc3RydWN0b3IoZSxwLGQpe3ZhciBmO2NvbnN0IG09YShlKSxnPWMobSksdj11KHsuLi5kdCwuLi5kfSkseT1fLmdldChtKSx4PW51bGw9PXk/dm9pZCAwOnkuZ2V0KHApLHc9Z3x8XCJjbG9zZWRcIiE9PW0uc3RhdGU/bTpudWxsIT09KGY9cihtKSkmJnZvaWQgMCE9PWY/ZjptLGI9aSh3LGc/bnVsbDplLmJhc2VMYXRlbmN5LGgscCx4LHYpO3N1cGVyKGUsITAsYixnP24ocCx2LHgpOm51bGwpO2NvbnN0IFQ9W107Yi5wYXJhbWV0ZXJzLmZvckVhY2goKHQsZSk9Pntjb25zdCBuPXModGhpcyxnLHQpO1QucHVzaChbZSxuXSl9KSx0aGlzLl9uYXRpdmVBdWRpb1dvcmtsZXROb2RlPWIsdGhpcy5fb25wcm9jZXNzb3JlcnJvcj1udWxsLHRoaXMuX3BhcmFtZXRlcnM9bmV3IHB0KFQpLGcmJnQobSx0aGlzKTtjb25zdHthY3RpdmVJbnB1dHM6U309byh0aGlzKTtsKGIsUyl9Z2V0IG9ucHJvY2Vzc29yZXJyb3IoKXtyZXR1cm4gdGhpcy5fb25wcm9jZXNzb3JlcnJvcn1zZXQgb25wcm9jZXNzb3JlcnJvcih0KXtjb25zdCBlPVwiZnVuY3Rpb25cIj09dHlwZW9mIHQ/cCh0aGlzLHQpOm51bGw7dGhpcy5fbmF0aXZlQXVkaW9Xb3JrbGV0Tm9kZS5vbnByb2Nlc3NvcmVycm9yPWU7Y29uc3Qgcz10aGlzLl9uYXRpdmVBdWRpb1dvcmtsZXROb2RlLm9ucHJvY2Vzc29yZXJyb3I7dGhpcy5fb25wcm9jZXNzb3JlcnJvcj1udWxsIT09cyYmcz09PWU/dDpzfWdldCBwYXJhbWV0ZXJzKCl7cmV0dXJuIG51bGw9PT10aGlzLl9wYXJhbWV0ZXJzP3RoaXMuX25hdGl2ZUF1ZGlvV29ya2xldE5vZGUucGFyYW1ldGVyczp0aGlzLl9wYXJhbWV0ZXJzfWdldCBwb3J0KCl7cmV0dXJuIHRoaXMuX25hdGl2ZUF1ZGlvV29ya2xldE5vZGUucG9ydH19KShPbixaZSxwcyxQbixObixMLGpuLEZlLE5lLHZuLHQ9Pih7Li4udCxvdXRwdXRDaGFubmVsQ291bnQ6dm9pZCAwIT09dC5vdXRwdXRDaGFubmVsQ291bnQ/dC5vdXRwdXRDaGFubmVsQ291bnQ6MT09PXQubnVtYmVyT2ZJbnB1dHMmJjE9PT10Lm51bWJlck9mT3V0cHV0cz9bdC5jaGFubmVsQ291bnRdOkFycmF5LmZyb20oe2xlbmd0aDp0Lm51bWJlck9mT3V0cHV0c30sKCk9PjEpfSksTG4sZGUpOnZvaWQgMCxCbj0oKCh0LGUscyxuLGkpPT57fSkoQXQsSHQsc2UsJHMsQmUpLCgodCxlKT0+KHMsbixpKT0+e2lmKG51bGw9PT1lKXRocm93IG5ldyBFcnJvcihcIk1pc3NpbmcgdGhlIG5hdGl2ZSBPZmZsaW5lQXVkaW9Db250ZXh0IGNvbnN0cnVjdG9yLlwiKTt0cnl7cmV0dXJuIG5ldyBlKHMsbixpKX1jYXRjaChlKXtpZihcIlN5bnRheEVycm9yXCI9PT1lLm5hbWUpdGhyb3cgdCgpO3Rocm93IGV9fSkoSHQsVmUpKSxXbj0oKHQsZSxzLG4saSxvLHIsYSk9Pntjb25zdCBjPVtdO3JldHVybihoLHUpPT5zKGgpLnJlbmRlcihoLHUsYykudGhlbigoKT0+UHJvbWlzZS5hbGwoQXJyYXkuZnJvbShuKHUpKS5tYXAodD0+cyh0KS5yZW5kZXIodCx1LGMpKSkpLnRoZW4oKCk9PmkodSkpLnRoZW4ocz0+KFwiZnVuY3Rpb25cIiE9dHlwZW9mIHMuY29weUZyb21DaGFubmVsPyhyKHMpLEYocykpOmUobywoKT0+byhzKSl8fGEocyksdC5hZGQocykscykpfSkoSGUseGUsQWUsQW4sVXMsUix0cyxlcyksR249KCgodCxlLHMsbixpKT0+e30pKHhlLEF0LEJuLCRzLFduKSwoKHQsZSxzLG4saSk9PmNsYXNzIGV4dGVuZHMgdHtjb25zdHJ1Y3Rvcih0LHMsaSl7bGV0IG87aWYoXCJudW1iZXJcIj09dHlwZW9mIHQmJnZvaWQgMCE9PXMmJnZvaWQgMCE9PWkpbz17bGVuZ3RoOnMsbnVtYmVyT2ZDaGFubmVsczp0LHNhbXBsZVJhdGU6aX07ZWxzZXtpZihcIm9iamVjdFwiIT10eXBlb2YgdCl0aHJvdyBuZXcgRXJyb3IoXCJUaGUgZ2l2ZW4gcGFyYW1ldGVycyBhcmUgbm90IHZhbGlkLlwiKTtvPXR9Y29uc3R7bGVuZ3RoOnIsbnVtYmVyT2ZDaGFubmVsczphLHNhbXBsZVJhdGU6Y309ey4uLiR0LC4uLm99LGg9bihhLHIsYyk7ZShSdCwoKT0+UnQoaCkpfHxoLmFkZEV2ZW50TGlzdGVuZXIoXCJzdGF0ZWNoYW5nZVwiLCgoKT0+e2xldCB0PTA7Y29uc3QgZT1zPT57XCJydW5uaW5nXCI9PT10aGlzLl9zdGF0ZSYmKHQ+MD8oaC5yZW1vdmVFdmVudExpc3RlbmVyKFwic3RhdGVjaGFuZ2VcIixlKSxzLnN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbigpLHRoaXMuX3dhaXRGb3JUaGVQcm9taXNlVG9TZXR0bGUocykpOnQrPTEpfTtyZXR1cm4gZX0pKCkpLHN1cGVyKGgsYSksdGhpcy5fbGVuZ3RoPXIsdGhpcy5fbmF0aXZlT2ZmbGluZUF1ZGlvQ29udGV4dD1oLHRoaXMuX3N0YXRlPW51bGx9Z2V0IGxlbmd0aCgpe3JldHVybiB2b2lkIDA9PT10aGlzLl9uYXRpdmVPZmZsaW5lQXVkaW9Db250ZXh0Lmxlbmd0aD90aGlzLl9sZW5ndGg6dGhpcy5fbmF0aXZlT2ZmbGluZUF1ZGlvQ29udGV4dC5sZW5ndGh9Z2V0IHN0YXRlKCl7cmV0dXJuIG51bGw9PT10aGlzLl9zdGF0ZT90aGlzLl9uYXRpdmVPZmZsaW5lQXVkaW9Db250ZXh0LnN0YXRlOnRoaXMuX3N0YXRlfXN0YXJ0UmVuZGVyaW5nKCl7cmV0dXJuXCJydW5uaW5nXCI9PT10aGlzLl9zdGF0ZT9Qcm9taXNlLnJlamVjdChzKCkpOih0aGlzLl9zdGF0ZT1cInJ1bm5pbmdcIixpKHRoaXMuZGVzdGluYXRpb24sdGhpcy5fbmF0aXZlT2ZmbGluZUF1ZGlvQ29udGV4dCkuZmluYWxseSgoKT0+e3RoaXMuX3N0YXRlPW51bGwsVyh0aGlzKX0pKX1fd2FpdEZvclRoZVByb21pc2VUb1NldHRsZSh0KXtudWxsPT09dGhpcy5fc3RhdGU/dGhpcy5fbmF0aXZlT2ZmbGluZUF1ZGlvQ29udGV4dC5kaXNwYXRjaEV2ZW50KHQpOnNldFRpbWVvdXQoKCk9PnRoaXMuX3dhaXRGb3JUaGVQcm9taXNlVG9TZXR0bGUodCkpfX0pKHduLHhlLEF0LEJuLFduKSksVW49KCh0LGUpPT5zPT57Y29uc3Qgbj10LmdldChzKTtyZXR1cm4gZShuKXx8ZShzKX0pKHAsV2UpLFFuPShabj1oLFhuPVVlLHQ9PlpuLmhhcyh0KXx8WG4odCkpO3ZhciBabixYbjtjb25zdCBZbj0oSG49bCwkbj1RZSx0PT5Ibi5oYXModCl8fCRuKHQpKTt2YXIgSG4sJG47Y29uc3QgSm49KCh0LGUpPT5zPT57Y29uc3Qgbj10LmdldChzKTtyZXR1cm4gZShuKXx8ZShzKX0pKHAsTmUpLEtuPSgpPT4oYXN5bmModCxlLHMsbixpLG8scixhLGMsaCx1LGwscCxkLGYsXyk9PntpZih0KGUsZSkmJnQocyxzKSYmdChpLGkpJiZ0KG8sbykmJnQoYSxhKSYmdChjLGMpJiZ0KGgsaCkmJnQodSx1KSYmdChsLGwpJiZ0KHAscCkmJnQoZCxkKSl7cmV0dXJuKGF3YWl0IFByb21pc2UuYWxsKFt0KG4sbiksdChyLHIpLHQoZixmKSx0KF8sXyldKSkuZXZlcnkodD0+dCl9cmV0dXJuITF9KSh4ZSwodD0+KCk9PntpZihudWxsPT09dClyZXR1cm4hMTtjb25zdCBlPW5ldyB0KDEsMSw0NDEwMCkuY3JlYXRlQnVmZmVyKDEsMSw0NDEwMCk7aWYodm9pZCAwPT09ZS5jb3B5VG9DaGFubmVsKXJldHVybiEwO2NvbnN0IHM9bmV3IEZsb2F0MzJBcnJheSgyKTt0cnl7ZS5jb3B5RnJvbUNoYW5uZWwocywwLDApfWNhdGNoe3JldHVybiExfXJldHVybiEwfSkoVmUpLCh0PT4oKT0+e2lmKG51bGw9PT10KXJldHVybiExO2lmKHZvaWQgMCE9PXQucHJvdG90eXBlJiZ2b2lkIDAhPT10LnByb3RvdHlwZS5jbG9zZSlyZXR1cm4hMDtjb25zdCBlPW5ldyB0LHM9dm9pZCAwIT09ZS5jbG9zZTt0cnl7ZS5jbG9zZSgpfWNhdGNoe31yZXR1cm4gc30pKEJlKSwodD0+KCk9PntpZihudWxsPT09dClyZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCExKTtjb25zdCBlPW5ldyB0KDEsMSw0NDEwMCk7cmV0dXJuIG5ldyBQcm9taXNlKHQ9PntsZXQgcz0hMDtjb25zdCBuPW49PntzJiYocz0hMSxlLnN0YXJ0UmVuZGVyaW5nKCksdChuIGluc3RhbmNlb2YgVHlwZUVycm9yKSl9O2xldCBpO3RyeXtpPWUuZGVjb2RlQXVkaW9EYXRhKG51bGwsKCk9Pnt9LG4pfWNhdGNoKHQpe24odCl9dm9pZCAwIT09aSYmaS5jYXRjaChuKX0pfSkoVmUpLCh0PT4oKT0+e2lmKG51bGw9PT10KXJldHVybiExO2xldCBlO3RyeXtlPW5ldyB0KHtsYXRlbmN5SGludDpcImJhbGFuY2VkXCJ9KX1jYXRjaHtyZXR1cm4hMX1yZXR1cm4gZS5jbG9zZSgpLCEwfSkoQmUpLCh0PT4oKT0+e2lmKG51bGw9PT10KXJldHVybiExO2NvbnN0IGU9bmV3IHQoMSwxLDQ0MTAwKS5jcmVhdGVHYWluKCkscz1lLmNvbm5lY3QoZSk9PT1lO3JldHVybiBlLmRpc2Nvbm5lY3QoZSksc30pKFZlKSwoKHQsZSk9PmFzeW5jKCk9PntpZihudWxsPT09dClyZXR1cm4hMDtpZihudWxsPT09ZSlyZXR1cm4hMTtjb25zdCBzPW5ldyBCbG9iKFsnY2xhc3MgQSBleHRlbmRzIEF1ZGlvV29ya2xldFByb2Nlc3Nvcntwcm9jZXNzKCl7dGhpcy5wb3J0LnBvc3RNZXNzYWdlKDApfX1yZWdpc3RlclByb2Nlc3NvcihcImFcIixBKSddLHt0eXBlOlwiYXBwbGljYXRpb24vamF2YXNjcmlwdDsgY2hhcnNldD11dGYtOFwifSksbj1uZXcgZSgxLDEyOCw4ZTMpLGk9VVJMLmNyZWF0ZU9iamVjdFVSTChzKTtsZXQgbz0hMTt0cnl7YXdhaXQgbi5hdWRpb1dvcmtsZXQuYWRkTW9kdWxlKGkpO2NvbnN0IGU9bmV3IHQobixcImFcIix7bnVtYmVyT2ZPdXRwdXRzOjB9KSxzPW4uY3JlYXRlT3NjaWxsYXRvcigpO2UucG9ydC5vbm1lc3NhZ2U9KCk9Pm89ITAscy5jb25uZWN0KGUpLHMuc3RhcnQoMCksYXdhaXQgbi5zdGFydFJlbmRlcmluZygpLG98fGF3YWl0IG5ldyBQcm9taXNlKHQ9PnNldFRpbWVvdXQodCw1KSl9Y2F0Y2h7fWZpbmFsbHl7VVJMLnJldm9rZU9iamVjdFVSTChpKX1yZXR1cm4gb30pKHZuLFZlKSwodD0+KCk9PntpZihudWxsPT09dClyZXR1cm4hMTtjb25zdCBlPW5ldyB0KDEsMSw0NDEwMCkuY3JlYXRlQ2hhbm5lbE1lcmdlcigpO2lmKFwibWF4XCI9PT1lLmNoYW5uZWxDb3VudE1vZGUpcmV0dXJuITA7dHJ5e2UuY2hhbm5lbENvdW50PTJ9Y2F0Y2h7cmV0dXJuITB9cmV0dXJuITF9KShWZSksKHQ9PigpPT57aWYobnVsbD09PXQpcmV0dXJuITE7Y29uc3QgZT1uZXcgdCgxLDEsNDQxMDApO2lmKHZvaWQgMD09PWUuY3JlYXRlQ29uc3RhbnRTb3VyY2UpcmV0dXJuITA7cmV0dXJuIGUuY3JlYXRlQ29uc3RhbnRTb3VyY2UoKS5vZmZzZXQubWF4VmFsdWUhPT1OdW1iZXIuUE9TSVRJVkVfSU5GSU5JVFl9KShWZSksKHQ9PigpPT57aWYobnVsbD09PXQpcmV0dXJuITE7Y29uc3QgZT1uZXcgdCgxLDEsNDQxMDApLHM9ZS5jcmVhdGVDb252b2x2ZXIoKTtzLmJ1ZmZlcj1lLmNyZWF0ZUJ1ZmZlcigxLDEsZS5zYW1wbGVSYXRlKTt0cnl7cy5idWZmZXI9ZS5jcmVhdGVCdWZmZXIoMSwxLGUuc2FtcGxlUmF0ZSl9Y2F0Y2h7cmV0dXJuITF9cmV0dXJuITB9KShWZSksKHQ9PigpPT57aWYobnVsbD09PXQpcmV0dXJuITE7Y29uc3QgZT1uZXcgdCgxLDEsNDQxMDApLmNyZWF0ZUNvbnZvbHZlcigpO3RyeXtlLmNoYW5uZWxDb3VudD0xfWNhdGNoe3JldHVybiExfXJldHVybiEwfSkoVmUpLHVlLCh0PT4oKT0+bnVsbCE9PXQmJnQuaGFzT3duUHJvcGVydHkoXCJpc1NlY3VyZUNvbnRleHRcIikpKFRlKSwodD0+KCk9PntpZihudWxsPT09dClyZXR1cm4hMTtjb25zdCBlPW5ldyB0O3RyeXtyZXR1cm4gZS5jcmVhdGVNZWRpYVN0cmVhbVNvdXJjZShuZXcgTWVkaWFTdHJlYW0pLCExfWNhdGNoKHQpe3JldHVybiEwfX0pKEJlKSwodD0+KCk9PntpZihudWxsPT09dClyZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCExKTtjb25zdCBlPW5ldyB0KDEsMSw0NDEwMCk7aWYodm9pZCAwPT09ZS5jcmVhdGVTdGVyZW9QYW5uZXIpcmV0dXJuIFByb21pc2UucmVzb2x2ZSghMCk7aWYodm9pZCAwPT09ZS5jcmVhdGVDb25zdGFudFNvdXJjZSlyZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCEwKTtjb25zdCBzPWUuY3JlYXRlQ29uc3RhbnRTb3VyY2UoKSxuPWUuY3JlYXRlU3RlcmVvUGFubmVyKCk7cmV0dXJuIHMuY2hhbm5lbENvdW50PTEscy5vZmZzZXQudmFsdWU9MSxuLmNoYW5uZWxDb3VudD0xLHMuc3RhcnQoKSxzLmNvbm5lY3QobikuY29ubmVjdChlLmRlc3RpbmF0aW9uKSxlLnN0YXJ0UmVuZGVyaW5nKCkudGhlbih0PT4xIT09dC5nZXRDaGFubmVsRGF0YSgwKVswXSl9KShWZSksbGUpO2Z1bmN0aW9uIHRpKHQsZSl7aWYoIXQpdGhyb3cgbmV3IEVycm9yKGUpfWZ1bmN0aW9uIGVpKHQsZSxzPTEvMCl7aWYoIShlPD10JiZ0PD1zKSl0aHJvdyBuZXcgUmFuZ2VFcnJvcihgVmFsdWUgbXVzdCBiZSB3aXRoaW4gWyR7ZX0sICR7c31dLCBnb3Q6ICR7dH1gKX1mdW5jdGlvbiBzaSh0KXt0LmlzT2ZmbGluZXx8XCJydW5uaW5nXCI9PT10LnN0YXRlfHxyaSgnVGhlIEF1ZGlvQ29udGV4dCBpcyBcInN1c3BlbmRlZFwiLiBJbnZva2UgVG9uZS5zdGFydCgpIGZyb20gYSB1c2VyIGFjdGlvbiB0byBzdGFydCB0aGUgYXVkaW8uJyl9bGV0IG5pPWNvbnNvbGU7ZnVuY3Rpb24gaWkodCl7bmk9dH1mdW5jdGlvbiBvaSguLi50KXtuaS5sb2coLi4udCl9ZnVuY3Rpb24gcmkoLi4udCl7bmkud2FybiguLi50KX1mdW5jdGlvbiBhaSh0KXtyZXR1cm4gdm9pZCAwPT09dH1mdW5jdGlvbiBjaSh0KXtyZXR1cm4hYWkodCl9ZnVuY3Rpb24gaGkodCl7cmV0dXJuXCJmdW5jdGlvblwiPT10eXBlb2YgdH1mdW5jdGlvbiB1aSh0KXtyZXR1cm5cIm51bWJlclwiPT10eXBlb2YgdH1mdW5jdGlvbiBsaSh0KXtyZXR1cm5cIltvYmplY3QgT2JqZWN0XVwiPT09T2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKHQpJiZ0LmNvbnN0cnVjdG9yPT09T2JqZWN0fWZ1bmN0aW9uIHBpKHQpe3JldHVyblwiYm9vbGVhblwiPT10eXBlb2YgdH1mdW5jdGlvbiBkaSh0KXtyZXR1cm4gQXJyYXkuaXNBcnJheSh0KX1mdW5jdGlvbiBmaSh0KXtyZXR1cm5cInN0cmluZ1wiPT10eXBlb2YgdH1mdW5jdGlvbiBfaSh0KXtyZXR1cm4gZmkodCkmJi9eKFthLWddezF9KD86YnwjfHh8YmIpPykoLT9bMC05XSspL2kudGVzdCh0KX1jb25zdCBtaT1cIm9iamVjdFwiPT10eXBlb2Ygc2VsZj9zZWxmOm51bGwsZ2k9bWkmJihtaS5oYXNPd25Qcm9wZXJ0eShcIkF1ZGlvQ29udGV4dFwiKXx8bWkuaGFzT3duUHJvcGVydHkoXCJ3ZWJraXRBdWRpb0NvbnRleHRcIikpO2Z1bmN0aW9uIHZpKHQsZSxzLG4pe3ZhciBpLG89YXJndW1lbnRzLmxlbmd0aCxyPW88Mz9lOm51bGw9PT1uP249T2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihlLHMpOm47aWYoXCJvYmplY3RcIj09dHlwZW9mIFJlZmxlY3QmJlwiZnVuY3Rpb25cIj09dHlwZW9mIFJlZmxlY3QuZGVjb3JhdGUpcj1SZWZsZWN0LmRlY29yYXRlKHQsZSxzLG4pO2Vsc2UgZm9yKHZhciBhPXQubGVuZ3RoLTE7YT49MDthLS0pKGk9dFthXSkmJihyPShvPDM/aShyKTpvPjM/aShlLHMscik6aShlLHMpKXx8cik7cmV0dXJuIG8+MyYmciYmT2JqZWN0LmRlZmluZVByb3BlcnR5KGUscyxyKSxyfWZ1bmN0aW9uIHlpKHQsZSxzLG4pe3JldHVybiBuZXcoc3x8KHM9UHJvbWlzZSkpKChmdW5jdGlvbihpLG8pe2Z1bmN0aW9uIHIodCl7dHJ5e2Mobi5uZXh0KHQpKX1jYXRjaCh0KXtvKHQpfX1mdW5jdGlvbiBhKHQpe3RyeXtjKG4udGhyb3codCkpfWNhdGNoKHQpe28odCl9fWZ1bmN0aW9uIGModCl7dmFyIGU7dC5kb25lP2kodC52YWx1ZSk6KGU9dC52YWx1ZSxlIGluc3RhbmNlb2Ygcz9lOm5ldyBzKChmdW5jdGlvbih0KXt0KGUpfSkpKS50aGVuKHIsYSl9Yygobj1uLmFwcGx5KHQsZXx8W10pKS5uZXh0KCkpfSkpfU9iamVjdC5jcmVhdGU7T2JqZWN0LmNyZWF0ZTtjbGFzcyB4aXtjb25zdHJ1Y3Rvcih0LGUscyl7dGhpcy5fY2FsbGJhY2s9dCx0aGlzLl90eXBlPWUsdGhpcy5fdXBkYXRlSW50ZXJ2YWw9cyx0aGlzLl9jcmVhdGVDbG9jaygpfV9jcmVhdGVXb3JrZXIoKXtjb25zdCB0PW5ldyBCbG9iKFtgXFxuXFx0XFx0XFx0Ly8gdGhlIGluaXRpYWwgdGltZW91dCB0aW1lXFxuXFx0XFx0XFx0bGV0IHRpbWVvdXRUaW1lID0gICR7KDFlMyp0aGlzLl91cGRhdGVJbnRlcnZhbCkudG9GaXhlZCgxKX07XFxuXFx0XFx0XFx0Ly8gb25tZXNzYWdlIGNhbGxiYWNrXFxuXFx0XFx0XFx0c2VsZi5vbm1lc3NhZ2UgPSBmdW5jdGlvbihtc2cpe1xcblxcdFxcdFxcdFxcdHRpbWVvdXRUaW1lID0gcGFyc2VJbnQobXNnLmRhdGEpO1xcblxcdFxcdFxcdH07XFxuXFx0XFx0XFx0Ly8gdGhlIHRpY2sgZnVuY3Rpb24gd2hpY2ggcG9zdHMgYSBtZXNzYWdlXFxuXFx0XFx0XFx0Ly8gYW5kIHNjaGVkdWxlcyBhIG5ldyB0aWNrXFxuXFx0XFx0XFx0ZnVuY3Rpb24gdGljaygpe1xcblxcdFxcdFxcdFxcdHNldFRpbWVvdXQodGljaywgdGltZW91dFRpbWUpO1xcblxcdFxcdFxcdFxcdHNlbGYucG9zdE1lc3NhZ2UoJ3RpY2snKTtcXG5cXHRcXHRcXHR9XFxuXFx0XFx0XFx0Ly8gY2FsbCB0aWNrIGluaXRpYWxseVxcblxcdFxcdFxcdHRpY2soKTtcXG5cXHRcXHRcXHRgXSx7dHlwZTpcInRleHQvamF2YXNjcmlwdFwifSksZT1VUkwuY3JlYXRlT2JqZWN0VVJMKHQpLHM9bmV3IFdvcmtlcihlKTtzLm9ubWVzc2FnZT10aGlzLl9jYWxsYmFjay5iaW5kKHRoaXMpLHRoaXMuX3dvcmtlcj1zfV9jcmVhdGVUaW1lb3V0KCl7dGhpcy5fdGltZW91dD1zZXRUaW1lb3V0KCgpPT57dGhpcy5fY3JlYXRlVGltZW91dCgpLHRoaXMuX2NhbGxiYWNrKCl9LDFlMyp0aGlzLl91cGRhdGVJbnRlcnZhbCl9X2NyZWF0ZUNsb2NrKCl7aWYoXCJ3b3JrZXJcIj09PXRoaXMuX3R5cGUpdHJ5e3RoaXMuX2NyZWF0ZVdvcmtlcigpfWNhdGNoKHQpe3RoaXMuX3R5cGU9XCJ0aW1lb3V0XCIsdGhpcy5fY3JlYXRlQ2xvY2soKX1lbHNlXCJ0aW1lb3V0XCI9PT10aGlzLl90eXBlJiZ0aGlzLl9jcmVhdGVUaW1lb3V0KCl9X2Rpc3Bvc2VDbG9jaygpe3RoaXMuX3RpbWVvdXQmJihjbGVhclRpbWVvdXQodGhpcy5fdGltZW91dCksdGhpcy5fdGltZW91dD0wKSx0aGlzLl93b3JrZXImJih0aGlzLl93b3JrZXIudGVybWluYXRlKCksdGhpcy5fd29ya2VyLm9ubWVzc2FnZT1udWxsKX1nZXQgdXBkYXRlSW50ZXJ2YWwoKXtyZXR1cm4gdGhpcy5fdXBkYXRlSW50ZXJ2YWx9c2V0IHVwZGF0ZUludGVydmFsKHQpe3RoaXMuX3VwZGF0ZUludGVydmFsPU1hdGgubWF4KHQsMTI4LzQ0MTAwKSxcIndvcmtlclwiPT09dGhpcy5fdHlwZSYmdGhpcy5fd29ya2VyLnBvc3RNZXNzYWdlKE1hdGgubWF4KDFlMyp0LDEpKX1nZXQgdHlwZSgpe3JldHVybiB0aGlzLl90eXBlfXNldCB0eXBlKHQpe3RoaXMuX2Rpc3Bvc2VDbG9jaygpLHRoaXMuX3R5cGU9dCx0aGlzLl9jcmVhdGVDbG9jaygpfWRpc3Bvc2UoKXt0aGlzLl9kaXNwb3NlQ2xvY2soKX19ZnVuY3Rpb24gd2kodCl7cmV0dXJuIFluKHQpfWZ1bmN0aW9uIGJpKHQpe3JldHVybiBRbih0KX1mdW5jdGlvbiBUaSh0KXtyZXR1cm4gSm4odCl9ZnVuY3Rpb24gU2kodCl7cmV0dXJuIFVuKHQpfWZ1bmN0aW9uIGtpKHQpe3JldHVybiB0IGluc3RhbmNlb2YgQXVkaW9CdWZmZXJ9ZnVuY3Rpb24gQ2kodCxlKXtyZXR1cm5cInZhbHVlXCI9PT10fHx3aShlKXx8YmkoZSl8fGtpKGUpfWZ1bmN0aW9uIEFpKHQsLi4uZSl7aWYoIWUubGVuZ3RoKXJldHVybiB0O2NvbnN0IHM9ZS5zaGlmdCgpO2lmKGxpKHQpJiZsaShzKSlmb3IoY29uc3QgZSBpbiBzKUNpKGUsc1tlXSk/dFtlXT1zW2VdOmxpKHNbZV0pPyh0W2VdfHxPYmplY3QuYXNzaWduKHQse1tlXTp7fX0pLEFpKHRbZV0sc1tlXSkpOk9iamVjdC5hc3NpZ24odCx7W2VdOnNbZV19KTtyZXR1cm4gQWkodCwuLi5lKX1mdW5jdGlvbiBEaSh0LGUscz1bXSxuKXtjb25zdCBpPXt9LG89QXJyYXkuZnJvbShlKTtpZihsaShvWzBdKSYmbiYmIVJlZmxlY3QuaGFzKG9bMF0sbikpe09iamVjdC5rZXlzKG9bMF0pLnNvbWUoZT0+UmVmbGVjdC5oYXModCxlKSl8fChBaShpLHtbbl06b1swXX0pLHMuc3BsaWNlKHMuaW5kZXhPZihuKSwxKSxvLnNoaWZ0KCkpfWlmKDE9PT1vLmxlbmd0aCYmbGkob1swXSkpQWkoaSxvWzBdKTtlbHNlIGZvcihsZXQgdD0wO3Q8cy5sZW5ndGg7dCsrKWNpKG9bdF0pJiYoaVtzW3RdXT1vW3RdKTtyZXR1cm4gQWkodCxpKX1mdW5jdGlvbiBPaSh0LGUpe3JldHVybiBhaSh0KT9lOnR9ZnVuY3Rpb24gTWkodCxlKXtyZXR1cm4gZS5mb3JFYWNoKGU9PntSZWZsZWN0Lmhhcyh0LGUpJiZkZWxldGUgdFtlXX0pLHR9XG4vKipcbiAqIFRvbmUuanNcbiAqIEBhdXRob3IgWW90YW0gTWFublxuICogQGxpY2Vuc2UgaHR0cDovL29wZW5zb3VyY2Uub3JnL2xpY2Vuc2VzL01JVCBNSVQgTGljZW5zZVxuICogQGNvcHlyaWdodCAyMDE0LTIwMTkgWW90YW0gTWFublxuICovY2xhc3MgRWl7Y29uc3RydWN0b3IoKXt0aGlzLmRlYnVnPSExLHRoaXMuX3dhc0Rpc3Bvc2VkPSExfXN0YXRpYyBnZXREZWZhdWx0cygpe3JldHVybnt9fWxvZyguLi50KXsodGhpcy5kZWJ1Z3x8bWkmJnRoaXMudG9TdHJpbmcoKT09PW1pLlRPTkVfREVCVUdfQ0xBU1MpJiZvaSh0aGlzLC4uLnQpfWRpc3Bvc2UoKXtyZXR1cm4gdGhpcy5fd2FzRGlzcG9zZWQ9ITAsdGhpc31nZXQgZGlzcG9zZWQoKXtyZXR1cm4gdGhpcy5fd2FzRGlzcG9zZWR9dG9TdHJpbmcoKXtyZXR1cm4gdGhpcy5uYW1lfX1FaS52ZXJzaW9uPW87ZnVuY3Rpb24gUmkodCxlKXtyZXR1cm4gdD5lKzFlLTZ9ZnVuY3Rpb24gcWkodCxlKXtyZXR1cm4gUmkodCxlKXx8SWkodCxlKX1mdW5jdGlvbiBGaSh0LGUpe3JldHVybiB0KzFlLTY8ZX1mdW5jdGlvbiBJaSh0LGUpe3JldHVybiBNYXRoLmFicyh0LWUpPDFlLTZ9ZnVuY3Rpb24gVmkodCxlLHMpe3JldHVybiBNYXRoLm1heChNYXRoLm1pbih0LHMpLGUpfWNsYXNzIE5pIGV4dGVuZHMgRWl7Y29uc3RydWN0b3IoKXtzdXBlcigpLHRoaXMubmFtZT1cIlRpbWVsaW5lXCIsdGhpcy5fdGltZWxpbmU9W107Y29uc3QgdD1EaShOaS5nZXREZWZhdWx0cygpLGFyZ3VtZW50cyxbXCJtZW1vcnlcIl0pO3RoaXMubWVtb3J5PXQubWVtb3J5LHRoaXMuaW5jcmVhc2luZz10LmluY3JlYXNpbmd9c3RhdGljIGdldERlZmF1bHRzKCl7cmV0dXJue21lbW9yeToxLzAsaW5jcmVhc2luZzohMX19Z2V0IGxlbmd0aCgpe3JldHVybiB0aGlzLl90aW1lbGluZS5sZW5ndGh9YWRkKHQpe2lmKHRpKFJlZmxlY3QuaGFzKHQsXCJ0aW1lXCIpLFwiVGltZWxpbmU6IGV2ZW50cyBtdXN0IGhhdmUgYSB0aW1lIGF0dHJpYnV0ZVwiKSx0LnRpbWU9dC50aW1lLnZhbHVlT2YoKSx0aGlzLmluY3JlYXNpbmcmJnRoaXMubGVuZ3RoKXtjb25zdCBlPXRoaXMuX3RpbWVsaW5lW3RoaXMubGVuZ3RoLTFdO3RpKHFpKHQudGltZSxlLnRpbWUpLFwiVGhlIHRpbWUgbXVzdCBiZSBncmVhdGVyIHRoYW4gb3IgZXF1YWwgdG8gdGhlIGxhc3Qgc2NoZWR1bGVkIHRpbWVcIiksdGhpcy5fdGltZWxpbmUucHVzaCh0KX1lbHNle2NvbnN0IGU9dGhpcy5fc2VhcmNoKHQudGltZSk7dGhpcy5fdGltZWxpbmUuc3BsaWNlKGUrMSwwLHQpfWlmKHRoaXMubGVuZ3RoPnRoaXMubWVtb3J5KXtjb25zdCB0PXRoaXMubGVuZ3RoLXRoaXMubWVtb3J5O3RoaXMuX3RpbWVsaW5lLnNwbGljZSgwLHQpfXJldHVybiB0aGlzfXJlbW92ZSh0KXtjb25zdCBlPXRoaXMuX3RpbWVsaW5lLmluZGV4T2YodCk7cmV0dXJuLTEhPT1lJiZ0aGlzLl90aW1lbGluZS5zcGxpY2UoZSwxKSx0aGlzfWdldCh0LGU9XCJ0aW1lXCIpe2NvbnN0IHM9dGhpcy5fc2VhcmNoKHQsZSk7cmV0dXJuLTEhPT1zP3RoaXMuX3RpbWVsaW5lW3NdOm51bGx9cGVlaygpe3JldHVybiB0aGlzLl90aW1lbGluZVswXX1zaGlmdCgpe3JldHVybiB0aGlzLl90aW1lbGluZS5zaGlmdCgpfWdldEFmdGVyKHQsZT1cInRpbWVcIil7Y29uc3Qgcz10aGlzLl9zZWFyY2godCxlKTtyZXR1cm4gcysxPHRoaXMuX3RpbWVsaW5lLmxlbmd0aD90aGlzLl90aW1lbGluZVtzKzFdOm51bGx9Z2V0QmVmb3JlKHQpe2NvbnN0IGU9dGhpcy5fdGltZWxpbmUubGVuZ3RoO2lmKGU+MCYmdGhpcy5fdGltZWxpbmVbZS0xXS50aW1lPHQpcmV0dXJuIHRoaXMuX3RpbWVsaW5lW2UtMV07Y29uc3Qgcz10aGlzLl9zZWFyY2godCk7cmV0dXJuIHMtMT49MD90aGlzLl90aW1lbGluZVtzLTFdOm51bGx9Y2FuY2VsKHQpe2lmKHRoaXMuX3RpbWVsaW5lLmxlbmd0aD4xKXtsZXQgZT10aGlzLl9zZWFyY2godCk7aWYoZT49MClpZihJaSh0aGlzLl90aW1lbGluZVtlXS50aW1lLHQpKXtmb3IobGV0IHM9ZTtzPj0wJiZJaSh0aGlzLl90aW1lbGluZVtzXS50aW1lLHQpO3MtLSllPXM7dGhpcy5fdGltZWxpbmU9dGhpcy5fdGltZWxpbmUuc2xpY2UoMCxlKX1lbHNlIHRoaXMuX3RpbWVsaW5lPXRoaXMuX3RpbWVsaW5lLnNsaWNlKDAsZSsxKTtlbHNlIHRoaXMuX3RpbWVsaW5lPVtdfWVsc2UgMT09PXRoaXMuX3RpbWVsaW5lLmxlbmd0aCYmcWkodGhpcy5fdGltZWxpbmVbMF0udGltZSx0KSYmKHRoaXMuX3RpbWVsaW5lPVtdKTtyZXR1cm4gdGhpc31jYW5jZWxCZWZvcmUodCl7Y29uc3QgZT10aGlzLl9zZWFyY2godCk7cmV0dXJuIGU+PTAmJih0aGlzLl90aW1lbGluZT10aGlzLl90aW1lbGluZS5zbGljZShlKzEpKSx0aGlzfXByZXZpb3VzRXZlbnQodCl7Y29uc3QgZT10aGlzLl90aW1lbGluZS5pbmRleE9mKHQpO3JldHVybiBlPjA/dGhpcy5fdGltZWxpbmVbZS0xXTpudWxsfV9zZWFyY2godCxlPVwidGltZVwiKXtpZigwPT09dGhpcy5fdGltZWxpbmUubGVuZ3RoKXJldHVybi0xO2xldCBzPTA7Y29uc3Qgbj10aGlzLl90aW1lbGluZS5sZW5ndGg7bGV0IGk9bjtpZihuPjAmJnRoaXMuX3RpbWVsaW5lW24tMV1bZV08PXQpcmV0dXJuIG4tMTtmb3IoO3M8aTspe2xldCBuPU1hdGguZmxvb3IocysoaS1zKS8yKTtjb25zdCBvPXRoaXMuX3RpbWVsaW5lW25dLHI9dGhpcy5fdGltZWxpbmVbbisxXTtpZihJaShvW2VdLHQpKXtmb3IobGV0IHM9bjtzPHRoaXMuX3RpbWVsaW5lLmxlbmd0aDtzKyspe2lmKCFJaSh0aGlzLl90aW1lbGluZVtzXVtlXSx0KSlicmVhaztuPXN9cmV0dXJuIG59aWYoRmkob1tlXSx0KSYmUmkocltlXSx0KSlyZXR1cm4gbjtSaShvW2VdLHQpP2k9bjpzPW4rMX1yZXR1cm4tMX1faXRlcmF0ZSh0LGU9MCxzPXRoaXMuX3RpbWVsaW5lLmxlbmd0aC0xKXt0aGlzLl90aW1lbGluZS5zbGljZShlLHMrMSkuZm9yRWFjaCh0KX1mb3JFYWNoKHQpe3JldHVybiB0aGlzLl9pdGVyYXRlKHQpLHRoaXN9Zm9yRWFjaEJlZm9yZSh0LGUpe2NvbnN0IHM9dGhpcy5fc2VhcmNoKHQpO3JldHVybi0xIT09cyYmdGhpcy5faXRlcmF0ZShlLDAscyksdGhpc31mb3JFYWNoQWZ0ZXIodCxlKXtjb25zdCBzPXRoaXMuX3NlYXJjaCh0KTtyZXR1cm4gdGhpcy5faXRlcmF0ZShlLHMrMSksdGhpc31mb3JFYWNoQmV0d2Vlbih0LGUscyl7bGV0IG49dGhpcy5fc2VhcmNoKHQpLGk9dGhpcy5fc2VhcmNoKGUpO3JldHVybi0xIT09biYmLTEhPT1pPyh0aGlzLl90aW1lbGluZVtuXS50aW1lIT09dCYmKG4rPTEpLHRoaXMuX3RpbWVsaW5lW2ldLnRpbWU9PT1lJiYoaS09MSksdGhpcy5faXRlcmF0ZShzLG4saSkpOi0xPT09biYmdGhpcy5faXRlcmF0ZShzLDAsaSksdGhpc31mb3JFYWNoRnJvbSh0LGUpe2xldCBzPXRoaXMuX3NlYXJjaCh0KTtmb3IoO3M+PTAmJnRoaXMuX3RpbWVsaW5lW3NdLnRpbWU+PXQ7KXMtLTtyZXR1cm4gdGhpcy5faXRlcmF0ZShlLHMrMSksdGhpc31mb3JFYWNoQXRUaW1lKHQsZSl7Y29uc3Qgcz10aGlzLl9zZWFyY2godCk7aWYoLTEhPT1zJiZJaSh0aGlzLl90aW1lbGluZVtzXS50aW1lLHQpKXtsZXQgbj1zO2ZvcihsZXQgZT1zO2U+PTAmJklpKHRoaXMuX3RpbWVsaW5lW2VdLnRpbWUsdCk7ZS0tKW49ZTt0aGlzLl9pdGVyYXRlKHQ9PntlKHQpfSxuLHMpfXJldHVybiB0aGlzfWRpc3Bvc2UoKXtyZXR1cm4gc3VwZXIuZGlzcG9zZSgpLHRoaXMuX3RpbWVsaW5lPVtdLHRoaXN9fWNvbnN0IFBpPVtdO2Z1bmN0aW9uIGppKHQpe1BpLnB1c2godCl9Y29uc3QgTGk9W107ZnVuY3Rpb24gemkodCl7TGkucHVzaCh0KX1jbGFzcyBCaSBleHRlbmRzIEVpe2NvbnN0cnVjdG9yKCl7c3VwZXIoLi4uYXJndW1lbnRzKSx0aGlzLm5hbWU9XCJFbWl0dGVyXCJ9b24odCxlKXtyZXR1cm4gdC5zcGxpdCgvXFxXKy8pLmZvckVhY2godD0+e2FpKHRoaXMuX2V2ZW50cykmJih0aGlzLl9ldmVudHM9e30pLHRoaXMuX2V2ZW50cy5oYXNPd25Qcm9wZXJ0eSh0KXx8KHRoaXMuX2V2ZW50c1t0XT1bXSksdGhpcy5fZXZlbnRzW3RdLnB1c2goZSl9KSx0aGlzfW9uY2UodCxlKXtjb25zdCBzPSguLi5uKT0+e2UoLi4ubiksdGhpcy5vZmYodCxzKX07cmV0dXJuIHRoaXMub24odCxzKSx0aGlzfW9mZih0LGUpe3JldHVybiB0LnNwbGl0KC9cXFcrLykuZm9yRWFjaChzPT57aWYoYWkodGhpcy5fZXZlbnRzKSYmKHRoaXMuX2V2ZW50cz17fSksdGhpcy5fZXZlbnRzLmhhc093blByb3BlcnR5KHQpKWlmKGFpKGUpKXRoaXMuX2V2ZW50c1t0XT1bXTtlbHNle2NvbnN0IHM9dGhpcy5fZXZlbnRzW3RdO2ZvcihsZXQgdD1zLmxlbmd0aC0xO3Q+PTA7dC0tKXNbdF09PT1lJiZzLnNwbGljZSh0LDEpfX0pLHRoaXN9ZW1pdCh0LC4uLmUpe2lmKHRoaXMuX2V2ZW50cyYmdGhpcy5fZXZlbnRzLmhhc093blByb3BlcnR5KHQpKXtjb25zdCBzPXRoaXMuX2V2ZW50c1t0XS5zbGljZSgwKTtmb3IobGV0IHQ9MCxuPXMubGVuZ3RoO3Q8bjt0Kyspc1t0XS5hcHBseSh0aGlzLGUpfXJldHVybiB0aGlzfXN0YXRpYyBtaXhpbih0KXtbXCJvblwiLFwib25jZVwiLFwib2ZmXCIsXCJlbWl0XCJdLmZvckVhY2goZT0+e2NvbnN0IHM9T2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihCaS5wcm90b3R5cGUsZSk7T2JqZWN0LmRlZmluZVByb3BlcnR5KHQucHJvdG90eXBlLGUscyl9KX1kaXNwb3NlKCl7cmV0dXJuIHN1cGVyLmRpc3Bvc2UoKSx0aGlzLl9ldmVudHM9dm9pZCAwLHRoaXN9fWNsYXNzIFdpIGV4dGVuZHMgQml7Y29uc3RydWN0b3IoKXtzdXBlciguLi5hcmd1bWVudHMpLHRoaXMuaXNPZmZsaW5lPSExfXRvSlNPTigpe3JldHVybnt9fX1jbGFzcyBHaSBleHRlbmRzIFdpe2NvbnN0cnVjdG9yKCl7c3VwZXIoKSx0aGlzLm5hbWU9XCJDb250ZXh0XCIsdGhpcy5fY29uc3RhbnRzPW5ldyBNYXAsdGhpcy5fdGltZW91dHM9bmV3IE5pLHRoaXMuX3RpbWVvdXRJZHM9MCx0aGlzLl9pbml0aWFsaXplZD0hMSx0aGlzLmlzT2ZmbGluZT0hMSx0aGlzLl93b3JrbGV0TW9kdWxlcz1uZXcgTWFwO2NvbnN0IHQ9RGkoR2kuZ2V0RGVmYXVsdHMoKSxhcmd1bWVudHMsW1wiY29udGV4dFwiXSk7dC5jb250ZXh0P3RoaXMuX2NvbnRleHQ9dC5jb250ZXh0OnRoaXMuX2NvbnRleHQ9ZnVuY3Rpb24odCl7cmV0dXJuIG5ldyBDbih0KX0oe2xhdGVuY3lIaW50OnQubGF0ZW5jeUhpbnR9KSx0aGlzLl90aWNrZXI9bmV3IHhpKHRoaXMuZW1pdC5iaW5kKHRoaXMsXCJ0aWNrXCIpLHQuY2xvY2tTb3VyY2UsdC51cGRhdGVJbnRlcnZhbCksdGhpcy5vbihcInRpY2tcIix0aGlzLl90aW1lb3V0TG9vcC5iaW5kKHRoaXMpKSx0aGlzLl9jb250ZXh0Lm9uc3RhdGVjaGFuZ2U9KCk9Pnt0aGlzLmVtaXQoXCJzdGF0ZWNoYW5nZVwiLHRoaXMuc3RhdGUpfSx0aGlzLl9zZXRMYXRlbmN5SGludCh0LmxhdGVuY3lIaW50KSx0aGlzLmxvb2tBaGVhZD10Lmxvb2tBaGVhZH1zdGF0aWMgZ2V0RGVmYXVsdHMoKXtyZXR1cm57Y2xvY2tTb3VyY2U6XCJ3b3JrZXJcIixsYXRlbmN5SGludDpcImludGVyYWN0aXZlXCIsbG9va0FoZWFkOi4xLHVwZGF0ZUludGVydmFsOi4wNX19aW5pdGlhbGl6ZSgpe3ZhciB0O3JldHVybiB0aGlzLl9pbml0aWFsaXplZHx8KHQ9dGhpcyxQaS5mb3JFYWNoKGU9PmUodCkpLHRoaXMuX2luaXRpYWxpemVkPSEwKSx0aGlzfWNyZWF0ZUFuYWx5c2VyKCl7cmV0dXJuIHRoaXMuX2NvbnRleHQuY3JlYXRlQW5hbHlzZXIoKX1jcmVhdGVPc2NpbGxhdG9yKCl7cmV0dXJuIHRoaXMuX2NvbnRleHQuY3JlYXRlT3NjaWxsYXRvcigpfWNyZWF0ZUJ1ZmZlclNvdXJjZSgpe3JldHVybiB0aGlzLl9jb250ZXh0LmNyZWF0ZUJ1ZmZlclNvdXJjZSgpfWNyZWF0ZUJpcXVhZEZpbHRlcigpe3JldHVybiB0aGlzLl9jb250ZXh0LmNyZWF0ZUJpcXVhZEZpbHRlcigpfWNyZWF0ZUJ1ZmZlcih0LGUscyl7cmV0dXJuIHRoaXMuX2NvbnRleHQuY3JlYXRlQnVmZmVyKHQsZSxzKX1jcmVhdGVDaGFubmVsTWVyZ2VyKHQpe3JldHVybiB0aGlzLl9jb250ZXh0LmNyZWF0ZUNoYW5uZWxNZXJnZXIodCl9Y3JlYXRlQ2hhbm5lbFNwbGl0dGVyKHQpe3JldHVybiB0aGlzLl9jb250ZXh0LmNyZWF0ZUNoYW5uZWxTcGxpdHRlcih0KX1jcmVhdGVDb25zdGFudFNvdXJjZSgpe3JldHVybiB0aGlzLl9jb250ZXh0LmNyZWF0ZUNvbnN0YW50U291cmNlKCl9Y3JlYXRlQ29udm9sdmVyKCl7cmV0dXJuIHRoaXMuX2NvbnRleHQuY3JlYXRlQ29udm9sdmVyKCl9Y3JlYXRlRGVsYXkodCl7cmV0dXJuIHRoaXMuX2NvbnRleHQuY3JlYXRlRGVsYXkodCl9Y3JlYXRlRHluYW1pY3NDb21wcmVzc29yKCl7cmV0dXJuIHRoaXMuX2NvbnRleHQuY3JlYXRlRHluYW1pY3NDb21wcmVzc29yKCl9Y3JlYXRlR2Fpbigpe3JldHVybiB0aGlzLl9jb250ZXh0LmNyZWF0ZUdhaW4oKX1jcmVhdGVJSVJGaWx0ZXIodCxlKXtyZXR1cm4gdGhpcy5fY29udGV4dC5jcmVhdGVJSVJGaWx0ZXIodCxlKX1jcmVhdGVQYW5uZXIoKXtyZXR1cm4gdGhpcy5fY29udGV4dC5jcmVhdGVQYW5uZXIoKX1jcmVhdGVQZXJpb2RpY1dhdmUodCxlLHMpe3JldHVybiB0aGlzLl9jb250ZXh0LmNyZWF0ZVBlcmlvZGljV2F2ZSh0LGUscyl9Y3JlYXRlU3RlcmVvUGFubmVyKCl7cmV0dXJuIHRoaXMuX2NvbnRleHQuY3JlYXRlU3RlcmVvUGFubmVyKCl9Y3JlYXRlV2F2ZVNoYXBlcigpe3JldHVybiB0aGlzLl9jb250ZXh0LmNyZWF0ZVdhdmVTaGFwZXIoKX1jcmVhdGVNZWRpYVN0cmVhbVNvdXJjZSh0KXt0aShTaSh0aGlzLl9jb250ZXh0KSxcIk5vdCBhdmFpbGFibGUgaWYgT2ZmbGluZUF1ZGlvQ29udGV4dFwiKTtyZXR1cm4gdGhpcy5fY29udGV4dC5jcmVhdGVNZWRpYVN0cmVhbVNvdXJjZSh0KX1jcmVhdGVNZWRpYUVsZW1lbnRTb3VyY2UodCl7dGkoU2kodGhpcy5fY29udGV4dCksXCJOb3QgYXZhaWxhYmxlIGlmIE9mZmxpbmVBdWRpb0NvbnRleHRcIik7cmV0dXJuIHRoaXMuX2NvbnRleHQuY3JlYXRlTWVkaWFFbGVtZW50U291cmNlKHQpfWNyZWF0ZU1lZGlhU3RyZWFtRGVzdGluYXRpb24oKXt0aShTaSh0aGlzLl9jb250ZXh0KSxcIk5vdCBhdmFpbGFibGUgaWYgT2ZmbGluZUF1ZGlvQ29udGV4dFwiKTtyZXR1cm4gdGhpcy5fY29udGV4dC5jcmVhdGVNZWRpYVN0cmVhbURlc3RpbmF0aW9uKCl9ZGVjb2RlQXVkaW9EYXRhKHQpe3JldHVybiB0aGlzLl9jb250ZXh0LmRlY29kZUF1ZGlvRGF0YSh0KX1nZXQgY3VycmVudFRpbWUoKXtyZXR1cm4gdGhpcy5fY29udGV4dC5jdXJyZW50VGltZX1nZXQgc3RhdGUoKXtyZXR1cm4gdGhpcy5fY29udGV4dC5zdGF0ZX1nZXQgc2FtcGxlUmF0ZSgpe3JldHVybiB0aGlzLl9jb250ZXh0LnNhbXBsZVJhdGV9Z2V0IGxpc3RlbmVyKCl7cmV0dXJuIHRoaXMuaW5pdGlhbGl6ZSgpLHRoaXMuX2xpc3RlbmVyfXNldCBsaXN0ZW5lcih0KXt0aSghdGhpcy5faW5pdGlhbGl6ZWQsXCJUaGUgbGlzdGVuZXIgY2Fubm90IGJlIHNldCBhZnRlciBpbml0aWFsaXphdGlvbi5cIiksdGhpcy5fbGlzdGVuZXI9dH1nZXQgdHJhbnNwb3J0KCl7cmV0dXJuIHRoaXMuaW5pdGlhbGl6ZSgpLHRoaXMuX3RyYW5zcG9ydH1zZXQgdHJhbnNwb3J0KHQpe3RpKCF0aGlzLl9pbml0aWFsaXplZCxcIlRoZSB0cmFuc3BvcnQgY2Fubm90IGJlIHNldCBhZnRlciBpbml0aWFsaXphdGlvbi5cIiksdGhpcy5fdHJhbnNwb3J0PXR9Z2V0IGRyYXcoKXtyZXR1cm4gdGhpcy5pbml0aWFsaXplKCksdGhpcy5fZHJhd31zZXQgZHJhdyh0KXt0aSghdGhpcy5faW5pdGlhbGl6ZWQsXCJEcmF3IGNhbm5vdCBiZSBzZXQgYWZ0ZXIgaW5pdGlhbGl6YXRpb24uXCIpLHRoaXMuX2RyYXc9dH1nZXQgZGVzdGluYXRpb24oKXtyZXR1cm4gdGhpcy5pbml0aWFsaXplKCksdGhpcy5fZGVzdGluYXRpb259c2V0IGRlc3RpbmF0aW9uKHQpe3RpKCF0aGlzLl9pbml0aWFsaXplZCxcIlRoZSBkZXN0aW5hdGlvbiBjYW5ub3QgYmUgc2V0IGFmdGVyIGluaXRpYWxpemF0aW9uLlwiKSx0aGlzLl9kZXN0aW5hdGlvbj10fWNyZWF0ZUF1ZGlvV29ya2xldE5vZGUodCxlKXtyZXR1cm4gZnVuY3Rpb24odCxlLHMpe3JldHVybiB0aShjaSh6biksXCJUaGlzIG5vZGUgb25seSB3b3JrcyBpbiBhIHNlY3VyZSBjb250ZXh0IChodHRwcyBvciBsb2NhbGhvc3QpXCIpLG5ldyB6bih0LGUscyl9XG4vKiEgKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcbkNvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLlxuXG5QZXJtaXNzaW9uIHRvIHVzZSwgY29weSwgbW9kaWZ5LCBhbmQvb3IgZGlzdHJpYnV0ZSB0aGlzIHNvZnR3YXJlIGZvciBhbnlcbnB1cnBvc2Ugd2l0aCBvciB3aXRob3V0IGZlZSBpcyBoZXJlYnkgZ3JhbnRlZC5cblxuVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEIFwiQVMgSVNcIiBBTkQgVEhFIEFVVEhPUiBESVNDTEFJTVMgQUxMIFdBUlJBTlRJRVMgV0lUSFxuUkVHQVJEIFRPIFRISVMgU09GVFdBUkUgSU5DTFVESU5HIEFMTCBJTVBMSUVEIFdBUlJBTlRJRVMgT0YgTUVSQ0hBTlRBQklMSVRZXG5BTkQgRklUTkVTUy4gSU4gTk8gRVZFTlQgU0hBTEwgVEhFIEFVVEhPUiBCRSBMSUFCTEUgRk9SIEFOWSBTUEVDSUFMLCBESVJFQ1QsXG5JTkRJUkVDVCwgT1IgQ09OU0VRVUVOVElBTCBEQU1BR0VTIE9SIEFOWSBEQU1BR0VTIFdIQVRTT0VWRVIgUkVTVUxUSU5HIEZST01cbkxPU1MgT0YgVVNFLCBEQVRBIE9SIFBST0ZJVFMsIFdIRVRIRVIgSU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULCBORUdMSUdFTkNFIE9SXG5PVEhFUiBUT1JUSU9VUyBBQ1RJT04sIEFSSVNJTkcgT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgVVNFIE9SXG5QRVJGT1JNQU5DRSBPRiBUSElTIFNPRlRXQVJFLlxuKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiogKi8odGhpcy5yYXdDb250ZXh0LHQsZSl9YWRkQXVkaW9Xb3JrbGV0TW9kdWxlKHQsZSl7cmV0dXJuIHlpKHRoaXMsdm9pZCAwLHZvaWQgMCwoZnVuY3Rpb24qKCl7dGkoY2kodGhpcy5yYXdDb250ZXh0LmF1ZGlvV29ya2xldCksXCJBdWRpb1dvcmtsZXROb2RlIGlzIG9ubHkgYXZhaWxhYmxlIGluIGEgc2VjdXJlIGNvbnRleHQgKGh0dHBzIG9yIGxvY2FsaG9zdClcIiksdGhpcy5fd29ya2xldE1vZHVsZXMuaGFzKGUpfHx0aGlzLl93b3JrbGV0TW9kdWxlcy5zZXQoZSx0aGlzLnJhd0NvbnRleHQuYXVkaW9Xb3JrbGV0LmFkZE1vZHVsZSh0KSkseWllbGQgdGhpcy5fd29ya2xldE1vZHVsZXMuZ2V0KGUpfSkpfXdvcmtsZXRzQXJlUmVhZHkoKXtyZXR1cm4geWkodGhpcyx2b2lkIDAsdm9pZCAwLChmdW5jdGlvbiooKXtjb25zdCB0PVtdO3RoaXMuX3dvcmtsZXRNb2R1bGVzLmZvckVhY2goZT0+dC5wdXNoKGUpKSx5aWVsZCBQcm9taXNlLmFsbCh0KX0pKX1nZXQgdXBkYXRlSW50ZXJ2YWwoKXtyZXR1cm4gdGhpcy5fdGlja2VyLnVwZGF0ZUludGVydmFsfXNldCB1cGRhdGVJbnRlcnZhbCh0KXt0aGlzLl90aWNrZXIudXBkYXRlSW50ZXJ2YWw9dH1nZXQgY2xvY2tTb3VyY2UoKXtyZXR1cm4gdGhpcy5fdGlja2VyLnR5cGV9c2V0IGNsb2NrU291cmNlKHQpe3RoaXMuX3RpY2tlci50eXBlPXR9Z2V0IGxhdGVuY3lIaW50KCl7cmV0dXJuIHRoaXMuX2xhdGVuY3lIaW50fV9zZXRMYXRlbmN5SGludCh0KXtsZXQgZT0wO2lmKHRoaXMuX2xhdGVuY3lIaW50PXQsZmkodCkpc3dpdGNoKHQpe2Nhc2VcImludGVyYWN0aXZlXCI6ZT0uMTticmVhaztjYXNlXCJwbGF5YmFja1wiOmU9LjU7YnJlYWs7Y2FzZVwiYmFsYW5jZWRcIjplPS4yNX10aGlzLmxvb2tBaGVhZD1lLHRoaXMudXBkYXRlSW50ZXJ2YWw9ZS8yfWdldCByYXdDb250ZXh0KCl7cmV0dXJuIHRoaXMuX2NvbnRleHR9bm93KCl7cmV0dXJuIHRoaXMuX2NvbnRleHQuY3VycmVudFRpbWUrdGhpcy5sb29rQWhlYWR9aW1tZWRpYXRlKCl7cmV0dXJuIHRoaXMuX2NvbnRleHQuY3VycmVudFRpbWV9cmVzdW1lKCl7cmV0dXJuIFNpKHRoaXMuX2NvbnRleHQpP3RoaXMuX2NvbnRleHQucmVzdW1lKCk6UHJvbWlzZS5yZXNvbHZlKCl9Y2xvc2UoKXtyZXR1cm4geWkodGhpcyx2b2lkIDAsdm9pZCAwLChmdW5jdGlvbiooKXt2YXIgdDtTaSh0aGlzLl9jb250ZXh0KSYmKHlpZWxkIHRoaXMuX2NvbnRleHQuY2xvc2UoKSksdGhpcy5faW5pdGlhbGl6ZWQmJih0PXRoaXMsTGkuZm9yRWFjaChlPT5lKHQpKSl9KSl9Z2V0Q29uc3RhbnQodCl7aWYodGhpcy5fY29uc3RhbnRzLmhhcyh0KSlyZXR1cm4gdGhpcy5fY29uc3RhbnRzLmdldCh0KTt7Y29uc3QgZT10aGlzLl9jb250ZXh0LmNyZWF0ZUJ1ZmZlcigxLDEyOCx0aGlzLl9jb250ZXh0LnNhbXBsZVJhdGUpLHM9ZS5nZXRDaGFubmVsRGF0YSgwKTtmb3IobGV0IGU9MDtlPHMubGVuZ3RoO2UrKylzW2VdPXQ7Y29uc3Qgbj10aGlzLl9jb250ZXh0LmNyZWF0ZUJ1ZmZlclNvdXJjZSgpO3JldHVybiBuLmNoYW5uZWxDb3VudD0xLG4uY2hhbm5lbENvdW50TW9kZT1cImV4cGxpY2l0XCIsbi5idWZmZXI9ZSxuLmxvb3A9ITAsbi5zdGFydCgwKSx0aGlzLl9jb25zdGFudHMuc2V0KHQsbiksbn19ZGlzcG9zZSgpe3JldHVybiBzdXBlci5kaXNwb3NlKCksdGhpcy5fdGlja2VyLmRpc3Bvc2UoKSx0aGlzLl90aW1lb3V0cy5kaXNwb3NlKCksT2JqZWN0LmtleXModGhpcy5fY29uc3RhbnRzKS5tYXAodD0+dGhpcy5fY29uc3RhbnRzW3RdLmRpc2Nvbm5lY3QoKSksdGhpc31fdGltZW91dExvb3AoKXtjb25zdCB0PXRoaXMubm93KCk7bGV0IGU9dGhpcy5fdGltZW91dHMucGVlaygpO2Zvcig7dGhpcy5fdGltZW91dHMubGVuZ3RoJiZlJiZlLnRpbWU8PXQ7KWUuY2FsbGJhY2soKSx0aGlzLl90aW1lb3V0cy5zaGlmdCgpLGU9dGhpcy5fdGltZW91dHMucGVlaygpfXNldFRpbWVvdXQodCxlKXt0aGlzLl90aW1lb3V0SWRzKys7Y29uc3Qgcz10aGlzLm5vdygpO3JldHVybiB0aGlzLl90aW1lb3V0cy5hZGQoe2NhbGxiYWNrOnQsaWQ6dGhpcy5fdGltZW91dElkcyx0aW1lOnMrZX0pLHRoaXMuX3RpbWVvdXRJZHN9Y2xlYXJUaW1lb3V0KHQpe3JldHVybiB0aGlzLl90aW1lb3V0cy5mb3JFYWNoKGU9PntlLmlkPT09dCYmdGhpcy5fdGltZW91dHMucmVtb3ZlKGUpfSksdGhpc31jbGVhckludGVydmFsKHQpe3JldHVybiB0aGlzLmNsZWFyVGltZW91dCh0KX1zZXRJbnRlcnZhbCh0LGUpe2NvbnN0IHM9Kyt0aGlzLl90aW1lb3V0SWRzLG49KCk9Pntjb25zdCBpPXRoaXMubm93KCk7dGhpcy5fdGltZW91dHMuYWRkKHtjYWxsYmFjazooKT0+e3QoKSxuKCl9LGlkOnMsdGltZTppK2V9KX07cmV0dXJuIG4oKSxzfX1mdW5jdGlvbiBVaSh0LGUpe2RpKGUpP2UuZm9yRWFjaChlPT5VaSh0LGUpKTpPYmplY3QuZGVmaW5lUHJvcGVydHkodCxlLHtlbnVtZXJhYmxlOiEwLHdyaXRhYmxlOiExfSl9ZnVuY3Rpb24gUWkodCxlKXtkaShlKT9lLmZvckVhY2goZT0+UWkodCxlKSk6T2JqZWN0LmRlZmluZVByb3BlcnR5KHQsZSx7d3JpdGFibGU6ITB9KX1jb25zdCBaaT0oKT0+e307Y2xhc3MgWGkgZXh0ZW5kcyBFaXtjb25zdHJ1Y3Rvcigpe3N1cGVyKCksdGhpcy5uYW1lPVwiVG9uZUF1ZGlvQnVmZmVyXCIsdGhpcy5vbmxvYWQ9Wmk7Y29uc3QgdD1EaShYaS5nZXREZWZhdWx0cygpLGFyZ3VtZW50cyxbXCJ1cmxcIixcIm9ubG9hZFwiLFwib25lcnJvclwiXSk7dGhpcy5yZXZlcnNlPXQucmV2ZXJzZSx0aGlzLm9ubG9hZD10Lm9ubG9hZCx0LnVybCYma2kodC51cmwpfHx0LnVybCBpbnN0YW5jZW9mIFhpP3RoaXMuc2V0KHQudXJsKTpmaSh0LnVybCkmJnRoaXMubG9hZCh0LnVybCkuY2F0Y2godC5vbmVycm9yKX1zdGF0aWMgZ2V0RGVmYXVsdHMoKXtyZXR1cm57b25lcnJvcjpaaSxvbmxvYWQ6WmkscmV2ZXJzZTohMX19Z2V0IHNhbXBsZVJhdGUoKXtyZXR1cm4gdGhpcy5fYnVmZmVyP3RoaXMuX2J1ZmZlci5zYW1wbGVSYXRlOkppKCkuc2FtcGxlUmF0ZX1zZXQodCl7cmV0dXJuIHQgaW5zdGFuY2VvZiBYaT90LmxvYWRlZD90aGlzLl9idWZmZXI9dC5nZXQoKTp0Lm9ubG9hZD0oKT0+e3RoaXMuc2V0KHQpLHRoaXMub25sb2FkKHRoaXMpfTp0aGlzLl9idWZmZXI9dCx0aGlzLl9yZXZlcnNlZCYmdGhpcy5fcmV2ZXJzZSgpLHRoaXN9Z2V0KCl7cmV0dXJuIHRoaXMuX2J1ZmZlcn1sb2FkKHQpe3JldHVybiB5aSh0aGlzLHZvaWQgMCx2b2lkIDAsKGZ1bmN0aW9uKigpe2NvbnN0IGU9WGkubG9hZCh0KS50aGVuKHQ9Pnt0aGlzLnNldCh0KSx0aGlzLm9ubG9hZCh0aGlzKX0pO1hpLmRvd25sb2Fkcy5wdXNoKGUpO3RyeXt5aWVsZCBlfWZpbmFsbHl7Y29uc3QgdD1YaS5kb3dubG9hZHMuaW5kZXhPZihlKTtYaS5kb3dubG9hZHMuc3BsaWNlKHQsMSl9cmV0dXJuIHRoaXN9KSl9ZGlzcG9zZSgpe3JldHVybiBzdXBlci5kaXNwb3NlKCksdGhpcy5fYnVmZmVyPXZvaWQgMCx0aGlzfWZyb21BcnJheSh0KXtjb25zdCBlPWRpKHQpJiZ0WzBdLmxlbmd0aD4wLHM9ZT90Lmxlbmd0aDoxLG49ZT90WzBdLmxlbmd0aDp0Lmxlbmd0aCxpPUppKCksbz1pLmNyZWF0ZUJ1ZmZlcihzLG4saS5zYW1wbGVSYXRlKSxyPWV8fDEhPT1zP3Q6W3RdO2ZvcihsZXQgdD0wO3Q8czt0Kyspby5jb3B5VG9DaGFubmVsKHJbdF0sdCk7cmV0dXJuIHRoaXMuX2J1ZmZlcj1vLHRoaXN9dG9Nb25vKHQpe2lmKHVpKHQpKXRoaXMuZnJvbUFycmF5KHRoaXMudG9BcnJheSh0KSk7ZWxzZXtsZXQgdD1uZXcgRmxvYXQzMkFycmF5KHRoaXMubGVuZ3RoKTtjb25zdCBlPXRoaXMubnVtYmVyT2ZDaGFubmVscztmb3IobGV0IHM9MDtzPGU7cysrKXtjb25zdCBlPXRoaXMudG9BcnJheShzKTtmb3IobGV0IHM9MDtzPGUubGVuZ3RoO3MrKyl0W3NdKz1lW3NdfXQ9dC5tYXAodD0+dC9lKSx0aGlzLmZyb21BcnJheSh0KX1yZXR1cm4gdGhpc310b0FycmF5KHQpe2lmKHVpKHQpKXJldHVybiB0aGlzLmdldENoYW5uZWxEYXRhKHQpO2lmKDE9PT10aGlzLm51bWJlck9mQ2hhbm5lbHMpcmV0dXJuIHRoaXMudG9BcnJheSgwKTt7Y29uc3QgdD1bXTtmb3IobGV0IGU9MDtlPHRoaXMubnVtYmVyT2ZDaGFubmVscztlKyspdFtlXT10aGlzLmdldENoYW5uZWxEYXRhKGUpO3JldHVybiB0fX1nZXRDaGFubmVsRGF0YSh0KXtyZXR1cm4gdGhpcy5fYnVmZmVyP3RoaXMuX2J1ZmZlci5nZXRDaGFubmVsRGF0YSh0KTpuZXcgRmxvYXQzMkFycmF5KDApfXNsaWNlKHQsZT10aGlzLmR1cmF0aW9uKXtjb25zdCBzPU1hdGguZmxvb3IodCp0aGlzLnNhbXBsZVJhdGUpLG49TWF0aC5mbG9vcihlKnRoaXMuc2FtcGxlUmF0ZSk7dGkoczxuLFwiVGhlIHN0YXJ0IHRpbWUgbXVzdCBiZSBsZXNzIHRoYW4gdGhlIGVuZCB0aW1lXCIpO2NvbnN0IGk9bi1zLG89SmkoKS5jcmVhdGVCdWZmZXIodGhpcy5udW1iZXJPZkNoYW5uZWxzLGksdGhpcy5zYW1wbGVSYXRlKTtmb3IobGV0IHQ9MDt0PHRoaXMubnVtYmVyT2ZDaGFubmVsczt0Kyspby5jb3B5VG9DaGFubmVsKHRoaXMuZ2V0Q2hhbm5lbERhdGEodCkuc3ViYXJyYXkocyxuKSx0KTtyZXR1cm4gbmV3IFhpKG8pfV9yZXZlcnNlKCl7aWYodGhpcy5sb2FkZWQpZm9yKGxldCB0PTA7dDx0aGlzLm51bWJlck9mQ2hhbm5lbHM7dCsrKXRoaXMuZ2V0Q2hhbm5lbERhdGEodCkucmV2ZXJzZSgpO3JldHVybiB0aGlzfWdldCBsb2FkZWQoKXtyZXR1cm4gdGhpcy5sZW5ndGg+MH1nZXQgZHVyYXRpb24oKXtyZXR1cm4gdGhpcy5fYnVmZmVyP3RoaXMuX2J1ZmZlci5kdXJhdGlvbjowfWdldCBsZW5ndGgoKXtyZXR1cm4gdGhpcy5fYnVmZmVyP3RoaXMuX2J1ZmZlci5sZW5ndGg6MH1nZXQgbnVtYmVyT2ZDaGFubmVscygpe3JldHVybiB0aGlzLl9idWZmZXI/dGhpcy5fYnVmZmVyLm51bWJlck9mQ2hhbm5lbHM6MH1nZXQgcmV2ZXJzZSgpe3JldHVybiB0aGlzLl9yZXZlcnNlZH1zZXQgcmV2ZXJzZSh0KXt0aGlzLl9yZXZlcnNlZCE9PXQmJih0aGlzLl9yZXZlcnNlZD10LHRoaXMuX3JldmVyc2UoKSl9c3RhdGljIGZyb21BcnJheSh0KXtyZXR1cm4obmV3IFhpKS5mcm9tQXJyYXkodCl9c3RhdGljIGZyb21VcmwodCl7cmV0dXJuIHlpKHRoaXMsdm9pZCAwLHZvaWQgMCwoZnVuY3Rpb24qKCl7Y29uc3QgZT1uZXcgWGk7cmV0dXJuIHlpZWxkIGUubG9hZCh0KX0pKX1zdGF0aWMgbG9hZCh0KXtyZXR1cm4geWkodGhpcyx2b2lkIDAsdm9pZCAwLChmdW5jdGlvbiooKXtjb25zdCBlPXQubWF0Y2goL1xcWyhbXlxcXVxcW10rXFx8LispXFxdJC8pO2lmKGUpe2NvbnN0IHM9ZVsxXS5zcGxpdChcInxcIik7bGV0IG49c1swXTtmb3IoY29uc3QgdCBvZiBzKWlmKFhpLnN1cHBvcnRzVHlwZSh0KSl7bj10O2JyZWFrfXQ9dC5yZXBsYWNlKGVbMF0sbil9Y29uc3Qgcz1cIlwiPT09WGkuYmFzZVVybHx8WGkuYmFzZVVybC5lbmRzV2l0aChcIi9cIik/WGkuYmFzZVVybDpYaS5iYXNlVXJsK1wiL1wiLG49eWllbGQgZmV0Y2gocyt0KTtpZighbi5vayl0aHJvdyBuZXcgRXJyb3IoXCJjb3VsZCBub3QgbG9hZCB1cmw6IFwiK3QpO2NvbnN0IGk9eWllbGQgbi5hcnJheUJ1ZmZlcigpO3JldHVybiB5aWVsZCBKaSgpLmRlY29kZUF1ZGlvRGF0YShpKX0pKX1zdGF0aWMgc3VwcG9ydHNUeXBlKHQpe2NvbnN0IGU9dC5zcGxpdChcIi5cIikscz1lW2UubGVuZ3RoLTFdO3JldHVyblwiXCIhPT1kb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiYXVkaW9cIikuY2FuUGxheVR5cGUoXCJhdWRpby9cIitzKX1zdGF0aWMgbG9hZGVkKCl7cmV0dXJuIHlpKHRoaXMsdm9pZCAwLHZvaWQgMCwoZnVuY3Rpb24qKCl7Zm9yKHlpZWxkIFByb21pc2UucmVzb2x2ZSgpO1hpLmRvd25sb2Fkcy5sZW5ndGg7KXlpZWxkIFhpLmRvd25sb2Fkc1swXX0pKX19WGkuYmFzZVVybD1cIlwiLFhpLmRvd25sb2Fkcz1bXTtjbGFzcyBZaSBleHRlbmRzIEdpe2NvbnN0cnVjdG9yKCl7dmFyIHQsZSxzO3N1cGVyKHtjbG9ja1NvdXJjZTpcIm9mZmxpbmVcIixjb250ZXh0OlRpKGFyZ3VtZW50c1swXSk/YXJndW1lbnRzWzBdOih0PWFyZ3VtZW50c1swXSxlPWFyZ3VtZW50c1sxXSphcmd1bWVudHNbMl0scz1hcmd1bWVudHNbMl0sbmV3IEduKHQsZSxzKSksbG9va0FoZWFkOjAsdXBkYXRlSW50ZXJ2YWw6VGkoYXJndW1lbnRzWzBdKT8xMjgvYXJndW1lbnRzWzBdLnNhbXBsZVJhdGU6MTI4L2FyZ3VtZW50c1syXX0pLHRoaXMubmFtZT1cIk9mZmxpbmVDb250ZXh0XCIsdGhpcy5fY3VycmVudFRpbWU9MCx0aGlzLmlzT2ZmbGluZT0hMCx0aGlzLl9kdXJhdGlvbj1UaShhcmd1bWVudHNbMF0pP2FyZ3VtZW50c1swXS5sZW5ndGgvYXJndW1lbnRzWzBdLnNhbXBsZVJhdGU6YXJndW1lbnRzWzFdfW5vdygpe3JldHVybiB0aGlzLl9jdXJyZW50VGltZX1nZXQgY3VycmVudFRpbWUoKXtyZXR1cm4gdGhpcy5fY3VycmVudFRpbWV9X3JlbmRlckNsb2NrKHQpe3JldHVybiB5aSh0aGlzLHZvaWQgMCx2b2lkIDAsKGZ1bmN0aW9uKigpe2xldCBlPTA7Zm9yKDt0aGlzLl9kdXJhdGlvbi10aGlzLl9jdXJyZW50VGltZT49MDspe3RoaXMuZW1pdChcInRpY2tcIiksdGhpcy5fY3VycmVudFRpbWUrPTEyOC90aGlzLnNhbXBsZVJhdGUsZSsrO2NvbnN0IHM9TWF0aC5mbG9vcih0aGlzLnNhbXBsZVJhdGUvMTI4KTt0JiZlJXM9PTAmJih5aWVsZCBuZXcgUHJvbWlzZSh0PT5zZXRUaW1lb3V0KHQsMSkpKX19KSl9cmVuZGVyKHQ9ITApe3JldHVybiB5aSh0aGlzLHZvaWQgMCx2b2lkIDAsKGZ1bmN0aW9uKigpe3lpZWxkIHRoaXMud29ya2xldHNBcmVSZWFkeSgpLHlpZWxkIHRoaXMuX3JlbmRlckNsb2NrKHQpO2NvbnN0IGU9eWllbGQgdGhpcy5fY29udGV4dC5zdGFydFJlbmRlcmluZygpO3JldHVybiBuZXcgWGkoZSl9KSl9Y2xvc2UoKXtyZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCl9fWNvbnN0IEhpPW5ldyBjbGFzcyBleHRlbmRzIFdpe2NvbnN0cnVjdG9yKCl7c3VwZXIoLi4uYXJndW1lbnRzKSx0aGlzLmxvb2tBaGVhZD0wLHRoaXMubGF0ZW5jeUhpbnQ9MCx0aGlzLmlzT2ZmbGluZT0hMX1jcmVhdGVBbmFseXNlcigpe3JldHVybnt9fWNyZWF0ZU9zY2lsbGF0b3IoKXtyZXR1cm57fX1jcmVhdGVCdWZmZXJTb3VyY2UoKXtyZXR1cm57fX1jcmVhdGVCaXF1YWRGaWx0ZXIoKXtyZXR1cm57fX1jcmVhdGVCdWZmZXIodCxlLHMpe3JldHVybnt9fWNyZWF0ZUNoYW5uZWxNZXJnZXIodCl7cmV0dXJue319Y3JlYXRlQ2hhbm5lbFNwbGl0dGVyKHQpe3JldHVybnt9fWNyZWF0ZUNvbnN0YW50U291cmNlKCl7cmV0dXJue319Y3JlYXRlQ29udm9sdmVyKCl7cmV0dXJue319Y3JlYXRlRGVsYXkodCl7cmV0dXJue319Y3JlYXRlRHluYW1pY3NDb21wcmVzc29yKCl7cmV0dXJue319Y3JlYXRlR2Fpbigpe3JldHVybnt9fWNyZWF0ZUlJUkZpbHRlcih0LGUpe3JldHVybnt9fWNyZWF0ZVBhbm5lcigpe3JldHVybnt9fWNyZWF0ZVBlcmlvZGljV2F2ZSh0LGUscyl7cmV0dXJue319Y3JlYXRlU3RlcmVvUGFubmVyKCl7cmV0dXJue319Y3JlYXRlV2F2ZVNoYXBlcigpe3JldHVybnt9fWNyZWF0ZU1lZGlhU3RyZWFtU291cmNlKHQpe3JldHVybnt9fWNyZWF0ZU1lZGlhRWxlbWVudFNvdXJjZSh0KXtyZXR1cm57fX1jcmVhdGVNZWRpYVN0cmVhbURlc3RpbmF0aW9uKCl7cmV0dXJue319ZGVjb2RlQXVkaW9EYXRhKHQpe3JldHVybiBQcm9taXNlLnJlc29sdmUoe30pfWNyZWF0ZUF1ZGlvV29ya2xldE5vZGUodCxlKXtyZXR1cm57fX1nZXQgcmF3Q29udGV4dCgpe3JldHVybnt9fWFkZEF1ZGlvV29ya2xldE1vZHVsZSh0LGUpe3JldHVybiB5aSh0aGlzLHZvaWQgMCx2b2lkIDAsKGZ1bmN0aW9uKigpe3JldHVybiBQcm9taXNlLnJlc29sdmUoKX0pKX1yZXN1bWUoKXtyZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCl9c2V0VGltZW91dCh0LGUpe3JldHVybiAwfWNsZWFyVGltZW91dCh0KXtyZXR1cm4gdGhpc31zZXRJbnRlcnZhbCh0LGUpe3JldHVybiAwfWNsZWFySW50ZXJ2YWwodCl7cmV0dXJuIHRoaXN9Z2V0Q29uc3RhbnQodCl7cmV0dXJue319Z2V0IGN1cnJlbnRUaW1lKCl7cmV0dXJuIDB9Z2V0IHN0YXRlKCl7cmV0dXJue319Z2V0IHNhbXBsZVJhdGUoKXtyZXR1cm4gMH1nZXQgbGlzdGVuZXIoKXtyZXR1cm57fX1nZXQgdHJhbnNwb3J0KCl7cmV0dXJue319Z2V0IGRyYXcoKXtyZXR1cm57fX1zZXQgZHJhdyh0KXt9Z2V0IGRlc3RpbmF0aW9uKCl7cmV0dXJue319c2V0IGRlc3RpbmF0aW9uKHQpe31ub3coKXtyZXR1cm4gMH1pbW1lZGlhdGUoKXtyZXR1cm4gMH19O2xldCAkaT1IaTtmdW5jdGlvbiBKaSgpe3JldHVybiAkaT09PUhpJiZnaSYmS2kobmV3IEdpKSwkaX1mdW5jdGlvbiBLaSh0KXskaT1TaSh0KT9uZXcgR2kodCk6VGkodCk/bmV3IFlpKHQpOnR9ZnVuY3Rpb24gdG8oKXtyZXR1cm4gJGkucmVzdW1lKCl9aWYobWkmJiFtaS5UT05FX1NJTEVOQ0VfTE9HR0lORyl7bGV0IHQ9XCJ2XCI7XCJkZXZcIj09PW8mJih0PVwiXCIpO2NvbnN0IGU9YCAqIFRvbmUuanMgJHt0fSR7b30gKiBgO2NvbnNvbGUubG9nKFwiJWNcIitlLFwiYmFja2dyb3VuZDogIzAwMDsgY29sb3I6ICNmZmZcIil9ZnVuY3Rpb24gZW8odCl7cmV0dXJuIE1hdGgucG93KDEwLHQvMjApfWZ1bmN0aW9uIHNvKHQpe3JldHVybiBNYXRoLmxvZyh0KS9NYXRoLkxOMTAqMjB9ZnVuY3Rpb24gbm8odCl7cmV0dXJuIE1hdGgucG93KDIsdC8xMil9bGV0IGlvPTQ0MDtmdW5jdGlvbiBvbyh0KXtyZXR1cm4gTWF0aC5yb3VuZChybyh0KSl9ZnVuY3Rpb24gcm8odCl7cmV0dXJuIDY5KzEyKk1hdGgubG9nMih0L2lvKX1mdW5jdGlvbiBhbyh0KXtyZXR1cm4gaW8qTWF0aC5wb3coMiwodC02OSkvMTIpfWNsYXNzIGNvIGV4dGVuZHMgRWl7Y29uc3RydWN0b3IodCxlLHMpe3N1cGVyKCksdGhpcy5kZWZhdWx0VW5pdHM9XCJzXCIsdGhpcy5fdmFsPWUsdGhpcy5fdW5pdHM9cyx0aGlzLmNvbnRleHQ9dCx0aGlzLl9leHByZXNzaW9ucz10aGlzLl9nZXRFeHByZXNzaW9ucygpfV9nZXRFeHByZXNzaW9ucygpe3JldHVybntoejp7bWV0aG9kOnQ9PnRoaXMuX2ZyZXF1ZW5jeVRvVW5pdHMocGFyc2VGbG9hdCh0KSkscmVnZXhwOi9eKFxcZCsoPzpcXC5cXGQrKT8paHokL2l9LGk6e21ldGhvZDp0PT50aGlzLl90aWNrc1RvVW5pdHMocGFyc2VJbnQodCwxMCkpLHJlZ2V4cDovXihcXGQrKWkkL2l9LG06e21ldGhvZDp0PT50aGlzLl9iZWF0c1RvVW5pdHMocGFyc2VJbnQodCwxMCkqdGhpcy5fZ2V0VGltZVNpZ25hdHVyZSgpKSxyZWdleHA6L14oXFxkKyltJC9pfSxuOnttZXRob2Q6KHQsZSk9Pntjb25zdCBzPXBhcnNlSW50KHQsMTApLG49XCIuXCI9PT1lPzEuNToxO3JldHVybiAxPT09cz90aGlzLl9iZWF0c1RvVW5pdHModGhpcy5fZ2V0VGltZVNpZ25hdHVyZSgpKSpuOnRoaXMuX2JlYXRzVG9Vbml0cyg0L3MpKm59LHJlZ2V4cDovXihcXGQrKW4oXFwuPykkL2l9LG51bWJlcjp7bWV0aG9kOnQ9PnRoaXMuX2V4cHJlc3Npb25zW3RoaXMuZGVmYXVsdFVuaXRzXS5tZXRob2QuY2FsbCh0aGlzLHQpLHJlZ2V4cDovXihcXGQrKD86XFwuXFxkKyk/KSQvfSxzOnttZXRob2Q6dD0+dGhpcy5fc2Vjb25kc1RvVW5pdHMocGFyc2VGbG9hdCh0KSkscmVnZXhwOi9eKFxcZCsoPzpcXC5cXGQrKT8pcyQvfSxzYW1wbGVzOnttZXRob2Q6dD0+cGFyc2VJbnQodCwxMCkvdGhpcy5jb250ZXh0LnNhbXBsZVJhdGUscmVnZXhwOi9eKFxcZCspc2FtcGxlcyQvfSx0OnttZXRob2Q6dD0+e2NvbnN0IGU9cGFyc2VJbnQodCwxMCk7cmV0dXJuIHRoaXMuX2JlYXRzVG9Vbml0cyg4LygzKk1hdGguZmxvb3IoZSkpKX0scmVnZXhwOi9eKFxcZCspdCQvaX0sdHI6e21ldGhvZDoodCxlLHMpPT57bGV0IG49MDtyZXR1cm4gdCYmXCIwXCIhPT10JiYobis9dGhpcy5fYmVhdHNUb1VuaXRzKHRoaXMuX2dldFRpbWVTaWduYXR1cmUoKSpwYXJzZUZsb2F0KHQpKSksZSYmXCIwXCIhPT1lJiYobis9dGhpcy5fYmVhdHNUb1VuaXRzKHBhcnNlRmxvYXQoZSkpKSxzJiZcIjBcIiE9PXMmJihuKz10aGlzLl9iZWF0c1RvVW5pdHMocGFyc2VGbG9hdChzKS80KSksbn0scmVnZXhwOi9eKFxcZCsoPzpcXC5cXGQrKT8pOihcXGQrKD86XFwuXFxkKyk/KTo/KFxcZCsoPzpcXC5cXGQrKT8pPyQvfX19dmFsdWVPZigpe2lmKHRoaXMuX3ZhbCBpbnN0YW5jZW9mIGNvJiZ0aGlzLmZyb21UeXBlKHRoaXMuX3ZhbCksYWkodGhpcy5fdmFsKSlyZXR1cm4gdGhpcy5fbm9BcmcoKTtpZihmaSh0aGlzLl92YWwpJiZhaSh0aGlzLl91bml0cykpe2Zvcihjb25zdCB0IGluIHRoaXMuX2V4cHJlc3Npb25zKWlmKHRoaXMuX2V4cHJlc3Npb25zW3RdLnJlZ2V4cC50ZXN0KHRoaXMuX3ZhbC50cmltKCkpKXt0aGlzLl91bml0cz10O2JyZWFrfX1lbHNlIGlmKGxpKHRoaXMuX3ZhbCkpe2xldCB0PTA7Zm9yKGNvbnN0IGUgaW4gdGhpcy5fdmFsKWlmKGNpKHRoaXMuX3ZhbFtlXSkpe2NvbnN0IHM9dGhpcy5fdmFsW2VdO3QrPW5ldyB0aGlzLmNvbnN0cnVjdG9yKHRoaXMuY29udGV4dCxlKS52YWx1ZU9mKCkqc31yZXR1cm4gdH1pZihjaSh0aGlzLl91bml0cykpe2NvbnN0IHQ9dGhpcy5fZXhwcmVzc2lvbnNbdGhpcy5fdW5pdHNdLGU9dGhpcy5fdmFsLnRvU3RyaW5nKCkudHJpbSgpLm1hdGNoKHQucmVnZXhwKTtyZXR1cm4gZT90Lm1ldGhvZC5hcHBseSh0aGlzLGUuc2xpY2UoMSkpOnQubWV0aG9kLmNhbGwodGhpcyx0aGlzLl92YWwpfXJldHVybiBmaSh0aGlzLl92YWwpP3BhcnNlRmxvYXQodGhpcy5fdmFsKTp0aGlzLl92YWx9X2ZyZXF1ZW5jeVRvVW5pdHModCl7cmV0dXJuIDEvdH1fYmVhdHNUb1VuaXRzKHQpe3JldHVybiA2MC90aGlzLl9nZXRCcG0oKSp0fV9zZWNvbmRzVG9Vbml0cyh0KXtyZXR1cm4gdH1fdGlja3NUb1VuaXRzKHQpe3JldHVybiB0KnRoaXMuX2JlYXRzVG9Vbml0cygxKS90aGlzLl9nZXRQUFEoKX1fbm9BcmcoKXtyZXR1cm4gdGhpcy5fbm93KCl9X2dldEJwbSgpe3JldHVybiB0aGlzLmNvbnRleHQudHJhbnNwb3J0LmJwbS52YWx1ZX1fZ2V0VGltZVNpZ25hdHVyZSgpe3JldHVybiB0aGlzLmNvbnRleHQudHJhbnNwb3J0LnRpbWVTaWduYXR1cmV9X2dldFBQUSgpe3JldHVybiB0aGlzLmNvbnRleHQudHJhbnNwb3J0LlBQUX1mcm9tVHlwZSh0KXtzd2l0Y2godGhpcy5fdW5pdHM9dm9pZCAwLHRoaXMuZGVmYXVsdFVuaXRzKXtjYXNlXCJzXCI6dGhpcy5fdmFsPXQudG9TZWNvbmRzKCk7YnJlYWs7Y2FzZVwiaVwiOnRoaXMuX3ZhbD10LnRvVGlja3MoKTticmVhaztjYXNlXCJoelwiOnRoaXMuX3ZhbD10LnRvRnJlcXVlbmN5KCk7YnJlYWs7Y2FzZVwibWlkaVwiOnRoaXMuX3ZhbD10LnRvTWlkaSgpfXJldHVybiB0aGlzfXRvRnJlcXVlbmN5KCl7cmV0dXJuIDEvdGhpcy50b1NlY29uZHMoKX10b1NhbXBsZXMoKXtyZXR1cm4gdGhpcy50b1NlY29uZHMoKSp0aGlzLmNvbnRleHQuc2FtcGxlUmF0ZX10b01pbGxpc2Vjb25kcygpe3JldHVybiAxZTMqdGhpcy50b1NlY29uZHMoKX19Y2xhc3MgaG8gZXh0ZW5kcyBjb3tjb25zdHJ1Y3Rvcigpe3N1cGVyKC4uLmFyZ3VtZW50cyksdGhpcy5uYW1lPVwiVGltZUNsYXNzXCJ9X2dldEV4cHJlc3Npb25zKCl7cmV0dXJuIE9iamVjdC5hc3NpZ24oc3VwZXIuX2dldEV4cHJlc3Npb25zKCkse25vdzp7bWV0aG9kOnQ9PnRoaXMuX25vdygpK25ldyB0aGlzLmNvbnN0cnVjdG9yKHRoaXMuY29udGV4dCx0KS52YWx1ZU9mKCkscmVnZXhwOi9eXFwrKC4rKS99LHF1YW50aXplOnttZXRob2Q6dD0+e2NvbnN0IGU9bmV3IGhvKHRoaXMuY29udGV4dCx0KS52YWx1ZU9mKCk7cmV0dXJuIHRoaXMuX3NlY29uZHNUb1VuaXRzKHRoaXMuY29udGV4dC50cmFuc3BvcnQubmV4dFN1YmRpdmlzaW9uKGUpKX0scmVnZXhwOi9eQCguKykvfX0pfXF1YW50aXplKHQsZT0xKXtjb25zdCBzPW5ldyB0aGlzLmNvbnN0cnVjdG9yKHRoaXMuY29udGV4dCx0KS52YWx1ZU9mKCksbj10aGlzLnZhbHVlT2YoKTtyZXR1cm4gbisoTWF0aC5yb3VuZChuL3MpKnMtbikqZX10b05vdGF0aW9uKCl7Y29uc3QgdD10aGlzLnRvU2Vjb25kcygpLGU9W1wiMW1cIl07Zm9yKGxldCB0PTE7dDw5O3QrKyl7Y29uc3Qgcz1NYXRoLnBvdygyLHQpO2UucHVzaChzK1wibi5cIiksZS5wdXNoKHMrXCJuXCIpLGUucHVzaChzK1widFwiKX1lLnB1c2goXCIwXCIpO2xldCBzPWVbMF0sbj1uZXcgaG8odGhpcy5jb250ZXh0LGVbMF0pLnRvU2Vjb25kcygpO3JldHVybiBlLmZvckVhY2goZT0+e2NvbnN0IGk9bmV3IGhvKHRoaXMuY29udGV4dCxlKS50b1NlY29uZHMoKTtNYXRoLmFicyhpLXQpPE1hdGguYWJzKG4tdCkmJihzPWUsbj1pKX0pLHN9dG9CYXJzQmVhdHNTaXh0ZWVudGhzKCl7Y29uc3QgdD10aGlzLl9iZWF0c1RvVW5pdHMoMSk7bGV0IGU9dGhpcy52YWx1ZU9mKCkvdDtlPXBhcnNlRmxvYXQoZS50b0ZpeGVkKDQpKTtjb25zdCBzPU1hdGguZmxvb3IoZS90aGlzLl9nZXRUaW1lU2lnbmF0dXJlKCkpO2xldCBuPWUlMSo0O2U9TWF0aC5mbG9vcihlKSV0aGlzLl9nZXRUaW1lU2lnbmF0dXJlKCk7Y29uc3QgaT1uLnRvU3RyaW5nKCk7aS5sZW5ndGg+MyYmKG49cGFyc2VGbG9hdChwYXJzZUZsb2F0KGkpLnRvRml4ZWQoMykpKTtyZXR1cm5bcyxlLG5dLmpvaW4oXCI6XCIpfXRvVGlja3MoKXtjb25zdCB0PXRoaXMuX2JlYXRzVG9Vbml0cygxKSxlPXRoaXMudmFsdWVPZigpL3Q7cmV0dXJuIE1hdGgucm91bmQoZSp0aGlzLl9nZXRQUFEoKSl9dG9TZWNvbmRzKCl7cmV0dXJuIHRoaXMudmFsdWVPZigpfXRvTWlkaSgpe3JldHVybiBvbyh0aGlzLnRvRnJlcXVlbmN5KCkpfV9ub3coKXtyZXR1cm4gdGhpcy5jb250ZXh0Lm5vdygpfX1mdW5jdGlvbiB1byh0LGUpe3JldHVybiBuZXcgaG8oSmkoKSx0LGUpfWNsYXNzIGxvIGV4dGVuZHMgaG97Y29uc3RydWN0b3IoKXtzdXBlciguLi5hcmd1bWVudHMpLHRoaXMubmFtZT1cIkZyZXF1ZW5jeVwiLHRoaXMuZGVmYXVsdFVuaXRzPVwiaHpcIn1zdGF0aWMgZ2V0IEE0KCl7cmV0dXJuIGlvfXN0YXRpYyBzZXQgQTQodCl7IWZ1bmN0aW9uKHQpe2lvPXR9KHQpfV9nZXRFeHByZXNzaW9ucygpe3JldHVybiBPYmplY3QuYXNzaWduKHt9LHN1cGVyLl9nZXRFeHByZXNzaW9ucygpLHttaWRpOntyZWdleHA6L14oXFxkKyg/OlxcLlxcZCspP21pZGkpLyxtZXRob2QodCl7cmV0dXJuXCJtaWRpXCI9PT10aGlzLmRlZmF1bHRVbml0cz90OmxvLm10b2YodCl9fSxub3RlOntyZWdleHA6L14oW2EtZ117MX0oPzpifCN8eHxiYik/KSgtP1swLTldKykvaSxtZXRob2QodCxlKXtjb25zdCBzPXBvW3QudG9Mb3dlckNhc2UoKV0rMTIqKHBhcnNlSW50KGUsMTApKzEpO3JldHVyblwibWlkaVwiPT09dGhpcy5kZWZhdWx0VW5pdHM/czpsby5tdG9mKHMpfX0sdHI6e3JlZ2V4cDovXihcXGQrKD86XFwuXFxkKyk/KTooXFxkKyg/OlxcLlxcZCspPyk6PyhcXGQrKD86XFwuXFxkKyk/KT8vLG1ldGhvZCh0LGUscyl7bGV0IG49MTtyZXR1cm4gdCYmXCIwXCIhPT10JiYobio9dGhpcy5fYmVhdHNUb1VuaXRzKHRoaXMuX2dldFRpbWVTaWduYXR1cmUoKSpwYXJzZUZsb2F0KHQpKSksZSYmXCIwXCIhPT1lJiYobio9dGhpcy5fYmVhdHNUb1VuaXRzKHBhcnNlRmxvYXQoZSkpKSxzJiZcIjBcIiE9PXMmJihuKj10aGlzLl9iZWF0c1RvVW5pdHMocGFyc2VGbG9hdChzKS80KSksbn19fSl9dHJhbnNwb3NlKHQpe3JldHVybiBuZXcgbG8odGhpcy5jb250ZXh0LHRoaXMudmFsdWVPZigpKm5vKHQpKX1oYXJtb25pemUodCl7cmV0dXJuIHQubWFwKHQ9PnRoaXMudHJhbnNwb3NlKHQpKX10b01pZGkoKXtyZXR1cm4gb28odGhpcy52YWx1ZU9mKCkpfXRvTm90ZSgpe2NvbnN0IHQ9dGhpcy50b0ZyZXF1ZW5jeSgpLGU9TWF0aC5sb2cyKHQvbG8uQTQpO2xldCBzPU1hdGgucm91bmQoMTIqZSkrNTc7Y29uc3Qgbj1NYXRoLmZsb29yKHMvMTIpO248MCYmKHMrPS0xMipuKTtyZXR1cm4gZm9bcyUxMl0rbi50b1N0cmluZygpfXRvU2Vjb25kcygpe3JldHVybiAxL3N1cGVyLnRvU2Vjb25kcygpfXRvVGlja3MoKXtjb25zdCB0PXRoaXMuX2JlYXRzVG9Vbml0cygxKSxlPXRoaXMudmFsdWVPZigpL3Q7cmV0dXJuIE1hdGguZmxvb3IoZSp0aGlzLl9nZXRQUFEoKSl9X25vQXJnKCl7cmV0dXJuIDB9X2ZyZXF1ZW5jeVRvVW5pdHModCl7cmV0dXJuIHR9X3RpY2tzVG9Vbml0cyh0KXtyZXR1cm4gMS8oNjAqdC8odGhpcy5fZ2V0QnBtKCkqdGhpcy5fZ2V0UFBRKCkpKX1fYmVhdHNUb1VuaXRzKHQpe3JldHVybiAxL3N1cGVyLl9iZWF0c1RvVW5pdHModCl9X3NlY29uZHNUb1VuaXRzKHQpe3JldHVybiAxL3R9c3RhdGljIG10b2YodCl7cmV0dXJuIGFvKHQpfXN0YXRpYyBmdG9tKHQpe3JldHVybiBvbyh0KX19Y29uc3QgcG89e2NiYjotMixjYjotMSxjOjAsXCJjI1wiOjEsY3g6MixkYmI6MCxkYjoxLGQ6MixcImQjXCI6MyxkeDo0LGViYjoyLGViOjMsZTo0LFwiZSNcIjo1LGV4OjYsZmJiOjMsZmI6NCxmOjUsXCJmI1wiOjYsZng6NyxnYmI6NSxnYjo2LGc6NyxcImcjXCI6OCxneDo5LGFiYjo3LGFiOjgsYTo5LFwiYSNcIjoxMCxheDoxMSxiYmI6OSxiYjoxMCxiOjExLFwiYiNcIjoxMixieDoxM30sZm89W1wiQ1wiLFwiQyNcIixcIkRcIixcIkQjXCIsXCJFXCIsXCJGXCIsXCJGI1wiLFwiR1wiLFwiRyNcIixcIkFcIixcIkEjXCIsXCJCXCJdO2Z1bmN0aW9uIF9vKHQsZSl7cmV0dXJuIG5ldyBsbyhKaSgpLHQsZSl9Y2xhc3MgbW8gZXh0ZW5kcyBob3tjb25zdHJ1Y3Rvcigpe3N1cGVyKC4uLmFyZ3VtZW50cyksdGhpcy5uYW1lPVwiVHJhbnNwb3J0VGltZVwifV9ub3coKXtyZXR1cm4gdGhpcy5jb250ZXh0LnRyYW5zcG9ydC5zZWNvbmRzfX1mdW5jdGlvbiBnbyh0LGUpe3JldHVybiBuZXcgbW8oSmkoKSx0LGUpfWNsYXNzIHZvIGV4dGVuZHMgRWl7Y29uc3RydWN0b3IoKXtzdXBlcigpO2NvbnN0IHQ9RGkodm8uZ2V0RGVmYXVsdHMoKSxhcmd1bWVudHMsW1wiY29udGV4dFwiXSk7dGhpcy5kZWZhdWx0Q29udGV4dD90aGlzLmNvbnRleHQ9dGhpcy5kZWZhdWx0Q29udGV4dDp0aGlzLmNvbnRleHQ9dC5jb250ZXh0fXN0YXRpYyBnZXREZWZhdWx0cygpe3JldHVybntjb250ZXh0OkppKCl9fW5vdygpe3JldHVybiB0aGlzLmNvbnRleHQuY3VycmVudFRpbWUrdGhpcy5jb250ZXh0Lmxvb2tBaGVhZH1pbW1lZGlhdGUoKXtyZXR1cm4gdGhpcy5jb250ZXh0LmN1cnJlbnRUaW1lfWdldCBzYW1wbGVUaW1lKCl7cmV0dXJuIDEvdGhpcy5jb250ZXh0LnNhbXBsZVJhdGV9Z2V0IGJsb2NrVGltZSgpe3JldHVybiAxMjgvdGhpcy5jb250ZXh0LnNhbXBsZVJhdGV9dG9TZWNvbmRzKHQpe3JldHVybiBuZXcgaG8odGhpcy5jb250ZXh0LHQpLnRvU2Vjb25kcygpfXRvRnJlcXVlbmN5KHQpe3JldHVybiBuZXcgbG8odGhpcy5jb250ZXh0LHQpLnRvRnJlcXVlbmN5KCl9dG9UaWNrcyh0KXtyZXR1cm4gbmV3IG1vKHRoaXMuY29udGV4dCx0KS50b1RpY2tzKCl9X2dldFBhcnRpYWxQcm9wZXJ0aWVzKHQpe2NvbnN0IGU9dGhpcy5nZXQoKTtyZXR1cm4gT2JqZWN0LmtleXMoZSkuZm9yRWFjaChzPT57YWkodFtzXSkmJmRlbGV0ZSBlW3NdfSksZX1nZXQoKXtjb25zdCB0PXRoaXMuY29uc3RydWN0b3IuZ2V0RGVmYXVsdHMoKTtyZXR1cm4gT2JqZWN0LmtleXModCkuZm9yRWFjaChlPT57aWYoUmVmbGVjdC5oYXModGhpcyxlKSl7Y29uc3Qgcz10aGlzW2VdO2NpKHMpJiZjaShzLnZhbHVlKSYmY2kocy5zZXRWYWx1ZUF0VGltZSk/dFtlXT1zLnZhbHVlOnMgaW5zdGFuY2VvZiB2bz90W2VdPXMuX2dldFBhcnRpYWxQcm9wZXJ0aWVzKHRbZV0pOmRpKHMpfHx1aShzKXx8Zmkocyl8fHBpKHMpP3RbZV09czpkZWxldGUgdFtlXX19KSx0fXNldCh0KXtyZXR1cm4gT2JqZWN0LmtleXModCkuZm9yRWFjaChlPT57UmVmbGVjdC5oYXModGhpcyxlKSYmY2kodGhpc1tlXSkmJih0aGlzW2VdJiZjaSh0aGlzW2VdLnZhbHVlKSYmY2kodGhpc1tlXS5zZXRWYWx1ZUF0VGltZSk/dGhpc1tlXS52YWx1ZSE9PXRbZV0mJih0aGlzW2VdLnZhbHVlPXRbZV0pOnRoaXNbZV1pbnN0YW5jZW9mIHZvP3RoaXNbZV0uc2V0KHRbZV0pOnRoaXNbZV09dFtlXSl9KSx0aGlzfX1jbGFzcyB5byBleHRlbmRzIE5pe2NvbnN0cnVjdG9yKHQ9XCJzdG9wcGVkXCIpe3N1cGVyKCksdGhpcy5uYW1lPVwiU3RhdGVUaW1lbGluZVwiLHRoaXMuX2luaXRpYWw9dCx0aGlzLnNldFN0YXRlQXRUaW1lKHRoaXMuX2luaXRpYWwsMCl9Z2V0VmFsdWVBdFRpbWUodCl7Y29uc3QgZT10aGlzLmdldCh0KTtyZXR1cm4gbnVsbCE9PWU/ZS5zdGF0ZTp0aGlzLl9pbml0aWFsfXNldFN0YXRlQXRUaW1lKHQsZSxzKXtyZXR1cm4gZWkoZSwwKSx0aGlzLmFkZChPYmplY3QuYXNzaWduKHt9LHMse3N0YXRlOnQsdGltZTplfSkpLHRoaXN9Z2V0TGFzdFN0YXRlKHQsZSl7Zm9yKGxldCBzPXRoaXMuX3NlYXJjaChlKTtzPj0wO3MtLSl7Y29uc3QgZT10aGlzLl90aW1lbGluZVtzXTtpZihlLnN0YXRlPT09dClyZXR1cm4gZX19Z2V0TmV4dFN0YXRlKHQsZSl7Y29uc3Qgcz10aGlzLl9zZWFyY2goZSk7aWYoLTEhPT1zKWZvcihsZXQgZT1zO2U8dGhpcy5fdGltZWxpbmUubGVuZ3RoO2UrKyl7Y29uc3Qgcz10aGlzLl90aW1lbGluZVtlXTtpZihzLnN0YXRlPT09dClyZXR1cm4gc319fWNsYXNzIHhvIGV4dGVuZHMgdm97Y29uc3RydWN0b3IoKXtzdXBlcihEaSh4by5nZXREZWZhdWx0cygpLGFyZ3VtZW50cyxbXCJwYXJhbVwiLFwidW5pdHNcIixcImNvbnZlcnRcIl0pKSx0aGlzLm5hbWU9XCJQYXJhbVwiLHRoaXMub3ZlcnJpZGRlbj0hMSx0aGlzLl9taW5PdXRwdXQ9MWUtNztjb25zdCB0PURpKHhvLmdldERlZmF1bHRzKCksYXJndW1lbnRzLFtcInBhcmFtXCIsXCJ1bml0c1wiLFwiY29udmVydFwiXSk7Zm9yKHRpKGNpKHQucGFyYW0pJiYod2kodC5wYXJhbSl8fHQucGFyYW0gaW5zdGFuY2VvZiB4byksXCJwYXJhbSBtdXN0IGJlIGFuIEF1ZGlvUGFyYW1cIik7IXdpKHQucGFyYW0pOyl0LnBhcmFtPXQucGFyYW0uX3BhcmFtO3RoaXMuX3N3YXBwYWJsZT0hIWNpKHQuc3dhcHBhYmxlKSYmdC5zd2FwcGFibGUsdGhpcy5fc3dhcHBhYmxlPyh0aGlzLmlucHV0PXRoaXMuY29udGV4dC5jcmVhdGVHYWluKCksdGhpcy5fcGFyYW09dC5wYXJhbSx0aGlzLmlucHV0LmNvbm5lY3QodGhpcy5fcGFyYW0pKTp0aGlzLl9wYXJhbT10aGlzLmlucHV0PXQucGFyYW0sdGhpcy5fZXZlbnRzPW5ldyBOaSgxZTMpLHRoaXMuX2luaXRpYWxWYWx1ZT10aGlzLl9wYXJhbS5kZWZhdWx0VmFsdWUsdGhpcy51bml0cz10LnVuaXRzLHRoaXMuY29udmVydD10LmNvbnZlcnQsdGhpcy5fbWluVmFsdWU9dC5taW5WYWx1ZSx0aGlzLl9tYXhWYWx1ZT10Lm1heFZhbHVlLGNpKHQudmFsdWUpJiZ0LnZhbHVlIT09dGhpcy5fdG9UeXBlKHRoaXMuX2luaXRpYWxWYWx1ZSkmJnRoaXMuc2V0VmFsdWVBdFRpbWUodC52YWx1ZSwwKX1zdGF0aWMgZ2V0RGVmYXVsdHMoKXtyZXR1cm4gT2JqZWN0LmFzc2lnbih2by5nZXREZWZhdWx0cygpLHtjb252ZXJ0OiEwLHVuaXRzOlwibnVtYmVyXCJ9KX1nZXQgdmFsdWUoKXtjb25zdCB0PXRoaXMubm93KCk7cmV0dXJuIHRoaXMuZ2V0VmFsdWVBdFRpbWUodCl9c2V0IHZhbHVlKHQpe3RoaXMuY2FuY2VsU2NoZWR1bGVkVmFsdWVzKHRoaXMubm93KCkpLHRoaXMuc2V0VmFsdWVBdFRpbWUodCx0aGlzLm5vdygpKX1nZXQgbWluVmFsdWUoKXtyZXR1cm4gY2kodGhpcy5fbWluVmFsdWUpP3RoaXMuX21pblZhbHVlOlwidGltZVwiPT09dGhpcy51bml0c3x8XCJmcmVxdWVuY3lcIj09PXRoaXMudW5pdHN8fFwibm9ybWFsUmFuZ2VcIj09PXRoaXMudW5pdHN8fFwicG9zaXRpdmVcIj09PXRoaXMudW5pdHN8fFwidHJhbnNwb3J0VGltZVwiPT09dGhpcy51bml0c3x8XCJ0aWNrc1wiPT09dGhpcy51bml0c3x8XCJicG1cIj09PXRoaXMudW5pdHN8fFwiaGVydHpcIj09PXRoaXMudW5pdHN8fFwic2FtcGxlc1wiPT09dGhpcy51bml0cz8wOlwiYXVkaW9SYW5nZVwiPT09dGhpcy51bml0cz8tMTpcImRlY2liZWxzXCI9PT10aGlzLnVuaXRzPy0xLzA6dGhpcy5fcGFyYW0ubWluVmFsdWV9Z2V0IG1heFZhbHVlKCl7cmV0dXJuIGNpKHRoaXMuX21heFZhbHVlKT90aGlzLl9tYXhWYWx1ZTpcIm5vcm1hbFJhbmdlXCI9PT10aGlzLnVuaXRzfHxcImF1ZGlvUmFuZ2VcIj09PXRoaXMudW5pdHM/MTp0aGlzLl9wYXJhbS5tYXhWYWx1ZX1faXModCxlKXtyZXR1cm4gdGhpcy51bml0cz09PWV9X2Fzc2VydFJhbmdlKHQpe3JldHVybiBjaSh0aGlzLm1heFZhbHVlKSYmY2kodGhpcy5taW5WYWx1ZSkmJmVpKHQsdGhpcy5fZnJvbVR5cGUodGhpcy5taW5WYWx1ZSksdGhpcy5fZnJvbVR5cGUodGhpcy5tYXhWYWx1ZSkpLHR9X2Zyb21UeXBlKHQpe3JldHVybiB0aGlzLmNvbnZlcnQmJiF0aGlzLm92ZXJyaWRkZW4/dGhpcy5faXModCxcInRpbWVcIik/dGhpcy50b1NlY29uZHModCk6dGhpcy5faXModCxcImRlY2liZWxzXCIpP2VvKHQpOnRoaXMuX2lzKHQsXCJmcmVxdWVuY3lcIik/dGhpcy50b0ZyZXF1ZW5jeSh0KTp0OnRoaXMub3ZlcnJpZGRlbj8wOnR9X3RvVHlwZSh0KXtyZXR1cm4gdGhpcy5jb252ZXJ0JiZcImRlY2liZWxzXCI9PT10aGlzLnVuaXRzP3NvKHQpOnR9c2V0VmFsdWVBdFRpbWUodCxlKXtjb25zdCBzPXRoaXMudG9TZWNvbmRzKGUpLG49dGhpcy5fZnJvbVR5cGUodCk7cmV0dXJuIHRpKGlzRmluaXRlKG4pJiZpc0Zpbml0ZShzKSxgSW52YWxpZCBhcmd1bWVudChzKSB0byBzZXRWYWx1ZUF0VGltZTogJHtKU09OLnN0cmluZ2lmeSh0KX0sICR7SlNPTi5zdHJpbmdpZnkoZSl9YCksdGhpcy5fYXNzZXJ0UmFuZ2UobiksdGhpcy5sb2codGhpcy51bml0cyxcInNldFZhbHVlQXRUaW1lXCIsdCxzKSx0aGlzLl9ldmVudHMuYWRkKHt0aW1lOnMsdHlwZTpcInNldFZhbHVlQXRUaW1lXCIsdmFsdWU6bn0pLHRoaXMuX3BhcmFtLnNldFZhbHVlQXRUaW1lKG4scyksdGhpc31nZXRWYWx1ZUF0VGltZSh0KXtjb25zdCBlPU1hdGgubWF4KHRoaXMudG9TZWNvbmRzKHQpLDApLHM9dGhpcy5fZXZlbnRzLmdldEFmdGVyKGUpLG49dGhpcy5fZXZlbnRzLmdldChlKTtsZXQgaT10aGlzLl9pbml0aWFsVmFsdWU7aWYobnVsbD09PW4paT10aGlzLl9pbml0aWFsVmFsdWU7ZWxzZSBpZihcInNldFRhcmdldEF0VGltZVwiIT09bi50eXBlfHxudWxsIT09cyYmXCJzZXRWYWx1ZUF0VGltZVwiIT09cy50eXBlKWlmKG51bGw9PT1zKWk9bi52YWx1ZTtlbHNlIGlmKFwibGluZWFyUmFtcFRvVmFsdWVBdFRpbWVcIj09PXMudHlwZXx8XCJleHBvbmVudGlhbFJhbXBUb1ZhbHVlQXRUaW1lXCI9PT1zLnR5cGUpe2xldCB0PW4udmFsdWU7aWYoXCJzZXRUYXJnZXRBdFRpbWVcIj09PW4udHlwZSl7Y29uc3QgZT10aGlzLl9ldmVudHMuZ2V0QmVmb3JlKG4udGltZSk7dD1udWxsPT09ZT90aGlzLl9pbml0aWFsVmFsdWU6ZS52YWx1ZX1pPVwibGluZWFyUmFtcFRvVmFsdWVBdFRpbWVcIj09PXMudHlwZT90aGlzLl9saW5lYXJJbnRlcnBvbGF0ZShuLnRpbWUsdCxzLnRpbWUscy52YWx1ZSxlKTp0aGlzLl9leHBvbmVudGlhbEludGVycG9sYXRlKG4udGltZSx0LHMudGltZSxzLnZhbHVlLGUpfWVsc2UgaT1uLnZhbHVlO2Vsc2V7Y29uc3QgdD10aGlzLl9ldmVudHMuZ2V0QmVmb3JlKG4udGltZSk7bGV0IHM7cz1udWxsPT09dD90aGlzLl9pbml0aWFsVmFsdWU6dC52YWx1ZSxcInNldFRhcmdldEF0VGltZVwiPT09bi50eXBlJiYoaT10aGlzLl9leHBvbmVudGlhbEFwcHJvYWNoKG4udGltZSxzLG4udmFsdWUsbi5jb25zdGFudCxlKSl9cmV0dXJuIHRoaXMuX3RvVHlwZShpKX1zZXRSYW1wUG9pbnQodCl7dD10aGlzLnRvU2Vjb25kcyh0KTtsZXQgZT10aGlzLmdldFZhbHVlQXRUaW1lKHQpO3JldHVybiB0aGlzLmNhbmNlbEFuZEhvbGRBdFRpbWUodCksMD09PXRoaXMuX2Zyb21UeXBlKGUpJiYoZT10aGlzLl90b1R5cGUodGhpcy5fbWluT3V0cHV0KSksdGhpcy5zZXRWYWx1ZUF0VGltZShlLHQpLHRoaXN9bGluZWFyUmFtcFRvVmFsdWVBdFRpbWUodCxlKXtjb25zdCBzPXRoaXMuX2Zyb21UeXBlKHQpLG49dGhpcy50b1NlY29uZHMoZSk7cmV0dXJuIHRpKGlzRmluaXRlKHMpJiZpc0Zpbml0ZShuKSxgSW52YWxpZCBhcmd1bWVudChzKSB0byBsaW5lYXJSYW1wVG9WYWx1ZUF0VGltZTogJHtKU09OLnN0cmluZ2lmeSh0KX0sICR7SlNPTi5zdHJpbmdpZnkoZSl9YCksdGhpcy5fYXNzZXJ0UmFuZ2UocyksdGhpcy5fZXZlbnRzLmFkZCh7dGltZTpuLHR5cGU6XCJsaW5lYXJSYW1wVG9WYWx1ZUF0VGltZVwiLHZhbHVlOnN9KSx0aGlzLmxvZyh0aGlzLnVuaXRzLFwibGluZWFyUmFtcFRvVmFsdWVBdFRpbWVcIix0LG4pLHRoaXMuX3BhcmFtLmxpbmVhclJhbXBUb1ZhbHVlQXRUaW1lKHMsbiksdGhpc31leHBvbmVudGlhbFJhbXBUb1ZhbHVlQXRUaW1lKHQsZSl7bGV0IHM9dGhpcy5fZnJvbVR5cGUodCk7cz1JaShzLDApP3RoaXMuX21pbk91dHB1dDpzLHRoaXMuX2Fzc2VydFJhbmdlKHMpO2NvbnN0IG49dGhpcy50b1NlY29uZHMoZSk7cmV0dXJuIHRpKGlzRmluaXRlKHMpJiZpc0Zpbml0ZShuKSxgSW52YWxpZCBhcmd1bWVudChzKSB0byBleHBvbmVudGlhbFJhbXBUb1ZhbHVlQXRUaW1lOiAke0pTT04uc3RyaW5naWZ5KHQpfSwgJHtKU09OLnN0cmluZ2lmeShlKX1gKSx0aGlzLl9ldmVudHMuYWRkKHt0aW1lOm4sdHlwZTpcImV4cG9uZW50aWFsUmFtcFRvVmFsdWVBdFRpbWVcIix2YWx1ZTpzfSksdGhpcy5sb2codGhpcy51bml0cyxcImV4cG9uZW50aWFsUmFtcFRvVmFsdWVBdFRpbWVcIix0LG4pLHRoaXMuX3BhcmFtLmV4cG9uZW50aWFsUmFtcFRvVmFsdWVBdFRpbWUocyxuKSx0aGlzfWV4cG9uZW50aWFsUmFtcFRvKHQsZSxzKXtyZXR1cm4gcz10aGlzLnRvU2Vjb25kcyhzKSx0aGlzLnNldFJhbXBQb2ludChzKSx0aGlzLmV4cG9uZW50aWFsUmFtcFRvVmFsdWVBdFRpbWUodCxzK3RoaXMudG9TZWNvbmRzKGUpKSx0aGlzfWxpbmVhclJhbXBUbyh0LGUscyl7cmV0dXJuIHM9dGhpcy50b1NlY29uZHMocyksdGhpcy5zZXRSYW1wUG9pbnQocyksdGhpcy5saW5lYXJSYW1wVG9WYWx1ZUF0VGltZSh0LHMrdGhpcy50b1NlY29uZHMoZSkpLHRoaXN9dGFyZ2V0UmFtcFRvKHQsZSxzKXtyZXR1cm4gcz10aGlzLnRvU2Vjb25kcyhzKSx0aGlzLnNldFJhbXBQb2ludChzKSx0aGlzLmV4cG9uZW50aWFsQXBwcm9hY2hWYWx1ZUF0VGltZSh0LHMsZSksdGhpc31leHBvbmVudGlhbEFwcHJvYWNoVmFsdWVBdFRpbWUodCxlLHMpe2U9dGhpcy50b1NlY29uZHMoZSkscz10aGlzLnRvU2Vjb25kcyhzKTtjb25zdCBuPU1hdGgubG9nKHMrMSkvTWF0aC5sb2coMjAwKTtyZXR1cm4gdGhpcy5zZXRUYXJnZXRBdFRpbWUodCxlLG4pLHRoaXMuY2FuY2VsQW5kSG9sZEF0VGltZShlKy45KnMpLHRoaXMubGluZWFyUmFtcFRvVmFsdWVBdFRpbWUodCxlK3MpLHRoaXN9c2V0VGFyZ2V0QXRUaW1lKHQsZSxzKXtjb25zdCBuPXRoaXMuX2Zyb21UeXBlKHQpO3RpKGlzRmluaXRlKHMpJiZzPjAsXCJ0aW1lQ29uc3RhbnQgbXVzdCBiZSBhIG51bWJlciBncmVhdGVyIHRoYW4gMFwiKTtjb25zdCBpPXRoaXMudG9TZWNvbmRzKGUpO3JldHVybiB0aGlzLl9hc3NlcnRSYW5nZShuKSx0aShpc0Zpbml0ZShuKSYmaXNGaW5pdGUoaSksYEludmFsaWQgYXJndW1lbnQocykgdG8gc2V0VGFyZ2V0QXRUaW1lOiAke0pTT04uc3RyaW5naWZ5KHQpfSwgJHtKU09OLnN0cmluZ2lmeShlKX1gKSx0aGlzLl9ldmVudHMuYWRkKHtjb25zdGFudDpzLHRpbWU6aSx0eXBlOlwic2V0VGFyZ2V0QXRUaW1lXCIsdmFsdWU6bn0pLHRoaXMubG9nKHRoaXMudW5pdHMsXCJzZXRUYXJnZXRBdFRpbWVcIix0LGkscyksdGhpcy5fcGFyYW0uc2V0VGFyZ2V0QXRUaW1lKG4saSxzKSx0aGlzfXNldFZhbHVlQ3VydmVBdFRpbWUodCxlLHMsbj0xKXtzPXRoaXMudG9TZWNvbmRzKHMpLGU9dGhpcy50b1NlY29uZHMoZSk7Y29uc3QgaT10aGlzLl9mcm9tVHlwZSh0WzBdKSpuO3RoaXMuc2V0VmFsdWVBdFRpbWUodGhpcy5fdG9UeXBlKGkpLGUpO2NvbnN0IG89cy8odC5sZW5ndGgtMSk7Zm9yKGxldCBzPTE7czx0Lmxlbmd0aDtzKyspe2NvbnN0IGk9dGhpcy5fZnJvbVR5cGUodFtzXSkqbjt0aGlzLmxpbmVhclJhbXBUb1ZhbHVlQXRUaW1lKHRoaXMuX3RvVHlwZShpKSxlK3Mqbyl9cmV0dXJuIHRoaXN9Y2FuY2VsU2NoZWR1bGVkVmFsdWVzKHQpe2NvbnN0IGU9dGhpcy50b1NlY29uZHModCk7cmV0dXJuIHRpKGlzRmluaXRlKGUpLFwiSW52YWxpZCBhcmd1bWVudCB0byBjYW5jZWxTY2hlZHVsZWRWYWx1ZXM6IFwiK0pTT04uc3RyaW5naWZ5KHQpKSx0aGlzLl9ldmVudHMuY2FuY2VsKGUpLHRoaXMuX3BhcmFtLmNhbmNlbFNjaGVkdWxlZFZhbHVlcyhlKSx0aGlzLmxvZyh0aGlzLnVuaXRzLFwiY2FuY2VsU2NoZWR1bGVkVmFsdWVzXCIsZSksdGhpc31jYW5jZWxBbmRIb2xkQXRUaW1lKHQpe2NvbnN0IGU9dGhpcy50b1NlY29uZHModCkscz10aGlzLl9mcm9tVHlwZSh0aGlzLmdldFZhbHVlQXRUaW1lKGUpKTt0aShpc0Zpbml0ZShlKSxcIkludmFsaWQgYXJndW1lbnQgdG8gY2FuY2VsQW5kSG9sZEF0VGltZTogXCIrSlNPTi5zdHJpbmdpZnkodCkpLHRoaXMubG9nKHRoaXMudW5pdHMsXCJjYW5jZWxBbmRIb2xkQXRUaW1lXCIsZSxcInZhbHVlPVwiK3MpO2NvbnN0IG49dGhpcy5fZXZlbnRzLmdldChlKSxpPXRoaXMuX2V2ZW50cy5nZXRBZnRlcihlKTtyZXR1cm4gbiYmSWkobi50aW1lLGUpP2k/KHRoaXMuX3BhcmFtLmNhbmNlbFNjaGVkdWxlZFZhbHVlcyhpLnRpbWUpLHRoaXMuX2V2ZW50cy5jYW5jZWwoaS50aW1lKSk6KHRoaXMuX3BhcmFtLmNhbmNlbEFuZEhvbGRBdFRpbWUoZSksdGhpcy5fZXZlbnRzLmNhbmNlbChlK3RoaXMuc2FtcGxlVGltZSkpOmkmJih0aGlzLl9wYXJhbS5jYW5jZWxTY2hlZHVsZWRWYWx1ZXMoaS50aW1lKSx0aGlzLl9ldmVudHMuY2FuY2VsKGkudGltZSksXCJsaW5lYXJSYW1wVG9WYWx1ZUF0VGltZVwiPT09aS50eXBlP3RoaXMubGluZWFyUmFtcFRvVmFsdWVBdFRpbWUodGhpcy5fdG9UeXBlKHMpLGUpOlwiZXhwb25lbnRpYWxSYW1wVG9WYWx1ZUF0VGltZVwiPT09aS50eXBlJiZ0aGlzLmV4cG9uZW50aWFsUmFtcFRvVmFsdWVBdFRpbWUodGhpcy5fdG9UeXBlKHMpLGUpKSx0aGlzLl9ldmVudHMuYWRkKHt0aW1lOmUsdHlwZTpcInNldFZhbHVlQXRUaW1lXCIsdmFsdWU6c30pLHRoaXMuX3BhcmFtLnNldFZhbHVlQXRUaW1lKHMsZSksdGhpc31yYW1wVG8odCxlPS4xLHMpe3JldHVyblwiZnJlcXVlbmN5XCI9PT10aGlzLnVuaXRzfHxcImJwbVwiPT09dGhpcy51bml0c3x8XCJkZWNpYmVsc1wiPT09dGhpcy51bml0cz90aGlzLmV4cG9uZW50aWFsUmFtcFRvKHQsZSxzKTp0aGlzLmxpbmVhclJhbXBUbyh0LGUscyksdGhpc31hcHBseSh0KXtjb25zdCBlPXRoaXMuY29udGV4dC5jdXJyZW50VGltZTt0LnNldFZhbHVlQXRUaW1lKHRoaXMuZ2V0VmFsdWVBdFRpbWUoZSksZSk7Y29uc3Qgcz10aGlzLl9ldmVudHMuZ2V0KGUpO2lmKHMmJlwic2V0VGFyZ2V0QXRUaW1lXCI9PT1zLnR5cGUpe2NvbnN0IG49dGhpcy5fZXZlbnRzLmdldEFmdGVyKHMudGltZSksaT1uP24udGltZTplKzIsbz0oaS1lKS8xMDtmb3IobGV0IHM9ZTtzPGk7cys9byl0LmxpbmVhclJhbXBUb1ZhbHVlQXRUaW1lKHRoaXMuZ2V0VmFsdWVBdFRpbWUocykscyl9cmV0dXJuIHRoaXMuX2V2ZW50cy5mb3JFYWNoQWZ0ZXIodGhpcy5jb250ZXh0LmN1cnJlbnRUaW1lLGU9PntcImNhbmNlbFNjaGVkdWxlZFZhbHVlc1wiPT09ZS50eXBlP3QuY2FuY2VsU2NoZWR1bGVkVmFsdWVzKGUudGltZSk6XCJzZXRUYXJnZXRBdFRpbWVcIj09PWUudHlwZT90LnNldFRhcmdldEF0VGltZShlLnZhbHVlLGUudGltZSxlLmNvbnN0YW50KTp0W2UudHlwZV0oZS52YWx1ZSxlLnRpbWUpfSksdGhpc31zZXRQYXJhbSh0KXt0aSh0aGlzLl9zd2FwcGFibGUsXCJUaGUgUGFyYW0gbXVzdCBiZSBhc3NpZ25lZCBhcyAnc3dhcHBhYmxlJyBpbiB0aGUgY29uc3RydWN0b3JcIik7Y29uc3QgZT10aGlzLmlucHV0O3JldHVybiBlLmRpc2Nvbm5lY3QodGhpcy5fcGFyYW0pLHRoaXMuYXBwbHkodCksdGhpcy5fcGFyYW09dCxlLmNvbm5lY3QodGhpcy5fcGFyYW0pLHRoaXN9ZGlzcG9zZSgpe3JldHVybiBzdXBlci5kaXNwb3NlKCksdGhpcy5fZXZlbnRzLmRpc3Bvc2UoKSx0aGlzfWdldCBkZWZhdWx0VmFsdWUoKXtyZXR1cm4gdGhpcy5fdG9UeXBlKHRoaXMuX3BhcmFtLmRlZmF1bHRWYWx1ZSl9X2V4cG9uZW50aWFsQXBwcm9hY2godCxlLHMsbixpKXtyZXR1cm4gcysoZS1zKSpNYXRoLmV4cCgtKGktdCkvbil9X2xpbmVhckludGVycG9sYXRlKHQsZSxzLG4saSl7cmV0dXJuIGUrKGktdCkvKHMtdCkqKG4tZSl9X2V4cG9uZW50aWFsSW50ZXJwb2xhdGUodCxlLHMsbixpKXtyZXR1cm4gZSpNYXRoLnBvdyhuL2UsKGktdCkvKHMtdCkpfX1jbGFzcyB3byBleHRlbmRzIHZve2NvbnN0cnVjdG9yKCl7c3VwZXIoLi4uYXJndW1lbnRzKSx0aGlzLm5hbWU9XCJUb25lQXVkaW9Ob2RlXCIsdGhpcy5faW50ZXJuYWxDaGFubmVscz1bXX1nZXQgbnVtYmVyT2ZJbnB1dHMoKXtyZXR1cm4gY2kodGhpcy5pbnB1dCk/d2kodGhpcy5pbnB1dCl8fHRoaXMuaW5wdXQgaW5zdGFuY2VvZiB4bz8xOnRoaXMuaW5wdXQubnVtYmVyT2ZJbnB1dHM6MH1nZXQgbnVtYmVyT2ZPdXRwdXRzKCl7cmV0dXJuIGNpKHRoaXMub3V0cHV0KT90aGlzLm91dHB1dC5udW1iZXJPZk91dHB1dHM6MH1faXNBdWRpb05vZGUodCl7cmV0dXJuIGNpKHQpJiYodCBpbnN0YW5jZW9mIHdvfHxiaSh0KSl9X2dldEludGVybmFsTm9kZXMoKXtjb25zdCB0PXRoaXMuX2ludGVybmFsQ2hhbm5lbHMuc2xpY2UoMCk7cmV0dXJuIHRoaXMuX2lzQXVkaW9Ob2RlKHRoaXMuaW5wdXQpJiZ0LnB1c2godGhpcy5pbnB1dCksdGhpcy5faXNBdWRpb05vZGUodGhpcy5vdXRwdXQpJiZ0aGlzLmlucHV0IT09dGhpcy5vdXRwdXQmJnQucHVzaCh0aGlzLm91dHB1dCksdH1fc2V0Q2hhbm5lbFByb3BlcnRpZXModCl7dGhpcy5fZ2V0SW50ZXJuYWxOb2RlcygpLmZvckVhY2goZT0+e2UuY2hhbm5lbENvdW50PXQuY2hhbm5lbENvdW50LGUuY2hhbm5lbENvdW50TW9kZT10LmNoYW5uZWxDb3VudE1vZGUsZS5jaGFubmVsSW50ZXJwcmV0YXRpb249dC5jaGFubmVsSW50ZXJwcmV0YXRpb259KX1fZ2V0Q2hhbm5lbFByb3BlcnRpZXMoKXtjb25zdCB0PXRoaXMuX2dldEludGVybmFsTm9kZXMoKTt0aSh0Lmxlbmd0aD4wLFwiVG9uZUF1ZGlvTm9kZSBkb2VzIG5vdCBoYXZlIGFueSBpbnRlcm5hbCBub2Rlc1wiKTtjb25zdCBlPXRbMF07cmV0dXJue2NoYW5uZWxDb3VudDplLmNoYW5uZWxDb3VudCxjaGFubmVsQ291bnRNb2RlOmUuY2hhbm5lbENvdW50TW9kZSxjaGFubmVsSW50ZXJwcmV0YXRpb246ZS5jaGFubmVsSW50ZXJwcmV0YXRpb259fWdldCBjaGFubmVsQ291bnQoKXtyZXR1cm4gdGhpcy5fZ2V0Q2hhbm5lbFByb3BlcnRpZXMoKS5jaGFubmVsQ291bnR9c2V0IGNoYW5uZWxDb3VudCh0KXtjb25zdCBlPXRoaXMuX2dldENoYW5uZWxQcm9wZXJ0aWVzKCk7dGhpcy5fc2V0Q2hhbm5lbFByb3BlcnRpZXMoT2JqZWN0LmFzc2lnbihlLHtjaGFubmVsQ291bnQ6dH0pKX1nZXQgY2hhbm5lbENvdW50TW9kZSgpe3JldHVybiB0aGlzLl9nZXRDaGFubmVsUHJvcGVydGllcygpLmNoYW5uZWxDb3VudE1vZGV9c2V0IGNoYW5uZWxDb3VudE1vZGUodCl7Y29uc3QgZT10aGlzLl9nZXRDaGFubmVsUHJvcGVydGllcygpO3RoaXMuX3NldENoYW5uZWxQcm9wZXJ0aWVzKE9iamVjdC5hc3NpZ24oZSx7Y2hhbm5lbENvdW50TW9kZTp0fSkpfWdldCBjaGFubmVsSW50ZXJwcmV0YXRpb24oKXtyZXR1cm4gdGhpcy5fZ2V0Q2hhbm5lbFByb3BlcnRpZXMoKS5jaGFubmVsSW50ZXJwcmV0YXRpb259c2V0IGNoYW5uZWxJbnRlcnByZXRhdGlvbih0KXtjb25zdCBlPXRoaXMuX2dldENoYW5uZWxQcm9wZXJ0aWVzKCk7dGhpcy5fc2V0Q2hhbm5lbFByb3BlcnRpZXMoT2JqZWN0LmFzc2lnbihlLHtjaGFubmVsSW50ZXJwcmV0YXRpb246dH0pKX1jb25uZWN0KHQsZT0wLHM9MCl7cmV0dXJuIFRvKHRoaXMsdCxlLHMpLHRoaXN9dG9EZXN0aW5hdGlvbigpe3JldHVybiB0aGlzLmNvbm5lY3QodGhpcy5jb250ZXh0LmRlc3RpbmF0aW9uKSx0aGlzfXRvTWFzdGVyKCl7cmV0dXJuIHJpKFwidG9NYXN0ZXIoKSBoYXMgYmVlbiByZW5hbWVkIHRvRGVzdGluYXRpb24oKVwiKSx0aGlzLnRvRGVzdGluYXRpb24oKX1kaXNjb25uZWN0KHQsZT0wLHM9MCl7cmV0dXJuIFNvKHRoaXMsdCxlLHMpLHRoaXN9Y2hhaW4oLi4udCl7cmV0dXJuIGJvKHRoaXMsLi4udCksdGhpc31mYW4oLi4udCl7cmV0dXJuIHQuZm9yRWFjaCh0PT50aGlzLmNvbm5lY3QodCkpLHRoaXN9ZGlzcG9zZSgpe3JldHVybiBzdXBlci5kaXNwb3NlKCksY2kodGhpcy5pbnB1dCkmJih0aGlzLmlucHV0IGluc3RhbmNlb2Ygd28/dGhpcy5pbnB1dC5kaXNwb3NlKCk6YmkodGhpcy5pbnB1dCkmJnRoaXMuaW5wdXQuZGlzY29ubmVjdCgpKSxjaSh0aGlzLm91dHB1dCkmJih0aGlzLm91dHB1dCBpbnN0YW5jZW9mIHdvP3RoaXMub3V0cHV0LmRpc3Bvc2UoKTpiaSh0aGlzLm91dHB1dCkmJnRoaXMub3V0cHV0LmRpc2Nvbm5lY3QoKSksdGhpcy5faW50ZXJuYWxDaGFubmVscz1bXSx0aGlzfX1mdW5jdGlvbiBibyguLi50KXtjb25zdCBlPXQuc2hpZnQoKTt0LnJlZHVjZSgodCxlKT0+KHQgaW5zdGFuY2VvZiB3bz90LmNvbm5lY3QoZSk6YmkodCkmJlRvKHQsZSksZSksZSl9ZnVuY3Rpb24gVG8odCxlLHM9MCxuPTApe2Zvcih0aShjaSh0KSxcIkNhbm5vdCBjb25uZWN0IGZyb20gdW5kZWZpbmVkIG5vZGVcIiksdGkoY2koZSksXCJDYW5ub3QgY29ubmVjdCB0byB1bmRlZmluZWQgbm9kZVwiKSwoZSBpbnN0YW5jZW9mIHdvfHxiaShlKSkmJnRpKGUubnVtYmVyT2ZJbnB1dHM+MCxcIkNhbm5vdCBjb25uZWN0IHRvIG5vZGUgd2l0aCBubyBpbnB1dHNcIiksdGkodC5udW1iZXJPZk91dHB1dHM+MCxcIkNhbm5vdCBjb25uZWN0IGZyb20gbm9kZSB3aXRoIG5vIG91dHB1dHNcIik7ZSBpbnN0YW5jZW9mIHdvfHxlIGluc3RhbmNlb2YgeG87KWNpKGUuaW5wdXQpJiYoZT1lLmlucHV0KTtmb3IoO3QgaW5zdGFuY2VvZiB3bzspY2kodC5vdXRwdXQpJiYodD10Lm91dHB1dCk7d2koZSk/dC5jb25uZWN0KGUscyk6dC5jb25uZWN0KGUscyxuKX1mdW5jdGlvbiBTbyh0LGUscz0wLG49MCl7aWYoY2koZSkpZm9yKDtlIGluc3RhbmNlb2Ygd287KWU9ZS5pbnB1dDtmb3IoOyFiaSh0KTspY2kodC5vdXRwdXQpJiYodD10Lm91dHB1dCk7d2koZSk/dC5kaXNjb25uZWN0KGUscyk6YmkoZSk/dC5kaXNjb25uZWN0KGUscyxuKTp0LmRpc2Nvbm5lY3QoKX1jbGFzcyBrbyBleHRlbmRzIHdve2NvbnN0cnVjdG9yKCl7c3VwZXIoRGkoa28uZ2V0RGVmYXVsdHMoKSxhcmd1bWVudHMsW1wiZ2FpblwiLFwidW5pdHNcIl0pKSx0aGlzLm5hbWU9XCJHYWluXCIsdGhpcy5fZ2Fpbk5vZGU9dGhpcy5jb250ZXh0LmNyZWF0ZUdhaW4oKSx0aGlzLmlucHV0PXRoaXMuX2dhaW5Ob2RlLHRoaXMub3V0cHV0PXRoaXMuX2dhaW5Ob2RlO2NvbnN0IHQ9RGkoa28uZ2V0RGVmYXVsdHMoKSxhcmd1bWVudHMsW1wiZ2FpblwiLFwidW5pdHNcIl0pO3RoaXMuZ2Fpbj1uZXcgeG8oe2NvbnRleHQ6dGhpcy5jb250ZXh0LGNvbnZlcnQ6dC5jb252ZXJ0LHBhcmFtOnRoaXMuX2dhaW5Ob2RlLmdhaW4sdW5pdHM6dC51bml0cyx2YWx1ZTp0LmdhaW4sbWluVmFsdWU6dC5taW5WYWx1ZSxtYXhWYWx1ZTp0Lm1heFZhbHVlfSksVWkodGhpcyxcImdhaW5cIil9c3RhdGljIGdldERlZmF1bHRzKCl7cmV0dXJuIE9iamVjdC5hc3NpZ24od28uZ2V0RGVmYXVsdHMoKSx7Y29udmVydDohMCxnYWluOjEsdW5pdHM6XCJnYWluXCJ9KX1kaXNwb3NlKCl7cmV0dXJuIHN1cGVyLmRpc3Bvc2UoKSx0aGlzLl9nYWluTm9kZS5kaXNjb25uZWN0KCksdGhpcy5nYWluLmRpc3Bvc2UoKSx0aGlzfX1jbGFzcyBDbyBleHRlbmRzIHdve2NvbnN0cnVjdG9yKHQpe3N1cGVyKHQpLHRoaXMub25lbmRlZD1aaSx0aGlzLl9zdGFydFRpbWU9LTEsdGhpcy5fc3RvcFRpbWU9LTEsdGhpcy5fdGltZW91dD0tMSx0aGlzLm91dHB1dD1uZXcga28oe2NvbnRleHQ6dGhpcy5jb250ZXh0LGdhaW46MH0pLHRoaXMuX2dhaW5Ob2RlPXRoaXMub3V0cHV0LHRoaXMuZ2V0U3RhdGVBdFRpbWU9ZnVuY3Rpb24odCl7Y29uc3QgZT10aGlzLnRvU2Vjb25kcyh0KTtyZXR1cm4tMSE9PXRoaXMuX3N0YXJ0VGltZSYmZT49dGhpcy5fc3RhcnRUaW1lJiYoLTE9PT10aGlzLl9zdG9wVGltZXx8ZTw9dGhpcy5fc3RvcFRpbWUpP1wic3RhcnRlZFwiOlwic3RvcHBlZFwifSx0aGlzLl9mYWRlSW49dC5mYWRlSW4sdGhpcy5fZmFkZU91dD10LmZhZGVPdXQsdGhpcy5fY3VydmU9dC5jdXJ2ZSx0aGlzLm9uZW5kZWQ9dC5vbmVuZGVkfXN0YXRpYyBnZXREZWZhdWx0cygpe3JldHVybiBPYmplY3QuYXNzaWduKHdvLmdldERlZmF1bHRzKCkse2N1cnZlOlwibGluZWFyXCIsZmFkZUluOjAsZmFkZU91dDowLG9uZW5kZWQ6Wml9KX1fc3RhcnRHYWluKHQsZT0xKXt0aSgtMT09PXRoaXMuX3N0YXJ0VGltZSxcIlNvdXJjZSBjYW5ub3QgYmUgc3RhcnRlZCBtb3JlIHRoYW4gb25jZVwiKTtjb25zdCBzPXRoaXMudG9TZWNvbmRzKHRoaXMuX2ZhZGVJbik7cmV0dXJuIHRoaXMuX3N0YXJ0VGltZT10K3MsdGhpcy5fc3RhcnRUaW1lPU1hdGgubWF4KHRoaXMuX3N0YXJ0VGltZSx0aGlzLmNvbnRleHQuY3VycmVudFRpbWUpLHM+MD8odGhpcy5fZ2Fpbk5vZGUuZ2Fpbi5zZXRWYWx1ZUF0VGltZSgwLHQpLFwibGluZWFyXCI9PT10aGlzLl9jdXJ2ZT90aGlzLl9nYWluTm9kZS5nYWluLmxpbmVhclJhbXBUb1ZhbHVlQXRUaW1lKGUsdCtzKTp0aGlzLl9nYWluTm9kZS5nYWluLmV4cG9uZW50aWFsQXBwcm9hY2hWYWx1ZUF0VGltZShlLHQscykpOnRoaXMuX2dhaW5Ob2RlLmdhaW4uc2V0VmFsdWVBdFRpbWUoZSx0KSx0aGlzfXN0b3AodCl7cmV0dXJuIHRoaXMubG9nKFwic3RvcFwiLHQpLHRoaXMuX3N0b3BHYWluKHRoaXMudG9TZWNvbmRzKHQpKSx0aGlzfV9zdG9wR2Fpbih0KXt0aSgtMSE9PXRoaXMuX3N0YXJ0VGltZSxcIidzdGFydCcgbXVzdCBiZSBjYWxsZWQgYmVmb3JlICdzdG9wJ1wiKSx0aGlzLmNhbmNlbFN0b3AoKTtjb25zdCBlPXRoaXMudG9TZWNvbmRzKHRoaXMuX2ZhZGVPdXQpO3JldHVybiB0aGlzLl9zdG9wVGltZT10aGlzLnRvU2Vjb25kcyh0KStlLHRoaXMuX3N0b3BUaW1lPU1hdGgubWF4KHRoaXMuX3N0b3BUaW1lLHRoaXMuY29udGV4dC5jdXJyZW50VGltZSksZT4wP1wibGluZWFyXCI9PT10aGlzLl9jdXJ2ZT90aGlzLl9nYWluTm9kZS5nYWluLmxpbmVhclJhbXBUbygwLGUsdCk6dGhpcy5fZ2Fpbk5vZGUuZ2Fpbi50YXJnZXRSYW1wVG8oMCxlLHQpOih0aGlzLl9nYWluTm9kZS5nYWluLmNhbmNlbEFuZEhvbGRBdFRpbWUodCksdGhpcy5fZ2Fpbk5vZGUuZ2Fpbi5zZXRWYWx1ZUF0VGltZSgwLHQpKSx0aGlzLmNvbnRleHQuY2xlYXJUaW1lb3V0KHRoaXMuX3RpbWVvdXQpLHRoaXMuX3RpbWVvdXQ9dGhpcy5jb250ZXh0LnNldFRpbWVvdXQoKCk9Pntjb25zdCB0PVwiZXhwb25lbnRpYWxcIj09PXRoaXMuX2N1cnZlPzIqZTowO3RoaXMuX3N0b3BTb3VyY2UodGhpcy5ub3coKSt0KSx0aGlzLl9vbmVuZGVkKCl9LHRoaXMuX3N0b3BUaW1lLXRoaXMuY29udGV4dC5jdXJyZW50VGltZSksdGhpc31fb25lbmRlZCgpe2lmKHRoaXMub25lbmRlZCE9PVppJiYodGhpcy5vbmVuZGVkKHRoaXMpLHRoaXMub25lbmRlZD1aaSwhdGhpcy5jb250ZXh0LmlzT2ZmbGluZSkpe2NvbnN0IHQ9KCk9PnRoaXMuZGlzcG9zZSgpO3ZvaWQgMCE9PXdpbmRvdy5yZXF1ZXN0SWRsZUNhbGxiYWNrP3dpbmRvdy5yZXF1ZXN0SWRsZUNhbGxiYWNrKHQpOnNldFRpbWVvdXQodCwxZTMpfX1nZXQgc3RhdGUoKXtyZXR1cm4gdGhpcy5nZXRTdGF0ZUF0VGltZSh0aGlzLm5vdygpKX1jYW5jZWxTdG9wKCl7cmV0dXJuIHRoaXMubG9nKFwiY2FuY2VsU3RvcFwiKSx0aSgtMSE9PXRoaXMuX3N0YXJ0VGltZSxcIlNvdXJjZSBpcyBub3Qgc3RhcnRlZFwiKSx0aGlzLl9nYWluTm9kZS5nYWluLmNhbmNlbFNjaGVkdWxlZFZhbHVlcyh0aGlzLl9zdGFydFRpbWUrdGhpcy5zYW1wbGVUaW1lKSx0aGlzLmNvbnRleHQuY2xlYXJUaW1lb3V0KHRoaXMuX3RpbWVvdXQpLHRoaXMuX3N0b3BUaW1lPS0xLHRoaXN9ZGlzcG9zZSgpe3JldHVybiBzdXBlci5kaXNwb3NlKCksdGhpcy5fZ2Fpbk5vZGUuZGlzY29ubmVjdCgpLHRoaXN9fWNsYXNzIEFvIGV4dGVuZHMgQ297Y29uc3RydWN0b3IoKXtzdXBlcihEaShBby5nZXREZWZhdWx0cygpLGFyZ3VtZW50cyxbXCJvZmZzZXRcIl0pKSx0aGlzLm5hbWU9XCJUb25lQ29uc3RhbnRTb3VyY2VcIix0aGlzLl9zb3VyY2U9dGhpcy5jb250ZXh0LmNyZWF0ZUNvbnN0YW50U291cmNlKCk7Y29uc3QgdD1EaShBby5nZXREZWZhdWx0cygpLGFyZ3VtZW50cyxbXCJvZmZzZXRcIl0pO1RvKHRoaXMuX3NvdXJjZSx0aGlzLl9nYWluTm9kZSksdGhpcy5vZmZzZXQ9bmV3IHhvKHtjb250ZXh0OnRoaXMuY29udGV4dCxjb252ZXJ0OnQuY29udmVydCxwYXJhbTp0aGlzLl9zb3VyY2Uub2Zmc2V0LHVuaXRzOnQudW5pdHMsdmFsdWU6dC5vZmZzZXQsbWluVmFsdWU6dC5taW5WYWx1ZSxtYXhWYWx1ZTp0Lm1heFZhbHVlfSl9c3RhdGljIGdldERlZmF1bHRzKCl7cmV0dXJuIE9iamVjdC5hc3NpZ24oQ28uZ2V0RGVmYXVsdHMoKSx7Y29udmVydDohMCxvZmZzZXQ6MSx1bml0czpcIm51bWJlclwifSl9c3RhcnQodCl7Y29uc3QgZT10aGlzLnRvU2Vjb25kcyh0KTtyZXR1cm4gdGhpcy5sb2coXCJzdGFydFwiLGUpLHRoaXMuX3N0YXJ0R2FpbihlKSx0aGlzLl9zb3VyY2Uuc3RhcnQoZSksdGhpc31fc3RvcFNvdXJjZSh0KXt0aGlzLl9zb3VyY2Uuc3RvcCh0KX1kaXNwb3NlKCl7cmV0dXJuIHN1cGVyLmRpc3Bvc2UoKSxcInN0YXJ0ZWRcIj09PXRoaXMuc3RhdGUmJnRoaXMuc3RvcCgpLHRoaXMuX3NvdXJjZS5kaXNjb25uZWN0KCksdGhpcy5vZmZzZXQuZGlzcG9zZSgpLHRoaXN9fWNsYXNzIERvIGV4dGVuZHMgd297Y29uc3RydWN0b3IoKXtzdXBlcihEaShEby5nZXREZWZhdWx0cygpLGFyZ3VtZW50cyxbXCJ2YWx1ZVwiLFwidW5pdHNcIl0pKSx0aGlzLm5hbWU9XCJTaWduYWxcIix0aGlzLm92ZXJyaWRlPSEwO2NvbnN0IHQ9RGkoRG8uZ2V0RGVmYXVsdHMoKSxhcmd1bWVudHMsW1widmFsdWVcIixcInVuaXRzXCJdKTt0aGlzLm91dHB1dD10aGlzLl9jb25zdGFudFNvdXJjZT1uZXcgQW8oe2NvbnRleHQ6dGhpcy5jb250ZXh0LGNvbnZlcnQ6dC5jb252ZXJ0LG9mZnNldDp0LnZhbHVlLHVuaXRzOnQudW5pdHMsbWluVmFsdWU6dC5taW5WYWx1ZSxtYXhWYWx1ZTp0Lm1heFZhbHVlfSksdGhpcy5fY29uc3RhbnRTb3VyY2Uuc3RhcnQoMCksdGhpcy5pbnB1dD10aGlzLl9wYXJhbT10aGlzLl9jb25zdGFudFNvdXJjZS5vZmZzZXR9c3RhdGljIGdldERlZmF1bHRzKCl7cmV0dXJuIE9iamVjdC5hc3NpZ24od28uZ2V0RGVmYXVsdHMoKSx7Y29udmVydDohMCx1bml0czpcIm51bWJlclwiLHZhbHVlOjB9KX1jb25uZWN0KHQsZT0wLHM9MCl7cmV0dXJuIE9vKHRoaXMsdCxlLHMpLHRoaXN9ZGlzcG9zZSgpe3JldHVybiBzdXBlci5kaXNwb3NlKCksdGhpcy5fcGFyYW0uZGlzcG9zZSgpLHRoaXMuX2NvbnN0YW50U291cmNlLmRpc3Bvc2UoKSx0aGlzfXNldFZhbHVlQXRUaW1lKHQsZSl7cmV0dXJuIHRoaXMuX3BhcmFtLnNldFZhbHVlQXRUaW1lKHQsZSksdGhpc31nZXRWYWx1ZUF0VGltZSh0KXtyZXR1cm4gdGhpcy5fcGFyYW0uZ2V0VmFsdWVBdFRpbWUodCl9c2V0UmFtcFBvaW50KHQpe3JldHVybiB0aGlzLl9wYXJhbS5zZXRSYW1wUG9pbnQodCksdGhpc31saW5lYXJSYW1wVG9WYWx1ZUF0VGltZSh0LGUpe3JldHVybiB0aGlzLl9wYXJhbS5saW5lYXJSYW1wVG9WYWx1ZUF0VGltZSh0LGUpLHRoaXN9ZXhwb25lbnRpYWxSYW1wVG9WYWx1ZUF0VGltZSh0LGUpe3JldHVybiB0aGlzLl9wYXJhbS5leHBvbmVudGlhbFJhbXBUb1ZhbHVlQXRUaW1lKHQsZSksdGhpc31leHBvbmVudGlhbFJhbXBUbyh0LGUscyl7cmV0dXJuIHRoaXMuX3BhcmFtLmV4cG9uZW50aWFsUmFtcFRvKHQsZSxzKSx0aGlzfWxpbmVhclJhbXBUbyh0LGUscyl7cmV0dXJuIHRoaXMuX3BhcmFtLmxpbmVhclJhbXBUbyh0LGUscyksdGhpc310YXJnZXRSYW1wVG8odCxlLHMpe3JldHVybiB0aGlzLl9wYXJhbS50YXJnZXRSYW1wVG8odCxlLHMpLHRoaXN9ZXhwb25lbnRpYWxBcHByb2FjaFZhbHVlQXRUaW1lKHQsZSxzKXtyZXR1cm4gdGhpcy5fcGFyYW0uZXhwb25lbnRpYWxBcHByb2FjaFZhbHVlQXRUaW1lKHQsZSxzKSx0aGlzfXNldFRhcmdldEF0VGltZSh0LGUscyl7cmV0dXJuIHRoaXMuX3BhcmFtLnNldFRhcmdldEF0VGltZSh0LGUscyksdGhpc31zZXRWYWx1ZUN1cnZlQXRUaW1lKHQsZSxzLG4pe3JldHVybiB0aGlzLl9wYXJhbS5zZXRWYWx1ZUN1cnZlQXRUaW1lKHQsZSxzLG4pLHRoaXN9Y2FuY2VsU2NoZWR1bGVkVmFsdWVzKHQpe3JldHVybiB0aGlzLl9wYXJhbS5jYW5jZWxTY2hlZHVsZWRWYWx1ZXModCksdGhpc31jYW5jZWxBbmRIb2xkQXRUaW1lKHQpe3JldHVybiB0aGlzLl9wYXJhbS5jYW5jZWxBbmRIb2xkQXRUaW1lKHQpLHRoaXN9cmFtcFRvKHQsZSxzKXtyZXR1cm4gdGhpcy5fcGFyYW0ucmFtcFRvKHQsZSxzKSx0aGlzfWdldCB2YWx1ZSgpe3JldHVybiB0aGlzLl9wYXJhbS52YWx1ZX1zZXQgdmFsdWUodCl7dGhpcy5fcGFyYW0udmFsdWU9dH1nZXQgY29udmVydCgpe3JldHVybiB0aGlzLl9wYXJhbS5jb252ZXJ0fXNldCBjb252ZXJ0KHQpe3RoaXMuX3BhcmFtLmNvbnZlcnQ9dH1nZXQgdW5pdHMoKXtyZXR1cm4gdGhpcy5fcGFyYW0udW5pdHN9Z2V0IG92ZXJyaWRkZW4oKXtyZXR1cm4gdGhpcy5fcGFyYW0ub3ZlcnJpZGRlbn1zZXQgb3ZlcnJpZGRlbih0KXt0aGlzLl9wYXJhbS5vdmVycmlkZGVuPXR9Z2V0IG1heFZhbHVlKCl7cmV0dXJuIHRoaXMuX3BhcmFtLm1heFZhbHVlfWdldCBtaW5WYWx1ZSgpe3JldHVybiB0aGlzLl9wYXJhbS5taW5WYWx1ZX1hcHBseSh0KXtyZXR1cm4gdGhpcy5fcGFyYW0uYXBwbHkodCksdGhpc319ZnVuY3Rpb24gT28odCxlLHMsbil7KGUgaW5zdGFuY2VvZiB4b3x8d2koZSl8fGUgaW5zdGFuY2VvZiBEbyYmZS5vdmVycmlkZSkmJihlLmNhbmNlbFNjaGVkdWxlZFZhbHVlcygwKSxlLnNldFZhbHVlQXRUaW1lKDAsMCksZSBpbnN0YW5jZW9mIERvJiYoZS5vdmVycmlkZGVuPSEwKSksVG8odCxlLHMsbil9Y2xhc3MgTW8gZXh0ZW5kcyB4b3tjb25zdHJ1Y3Rvcigpe3N1cGVyKERpKE1vLmdldERlZmF1bHRzKCksYXJndW1lbnRzLFtcInZhbHVlXCJdKSksdGhpcy5uYW1lPVwiVGlja1BhcmFtXCIsdGhpcy5fZXZlbnRzPW5ldyBOaSgxLzApLHRoaXMuX211bHRpcGxpZXI9MTtjb25zdCB0PURpKE1vLmdldERlZmF1bHRzKCksYXJndW1lbnRzLFtcInZhbHVlXCJdKTt0aGlzLl9tdWx0aXBsaWVyPXQubXVsdGlwbGllcix0aGlzLl9ldmVudHMuY2FuY2VsKDApLHRoaXMuX2V2ZW50cy5hZGQoe3RpY2tzOjAsdGltZTowLHR5cGU6XCJzZXRWYWx1ZUF0VGltZVwiLHZhbHVlOnRoaXMuX2Zyb21UeXBlKHQudmFsdWUpfSksdGhpcy5zZXRWYWx1ZUF0VGltZSh0LnZhbHVlLDApfXN0YXRpYyBnZXREZWZhdWx0cygpe3JldHVybiBPYmplY3QuYXNzaWduKHhvLmdldERlZmF1bHRzKCkse211bHRpcGxpZXI6MSx1bml0czpcImhlcnR6XCIsdmFsdWU6MX0pfXNldFRhcmdldEF0VGltZSh0LGUscyl7ZT10aGlzLnRvU2Vjb25kcyhlKSx0aGlzLnNldFJhbXBQb2ludChlKTtjb25zdCBuPXRoaXMuX2Zyb21UeXBlKHQpLGk9dGhpcy5fZXZlbnRzLmdldChlKSxvPU1hdGgucm91bmQoTWF0aC5tYXgoMS9zLDEpKTtmb3IobGV0IHQ9MDt0PD1vO3QrKyl7Y29uc3Qgbz1zKnQrZSxyPXRoaXMuX2V4cG9uZW50aWFsQXBwcm9hY2goaS50aW1lLGkudmFsdWUsbixzLG8pO3RoaXMubGluZWFyUmFtcFRvVmFsdWVBdFRpbWUodGhpcy5fdG9UeXBlKHIpLG8pfXJldHVybiB0aGlzfXNldFZhbHVlQXRUaW1lKHQsZSl7Y29uc3Qgcz10aGlzLnRvU2Vjb25kcyhlKTtzdXBlci5zZXRWYWx1ZUF0VGltZSh0LGUpO2NvbnN0IG49dGhpcy5fZXZlbnRzLmdldChzKSxpPXRoaXMuX2V2ZW50cy5wcmV2aW91c0V2ZW50KG4pLG89dGhpcy5fZ2V0VGlja3NVbnRpbEV2ZW50KGkscyk7cmV0dXJuIG4udGlja3M9TWF0aC5tYXgobywwKSx0aGlzfWxpbmVhclJhbXBUb1ZhbHVlQXRUaW1lKHQsZSl7Y29uc3Qgcz10aGlzLnRvU2Vjb25kcyhlKTtzdXBlci5saW5lYXJSYW1wVG9WYWx1ZUF0VGltZSh0LGUpO2NvbnN0IG49dGhpcy5fZXZlbnRzLmdldChzKSxpPXRoaXMuX2V2ZW50cy5wcmV2aW91c0V2ZW50KG4pLG89dGhpcy5fZ2V0VGlja3NVbnRpbEV2ZW50KGkscyk7cmV0dXJuIG4udGlja3M9TWF0aC5tYXgobywwKSx0aGlzfWV4cG9uZW50aWFsUmFtcFRvVmFsdWVBdFRpbWUodCxlKXtlPXRoaXMudG9TZWNvbmRzKGUpO2NvbnN0IHM9dGhpcy5fZnJvbVR5cGUodCksbj10aGlzLl9ldmVudHMuZ2V0KGUpLGk9TWF0aC5yb3VuZChNYXRoLm1heCgxMCooZS1uLnRpbWUpLDEpKSxvPShlLW4udGltZSkvaTtmb3IobGV0IHQ9MDt0PD1pO3QrKyl7Y29uc3QgaT1vKnQrbi50aW1lLHI9dGhpcy5fZXhwb25lbnRpYWxJbnRlcnBvbGF0ZShuLnRpbWUsbi52YWx1ZSxlLHMsaSk7dGhpcy5saW5lYXJSYW1wVG9WYWx1ZUF0VGltZSh0aGlzLl90b1R5cGUociksaSl9cmV0dXJuIHRoaXN9X2dldFRpY2tzVW50aWxFdmVudCh0LGUpe2lmKG51bGw9PT10KXQ9e3RpY2tzOjAsdGltZTowLHR5cGU6XCJzZXRWYWx1ZUF0VGltZVwiLHZhbHVlOjB9O2Vsc2UgaWYoYWkodC50aWNrcykpe2NvbnN0IGU9dGhpcy5fZXZlbnRzLnByZXZpb3VzRXZlbnQodCk7dC50aWNrcz10aGlzLl9nZXRUaWNrc1VudGlsRXZlbnQoZSx0LnRpbWUpfWNvbnN0IHM9dGhpcy5fZnJvbVR5cGUodGhpcy5nZXRWYWx1ZUF0VGltZSh0LnRpbWUpKTtsZXQgbj10aGlzLl9mcm9tVHlwZSh0aGlzLmdldFZhbHVlQXRUaW1lKGUpKTtjb25zdCBpPXRoaXMuX2V2ZW50cy5nZXQoZSk7cmV0dXJuIGkmJmkudGltZT09PWUmJlwic2V0VmFsdWVBdFRpbWVcIj09PWkudHlwZSYmKG49dGhpcy5fZnJvbVR5cGUodGhpcy5nZXRWYWx1ZUF0VGltZShlLXRoaXMuc2FtcGxlVGltZSkpKSwuNSooZS10LnRpbWUpKihzK24pK3QudGlja3N9Z2V0VGlja3NBdFRpbWUodCl7Y29uc3QgZT10aGlzLnRvU2Vjb25kcyh0KSxzPXRoaXMuX2V2ZW50cy5nZXQoZSk7cmV0dXJuIE1hdGgubWF4KHRoaXMuX2dldFRpY2tzVW50aWxFdmVudChzLGUpLDApfWdldER1cmF0aW9uT2ZUaWNrcyh0LGUpe2NvbnN0IHM9dGhpcy50b1NlY29uZHMoZSksbj10aGlzLmdldFRpY2tzQXRUaW1lKGUpO3JldHVybiB0aGlzLmdldFRpbWVPZlRpY2sobit0KS1zfWdldFRpbWVPZlRpY2sodCl7Y29uc3QgZT10aGlzLl9ldmVudHMuZ2V0KHQsXCJ0aWNrc1wiKSxzPXRoaXMuX2V2ZW50cy5nZXRBZnRlcih0LFwidGlja3NcIik7aWYoZSYmZS50aWNrcz09PXQpcmV0dXJuIGUudGltZTtpZihlJiZzJiZcImxpbmVhclJhbXBUb1ZhbHVlQXRUaW1lXCI9PT1zLnR5cGUmJmUudmFsdWUhPT1zLnZhbHVlKXtjb25zdCBuPXRoaXMuX2Zyb21UeXBlKHRoaXMuZ2V0VmFsdWVBdFRpbWUoZS50aW1lKSksaT0odGhpcy5fZnJvbVR5cGUodGhpcy5nZXRWYWx1ZUF0VGltZShzLnRpbWUpKS1uKS8ocy50aW1lLWUudGltZSksbz1NYXRoLnNxcnQoTWF0aC5wb3cobiwyKS0yKmkqKGUudGlja3MtdCkpLHI9KC1uK28pL2ksYT0oLW4tbykvaTtyZXR1cm4ocj4wP3I6YSkrZS50aW1lfXJldHVybiBlPzA9PT1lLnZhbHVlPzEvMDplLnRpbWUrKHQtZS50aWNrcykvZS52YWx1ZTp0L3RoaXMuX2luaXRpYWxWYWx1ZX10aWNrc1RvVGltZSh0LGUpe3JldHVybiB0aGlzLmdldER1cmF0aW9uT2ZUaWNrcyh0LGUpfXRpbWVUb1RpY2tzKHQsZSl7Y29uc3Qgcz10aGlzLnRvU2Vjb25kcyhlKSxuPXRoaXMudG9TZWNvbmRzKHQpLGk9dGhpcy5nZXRUaWNrc0F0VGltZShzKTtyZXR1cm4gdGhpcy5nZXRUaWNrc0F0VGltZShzK24pLWl9X2Zyb21UeXBlKHQpe3JldHVyblwiYnBtXCI9PT10aGlzLnVuaXRzJiZ0aGlzLm11bHRpcGxpZXI/MS8oNjAvdC90aGlzLm11bHRpcGxpZXIpOnN1cGVyLl9mcm9tVHlwZSh0KX1fdG9UeXBlKHQpe3JldHVyblwiYnBtXCI9PT10aGlzLnVuaXRzJiZ0aGlzLm11bHRpcGxpZXI/dC90aGlzLm11bHRpcGxpZXIqNjA6c3VwZXIuX3RvVHlwZSh0KX1nZXQgbXVsdGlwbGllcigpe3JldHVybiB0aGlzLl9tdWx0aXBsaWVyfXNldCBtdWx0aXBsaWVyKHQpe2NvbnN0IGU9dGhpcy52YWx1ZTt0aGlzLl9tdWx0aXBsaWVyPXQsdGhpcy5jYW5jZWxTY2hlZHVsZWRWYWx1ZXMoMCksdGhpcy5zZXRWYWx1ZUF0VGltZShlLDApfX1jbGFzcyBFbyBleHRlbmRzIERve2NvbnN0cnVjdG9yKCl7c3VwZXIoRGkoRW8uZ2V0RGVmYXVsdHMoKSxhcmd1bWVudHMsW1widmFsdWVcIl0pKSx0aGlzLm5hbWU9XCJUaWNrU2lnbmFsXCI7Y29uc3QgdD1EaShFby5nZXREZWZhdWx0cygpLGFyZ3VtZW50cyxbXCJ2YWx1ZVwiXSk7dGhpcy5pbnB1dD10aGlzLl9wYXJhbT1uZXcgTW8oe2NvbnRleHQ6dGhpcy5jb250ZXh0LGNvbnZlcnQ6dC5jb252ZXJ0LG11bHRpcGxpZXI6dC5tdWx0aXBsaWVyLHBhcmFtOnRoaXMuX2NvbnN0YW50U291cmNlLm9mZnNldCx1bml0czp0LnVuaXRzLHZhbHVlOnQudmFsdWV9KX1zdGF0aWMgZ2V0RGVmYXVsdHMoKXtyZXR1cm4gT2JqZWN0LmFzc2lnbihEby5nZXREZWZhdWx0cygpLHttdWx0aXBsaWVyOjEsdW5pdHM6XCJoZXJ0elwiLHZhbHVlOjF9KX10aWNrc1RvVGltZSh0LGUpe3JldHVybiB0aGlzLl9wYXJhbS50aWNrc1RvVGltZSh0LGUpfXRpbWVUb1RpY2tzKHQsZSl7cmV0dXJuIHRoaXMuX3BhcmFtLnRpbWVUb1RpY2tzKHQsZSl9Z2V0VGltZU9mVGljayh0KXtyZXR1cm4gdGhpcy5fcGFyYW0uZ2V0VGltZU9mVGljayh0KX1nZXREdXJhdGlvbk9mVGlja3ModCxlKXtyZXR1cm4gdGhpcy5fcGFyYW0uZ2V0RHVyYXRpb25PZlRpY2tzKHQsZSl9Z2V0VGlja3NBdFRpbWUodCl7cmV0dXJuIHRoaXMuX3BhcmFtLmdldFRpY2tzQXRUaW1lKHQpfWdldCBtdWx0aXBsaWVyKCl7cmV0dXJuIHRoaXMuX3BhcmFtLm11bHRpcGxpZXJ9c2V0IG11bHRpcGxpZXIodCl7dGhpcy5fcGFyYW0ubXVsdGlwbGllcj10fWRpc3Bvc2UoKXtyZXR1cm4gc3VwZXIuZGlzcG9zZSgpLHRoaXMuX3BhcmFtLmRpc3Bvc2UoKSx0aGlzfX1jbGFzcyBSbyBleHRlbmRzIHZve2NvbnN0cnVjdG9yKCl7c3VwZXIoRGkoUm8uZ2V0RGVmYXVsdHMoKSxhcmd1bWVudHMsW1wiZnJlcXVlbmN5XCJdKSksdGhpcy5uYW1lPVwiVGlja1NvdXJjZVwiLHRoaXMuX3N0YXRlPW5ldyB5byx0aGlzLl90aWNrT2Zmc2V0PW5ldyBOaTtjb25zdCB0PURpKFJvLmdldERlZmF1bHRzKCksYXJndW1lbnRzLFtcImZyZXF1ZW5jeVwiXSk7dGhpcy5mcmVxdWVuY3k9bmV3IEVvKHtjb250ZXh0OnRoaXMuY29udGV4dCx1bml0czp0LnVuaXRzLHZhbHVlOnQuZnJlcXVlbmN5fSksVWkodGhpcyxcImZyZXF1ZW5jeVwiKSx0aGlzLl9zdGF0ZS5zZXRTdGF0ZUF0VGltZShcInN0b3BwZWRcIiwwKSx0aGlzLnNldFRpY2tzQXRUaW1lKDAsMCl9c3RhdGljIGdldERlZmF1bHRzKCl7cmV0dXJuIE9iamVjdC5hc3NpZ24oe2ZyZXF1ZW5jeToxLHVuaXRzOlwiaGVydHpcIn0sdm8uZ2V0RGVmYXVsdHMoKSl9Z2V0IHN0YXRlKCl7cmV0dXJuIHRoaXMuZ2V0U3RhdGVBdFRpbWUodGhpcy5ub3coKSl9c3RhcnQodCxlKXtjb25zdCBzPXRoaXMudG9TZWNvbmRzKHQpO3JldHVyblwic3RhcnRlZFwiIT09dGhpcy5fc3RhdGUuZ2V0VmFsdWVBdFRpbWUocykmJih0aGlzLl9zdGF0ZS5zZXRTdGF0ZUF0VGltZShcInN0YXJ0ZWRcIixzKSxjaShlKSYmdGhpcy5zZXRUaWNrc0F0VGltZShlLHMpKSx0aGlzfXN0b3AodCl7Y29uc3QgZT10aGlzLnRvU2Vjb25kcyh0KTtpZihcInN0b3BwZWRcIj09PXRoaXMuX3N0YXRlLmdldFZhbHVlQXRUaW1lKGUpKXtjb25zdCB0PXRoaXMuX3N0YXRlLmdldChlKTt0JiZ0LnRpbWU+MCYmKHRoaXMuX3RpY2tPZmZzZXQuY2FuY2VsKHQudGltZSksdGhpcy5fc3RhdGUuY2FuY2VsKHQudGltZSkpfXJldHVybiB0aGlzLl9zdGF0ZS5jYW5jZWwoZSksdGhpcy5fc3RhdGUuc2V0U3RhdGVBdFRpbWUoXCJzdG9wcGVkXCIsZSksdGhpcy5zZXRUaWNrc0F0VGltZSgwLGUpLHRoaXN9cGF1c2UodCl7Y29uc3QgZT10aGlzLnRvU2Vjb25kcyh0KTtyZXR1cm5cInN0YXJ0ZWRcIj09PXRoaXMuX3N0YXRlLmdldFZhbHVlQXRUaW1lKGUpJiZ0aGlzLl9zdGF0ZS5zZXRTdGF0ZUF0VGltZShcInBhdXNlZFwiLGUpLHRoaXN9Y2FuY2VsKHQpe3JldHVybiB0PXRoaXMudG9TZWNvbmRzKHQpLHRoaXMuX3N0YXRlLmNhbmNlbCh0KSx0aGlzLl90aWNrT2Zmc2V0LmNhbmNlbCh0KSx0aGlzfWdldFRpY2tzQXRUaW1lKHQpe2NvbnN0IGU9dGhpcy50b1NlY29uZHModCkscz10aGlzLl9zdGF0ZS5nZXRMYXN0U3RhdGUoXCJzdG9wcGVkXCIsZSksbj17c3RhdGU6XCJwYXVzZWRcIix0aW1lOmV9O3RoaXMuX3N0YXRlLmFkZChuKTtsZXQgaT1zLG89MDtyZXR1cm4gdGhpcy5fc3RhdGUuZm9yRWFjaEJldHdlZW4ocy50aW1lLGUrdGhpcy5zYW1wbGVUaW1lLHQ9PntsZXQgZT1pLnRpbWU7Y29uc3Qgcz10aGlzLl90aWNrT2Zmc2V0LmdldCh0LnRpbWUpO3MmJnMudGltZT49aS50aW1lJiYobz1zLnRpY2tzLGU9cy50aW1lKSxcInN0YXJ0ZWRcIj09PWkuc3RhdGUmJlwic3RhcnRlZFwiIT09dC5zdGF0ZSYmKG8rPXRoaXMuZnJlcXVlbmN5LmdldFRpY2tzQXRUaW1lKHQudGltZSktdGhpcy5mcmVxdWVuY3kuZ2V0VGlja3NBdFRpbWUoZSkpLGk9dH0pLHRoaXMuX3N0YXRlLnJlbW92ZShuKSxvfWdldCB0aWNrcygpe3JldHVybiB0aGlzLmdldFRpY2tzQXRUaW1lKHRoaXMubm93KCkpfXNldCB0aWNrcyh0KXt0aGlzLnNldFRpY2tzQXRUaW1lKHQsdGhpcy5ub3coKSl9Z2V0IHNlY29uZHMoKXtyZXR1cm4gdGhpcy5nZXRTZWNvbmRzQXRUaW1lKHRoaXMubm93KCkpfXNldCBzZWNvbmRzKHQpe2NvbnN0IGU9dGhpcy5ub3coKSxzPXRoaXMuZnJlcXVlbmN5LnRpbWVUb1RpY2tzKHQsZSk7dGhpcy5zZXRUaWNrc0F0VGltZShzLGUpfWdldFNlY29uZHNBdFRpbWUodCl7dD10aGlzLnRvU2Vjb25kcyh0KTtjb25zdCBlPXRoaXMuX3N0YXRlLmdldExhc3RTdGF0ZShcInN0b3BwZWRcIix0KSxzPXtzdGF0ZTpcInBhdXNlZFwiLHRpbWU6dH07dGhpcy5fc3RhdGUuYWRkKHMpO2xldCBuPWUsaT0wO3JldHVybiB0aGlzLl9zdGF0ZS5mb3JFYWNoQmV0d2VlbihlLnRpbWUsdCt0aGlzLnNhbXBsZVRpbWUsdD0+e2xldCBlPW4udGltZTtjb25zdCBzPXRoaXMuX3RpY2tPZmZzZXQuZ2V0KHQudGltZSk7cyYmcy50aW1lPj1uLnRpbWUmJihpPXMuc2Vjb25kcyxlPXMudGltZSksXCJzdGFydGVkXCI9PT1uLnN0YXRlJiZcInN0YXJ0ZWRcIiE9PXQuc3RhdGUmJihpKz10LnRpbWUtZSksbj10fSksdGhpcy5fc3RhdGUucmVtb3ZlKHMpLGl9c2V0VGlja3NBdFRpbWUodCxlKXtyZXR1cm4gZT10aGlzLnRvU2Vjb25kcyhlKSx0aGlzLl90aWNrT2Zmc2V0LmNhbmNlbChlKSx0aGlzLl90aWNrT2Zmc2V0LmFkZCh7c2Vjb25kczp0aGlzLmZyZXF1ZW5jeS5nZXREdXJhdGlvbk9mVGlja3ModCxlKSx0aWNrczp0LHRpbWU6ZX0pLHRoaXN9Z2V0U3RhdGVBdFRpbWUodCl7cmV0dXJuIHQ9dGhpcy50b1NlY29uZHModCksdGhpcy5fc3RhdGUuZ2V0VmFsdWVBdFRpbWUodCl9Z2V0VGltZU9mVGljayh0LGU9dGhpcy5ub3coKSl7Y29uc3Qgcz10aGlzLl90aWNrT2Zmc2V0LmdldChlKSxuPXRoaXMuX3N0YXRlLmdldChlKSxpPU1hdGgubWF4KHMudGltZSxuLnRpbWUpLG89dGhpcy5mcmVxdWVuY3kuZ2V0VGlja3NBdFRpbWUoaSkrdC1zLnRpY2tzO3JldHVybiB0aGlzLmZyZXF1ZW5jeS5nZXRUaW1lT2ZUaWNrKG8pfWZvckVhY2hUaWNrQmV0d2Vlbih0LGUscyl7bGV0IG49dGhpcy5fc3RhdGUuZ2V0KHQpO3RoaXMuX3N0YXRlLmZvckVhY2hCZXR3ZWVuKHQsZSxlPT57biYmXCJzdGFydGVkXCI9PT1uLnN0YXRlJiZcInN0YXJ0ZWRcIiE9PWUuc3RhdGUmJnRoaXMuZm9yRWFjaFRpY2tCZXR3ZWVuKE1hdGgubWF4KG4udGltZSx0KSxlLnRpbWUtdGhpcy5zYW1wbGVUaW1lLHMpLG49ZX0pO2xldCBpPW51bGw7aWYobiYmXCJzdGFydGVkXCI9PT1uLnN0YXRlKXtjb25zdCBvPU1hdGgubWF4KG4udGltZSx0KSxyPXRoaXMuZnJlcXVlbmN5LmdldFRpY2tzQXRUaW1lKG8pLGE9ci10aGlzLmZyZXF1ZW5jeS5nZXRUaWNrc0F0VGltZShuLnRpbWUpO2xldCBjPU1hdGguY2VpbChhKS1hO2M9SWkoYywxKT8wOmM7bGV0IGg9dGhpcy5mcmVxdWVuY3kuZ2V0VGltZU9mVGljayhyK2MpO2Zvcig7aDxlOyl7dHJ5e3MoaCxNYXRoLnJvdW5kKHRoaXMuZ2V0VGlja3NBdFRpbWUoaCkpKX1jYXRjaCh0KXtpPXQ7YnJlYWt9aCs9dGhpcy5mcmVxdWVuY3kuZ2V0RHVyYXRpb25PZlRpY2tzKDEsaCl9fWlmKGkpdGhyb3cgaTtyZXR1cm4gdGhpc31kaXNwb3NlKCl7cmV0dXJuIHN1cGVyLmRpc3Bvc2UoKSx0aGlzLl9zdGF0ZS5kaXNwb3NlKCksdGhpcy5fdGlja09mZnNldC5kaXNwb3NlKCksdGhpcy5mcmVxdWVuY3kuZGlzcG9zZSgpLHRoaXN9fWNsYXNzIHFvIGV4dGVuZHMgdm97Y29uc3RydWN0b3IoKXtzdXBlcihEaShxby5nZXREZWZhdWx0cygpLGFyZ3VtZW50cyxbXCJjYWxsYmFja1wiLFwiZnJlcXVlbmN5XCJdKSksdGhpcy5uYW1lPVwiQ2xvY2tcIix0aGlzLmNhbGxiYWNrPVppLHRoaXMuX2xhc3RVcGRhdGU9MCx0aGlzLl9zdGF0ZT1uZXcgeW8oXCJzdG9wcGVkXCIpLHRoaXMuX2JvdW5kTG9vcD10aGlzLl9sb29wLmJpbmQodGhpcyk7Y29uc3QgdD1EaShxby5nZXREZWZhdWx0cygpLGFyZ3VtZW50cyxbXCJjYWxsYmFja1wiLFwiZnJlcXVlbmN5XCJdKTt0aGlzLmNhbGxiYWNrPXQuY2FsbGJhY2ssdGhpcy5fdGlja1NvdXJjZT1uZXcgUm8oe2NvbnRleHQ6dGhpcy5jb250ZXh0LGZyZXF1ZW5jeTp0LmZyZXF1ZW5jeSx1bml0czp0LnVuaXRzfSksdGhpcy5fbGFzdFVwZGF0ZT0wLHRoaXMuZnJlcXVlbmN5PXRoaXMuX3RpY2tTb3VyY2UuZnJlcXVlbmN5LFVpKHRoaXMsXCJmcmVxdWVuY3lcIiksdGhpcy5fc3RhdGUuc2V0U3RhdGVBdFRpbWUoXCJzdG9wcGVkXCIsMCksdGhpcy5jb250ZXh0Lm9uKFwidGlja1wiLHRoaXMuX2JvdW5kTG9vcCl9c3RhdGljIGdldERlZmF1bHRzKCl7cmV0dXJuIE9iamVjdC5hc3NpZ24odm8uZ2V0RGVmYXVsdHMoKSx7Y2FsbGJhY2s6WmksZnJlcXVlbmN5OjEsdW5pdHM6XCJoZXJ0elwifSl9Z2V0IHN0YXRlKCl7cmV0dXJuIHRoaXMuX3N0YXRlLmdldFZhbHVlQXRUaW1lKHRoaXMubm93KCkpfXN0YXJ0KHQsZSl7c2kodGhpcy5jb250ZXh0KTtjb25zdCBzPXRoaXMudG9TZWNvbmRzKHQpO3JldHVybiB0aGlzLmxvZyhcInN0YXJ0XCIscyksXCJzdGFydGVkXCIhPT10aGlzLl9zdGF0ZS5nZXRWYWx1ZUF0VGltZShzKSYmKHRoaXMuX3N0YXRlLnNldFN0YXRlQXRUaW1lKFwic3RhcnRlZFwiLHMpLHRoaXMuX3RpY2tTb3VyY2Uuc3RhcnQocyxlKSxzPHRoaXMuX2xhc3RVcGRhdGUmJnRoaXMuZW1pdChcInN0YXJ0XCIscyxlKSksdGhpc31zdG9wKHQpe2NvbnN0IGU9dGhpcy50b1NlY29uZHModCk7cmV0dXJuIHRoaXMubG9nKFwic3RvcFwiLGUpLHRoaXMuX3N0YXRlLmNhbmNlbChlKSx0aGlzLl9zdGF0ZS5zZXRTdGF0ZUF0VGltZShcInN0b3BwZWRcIixlKSx0aGlzLl90aWNrU291cmNlLnN0b3AoZSksZTx0aGlzLl9sYXN0VXBkYXRlJiZ0aGlzLmVtaXQoXCJzdG9wXCIsZSksdGhpc31wYXVzZSh0KXtjb25zdCBlPXRoaXMudG9TZWNvbmRzKHQpO3JldHVyblwic3RhcnRlZFwiPT09dGhpcy5fc3RhdGUuZ2V0VmFsdWVBdFRpbWUoZSkmJih0aGlzLl9zdGF0ZS5zZXRTdGF0ZUF0VGltZShcInBhdXNlZFwiLGUpLHRoaXMuX3RpY2tTb3VyY2UucGF1c2UoZSksZTx0aGlzLl9sYXN0VXBkYXRlJiZ0aGlzLmVtaXQoXCJwYXVzZVwiLGUpKSx0aGlzfWdldCB0aWNrcygpe3JldHVybiBNYXRoLmNlaWwodGhpcy5nZXRUaWNrc0F0VGltZSh0aGlzLm5vdygpKSl9c2V0IHRpY2tzKHQpe3RoaXMuX3RpY2tTb3VyY2UudGlja3M9dH1nZXQgc2Vjb25kcygpe3JldHVybiB0aGlzLl90aWNrU291cmNlLnNlY29uZHN9c2V0IHNlY29uZHModCl7dGhpcy5fdGlja1NvdXJjZS5zZWNvbmRzPXR9Z2V0U2Vjb25kc0F0VGltZSh0KXtyZXR1cm4gdGhpcy5fdGlja1NvdXJjZS5nZXRTZWNvbmRzQXRUaW1lKHQpfXNldFRpY2tzQXRUaW1lKHQsZSl7cmV0dXJuIHRoaXMuX3RpY2tTb3VyY2Uuc2V0VGlja3NBdFRpbWUodCxlKSx0aGlzfWdldFRpbWVPZlRpY2sodCxlPXRoaXMubm93KCkpe3JldHVybiB0aGlzLl90aWNrU291cmNlLmdldFRpbWVPZlRpY2sodCxlKX1nZXRUaWNrc0F0VGltZSh0KXtyZXR1cm4gdGhpcy5fdGlja1NvdXJjZS5nZXRUaWNrc0F0VGltZSh0KX1uZXh0VGlja1RpbWUodCxlKXtjb25zdCBzPXRoaXMudG9TZWNvbmRzKGUpLG49dGhpcy5nZXRUaWNrc0F0VGltZShzKTtyZXR1cm4gdGhpcy5fdGlja1NvdXJjZS5nZXRUaW1lT2ZUaWNrKG4rdCxzKX1fbG9vcCgpe2NvbnN0IHQ9dGhpcy5fbGFzdFVwZGF0ZSxlPXRoaXMubm93KCk7dGhpcy5fbGFzdFVwZGF0ZT1lLHRoaXMubG9nKFwibG9vcFwiLHQsZSksdCE9PWUmJih0aGlzLl9zdGF0ZS5mb3JFYWNoQmV0d2Vlbih0LGUsdD0+e3N3aXRjaCh0LnN0YXRlKXtjYXNlXCJzdGFydGVkXCI6Y29uc3QgZT10aGlzLl90aWNrU291cmNlLmdldFRpY2tzQXRUaW1lKHQudGltZSk7dGhpcy5lbWl0KFwic3RhcnRcIix0LnRpbWUsZSk7YnJlYWs7Y2FzZVwic3RvcHBlZFwiOjAhPT10LnRpbWUmJnRoaXMuZW1pdChcInN0b3BcIix0LnRpbWUpO2JyZWFrO2Nhc2VcInBhdXNlZFwiOnRoaXMuZW1pdChcInBhdXNlXCIsdC50aW1lKX19KSx0aGlzLl90aWNrU291cmNlLmZvckVhY2hUaWNrQmV0d2Vlbih0LGUsKHQsZSk9Pnt0aGlzLmNhbGxiYWNrKHQsZSl9KSl9Z2V0U3RhdGVBdFRpbWUodCl7Y29uc3QgZT10aGlzLnRvU2Vjb25kcyh0KTtyZXR1cm4gdGhpcy5fc3RhdGUuZ2V0VmFsdWVBdFRpbWUoZSl9ZGlzcG9zZSgpe3JldHVybiBzdXBlci5kaXNwb3NlKCksdGhpcy5jb250ZXh0Lm9mZihcInRpY2tcIix0aGlzLl9ib3VuZExvb3ApLHRoaXMuX3RpY2tTb3VyY2UuZGlzcG9zZSgpLHRoaXMuX3N0YXRlLmRpc3Bvc2UoKSx0aGlzfX1CaS5taXhpbihxbyk7Y2xhc3MgRm8gZXh0ZW5kcyB3b3tjb25zdHJ1Y3Rvcigpe3N1cGVyKERpKEZvLmdldERlZmF1bHRzKCksYXJndW1lbnRzLFtcImRlbGF5VGltZVwiLFwibWF4RGVsYXlcIl0pKSx0aGlzLm5hbWU9XCJEZWxheVwiO2NvbnN0IHQ9RGkoRm8uZ2V0RGVmYXVsdHMoKSxhcmd1bWVudHMsW1wiZGVsYXlUaW1lXCIsXCJtYXhEZWxheVwiXSksZT10aGlzLnRvU2Vjb25kcyh0Lm1heERlbGF5KTt0aGlzLl9tYXhEZWxheT1NYXRoLm1heChlLHRoaXMudG9TZWNvbmRzKHQuZGVsYXlUaW1lKSksdGhpcy5fZGVsYXlOb2RlPXRoaXMuaW5wdXQ9dGhpcy5vdXRwdXQ9dGhpcy5jb250ZXh0LmNyZWF0ZURlbGF5KGUpLHRoaXMuZGVsYXlUaW1lPW5ldyB4byh7Y29udGV4dDp0aGlzLmNvbnRleHQscGFyYW06dGhpcy5fZGVsYXlOb2RlLmRlbGF5VGltZSx1bml0czpcInRpbWVcIix2YWx1ZTp0LmRlbGF5VGltZSxtaW5WYWx1ZTowLG1heFZhbHVlOnRoaXMubWF4RGVsYXl9KSxVaSh0aGlzLFwiZGVsYXlUaW1lXCIpfXN0YXRpYyBnZXREZWZhdWx0cygpe3JldHVybiBPYmplY3QuYXNzaWduKHdvLmdldERlZmF1bHRzKCkse2RlbGF5VGltZTowLG1heERlbGF5OjF9KX1nZXQgbWF4RGVsYXkoKXtyZXR1cm4gdGhpcy5fbWF4RGVsYXl9ZGlzcG9zZSgpe3JldHVybiBzdXBlci5kaXNwb3NlKCksdGhpcy5fZGVsYXlOb2RlLmRpc2Nvbm5lY3QoKSx0aGlzLmRlbGF5VGltZS5kaXNwb3NlKCksdGhpc319ZnVuY3Rpb24gSW8odCxlLHM9MixuPUppKCkuc2FtcGxlUmF0ZSl7cmV0dXJuIHlpKHRoaXMsdm9pZCAwLHZvaWQgMCwoZnVuY3Rpb24qKCl7Y29uc3QgaT1KaSgpLG89bmV3IFlpKHMsZSxuKTtLaShvKSx5aWVsZCB0KG8pO2NvbnN0IHI9by5yZW5kZXIoKTtLaShpKTtjb25zdCBhPXlpZWxkIHI7cmV0dXJuIG5ldyBYaShhKX0pKX1jbGFzcyBWbyBleHRlbmRzIEVpe2NvbnN0cnVjdG9yKCl7c3VwZXIoKSx0aGlzLm5hbWU9XCJUb25lQXVkaW9CdWZmZXJzXCIsdGhpcy5fYnVmZmVycz1uZXcgTWFwLHRoaXMuX2xvYWRpbmdDb3VudD0wO2NvbnN0IHQ9RGkoVm8uZ2V0RGVmYXVsdHMoKSxhcmd1bWVudHMsW1widXJsc1wiLFwib25sb2FkXCIsXCJiYXNlVXJsXCJdLFwidXJsc1wiKTt0aGlzLmJhc2VVcmw9dC5iYXNlVXJsLE9iamVjdC5rZXlzKHQudXJscykuZm9yRWFjaChlPT57dGhpcy5fbG9hZGluZ0NvdW50Kys7Y29uc3Qgcz10LnVybHNbZV07dGhpcy5hZGQoZSxzLHRoaXMuX2J1ZmZlckxvYWRlZC5iaW5kKHRoaXMsdC5vbmxvYWQpLHQub25lcnJvcil9KX1zdGF0aWMgZ2V0RGVmYXVsdHMoKXtyZXR1cm57YmFzZVVybDpcIlwiLG9uZXJyb3I6Wmksb25sb2FkOlppLHVybHM6e319fWhhcyh0KXtyZXR1cm4gdGhpcy5fYnVmZmVycy5oYXModC50b1N0cmluZygpKX1nZXQodCl7cmV0dXJuIHRpKHRoaXMuaGFzKHQpLFwiVG9uZUF1ZGlvQnVmZmVycyBoYXMgbm8gYnVmZmVyIG5hbWVkOiBcIit0KSx0aGlzLl9idWZmZXJzLmdldCh0LnRvU3RyaW5nKCkpfV9idWZmZXJMb2FkZWQodCl7dGhpcy5fbG9hZGluZ0NvdW50LS0sMD09PXRoaXMuX2xvYWRpbmdDb3VudCYmdCYmdCgpfWdldCBsb2FkZWQoKXtyZXR1cm4gQXJyYXkuZnJvbSh0aGlzLl9idWZmZXJzKS5ldmVyeSgoW3QsZV0pPT5lLmxvYWRlZCl9YWRkKHQsZSxzPVppLG49Wmkpe3JldHVybiBmaShlKT90aGlzLl9idWZmZXJzLnNldCh0LnRvU3RyaW5nKCksbmV3IFhpKHRoaXMuYmFzZVVybCtlLHMsbikpOnRoaXMuX2J1ZmZlcnMuc2V0KHQudG9TdHJpbmcoKSxuZXcgWGkoZSxzLG4pKSx0aGlzfWRpc3Bvc2UoKXtyZXR1cm4gc3VwZXIuZGlzcG9zZSgpLHRoaXMuX2J1ZmZlcnMuZm9yRWFjaCh0PT50LmRpc3Bvc2UoKSksdGhpcy5fYnVmZmVycy5jbGVhcigpLHRoaXN9fWNsYXNzIE5vIGV4dGVuZHMgbG97Y29uc3RydWN0b3IoKXtzdXBlciguLi5hcmd1bWVudHMpLHRoaXMubmFtZT1cIk1pZGlDbGFzc1wiLHRoaXMuZGVmYXVsdFVuaXRzPVwibWlkaVwifV9mcmVxdWVuY3lUb1VuaXRzKHQpe3JldHVybiBvbyhzdXBlci5fZnJlcXVlbmN5VG9Vbml0cyh0KSl9X3RpY2tzVG9Vbml0cyh0KXtyZXR1cm4gb28oc3VwZXIuX3RpY2tzVG9Vbml0cyh0KSl9X2JlYXRzVG9Vbml0cyh0KXtyZXR1cm4gb28oc3VwZXIuX2JlYXRzVG9Vbml0cyh0KSl9X3NlY29uZHNUb1VuaXRzKHQpe3JldHVybiBvbyhzdXBlci5fc2Vjb25kc1RvVW5pdHModCkpfXRvTWlkaSgpe3JldHVybiB0aGlzLnZhbHVlT2YoKX10b0ZyZXF1ZW5jeSgpe3JldHVybiBhbyh0aGlzLnRvTWlkaSgpKX10cmFuc3Bvc2UodCl7cmV0dXJuIG5ldyBObyh0aGlzLmNvbnRleHQsdGhpcy50b01pZGkoKSt0KX19ZnVuY3Rpb24gUG8odCxlKXtyZXR1cm4gbmV3IE5vKEppKCksdCxlKX1jbGFzcyBqbyBleHRlbmRzIG1ve2NvbnN0cnVjdG9yKCl7c3VwZXIoLi4uYXJndW1lbnRzKSx0aGlzLm5hbWU9XCJUaWNrc1wiLHRoaXMuZGVmYXVsdFVuaXRzPVwiaVwifV9ub3coKXtyZXR1cm4gdGhpcy5jb250ZXh0LnRyYW5zcG9ydC50aWNrc31fYmVhdHNUb1VuaXRzKHQpe3JldHVybiB0aGlzLl9nZXRQUFEoKSp0fV9zZWNvbmRzVG9Vbml0cyh0KXtyZXR1cm4gTWF0aC5mbG9vcih0Lyg2MC90aGlzLl9nZXRCcG0oKSkqdGhpcy5fZ2V0UFBRKCkpfV90aWNrc1RvVW5pdHModCl7cmV0dXJuIHR9dG9UaWNrcygpe3JldHVybiB0aGlzLnZhbHVlT2YoKX10b1NlY29uZHMoKXtyZXR1cm4gdGhpcy52YWx1ZU9mKCkvdGhpcy5fZ2V0UFBRKCkqKDYwL3RoaXMuX2dldEJwbSgpKX19ZnVuY3Rpb24gTG8odCxlKXtyZXR1cm4gbmV3IGpvKEppKCksdCxlKX1jbGFzcyB6byBleHRlbmRzIHZve2NvbnN0cnVjdG9yKCl7c3VwZXIoLi4uYXJndW1lbnRzKSx0aGlzLm5hbWU9XCJEcmF3XCIsdGhpcy5leHBpcmF0aW9uPS4yNSx0aGlzLmFudGljaXBhdGlvbj0uMDA4LHRoaXMuX2V2ZW50cz1uZXcgTmksdGhpcy5fYm91bmREcmF3TG9vcD10aGlzLl9kcmF3TG9vcC5iaW5kKHRoaXMpLHRoaXMuX2FuaW1hdGlvbkZyYW1lPS0xfXNjaGVkdWxlKHQsZSl7cmV0dXJuIHRoaXMuX2V2ZW50cy5hZGQoe2NhbGxiYWNrOnQsdGltZTp0aGlzLnRvU2Vjb25kcyhlKX0pLDE9PT10aGlzLl9ldmVudHMubGVuZ3RoJiYodGhpcy5fYW5pbWF0aW9uRnJhbWU9cmVxdWVzdEFuaW1hdGlvbkZyYW1lKHRoaXMuX2JvdW5kRHJhd0xvb3ApKSx0aGlzfWNhbmNlbCh0KXtyZXR1cm4gdGhpcy5fZXZlbnRzLmNhbmNlbCh0aGlzLnRvU2Vjb25kcyh0KSksdGhpc31fZHJhd0xvb3AoKXtjb25zdCB0PXRoaXMuY29udGV4dC5jdXJyZW50VGltZTtmb3IoO3RoaXMuX2V2ZW50cy5sZW5ndGgmJnRoaXMuX2V2ZW50cy5wZWVrKCkudGltZS10aGlzLmFudGljaXBhdGlvbjw9dDspe2NvbnN0IGU9dGhpcy5fZXZlbnRzLnNoaWZ0KCk7ZSYmdC1lLnRpbWU8PXRoaXMuZXhwaXJhdGlvbiYmZS5jYWxsYmFjaygpfXRoaXMuX2V2ZW50cy5sZW5ndGg+MCYmKHRoaXMuX2FuaW1hdGlvbkZyYW1lPXJlcXVlc3RBbmltYXRpb25GcmFtZSh0aGlzLl9ib3VuZERyYXdMb29wKSl9ZGlzcG9zZSgpe3JldHVybiBzdXBlci5kaXNwb3NlKCksdGhpcy5fZXZlbnRzLmRpc3Bvc2UoKSxjYW5jZWxBbmltYXRpb25GcmFtZSh0aGlzLl9hbmltYXRpb25GcmFtZSksdGhpc319amkodD0+e3QuZHJhdz1uZXcgem8oe2NvbnRleHQ6dH0pfSksemkodD0+e3QuZHJhdy5kaXNwb3NlKCl9KTtjbGFzcyBCbyBleHRlbmRzIEVpe2NvbnN0cnVjdG9yKCl7c3VwZXIoLi4uYXJndW1lbnRzKSx0aGlzLm5hbWU9XCJJbnRlcnZhbFRpbWVsaW5lXCIsdGhpcy5fcm9vdD1udWxsLHRoaXMuX2xlbmd0aD0wfWFkZCh0KXt0aShjaSh0LnRpbWUpLFwiRXZlbnRzIG11c3QgaGF2ZSBhIHRpbWUgcHJvcGVydHlcIiksdGkoY2kodC5kdXJhdGlvbiksXCJFdmVudHMgbXVzdCBoYXZlIGEgZHVyYXRpb24gcGFyYW1ldGVyXCIpLHQudGltZT10LnRpbWUudmFsdWVPZigpO2xldCBlPW5ldyBXbyh0LnRpbWUsdC50aW1lK3QuZHVyYXRpb24sdCk7Zm9yKG51bGw9PT10aGlzLl9yb290P3RoaXMuX3Jvb3Q9ZTp0aGlzLl9yb290Lmluc2VydChlKSx0aGlzLl9sZW5ndGgrKztudWxsIT09ZTspZS51cGRhdGVIZWlnaHQoKSxlLnVwZGF0ZU1heCgpLHRoaXMuX3JlYmFsYW5jZShlKSxlPWUucGFyZW50O3JldHVybiB0aGlzfXJlbW92ZSh0KXtpZihudWxsIT09dGhpcy5fcm9vdCl7Y29uc3QgZT1bXTt0aGlzLl9yb290LnNlYXJjaCh0LnRpbWUsZSk7Zm9yKGNvbnN0IHMgb2YgZSlpZihzLmV2ZW50PT09dCl7dGhpcy5fcmVtb3ZlTm9kZShzKSx0aGlzLl9sZW5ndGgtLTticmVha319cmV0dXJuIHRoaXN9Z2V0IGxlbmd0aCgpe3JldHVybiB0aGlzLl9sZW5ndGh9Y2FuY2VsKHQpe3JldHVybiB0aGlzLmZvckVhY2hGcm9tKHQsdD0+dGhpcy5yZW1vdmUodCkpLHRoaXN9X3NldFJvb3QodCl7dGhpcy5fcm9vdD10LG51bGwhPT10aGlzLl9yb290JiYodGhpcy5fcm9vdC5wYXJlbnQ9bnVsbCl9X3JlcGxhY2VOb2RlSW5QYXJlbnQodCxlKXtudWxsIT09dC5wYXJlbnQ/KHQuaXNMZWZ0Q2hpbGQoKT90LnBhcmVudC5sZWZ0PWU6dC5wYXJlbnQucmlnaHQ9ZSx0aGlzLl9yZWJhbGFuY2UodC5wYXJlbnQpKTp0aGlzLl9zZXRSb290KGUpfV9yZW1vdmVOb2RlKHQpe2lmKG51bGw9PT10LmxlZnQmJm51bGw9PT10LnJpZ2h0KXRoaXMuX3JlcGxhY2VOb2RlSW5QYXJlbnQodCxudWxsKTtlbHNlIGlmKG51bGw9PT10LnJpZ2h0KXRoaXMuX3JlcGxhY2VOb2RlSW5QYXJlbnQodCx0LmxlZnQpO2Vsc2UgaWYobnVsbD09PXQubGVmdCl0aGlzLl9yZXBsYWNlTm9kZUluUGFyZW50KHQsdC5yaWdodCk7ZWxzZXtsZXQgZSxzPW51bGw7aWYodC5nZXRCYWxhbmNlKCk+MClpZihudWxsPT09dC5sZWZ0LnJpZ2h0KWU9dC5sZWZ0LGUucmlnaHQ9dC5yaWdodCxzPWU7ZWxzZXtmb3IoZT10LmxlZnQucmlnaHQ7bnVsbCE9PWUucmlnaHQ7KWU9ZS5yaWdodDtlLnBhcmVudCYmKGUucGFyZW50LnJpZ2h0PWUubGVmdCxzPWUucGFyZW50LGUubGVmdD10LmxlZnQsZS5yaWdodD10LnJpZ2h0KX1lbHNlIGlmKG51bGw9PT10LnJpZ2h0LmxlZnQpZT10LnJpZ2h0LGUubGVmdD10LmxlZnQscz1lO2Vsc2V7Zm9yKGU9dC5yaWdodC5sZWZ0O251bGwhPT1lLmxlZnQ7KWU9ZS5sZWZ0O2UucGFyZW50JiYoZS5wYXJlbnQubGVmdD1lLnJpZ2h0LHM9ZS5wYXJlbnQsZS5sZWZ0PXQubGVmdCxlLnJpZ2h0PXQucmlnaHQpfW51bGwhPT10LnBhcmVudD90LmlzTGVmdENoaWxkKCk/dC5wYXJlbnQubGVmdD1lOnQucGFyZW50LnJpZ2h0PWU6dGhpcy5fc2V0Um9vdChlKSxzJiZ0aGlzLl9yZWJhbGFuY2Uocyl9dC5kaXNwb3NlKCl9X3JvdGF0ZUxlZnQodCl7Y29uc3QgZT10LnBhcmVudCxzPXQuaXNMZWZ0Q2hpbGQoKSxuPXQucmlnaHQ7biYmKHQucmlnaHQ9bi5sZWZ0LG4ubGVmdD10KSxudWxsIT09ZT9zP2UubGVmdD1uOmUucmlnaHQ9bjp0aGlzLl9zZXRSb290KG4pfV9yb3RhdGVSaWdodCh0KXtjb25zdCBlPXQucGFyZW50LHM9dC5pc0xlZnRDaGlsZCgpLG49dC5sZWZ0O24mJih0LmxlZnQ9bi5yaWdodCxuLnJpZ2h0PXQpLG51bGwhPT1lP3M/ZS5sZWZ0PW46ZS5yaWdodD1uOnRoaXMuX3NldFJvb3Qobil9X3JlYmFsYW5jZSh0KXtjb25zdCBlPXQuZ2V0QmFsYW5jZSgpO2U+MSYmdC5sZWZ0P3QubGVmdC5nZXRCYWxhbmNlKCk8MD90aGlzLl9yb3RhdGVMZWZ0KHQubGVmdCk6dGhpcy5fcm90YXRlUmlnaHQodCk6ZTwtMSYmdC5yaWdodCYmKHQucmlnaHQuZ2V0QmFsYW5jZSgpPjA/dGhpcy5fcm90YXRlUmlnaHQodC5yaWdodCk6dGhpcy5fcm90YXRlTGVmdCh0KSl9Z2V0KHQpe2lmKG51bGwhPT10aGlzLl9yb290KXtjb25zdCBlPVtdO2lmKHRoaXMuX3Jvb3Quc2VhcmNoKHQsZSksZS5sZW5ndGg+MCl7bGV0IHQ9ZVswXTtmb3IobGV0IHM9MTtzPGUubGVuZ3RoO3MrKyllW3NdLmxvdz50LmxvdyYmKHQ9ZVtzXSk7cmV0dXJuIHQuZXZlbnR9fXJldHVybiBudWxsfWZvckVhY2godCl7aWYobnVsbCE9PXRoaXMuX3Jvb3Qpe2NvbnN0IGU9W107dGhpcy5fcm9vdC50cmF2ZXJzZSh0PT5lLnB1c2godCkpLGUuZm9yRWFjaChlPT57ZS5ldmVudCYmdChlLmV2ZW50KX0pfXJldHVybiB0aGlzfWZvckVhY2hBdFRpbWUodCxlKXtpZihudWxsIT09dGhpcy5fcm9vdCl7Y29uc3Qgcz1bXTt0aGlzLl9yb290LnNlYXJjaCh0LHMpLHMuZm9yRWFjaCh0PT57dC5ldmVudCYmZSh0LmV2ZW50KX0pfXJldHVybiB0aGlzfWZvckVhY2hGcm9tKHQsZSl7aWYobnVsbCE9PXRoaXMuX3Jvb3Qpe2NvbnN0IHM9W107dGhpcy5fcm9vdC5zZWFyY2hBZnRlcih0LHMpLHMuZm9yRWFjaCh0PT57dC5ldmVudCYmZSh0LmV2ZW50KX0pfXJldHVybiB0aGlzfWRpc3Bvc2UoKXtyZXR1cm4gc3VwZXIuZGlzcG9zZSgpLG51bGwhPT10aGlzLl9yb290JiZ0aGlzLl9yb290LnRyYXZlcnNlKHQ9PnQuZGlzcG9zZSgpKSx0aGlzLl9yb290PW51bGwsdGhpc319Y2xhc3MgV297Y29uc3RydWN0b3IodCxlLHMpe3RoaXMuX2xlZnQ9bnVsbCx0aGlzLl9yaWdodD1udWxsLHRoaXMucGFyZW50PW51bGwsdGhpcy5oZWlnaHQ9MCx0aGlzLmV2ZW50PXMsdGhpcy5sb3c9dCx0aGlzLmhpZ2g9ZSx0aGlzLm1heD10aGlzLmhpZ2h9aW5zZXJ0KHQpe3QubG93PD10aGlzLmxvdz9udWxsPT09dGhpcy5sZWZ0P3RoaXMubGVmdD10OnRoaXMubGVmdC5pbnNlcnQodCk6bnVsbD09PXRoaXMucmlnaHQ/dGhpcy5yaWdodD10OnRoaXMucmlnaHQuaW5zZXJ0KHQpfXNlYXJjaCh0LGUpe3Q+dGhpcy5tYXh8fChudWxsIT09dGhpcy5sZWZ0JiZ0aGlzLmxlZnQuc2VhcmNoKHQsZSksdGhpcy5sb3c8PXQmJnRoaXMuaGlnaD50JiZlLnB1c2godGhpcyksdGhpcy5sb3c+dHx8bnVsbCE9PXRoaXMucmlnaHQmJnRoaXMucmlnaHQuc2VhcmNoKHQsZSkpfXNlYXJjaEFmdGVyKHQsZSl7dGhpcy5sb3c+PXQmJihlLnB1c2godGhpcyksbnVsbCE9PXRoaXMubGVmdCYmdGhpcy5sZWZ0LnNlYXJjaEFmdGVyKHQsZSkpLG51bGwhPT10aGlzLnJpZ2h0JiZ0aGlzLnJpZ2h0LnNlYXJjaEFmdGVyKHQsZSl9dHJhdmVyc2UodCl7dCh0aGlzKSxudWxsIT09dGhpcy5sZWZ0JiZ0aGlzLmxlZnQudHJhdmVyc2UodCksbnVsbCE9PXRoaXMucmlnaHQmJnRoaXMucmlnaHQudHJhdmVyc2UodCl9dXBkYXRlSGVpZ2h0KCl7bnVsbCE9PXRoaXMubGVmdCYmbnVsbCE9PXRoaXMucmlnaHQ/dGhpcy5oZWlnaHQ9TWF0aC5tYXgodGhpcy5sZWZ0LmhlaWdodCx0aGlzLnJpZ2h0LmhlaWdodCkrMTpudWxsIT09dGhpcy5yaWdodD90aGlzLmhlaWdodD10aGlzLnJpZ2h0LmhlaWdodCsxOm51bGwhPT10aGlzLmxlZnQ/dGhpcy5oZWlnaHQ9dGhpcy5sZWZ0LmhlaWdodCsxOnRoaXMuaGVpZ2h0PTB9dXBkYXRlTWF4KCl7dGhpcy5tYXg9dGhpcy5oaWdoLG51bGwhPT10aGlzLmxlZnQmJih0aGlzLm1heD1NYXRoLm1heCh0aGlzLm1heCx0aGlzLmxlZnQubWF4KSksbnVsbCE9PXRoaXMucmlnaHQmJih0aGlzLm1heD1NYXRoLm1heCh0aGlzLm1heCx0aGlzLnJpZ2h0Lm1heCkpfWdldEJhbGFuY2UoKXtsZXQgdD0wO3JldHVybiBudWxsIT09dGhpcy5sZWZ0JiZudWxsIT09dGhpcy5yaWdodD90PXRoaXMubGVmdC5oZWlnaHQtdGhpcy5yaWdodC5oZWlnaHQ6bnVsbCE9PXRoaXMubGVmdD90PXRoaXMubGVmdC5oZWlnaHQrMTpudWxsIT09dGhpcy5yaWdodCYmKHQ9LSh0aGlzLnJpZ2h0LmhlaWdodCsxKSksdH1pc0xlZnRDaGlsZCgpe3JldHVybiBudWxsIT09dGhpcy5wYXJlbnQmJnRoaXMucGFyZW50LmxlZnQ9PT10aGlzfWdldCBsZWZ0KCl7cmV0dXJuIHRoaXMuX2xlZnR9c2V0IGxlZnQodCl7dGhpcy5fbGVmdD10LG51bGwhPT10JiYodC5wYXJlbnQ9dGhpcyksdGhpcy51cGRhdGVIZWlnaHQoKSx0aGlzLnVwZGF0ZU1heCgpfWdldCByaWdodCgpe3JldHVybiB0aGlzLl9yaWdodH1zZXQgcmlnaHQodCl7dGhpcy5fcmlnaHQ9dCxudWxsIT09dCYmKHQucGFyZW50PXRoaXMpLHRoaXMudXBkYXRlSGVpZ2h0KCksdGhpcy51cGRhdGVNYXgoKX1kaXNwb3NlKCl7dGhpcy5wYXJlbnQ9bnVsbCx0aGlzLl9sZWZ0PW51bGwsdGhpcy5fcmlnaHQ9bnVsbCx0aGlzLmV2ZW50PW51bGx9fWNsYXNzIEdvIGV4dGVuZHMgd297Y29uc3RydWN0b3IoKXtzdXBlcihEaShHby5nZXREZWZhdWx0cygpLGFyZ3VtZW50cyxbXCJ2b2x1bWVcIl0pKSx0aGlzLm5hbWU9XCJWb2x1bWVcIjtjb25zdCB0PURpKEdvLmdldERlZmF1bHRzKCksYXJndW1lbnRzLFtcInZvbHVtZVwiXSk7dGhpcy5pbnB1dD10aGlzLm91dHB1dD1uZXcga28oe2NvbnRleHQ6dGhpcy5jb250ZXh0LGdhaW46dC52b2x1bWUsdW5pdHM6XCJkZWNpYmVsc1wifSksdGhpcy52b2x1bWU9dGhpcy5vdXRwdXQuZ2FpbixVaSh0aGlzLFwidm9sdW1lXCIpLHRoaXMuX3VubXV0ZWRWb2x1bWU9dC52b2x1bWUsdGhpcy5tdXRlPXQubXV0ZX1zdGF0aWMgZ2V0RGVmYXVsdHMoKXtyZXR1cm4gT2JqZWN0LmFzc2lnbih3by5nZXREZWZhdWx0cygpLHttdXRlOiExLHZvbHVtZTowfSl9Z2V0IG11dGUoKXtyZXR1cm4gdGhpcy52b2x1bWUudmFsdWU9PT0tMS8wfXNldCBtdXRlKHQpeyF0aGlzLm11dGUmJnQ/KHRoaXMuX3VubXV0ZWRWb2x1bWU9dGhpcy52b2x1bWUudmFsdWUsdGhpcy52b2x1bWUudmFsdWU9LTEvMCk6dGhpcy5tdXRlJiYhdCYmKHRoaXMudm9sdW1lLnZhbHVlPXRoaXMuX3VubXV0ZWRWb2x1bWUpfWRpc3Bvc2UoKXtyZXR1cm4gc3VwZXIuZGlzcG9zZSgpLHRoaXMuaW5wdXQuZGlzcG9zZSgpLHRoaXMudm9sdW1lLmRpc3Bvc2UoKSx0aGlzfX1jbGFzcyBVbyBleHRlbmRzIHdve2NvbnN0cnVjdG9yKCl7c3VwZXIoRGkoVW8uZ2V0RGVmYXVsdHMoKSxhcmd1bWVudHMpKSx0aGlzLm5hbWU9XCJEZXN0aW5hdGlvblwiLHRoaXMuaW5wdXQ9bmV3IEdvKHtjb250ZXh0OnRoaXMuY29udGV4dH0pLHRoaXMub3V0cHV0PW5ldyBrbyh7Y29udGV4dDp0aGlzLmNvbnRleHR9KSx0aGlzLnZvbHVtZT10aGlzLmlucHV0LnZvbHVtZTtjb25zdCB0PURpKFVvLmdldERlZmF1bHRzKCksYXJndW1lbnRzKTtibyh0aGlzLmlucHV0LHRoaXMub3V0cHV0LHRoaXMuY29udGV4dC5yYXdDb250ZXh0LmRlc3RpbmF0aW9uKSx0aGlzLm11dGU9dC5tdXRlLHRoaXMuX2ludGVybmFsQ2hhbm5lbHM9W3RoaXMuaW5wdXQsdGhpcy5jb250ZXh0LnJhd0NvbnRleHQuZGVzdGluYXRpb24sdGhpcy5vdXRwdXRdfXN0YXRpYyBnZXREZWZhdWx0cygpe3JldHVybiBPYmplY3QuYXNzaWduKHdvLmdldERlZmF1bHRzKCkse211dGU6ITEsdm9sdW1lOjB9KX1nZXQgbXV0ZSgpe3JldHVybiB0aGlzLmlucHV0Lm11dGV9c2V0IG11dGUodCl7dGhpcy5pbnB1dC5tdXRlPXR9Y2hhaW4oLi4udCl7cmV0dXJuIHRoaXMuaW5wdXQuZGlzY29ubmVjdCgpLHQudW5zaGlmdCh0aGlzLmlucHV0KSx0LnB1c2godGhpcy5vdXRwdXQpLGJvKC4uLnQpLHRoaXN9Z2V0IG1heENoYW5uZWxDb3VudCgpe3JldHVybiB0aGlzLmNvbnRleHQucmF3Q29udGV4dC5kZXN0aW5hdGlvbi5tYXhDaGFubmVsQ291bnR9ZGlzcG9zZSgpe3JldHVybiBzdXBlci5kaXNwb3NlKCksdGhpcy52b2x1bWUuZGlzcG9zZSgpLHRoaXN9fWppKHQ9Pnt0LmRlc3RpbmF0aW9uPW5ldyBVbyh7Y29udGV4dDp0fSl9KSx6aSh0PT57dC5kZXN0aW5hdGlvbi5kaXNwb3NlKCl9KTtjbGFzcyBRbyBleHRlbmRzIEVpe2NvbnN0cnVjdG9yKHQpe3N1cGVyKCksdGhpcy5uYW1lPVwiVGltZWxpbmVWYWx1ZVwiLHRoaXMuX3RpbWVsaW5lPW5ldyBOaSh7bWVtb3J5OjEwfSksdGhpcy5faW5pdGlhbFZhbHVlPXR9c2V0KHQsZSl7cmV0dXJuIHRoaXMuX3RpbWVsaW5lLmFkZCh7dmFsdWU6dCx0aW1lOmV9KSx0aGlzfWdldCh0KXtjb25zdCBlPXRoaXMuX3RpbWVsaW5lLmdldCh0KTtyZXR1cm4gZT9lLnZhbHVlOnRoaXMuX2luaXRpYWxWYWx1ZX19Y2xhc3MgWm97Y29uc3RydWN0b3IodCxlKXt0aGlzLmlkPVpvLl9ldmVudElkKys7Y29uc3Qgcz1PYmplY3QuYXNzaWduKFpvLmdldERlZmF1bHRzKCksZSk7dGhpcy50cmFuc3BvcnQ9dCx0aGlzLmNhbGxiYWNrPXMuY2FsbGJhY2ssdGhpcy5fb25jZT1zLm9uY2UsdGhpcy50aW1lPXMudGltZX1zdGF0aWMgZ2V0RGVmYXVsdHMoKXtyZXR1cm57Y2FsbGJhY2s6Wmksb25jZTohMSx0aW1lOjB9fWludm9rZSh0KXt0aGlzLmNhbGxiYWNrJiYodGhpcy5jYWxsYmFjayh0KSx0aGlzLl9vbmNlJiZ0aGlzLnRyYW5zcG9ydC5jbGVhcih0aGlzLmlkKSl9ZGlzcG9zZSgpe3JldHVybiB0aGlzLmNhbGxiYWNrPXZvaWQgMCx0aGlzfX1aby5fZXZlbnRJZD0wO2NsYXNzIFhvIGV4dGVuZHMgWm97Y29uc3RydWN0b3IodCxlKXtzdXBlcih0LGUpLHRoaXMuX2N1cnJlbnRJZD0tMSx0aGlzLl9uZXh0SWQ9LTEsdGhpcy5fbmV4dFRpY2s9dGhpcy50aW1lLHRoaXMuX2JvdW5kUmVzdGFydD10aGlzLl9yZXN0YXJ0LmJpbmQodGhpcyk7Y29uc3Qgcz1PYmplY3QuYXNzaWduKFhvLmdldERlZmF1bHRzKCksZSk7dGhpcy5kdXJhdGlvbj1uZXcgam8odC5jb250ZXh0LHMuZHVyYXRpb24pLnZhbHVlT2YoKSx0aGlzLl9pbnRlcnZhbD1uZXcgam8odC5jb250ZXh0LHMuaW50ZXJ2YWwpLnZhbHVlT2YoKSx0aGlzLl9uZXh0VGljaz1zLnRpbWUsdGhpcy50cmFuc3BvcnQub24oXCJzdGFydFwiLHRoaXMuX2JvdW5kUmVzdGFydCksdGhpcy50cmFuc3BvcnQub24oXCJsb29wU3RhcnRcIix0aGlzLl9ib3VuZFJlc3RhcnQpLHRoaXMuY29udGV4dD10aGlzLnRyYW5zcG9ydC5jb250ZXh0LHRoaXMuX3Jlc3RhcnQoKX1zdGF0aWMgZ2V0RGVmYXVsdHMoKXtyZXR1cm4gT2JqZWN0LmFzc2lnbih7fSxaby5nZXREZWZhdWx0cygpLHtkdXJhdGlvbjoxLzAsaW50ZXJ2YWw6MSxvbmNlOiExfSl9aW52b2tlKHQpe3RoaXMuX2NyZWF0ZUV2ZW50cyh0KSxzdXBlci5pbnZva2UodCl9X2NyZWF0ZUV2ZW50cyh0KXtjb25zdCBlPXRoaXMudHJhbnNwb3J0LmdldFRpY2tzQXRUaW1lKHQpO2U+PXRoaXMudGltZSYmZT49dGhpcy5fbmV4dFRpY2smJnRoaXMuX25leHRUaWNrK3RoaXMuX2ludGVydmFsPHRoaXMudGltZSt0aGlzLmR1cmF0aW9uJiYodGhpcy5fbmV4dFRpY2srPXRoaXMuX2ludGVydmFsLHRoaXMuX2N1cnJlbnRJZD10aGlzLl9uZXh0SWQsdGhpcy5fbmV4dElkPXRoaXMudHJhbnNwb3J0LnNjaGVkdWxlT25jZSh0aGlzLmludm9rZS5iaW5kKHRoaXMpLG5ldyBqbyh0aGlzLmNvbnRleHQsdGhpcy5fbmV4dFRpY2spLnRvU2Vjb25kcygpKSl9X3Jlc3RhcnQodCl7dGhpcy50cmFuc3BvcnQuY2xlYXIodGhpcy5fY3VycmVudElkKSx0aGlzLnRyYW5zcG9ydC5jbGVhcih0aGlzLl9uZXh0SWQpLHRoaXMuX25leHRUaWNrPXRoaXMudGltZTtjb25zdCBlPXRoaXMudHJhbnNwb3J0LmdldFRpY2tzQXRUaW1lKHQpO2U+dGhpcy50aW1lJiYodGhpcy5fbmV4dFRpY2s9dGhpcy50aW1lK01hdGguY2VpbCgoZS10aGlzLnRpbWUpL3RoaXMuX2ludGVydmFsKSp0aGlzLl9pbnRlcnZhbCksdGhpcy5fY3VycmVudElkPXRoaXMudHJhbnNwb3J0LnNjaGVkdWxlT25jZSh0aGlzLmludm9rZS5iaW5kKHRoaXMpLG5ldyBqbyh0aGlzLmNvbnRleHQsdGhpcy5fbmV4dFRpY2spLnRvU2Vjb25kcygpKSx0aGlzLl9uZXh0VGljays9dGhpcy5faW50ZXJ2YWwsdGhpcy5fbmV4dElkPXRoaXMudHJhbnNwb3J0LnNjaGVkdWxlT25jZSh0aGlzLmludm9rZS5iaW5kKHRoaXMpLG5ldyBqbyh0aGlzLmNvbnRleHQsdGhpcy5fbmV4dFRpY2spLnRvU2Vjb25kcygpKX1kaXNwb3NlKCl7cmV0dXJuIHN1cGVyLmRpc3Bvc2UoKSx0aGlzLnRyYW5zcG9ydC5jbGVhcih0aGlzLl9jdXJyZW50SWQpLHRoaXMudHJhbnNwb3J0LmNsZWFyKHRoaXMuX25leHRJZCksdGhpcy50cmFuc3BvcnQub2ZmKFwic3RhcnRcIix0aGlzLl9ib3VuZFJlc3RhcnQpLHRoaXMudHJhbnNwb3J0Lm9mZihcImxvb3BTdGFydFwiLHRoaXMuX2JvdW5kUmVzdGFydCksdGhpc319Y2xhc3MgWW8gZXh0ZW5kcyB2b3tjb25zdHJ1Y3Rvcigpe3N1cGVyKERpKFlvLmdldERlZmF1bHRzKCksYXJndW1lbnRzKSksdGhpcy5uYW1lPVwiVHJhbnNwb3J0XCIsdGhpcy5fbG9vcD1uZXcgUW8oITEpLHRoaXMuX2xvb3BTdGFydD0wLHRoaXMuX2xvb3BFbmQ9MCx0aGlzLl9zY2hlZHVsZWRFdmVudHM9e30sdGhpcy5fdGltZWxpbmU9bmV3IE5pLHRoaXMuX3JlcGVhdGVkRXZlbnRzPW5ldyBCbyx0aGlzLl9zeW5jZWRTaWduYWxzPVtdLHRoaXMuX3N3aW5nQW1vdW50PTA7Y29uc3QgdD1EaShZby5nZXREZWZhdWx0cygpLGFyZ3VtZW50cyk7dGhpcy5fcHBxPXQucHBxLHRoaXMuX2Nsb2NrPW5ldyBxbyh7Y2FsbGJhY2s6dGhpcy5fcHJvY2Vzc1RpY2suYmluZCh0aGlzKSxjb250ZXh0OnRoaXMuY29udGV4dCxmcmVxdWVuY3k6MCx1bml0czpcImJwbVwifSksdGhpcy5fYmluZENsb2NrRXZlbnRzKCksdGhpcy5icG09dGhpcy5fY2xvY2suZnJlcXVlbmN5LHRoaXMuX2Nsb2NrLmZyZXF1ZW5jeS5tdWx0aXBsaWVyPXQucHBxLHRoaXMuYnBtLnNldFZhbHVlQXRUaW1lKHQuYnBtLDApLFVpKHRoaXMsXCJicG1cIiksdGhpcy5fdGltZVNpZ25hdHVyZT10LnRpbWVTaWduYXR1cmUsdGhpcy5fc3dpbmdUaWNrcz10LnBwcS8yfXN0YXRpYyBnZXREZWZhdWx0cygpe3JldHVybiBPYmplY3QuYXNzaWduKHZvLmdldERlZmF1bHRzKCkse2JwbToxMjAsbG9vcEVuZDpcIjRtXCIsbG9vcFN0YXJ0OjAscHBxOjE5Mixzd2luZzowLHN3aW5nU3ViZGl2aXNpb246XCI4blwiLHRpbWVTaWduYXR1cmU6NH0pfV9wcm9jZXNzVGljayh0LGUpe2lmKHRoaXMuX2xvb3AuZ2V0KHQpJiZlPj10aGlzLl9sb29wRW5kJiYodGhpcy5lbWl0KFwibG9vcEVuZFwiLHQpLHRoaXMuX2Nsb2NrLnNldFRpY2tzQXRUaW1lKHRoaXMuX2xvb3BTdGFydCx0KSxlPXRoaXMuX2xvb3BTdGFydCx0aGlzLmVtaXQoXCJsb29wU3RhcnRcIix0LHRoaXMuX2Nsb2NrLmdldFNlY29uZHNBdFRpbWUodCkpLHRoaXMuZW1pdChcImxvb3BcIix0KSksdGhpcy5fc3dpbmdBbW91bnQ+MCYmZSV0aGlzLl9wcHEhPTAmJmUlKDIqdGhpcy5fc3dpbmdUaWNrcykhPTApe2NvbnN0IHM9ZSUoMip0aGlzLl9zd2luZ1RpY2tzKS8oMip0aGlzLl9zd2luZ1RpY2tzKSxuPU1hdGguc2luKHMqTWF0aC5QSSkqdGhpcy5fc3dpbmdBbW91bnQ7dCs9bmV3IGpvKHRoaXMuY29udGV4dCwyKnRoaXMuX3N3aW5nVGlja3MvMykudG9TZWNvbmRzKCkqbn10aGlzLl90aW1lbGluZS5mb3JFYWNoQXRUaW1lKGUsZT0+ZS5pbnZva2UodCkpfXNjaGVkdWxlKHQsZSl7Y29uc3Qgcz1uZXcgWm8odGhpcyx7Y2FsbGJhY2s6dCx0aW1lOm5ldyBtbyh0aGlzLmNvbnRleHQsZSkudG9UaWNrcygpfSk7cmV0dXJuIHRoaXMuX2FkZEV2ZW50KHMsdGhpcy5fdGltZWxpbmUpfXNjaGVkdWxlUmVwZWF0KHQsZSxzLG49MS8wKXtjb25zdCBpPW5ldyBYbyh0aGlzLHtjYWxsYmFjazp0LGR1cmF0aW9uOm5ldyBobyh0aGlzLmNvbnRleHQsbikudG9UaWNrcygpLGludGVydmFsOm5ldyBobyh0aGlzLmNvbnRleHQsZSkudG9UaWNrcygpLHRpbWU6bmV3IG1vKHRoaXMuY29udGV4dCxzKS50b1RpY2tzKCl9KTtyZXR1cm4gdGhpcy5fYWRkRXZlbnQoaSx0aGlzLl9yZXBlYXRlZEV2ZW50cyl9c2NoZWR1bGVPbmNlKHQsZSl7Y29uc3Qgcz1uZXcgWm8odGhpcyx7Y2FsbGJhY2s6dCxvbmNlOiEwLHRpbWU6bmV3IG1vKHRoaXMuY29udGV4dCxlKS50b1RpY2tzKCl9KTtyZXR1cm4gdGhpcy5fYWRkRXZlbnQocyx0aGlzLl90aW1lbGluZSl9Y2xlYXIodCl7aWYodGhpcy5fc2NoZWR1bGVkRXZlbnRzLmhhc093blByb3BlcnR5KHQpKXtjb25zdCBlPXRoaXMuX3NjaGVkdWxlZEV2ZW50c1t0LnRvU3RyaW5nKCldO2UudGltZWxpbmUucmVtb3ZlKGUuZXZlbnQpLGUuZXZlbnQuZGlzcG9zZSgpLGRlbGV0ZSB0aGlzLl9zY2hlZHVsZWRFdmVudHNbdC50b1N0cmluZygpXX1yZXR1cm4gdGhpc31fYWRkRXZlbnQodCxlKXtyZXR1cm4gdGhpcy5fc2NoZWR1bGVkRXZlbnRzW3QuaWQudG9TdHJpbmcoKV09e2V2ZW50OnQsdGltZWxpbmU6ZX0sZS5hZGQodCksdC5pZH1jYW5jZWwodD0wKXtjb25zdCBlPXRoaXMudG9UaWNrcyh0KTtyZXR1cm4gdGhpcy5fdGltZWxpbmUuZm9yRWFjaEZyb20oZSx0PT50aGlzLmNsZWFyKHQuaWQpKSx0aGlzLl9yZXBlYXRlZEV2ZW50cy5mb3JFYWNoRnJvbShlLHQ9PnRoaXMuY2xlYXIodC5pZCkpLHRoaXN9X2JpbmRDbG9ja0V2ZW50cygpe3RoaXMuX2Nsb2NrLm9uKFwic3RhcnRcIiwodCxlKT0+e2U9bmV3IGpvKHRoaXMuY29udGV4dCxlKS50b1NlY29uZHMoKSx0aGlzLmVtaXQoXCJzdGFydFwiLHQsZSl9KSx0aGlzLl9jbG9jay5vbihcInN0b3BcIix0PT57dGhpcy5lbWl0KFwic3RvcFwiLHQpfSksdGhpcy5fY2xvY2sub24oXCJwYXVzZVwiLHQ9Pnt0aGlzLmVtaXQoXCJwYXVzZVwiLHQpfSl9Z2V0IHN0YXRlKCl7cmV0dXJuIHRoaXMuX2Nsb2NrLmdldFN0YXRlQXRUaW1lKHRoaXMubm93KCkpfXN0YXJ0KHQsZSl7bGV0IHM7cmV0dXJuIGNpKGUpJiYocz10aGlzLnRvVGlja3MoZSkpLHRoaXMuX2Nsb2NrLnN0YXJ0KHQscyksdGhpc31zdG9wKHQpe3JldHVybiB0aGlzLl9jbG9jay5zdG9wKHQpLHRoaXN9cGF1c2UodCl7cmV0dXJuIHRoaXMuX2Nsb2NrLnBhdXNlKHQpLHRoaXN9dG9nZ2xlKHQpe3JldHVybiB0PXRoaXMudG9TZWNvbmRzKHQpLFwic3RhcnRlZFwiIT09dGhpcy5fY2xvY2suZ2V0U3RhdGVBdFRpbWUodCk/dGhpcy5zdGFydCh0KTp0aGlzLnN0b3AodCksdGhpc31nZXQgdGltZVNpZ25hdHVyZSgpe3JldHVybiB0aGlzLl90aW1lU2lnbmF0dXJlfXNldCB0aW1lU2lnbmF0dXJlKHQpe2RpKHQpJiYodD10WzBdL3RbMV0qNCksdGhpcy5fdGltZVNpZ25hdHVyZT10fWdldCBsb29wU3RhcnQoKXtyZXR1cm4gbmV3IGhvKHRoaXMuY29udGV4dCx0aGlzLl9sb29wU3RhcnQsXCJpXCIpLnRvU2Vjb25kcygpfXNldCBsb29wU3RhcnQodCl7dGhpcy5fbG9vcFN0YXJ0PXRoaXMudG9UaWNrcyh0KX1nZXQgbG9vcEVuZCgpe3JldHVybiBuZXcgaG8odGhpcy5jb250ZXh0LHRoaXMuX2xvb3BFbmQsXCJpXCIpLnRvU2Vjb25kcygpfXNldCBsb29wRW5kKHQpe3RoaXMuX2xvb3BFbmQ9dGhpcy50b1RpY2tzKHQpfWdldCBsb29wKCl7cmV0dXJuIHRoaXMuX2xvb3AuZ2V0KHRoaXMubm93KCkpfXNldCBsb29wKHQpe3RoaXMuX2xvb3Auc2V0KHQsdGhpcy5ub3coKSl9c2V0TG9vcFBvaW50cyh0LGUpe3JldHVybiB0aGlzLmxvb3BTdGFydD10LHRoaXMubG9vcEVuZD1lLHRoaXN9Z2V0IHN3aW5nKCl7cmV0dXJuIHRoaXMuX3N3aW5nQW1vdW50fXNldCBzd2luZyh0KXt0aGlzLl9zd2luZ0Ftb3VudD10fWdldCBzd2luZ1N1YmRpdmlzaW9uKCl7cmV0dXJuIG5ldyBqbyh0aGlzLmNvbnRleHQsdGhpcy5fc3dpbmdUaWNrcykudG9Ob3RhdGlvbigpfXNldCBzd2luZ1N1YmRpdmlzaW9uKHQpe3RoaXMuX3N3aW5nVGlja3M9dGhpcy50b1RpY2tzKHQpfWdldCBwb3NpdGlvbigpe2NvbnN0IHQ9dGhpcy5ub3coKSxlPXRoaXMuX2Nsb2NrLmdldFRpY2tzQXRUaW1lKHQpO3JldHVybiBuZXcgam8odGhpcy5jb250ZXh0LGUpLnRvQmFyc0JlYXRzU2l4dGVlbnRocygpfXNldCBwb3NpdGlvbih0KXtjb25zdCBlPXRoaXMudG9UaWNrcyh0KTt0aGlzLnRpY2tzPWV9Z2V0IHNlY29uZHMoKXtyZXR1cm4gdGhpcy5fY2xvY2suc2Vjb25kc31zZXQgc2Vjb25kcyh0KXtjb25zdCBlPXRoaXMubm93KCkscz10aGlzLl9jbG9jay5mcmVxdWVuY3kudGltZVRvVGlja3ModCxlKTt0aGlzLnRpY2tzPXN9Z2V0IHByb2dyZXNzKCl7aWYodGhpcy5sb29wKXtjb25zdCB0PXRoaXMubm93KCk7cmV0dXJuKHRoaXMuX2Nsb2NrLmdldFRpY2tzQXRUaW1lKHQpLXRoaXMuX2xvb3BTdGFydCkvKHRoaXMuX2xvb3BFbmQtdGhpcy5fbG9vcFN0YXJ0KX1yZXR1cm4gMH1nZXQgdGlja3MoKXtyZXR1cm4gdGhpcy5fY2xvY2sudGlja3N9c2V0IHRpY2tzKHQpe2lmKHRoaXMuX2Nsb2NrLnRpY2tzIT09dCl7Y29uc3QgZT10aGlzLm5vdygpO2lmKFwic3RhcnRlZFwiPT09dGhpcy5zdGF0ZSl7Y29uc3Qgcz10aGlzLl9jbG9jay5nZXRUaWNrc0F0VGltZShlKSxuPWUrdGhpcy5fY2xvY2suZnJlcXVlbmN5LmdldER1cmF0aW9uT2ZUaWNrcyhNYXRoLmNlaWwocyktcyxlKTt0aGlzLmVtaXQoXCJzdG9wXCIsbiksdGhpcy5fY2xvY2suc2V0VGlja3NBdFRpbWUodCxuKSx0aGlzLmVtaXQoXCJzdGFydFwiLG4sdGhpcy5fY2xvY2suZ2V0U2Vjb25kc0F0VGltZShuKSl9ZWxzZSB0aGlzLl9jbG9jay5zZXRUaWNrc0F0VGltZSh0LGUpfX1nZXRUaWNrc0F0VGltZSh0KXtyZXR1cm4gTWF0aC5yb3VuZCh0aGlzLl9jbG9jay5nZXRUaWNrc0F0VGltZSh0KSl9Z2V0U2Vjb25kc0F0VGltZSh0KXtyZXR1cm4gdGhpcy5fY2xvY2suZ2V0U2Vjb25kc0F0VGltZSh0KX1nZXQgUFBRKCl7cmV0dXJuIHRoaXMuX2Nsb2NrLmZyZXF1ZW5jeS5tdWx0aXBsaWVyfXNldCBQUFEodCl7dGhpcy5fY2xvY2suZnJlcXVlbmN5Lm11bHRpcGxpZXI9dH1uZXh0U3ViZGl2aXNpb24odCl7aWYodD10aGlzLnRvVGlja3ModCksXCJzdGFydGVkXCIhPT10aGlzLnN0YXRlKXJldHVybiAwO3tjb25zdCBlPXRoaXMubm93KCkscz10LXRoaXMuZ2V0VGlja3NBdFRpbWUoZSkldDtyZXR1cm4gdGhpcy5fY2xvY2submV4dFRpY2tUaW1lKHMsZSl9fXN5bmNTaWduYWwodCxlKXtpZighZSl7Y29uc3Qgcz10aGlzLm5vdygpO2lmKDAhPT10LmdldFZhbHVlQXRUaW1lKHMpKXtjb25zdCBuPTEvKDYwL3RoaXMuYnBtLmdldFZhbHVlQXRUaW1lKHMpL3RoaXMuUFBRKTtlPXQuZ2V0VmFsdWVBdFRpbWUocykvbn1lbHNlIGU9MH1jb25zdCBzPW5ldyBrbyhlKTtyZXR1cm4gdGhpcy5icG0uY29ubmVjdChzKSxzLmNvbm5lY3QodC5fcGFyYW0pLHRoaXMuX3N5bmNlZFNpZ25hbHMucHVzaCh7aW5pdGlhbDp0LnZhbHVlLHJhdGlvOnMsc2lnbmFsOnR9KSx0LnZhbHVlPTAsdGhpc311bnN5bmNTaWduYWwodCl7Zm9yKGxldCBlPXRoaXMuX3N5bmNlZFNpZ25hbHMubGVuZ3RoLTE7ZT49MDtlLS0pe2NvbnN0IHM9dGhpcy5fc3luY2VkU2lnbmFsc1tlXTtzLnNpZ25hbD09PXQmJihzLnJhdGlvLmRpc3Bvc2UoKSxzLnNpZ25hbC52YWx1ZT1zLmluaXRpYWwsdGhpcy5fc3luY2VkU2lnbmFscy5zcGxpY2UoZSwxKSl9cmV0dXJuIHRoaXN9ZGlzcG9zZSgpe3JldHVybiBzdXBlci5kaXNwb3NlKCksdGhpcy5fY2xvY2suZGlzcG9zZSgpLFFpKHRoaXMsXCJicG1cIiksdGhpcy5fdGltZWxpbmUuZGlzcG9zZSgpLHRoaXMuX3JlcGVhdGVkRXZlbnRzLmRpc3Bvc2UoKSx0aGlzfX1CaS5taXhpbihZbyksamkodD0+e3QudHJhbnNwb3J0PW5ldyBZbyh7Y29udGV4dDp0fSl9KSx6aSh0PT57dC50cmFuc3BvcnQuZGlzcG9zZSgpfSk7Y2xhc3MgSG8gZXh0ZW5kcyB3b3tjb25zdHJ1Y3Rvcih0KXtzdXBlcih0KSx0aGlzLmlucHV0PXZvaWQgMCx0aGlzLl9zdGF0ZT1uZXcgeW8oXCJzdG9wcGVkXCIpLHRoaXMuX3N5bmNlZD0hMSx0aGlzLl9zY2hlZHVsZWQ9W10sdGhpcy5fc3luY2VkU3RhcnQ9WmksdGhpcy5fc3luY2VkU3RvcD1aaSx0aGlzLl9zdGF0ZS5tZW1vcnk9MTAwLHRoaXMuX3N0YXRlLmluY3JlYXNpbmc9ITAsdGhpcy5fdm9sdW1lPXRoaXMub3V0cHV0PW5ldyBHbyh7Y29udGV4dDp0aGlzLmNvbnRleHQsbXV0ZTp0Lm11dGUsdm9sdW1lOnQudm9sdW1lfSksdGhpcy52b2x1bWU9dGhpcy5fdm9sdW1lLnZvbHVtZSxVaSh0aGlzLFwidm9sdW1lXCIpLHRoaXMub25zdG9wPXQub25zdG9wfXN0YXRpYyBnZXREZWZhdWx0cygpe3JldHVybiBPYmplY3QuYXNzaWduKHdvLmdldERlZmF1bHRzKCkse211dGU6ITEsb25zdG9wOlppLHZvbHVtZTowfSl9Z2V0IHN0YXRlKCl7cmV0dXJuIHRoaXMuX3N5bmNlZD9cInN0YXJ0ZWRcIj09PXRoaXMuY29udGV4dC50cmFuc3BvcnQuc3RhdGU/dGhpcy5fc3RhdGUuZ2V0VmFsdWVBdFRpbWUodGhpcy5jb250ZXh0LnRyYW5zcG9ydC5zZWNvbmRzKTpcInN0b3BwZWRcIjp0aGlzLl9zdGF0ZS5nZXRWYWx1ZUF0VGltZSh0aGlzLm5vdygpKX1nZXQgbXV0ZSgpe3JldHVybiB0aGlzLl92b2x1bWUubXV0ZX1zZXQgbXV0ZSh0KXt0aGlzLl92b2x1bWUubXV0ZT10fV9jbGFtcFRvQ3VycmVudFRpbWUodCl7cmV0dXJuIHRoaXMuX3N5bmNlZD90Ok1hdGgubWF4KHQsdGhpcy5jb250ZXh0LmN1cnJlbnRUaW1lKX1zdGFydCh0LGUscyl7bGV0IG49YWkodCkmJnRoaXMuX3N5bmNlZD90aGlzLmNvbnRleHQudHJhbnNwb3J0LnNlY29uZHM6dGhpcy50b1NlY29uZHModCk7aWYobj10aGlzLl9jbGFtcFRvQ3VycmVudFRpbWUobiksdGhpcy5fc3luY2VkfHxcInN0YXJ0ZWRcIiE9PXRoaXMuX3N0YXRlLmdldFZhbHVlQXRUaW1lKG4pKWlmKHRoaXMubG9nKFwic3RhcnRcIixuKSx0aGlzLl9zdGF0ZS5zZXRTdGF0ZUF0VGltZShcInN0YXJ0ZWRcIixuKSx0aGlzLl9zeW5jZWQpe2NvbnN0IHQ9dGhpcy5fc3RhdGUuZ2V0KG4pO3QmJih0Lm9mZnNldD10aGlzLnRvU2Vjb25kcyhPaShlLDApKSx0LmR1cmF0aW9uPXM/dGhpcy50b1NlY29uZHMocyk6dm9pZCAwKTtjb25zdCBpPXRoaXMuY29udGV4dC50cmFuc3BvcnQuc2NoZWR1bGUodD0+e3RoaXMuX3N0YXJ0KHQsZSxzKX0sbik7dGhpcy5fc2NoZWR1bGVkLnB1c2goaSksXCJzdGFydGVkXCI9PT10aGlzLmNvbnRleHQudHJhbnNwb3J0LnN0YXRlJiZ0aGlzLmNvbnRleHQudHJhbnNwb3J0LmdldFNlY29uZHNBdFRpbWUodGhpcy5pbW1lZGlhdGUoKSk+biYmdGhpcy5fc3luY2VkU3RhcnQodGhpcy5ub3coKSx0aGlzLmNvbnRleHQudHJhbnNwb3J0LnNlY29uZHMpfWVsc2Ugc2kodGhpcy5jb250ZXh0KSx0aGlzLl9zdGFydChuLGUscyk7ZWxzZSB0aShSaShuLHRoaXMuX3N0YXRlLmdldChuKS50aW1lKSxcIlN0YXJ0IHRpbWUgbXVzdCBiZSBzdHJpY3RseSBncmVhdGVyIHRoYW4gcHJldmlvdXMgc3RhcnQgdGltZVwiKSx0aGlzLl9zdGF0ZS5jYW5jZWwobiksdGhpcy5fc3RhdGUuc2V0U3RhdGVBdFRpbWUoXCJzdGFydGVkXCIsbiksdGhpcy5sb2coXCJyZXN0YXJ0XCIsbiksdGhpcy5yZXN0YXJ0KG4sZSxzKTtyZXR1cm4gdGhpc31zdG9wKHQpe2xldCBlPWFpKHQpJiZ0aGlzLl9zeW5jZWQ/dGhpcy5jb250ZXh0LnRyYW5zcG9ydC5zZWNvbmRzOnRoaXMudG9TZWNvbmRzKHQpO2lmKGU9dGhpcy5fY2xhbXBUb0N1cnJlbnRUaW1lKGUpLFwic3RhcnRlZFwiPT09dGhpcy5fc3RhdGUuZ2V0VmFsdWVBdFRpbWUoZSl8fGNpKHRoaXMuX3N0YXRlLmdldE5leHRTdGF0ZShcInN0YXJ0ZWRcIixlKSkpe2lmKHRoaXMubG9nKFwic3RvcFwiLGUpLHRoaXMuX3N5bmNlZCl7Y29uc3QgdD10aGlzLmNvbnRleHQudHJhbnNwb3J0LnNjaGVkdWxlKHRoaXMuX3N0b3AuYmluZCh0aGlzKSxlKTt0aGlzLl9zY2hlZHVsZWQucHVzaCh0KX1lbHNlIHRoaXMuX3N0b3AoZSk7dGhpcy5fc3RhdGUuY2FuY2VsKGUpLHRoaXMuX3N0YXRlLnNldFN0YXRlQXRUaW1lKFwic3RvcHBlZFwiLGUpfXJldHVybiB0aGlzfXJlc3RhcnQodCxlLHMpe3JldHVybiB0PXRoaXMudG9TZWNvbmRzKHQpLFwic3RhcnRlZFwiPT09dGhpcy5fc3RhdGUuZ2V0VmFsdWVBdFRpbWUodCkmJih0aGlzLl9zdGF0ZS5jYW5jZWwodCksdGhpcy5fcmVzdGFydCh0LGUscykpLHRoaXN9c3luYygpe3JldHVybiB0aGlzLl9zeW5jZWR8fCh0aGlzLl9zeW5jZWQ9ITAsdGhpcy5fc3luY2VkU3RhcnQ9KHQsZSk9PntpZihlPjApe2NvbnN0IHM9dGhpcy5fc3RhdGUuZ2V0KGUpO2lmKHMmJlwic3RhcnRlZFwiPT09cy5zdGF0ZSYmcy50aW1lIT09ZSl7Y29uc3Qgbj1lLXRoaXMudG9TZWNvbmRzKHMudGltZSk7bGV0IGk7cy5kdXJhdGlvbiYmKGk9dGhpcy50b1NlY29uZHMocy5kdXJhdGlvbiktbiksdGhpcy5fc3RhcnQodCx0aGlzLnRvU2Vjb25kcyhzLm9mZnNldCkrbixpKX19fSx0aGlzLl9zeW5jZWRTdG9wPXQ9Pntjb25zdCBlPXRoaXMuY29udGV4dC50cmFuc3BvcnQuZ2V0U2Vjb25kc0F0VGltZShNYXRoLm1heCh0LXRoaXMuc2FtcGxlVGltZSwwKSk7XCJzdGFydGVkXCI9PT10aGlzLl9zdGF0ZS5nZXRWYWx1ZUF0VGltZShlKSYmdGhpcy5fc3RvcCh0KX0sdGhpcy5jb250ZXh0LnRyYW5zcG9ydC5vbihcInN0YXJ0XCIsdGhpcy5fc3luY2VkU3RhcnQpLHRoaXMuY29udGV4dC50cmFuc3BvcnQub24oXCJsb29wU3RhcnRcIix0aGlzLl9zeW5jZWRTdGFydCksdGhpcy5jb250ZXh0LnRyYW5zcG9ydC5vbihcInN0b3BcIix0aGlzLl9zeW5jZWRTdG9wKSx0aGlzLmNvbnRleHQudHJhbnNwb3J0Lm9uKFwicGF1c2VcIix0aGlzLl9zeW5jZWRTdG9wKSx0aGlzLmNvbnRleHQudHJhbnNwb3J0Lm9uKFwibG9vcEVuZFwiLHRoaXMuX3N5bmNlZFN0b3ApKSx0aGlzfXVuc3luYygpe3JldHVybiB0aGlzLl9zeW5jZWQmJih0aGlzLmNvbnRleHQudHJhbnNwb3J0Lm9mZihcInN0b3BcIix0aGlzLl9zeW5jZWRTdG9wKSx0aGlzLmNvbnRleHQudHJhbnNwb3J0Lm9mZihcInBhdXNlXCIsdGhpcy5fc3luY2VkU3RvcCksdGhpcy5jb250ZXh0LnRyYW5zcG9ydC5vZmYoXCJsb29wRW5kXCIsdGhpcy5fc3luY2VkU3RvcCksdGhpcy5jb250ZXh0LnRyYW5zcG9ydC5vZmYoXCJzdGFydFwiLHRoaXMuX3N5bmNlZFN0YXJ0KSx0aGlzLmNvbnRleHQudHJhbnNwb3J0Lm9mZihcImxvb3BTdGFydFwiLHRoaXMuX3N5bmNlZFN0YXJ0KSksdGhpcy5fc3luY2VkPSExLHRoaXMuX3NjaGVkdWxlZC5mb3JFYWNoKHQ9PnRoaXMuY29udGV4dC50cmFuc3BvcnQuY2xlYXIodCkpLHRoaXMuX3NjaGVkdWxlZD1bXSx0aGlzLl9zdGF0ZS5jYW5jZWwoMCksdGhpcy5fc3RvcCgwKSx0aGlzfWRpc3Bvc2UoKXtyZXR1cm4gc3VwZXIuZGlzcG9zZSgpLHRoaXMub25zdG9wPVppLHRoaXMudW5zeW5jKCksdGhpcy5fdm9sdW1lLmRpc3Bvc2UoKSx0aGlzLl9zdGF0ZS5kaXNwb3NlKCksdGhpc319Y2xhc3MgJG8gZXh0ZW5kcyBDb3tjb25zdHJ1Y3Rvcigpe3N1cGVyKERpKCRvLmdldERlZmF1bHRzKCksYXJndW1lbnRzLFtcInVybFwiLFwib25sb2FkXCJdKSksdGhpcy5uYW1lPVwiVG9uZUJ1ZmZlclNvdXJjZVwiLHRoaXMuX3NvdXJjZT10aGlzLmNvbnRleHQuY3JlYXRlQnVmZmVyU291cmNlKCksdGhpcy5faW50ZXJuYWxDaGFubmVscz1bdGhpcy5fc291cmNlXSx0aGlzLl9zb3VyY2VTdGFydGVkPSExLHRoaXMuX3NvdXJjZVN0b3BwZWQ9ITE7Y29uc3QgdD1EaSgkby5nZXREZWZhdWx0cygpLGFyZ3VtZW50cyxbXCJ1cmxcIixcIm9ubG9hZFwiXSk7VG8odGhpcy5fc291cmNlLHRoaXMuX2dhaW5Ob2RlKSx0aGlzLl9zb3VyY2Uub25lbmRlZD0oKT0+dGhpcy5fc3RvcFNvdXJjZSgpLHRoaXMucGxheWJhY2tSYXRlPW5ldyB4byh7Y29udGV4dDp0aGlzLmNvbnRleHQscGFyYW06dGhpcy5fc291cmNlLnBsYXliYWNrUmF0ZSx1bml0czpcInBvc2l0aXZlXCIsdmFsdWU6dC5wbGF5YmFja1JhdGV9KSx0aGlzLmxvb3A9dC5sb29wLHRoaXMubG9vcFN0YXJ0PXQubG9vcFN0YXJ0LHRoaXMubG9vcEVuZD10Lmxvb3BFbmQsdGhpcy5fYnVmZmVyPW5ldyBYaSh0LnVybCx0Lm9ubG9hZCx0Lm9uZXJyb3IpLHRoaXMuX2ludGVybmFsQ2hhbm5lbHMucHVzaCh0aGlzLl9zb3VyY2UpfXN0YXRpYyBnZXREZWZhdWx0cygpe3JldHVybiBPYmplY3QuYXNzaWduKENvLmdldERlZmF1bHRzKCkse3VybDpuZXcgWGksbG9vcDohMSxsb29wRW5kOjAsbG9vcFN0YXJ0OjAsb25sb2FkOlppLG9uZXJyb3I6WmkscGxheWJhY2tSYXRlOjF9KX1nZXQgZmFkZUluKCl7cmV0dXJuIHRoaXMuX2ZhZGVJbn1zZXQgZmFkZUluKHQpe3RoaXMuX2ZhZGVJbj10fWdldCBmYWRlT3V0KCl7cmV0dXJuIHRoaXMuX2ZhZGVPdXR9c2V0IGZhZGVPdXQodCl7dGhpcy5fZmFkZU91dD10fWdldCBjdXJ2ZSgpe3JldHVybiB0aGlzLl9jdXJ2ZX1zZXQgY3VydmUodCl7dGhpcy5fY3VydmU9dH1zdGFydCh0LGUscyxuPTEpe3RpKHRoaXMuYnVmZmVyLmxvYWRlZCxcImJ1ZmZlciBpcyBlaXRoZXIgbm90IHNldCBvciBub3QgbG9hZGVkXCIpO2NvbnN0IGk9dGhpcy50b1NlY29uZHModCk7dGhpcy5fc3RhcnRHYWluKGksbiksZT10aGlzLmxvb3A/T2koZSx0aGlzLmxvb3BTdGFydCk6T2koZSwwKTtsZXQgbz1NYXRoLm1heCh0aGlzLnRvU2Vjb25kcyhlKSwwKTtpZih0aGlzLmxvb3Ape2NvbnN0IHQ9dGhpcy50b1NlY29uZHModGhpcy5sb29wRW5kKXx8dGhpcy5idWZmZXIuZHVyYXRpb24sZT10aGlzLnRvU2Vjb25kcyh0aGlzLmxvb3BTdGFydCkscz10LWU7cWkobyx0KSYmKG89KG8tZSklcytlKSxJaShvLHRoaXMuYnVmZmVyLmR1cmF0aW9uKSYmKG89MCl9aWYodGhpcy5fc291cmNlLmJ1ZmZlcj10aGlzLmJ1ZmZlci5nZXQoKSx0aGlzLl9zb3VyY2UubG9vcEVuZD10aGlzLnRvU2Vjb25kcyh0aGlzLmxvb3BFbmQpfHx0aGlzLmJ1ZmZlci5kdXJhdGlvbixGaShvLHRoaXMuYnVmZmVyLmR1cmF0aW9uKSYmKHRoaXMuX3NvdXJjZVN0YXJ0ZWQ9ITAsdGhpcy5fc291cmNlLnN0YXJ0KGksbykpLGNpKHMpKXtsZXQgdD10aGlzLnRvU2Vjb25kcyhzKTt0PU1hdGgubWF4KHQsMCksdGhpcy5zdG9wKGkrdCl9cmV0dXJuIHRoaXN9X3N0b3BTb3VyY2UodCl7IXRoaXMuX3NvdXJjZVN0b3BwZWQmJnRoaXMuX3NvdXJjZVN0YXJ0ZWQmJih0aGlzLl9zb3VyY2VTdG9wcGVkPSEwLHRoaXMuX3NvdXJjZS5zdG9wKHRoaXMudG9TZWNvbmRzKHQpKSx0aGlzLl9vbmVuZGVkKCkpfWdldCBsb29wU3RhcnQoKXtyZXR1cm4gdGhpcy5fc291cmNlLmxvb3BTdGFydH1zZXQgbG9vcFN0YXJ0KHQpe3RoaXMuX3NvdXJjZS5sb29wU3RhcnQ9dGhpcy50b1NlY29uZHModCl9Z2V0IGxvb3BFbmQoKXtyZXR1cm4gdGhpcy5fc291cmNlLmxvb3BFbmR9c2V0IGxvb3BFbmQodCl7dGhpcy5fc291cmNlLmxvb3BFbmQ9dGhpcy50b1NlY29uZHModCl9Z2V0IGJ1ZmZlcigpe3JldHVybiB0aGlzLl9idWZmZXJ9c2V0IGJ1ZmZlcih0KXt0aGlzLl9idWZmZXIuc2V0KHQpfWdldCBsb29wKCl7cmV0dXJuIHRoaXMuX3NvdXJjZS5sb29wfXNldCBsb29wKHQpe3RoaXMuX3NvdXJjZS5sb29wPXQsdGhpcy5fc291cmNlU3RhcnRlZCYmdGhpcy5jYW5jZWxTdG9wKCl9ZGlzcG9zZSgpe3JldHVybiBzdXBlci5kaXNwb3NlKCksdGhpcy5fc291cmNlLm9uZW5kZWQ9bnVsbCx0aGlzLl9zb3VyY2UuZGlzY29ubmVjdCgpLHRoaXMuX2J1ZmZlci5kaXNwb3NlKCksdGhpcy5wbGF5YmFja1JhdGUuZGlzcG9zZSgpLHRoaXN9fWNsYXNzIEpvIGV4dGVuZHMgSG97Y29uc3RydWN0b3IoKXtzdXBlcihEaShKby5nZXREZWZhdWx0cygpLGFyZ3VtZW50cyxbXCJ0eXBlXCJdKSksdGhpcy5uYW1lPVwiTm9pc2VcIix0aGlzLl9zb3VyY2U9bnVsbDtjb25zdCB0PURpKEpvLmdldERlZmF1bHRzKCksYXJndW1lbnRzLFtcInR5cGVcIl0pO3RoaXMuX3BsYXliYWNrUmF0ZT10LnBsYXliYWNrUmF0ZSx0aGlzLnR5cGU9dC50eXBlLHRoaXMuX2ZhZGVJbj10LmZhZGVJbix0aGlzLl9mYWRlT3V0PXQuZmFkZU91dH1zdGF0aWMgZ2V0RGVmYXVsdHMoKXtyZXR1cm4gT2JqZWN0LmFzc2lnbihIby5nZXREZWZhdWx0cygpLHtmYWRlSW46MCxmYWRlT3V0OjAscGxheWJhY2tSYXRlOjEsdHlwZTpcIndoaXRlXCJ9KX1nZXQgdHlwZSgpe3JldHVybiB0aGlzLl90eXBlfXNldCB0eXBlKHQpe2lmKHRpKHQgaW4gdHIsXCJOb2lzZTogaW52YWxpZCB0eXBlOiBcIit0KSx0aGlzLl90eXBlIT09dCYmKHRoaXMuX3R5cGU9dCxcInN0YXJ0ZWRcIj09PXRoaXMuc3RhdGUpKXtjb25zdCB0PXRoaXMubm93KCk7dGhpcy5fc3RvcCh0KSx0aGlzLl9zdGFydCh0KX19Z2V0IHBsYXliYWNrUmF0ZSgpe3JldHVybiB0aGlzLl9wbGF5YmFja1JhdGV9c2V0IHBsYXliYWNrUmF0ZSh0KXt0aGlzLl9wbGF5YmFja1JhdGU9dCx0aGlzLl9zb3VyY2UmJih0aGlzLl9zb3VyY2UucGxheWJhY2tSYXRlLnZhbHVlPXQpfV9zdGFydCh0KXtjb25zdCBlPXRyW3RoaXMuX3R5cGVdO3RoaXMuX3NvdXJjZT1uZXcgJG8oe3VybDplLGNvbnRleHQ6dGhpcy5jb250ZXh0LGZhZGVJbjp0aGlzLl9mYWRlSW4sZmFkZU91dDp0aGlzLl9mYWRlT3V0LGxvb3A6ITAsb25lbmRlZDooKT0+dGhpcy5vbnN0b3AodGhpcykscGxheWJhY2tSYXRlOnRoaXMuX3BsYXliYWNrUmF0ZX0pLmNvbm5lY3QodGhpcy5vdXRwdXQpLHRoaXMuX3NvdXJjZS5zdGFydCh0aGlzLnRvU2Vjb25kcyh0KSxNYXRoLnJhbmRvbSgpKihlLmR1cmF0aW9uLS4wMDEpKX1fc3RvcCh0KXt0aGlzLl9zb3VyY2UmJih0aGlzLl9zb3VyY2Uuc3RvcCh0aGlzLnRvU2Vjb25kcyh0KSksdGhpcy5fc291cmNlPW51bGwpfWdldCBmYWRlSW4oKXtyZXR1cm4gdGhpcy5fZmFkZUlufXNldCBmYWRlSW4odCl7dGhpcy5fZmFkZUluPXQsdGhpcy5fc291cmNlJiYodGhpcy5fc291cmNlLmZhZGVJbj10aGlzLl9mYWRlSW4pfWdldCBmYWRlT3V0KCl7cmV0dXJuIHRoaXMuX2ZhZGVPdXR9c2V0IGZhZGVPdXQodCl7dGhpcy5fZmFkZU91dD10LHRoaXMuX3NvdXJjZSYmKHRoaXMuX3NvdXJjZS5mYWRlT3V0PXRoaXMuX2ZhZGVPdXQpfV9yZXN0YXJ0KHQpe3RoaXMuX3N0b3AodCksdGhpcy5fc3RhcnQodCl9ZGlzcG9zZSgpe3JldHVybiBzdXBlci5kaXNwb3NlKCksdGhpcy5fc291cmNlJiZ0aGlzLl9zb3VyY2UuZGlzY29ubmVjdCgpLHRoaXN9fWNvbnN0IEtvPXticm93bjpudWxsLHBpbms6bnVsbCx3aGl0ZTpudWxsfSx0cj17Z2V0IGJyb3duKCl7aWYoIUtvLmJyb3duKXtjb25zdCB0PVtdO2ZvcihsZXQgZT0wO2U8MjtlKyspe2NvbnN0IHM9bmV3IEZsb2F0MzJBcnJheSgyMjA1MDApO3RbZV09cztsZXQgbj0wO2ZvcihsZXQgdD0wO3Q8MjIwNTAwO3QrKyl7Y29uc3QgZT0yKk1hdGgucmFuZG9tKCktMTtzW3RdPShuKy4wMiplKS8xLjAyLG49c1t0XSxzW3RdKj0zLjV9fUtvLmJyb3duPShuZXcgWGkpLmZyb21BcnJheSh0KX1yZXR1cm4gS28uYnJvd259LGdldCBwaW5rKCl7aWYoIUtvLnBpbmspe2NvbnN0IHQ9W107Zm9yKGxldCBlPTA7ZTwyO2UrKyl7Y29uc3Qgcz1uZXcgRmxvYXQzMkFycmF5KDIyMDUwMCk7bGV0IG4saSxvLHIsYSxjLGg7dFtlXT1zLG49aT1vPXI9YT1jPWg9MDtmb3IobGV0IHQ9MDt0PDIyMDUwMDt0Kyspe2NvbnN0IGU9MipNYXRoLnJhbmRvbSgpLTE7bj0uOTk4ODYqbisuMDU1NTE3OSplLGk9Ljk5MzMyKmkrLjA3NTA3NTkqZSxvPS45NjkqbysuMTUzODUyKmUscj0uODY2NSpyKy4zMTA0ODU2KmUsYT0uNTUqYSsuNTMyOTUyMiplLGM9LS43NjE2KmMtLjAxNjg5OCplLHNbdF09bitpK28rcithK2MraCsuNTM2MiplLHNbdF0qPS4xMSxoPS4xMTU5MjYqZX19S28ucGluaz0obmV3IFhpKS5mcm9tQXJyYXkodCl9cmV0dXJuIEtvLnBpbmt9LGdldCB3aGl0ZSgpe2lmKCFLby53aGl0ZSl7Y29uc3QgdD1bXTtmb3IobGV0IGU9MDtlPDI7ZSsrKXtjb25zdCBzPW5ldyBGbG9hdDMyQXJyYXkoMjIwNTAwKTt0W2VdPXM7Zm9yKGxldCB0PTA7dDwyMjA1MDA7dCsrKXNbdF09MipNYXRoLnJhbmRvbSgpLTF9S28ud2hpdGU9KG5ldyBYaSkuZnJvbUFycmF5KHQpfXJldHVybiBLby53aGl0ZX19O2NsYXNzIGVyIGV4dGVuZHMgd297Y29uc3RydWN0b3IoKXtzdXBlcihEaShlci5nZXREZWZhdWx0cygpLGFyZ3VtZW50cyxbXCJ2b2x1bWVcIl0pKSx0aGlzLm5hbWU9XCJVc2VyTWVkaWFcIjtjb25zdCB0PURpKGVyLmdldERlZmF1bHRzKCksYXJndW1lbnRzLFtcInZvbHVtZVwiXSk7dGhpcy5fdm9sdW1lPXRoaXMub3V0cHV0PW5ldyBHbyh7Y29udGV4dDp0aGlzLmNvbnRleHQsdm9sdW1lOnQudm9sdW1lfSksdGhpcy52b2x1bWU9dGhpcy5fdm9sdW1lLnZvbHVtZSxVaSh0aGlzLFwidm9sdW1lXCIpLHRoaXMubXV0ZT10Lm11dGV9c3RhdGljIGdldERlZmF1bHRzKCl7cmV0dXJuIE9iamVjdC5hc3NpZ24od28uZ2V0RGVmYXVsdHMoKSx7bXV0ZTohMSx2b2x1bWU6MH0pfW9wZW4odCl7cmV0dXJuIHlpKHRoaXMsdm9pZCAwLHZvaWQgMCwoZnVuY3Rpb24qKCl7dGkoZXIuc3VwcG9ydGVkLFwiVXNlck1lZGlhIGlzIG5vdCBzdXBwb3J0ZWRcIiksXCJzdGFydGVkXCI9PT10aGlzLnN0YXRlJiZ0aGlzLmNsb3NlKCk7Y29uc3QgZT15aWVsZCBlci5lbnVtZXJhdGVEZXZpY2VzKCk7dWkodCk/dGhpcy5fZGV2aWNlPWVbdF06KHRoaXMuX2RldmljZT1lLmZpbmQoZT0+ZS5sYWJlbD09PXR8fGUuZGV2aWNlSWQ9PT10KSwhdGhpcy5fZGV2aWNlJiZlLmxlbmd0aD4wJiYodGhpcy5fZGV2aWNlPWVbMF0pLHRpKGNpKHRoaXMuX2RldmljZSksXCJObyBtYXRjaGluZyBkZXZpY2UgXCIrdCkpO2NvbnN0IHM9e2F1ZGlvOntlY2hvQ2FuY2VsbGF0aW9uOiExLHNhbXBsZVJhdGU6dGhpcy5jb250ZXh0LnNhbXBsZVJhdGUsbm9pc2VTdXBwcmVzc2lvbjohMSxtb3pOb2lzZVN1cHByZXNzaW9uOiExfX07dGhpcy5fZGV2aWNlJiYocy5hdWRpby5kZXZpY2VJZD10aGlzLl9kZXZpY2UuZGV2aWNlSWQpO2NvbnN0IG49eWllbGQgbmF2aWdhdG9yLm1lZGlhRGV2aWNlcy5nZXRVc2VyTWVkaWEocyk7aWYoIXRoaXMuX3N0cmVhbSl7dGhpcy5fc3RyZWFtPW47Y29uc3QgdD10aGlzLmNvbnRleHQuY3JlYXRlTWVkaWFTdHJlYW1Tb3VyY2Uobik7VG8odCx0aGlzLm91dHB1dCksdGhpcy5fbWVkaWFTdHJlYW09dH1yZXR1cm4gdGhpc30pKX1jbG9zZSgpe3JldHVybiB0aGlzLl9zdHJlYW0mJnRoaXMuX21lZGlhU3RyZWFtJiYodGhpcy5fc3RyZWFtLmdldEF1ZGlvVHJhY2tzKCkuZm9yRWFjaCh0PT57dC5zdG9wKCl9KSx0aGlzLl9zdHJlYW09dm9pZCAwLHRoaXMuX21lZGlhU3RyZWFtLmRpc2Nvbm5lY3QoKSx0aGlzLl9tZWRpYVN0cmVhbT12b2lkIDApLHRoaXMuX2RldmljZT12b2lkIDAsdGhpc31zdGF0aWMgZW51bWVyYXRlRGV2aWNlcygpe3JldHVybiB5aSh0aGlzLHZvaWQgMCx2b2lkIDAsKGZ1bmN0aW9uKigpe3JldHVybih5aWVsZCBuYXZpZ2F0b3IubWVkaWFEZXZpY2VzLmVudW1lcmF0ZURldmljZXMoKSkuZmlsdGVyKHQ9PlwiYXVkaW9pbnB1dFwiPT09dC5raW5kKX0pKX1nZXQgc3RhdGUoKXtyZXR1cm4gdGhpcy5fc3RyZWFtJiZ0aGlzLl9zdHJlYW0uYWN0aXZlP1wic3RhcnRlZFwiOlwic3RvcHBlZFwifWdldCBkZXZpY2VJZCgpe3JldHVybiB0aGlzLl9kZXZpY2U/dGhpcy5fZGV2aWNlLmRldmljZUlkOnZvaWQgMH1nZXQgZ3JvdXBJZCgpe3JldHVybiB0aGlzLl9kZXZpY2U/dGhpcy5fZGV2aWNlLmdyb3VwSWQ6dm9pZCAwfWdldCBsYWJlbCgpe3JldHVybiB0aGlzLl9kZXZpY2U/dGhpcy5fZGV2aWNlLmxhYmVsOnZvaWQgMH1nZXQgbXV0ZSgpe3JldHVybiB0aGlzLl92b2x1bWUubXV0ZX1zZXQgbXV0ZSh0KXt0aGlzLl92b2x1bWUubXV0ZT10fWRpc3Bvc2UoKXtyZXR1cm4gc3VwZXIuZGlzcG9zZSgpLHRoaXMuY2xvc2UoKSx0aGlzLl92b2x1bWUuZGlzcG9zZSgpLHRoaXMudm9sdW1lLmRpc3Bvc2UoKSx0aGlzfXN0YXRpYyBnZXQgc3VwcG9ydGVkKCl7cmV0dXJuIGNpKG5hdmlnYXRvci5tZWRpYURldmljZXMpJiZjaShuYXZpZ2F0b3IubWVkaWFEZXZpY2VzLmdldFVzZXJNZWRpYSl9fWZ1bmN0aW9uIHNyKHQsZSl7cmV0dXJuIHlpKHRoaXMsdm9pZCAwLHZvaWQgMCwoZnVuY3Rpb24qKCl7Y29uc3Qgcz1lL3QuY29udGV4dC5zYW1wbGVSYXRlLG49bmV3IFlpKDEscyx0LmNvbnRleHQuc2FtcGxlUmF0ZSk7bmV3IHQuY29uc3RydWN0b3IoT2JqZWN0LmFzc2lnbih0LmdldCgpLHtmcmVxdWVuY3k6Mi9zLGRldHVuZTowLGNvbnRleHQ6bn0pKS50b0Rlc3RpbmF0aW9uKCkuc3RhcnQoMCk7cmV0dXJuKHlpZWxkIG4ucmVuZGVyKCkpLmdldENoYW5uZWxEYXRhKDApfSkpfWNsYXNzIG5yIGV4dGVuZHMgQ297Y29uc3RydWN0b3IoKXtzdXBlcihEaShuci5nZXREZWZhdWx0cygpLGFyZ3VtZW50cyxbXCJmcmVxdWVuY3lcIixcInR5cGVcIl0pKSx0aGlzLm5hbWU9XCJUb25lT3NjaWxsYXRvck5vZGVcIix0aGlzLl9vc2NpbGxhdG9yPXRoaXMuY29udGV4dC5jcmVhdGVPc2NpbGxhdG9yKCksdGhpcy5faW50ZXJuYWxDaGFubmVscz1bdGhpcy5fb3NjaWxsYXRvcl07Y29uc3QgdD1EaShuci5nZXREZWZhdWx0cygpLGFyZ3VtZW50cyxbXCJmcmVxdWVuY3lcIixcInR5cGVcIl0pO1RvKHRoaXMuX29zY2lsbGF0b3IsdGhpcy5fZ2Fpbk5vZGUpLHRoaXMudHlwZT10LnR5cGUsdGhpcy5mcmVxdWVuY3k9bmV3IHhvKHtjb250ZXh0OnRoaXMuY29udGV4dCxwYXJhbTp0aGlzLl9vc2NpbGxhdG9yLmZyZXF1ZW5jeSx1bml0czpcImZyZXF1ZW5jeVwiLHZhbHVlOnQuZnJlcXVlbmN5fSksdGhpcy5kZXR1bmU9bmV3IHhvKHtjb250ZXh0OnRoaXMuY29udGV4dCxwYXJhbTp0aGlzLl9vc2NpbGxhdG9yLmRldHVuZSx1bml0czpcImNlbnRzXCIsdmFsdWU6dC5kZXR1bmV9KSxVaSh0aGlzLFtcImZyZXF1ZW5jeVwiLFwiZGV0dW5lXCJdKX1zdGF0aWMgZ2V0RGVmYXVsdHMoKXtyZXR1cm4gT2JqZWN0LmFzc2lnbihDby5nZXREZWZhdWx0cygpLHtkZXR1bmU6MCxmcmVxdWVuY3k6NDQwLHR5cGU6XCJzaW5lXCJ9KX1zdGFydCh0KXtjb25zdCBlPXRoaXMudG9TZWNvbmRzKHQpO3JldHVybiB0aGlzLmxvZyhcInN0YXJ0XCIsZSksdGhpcy5fc3RhcnRHYWluKGUpLHRoaXMuX29zY2lsbGF0b3Iuc3RhcnQoZSksdGhpc31fc3RvcFNvdXJjZSh0KXt0aGlzLl9vc2NpbGxhdG9yLnN0b3AodCl9c2V0UGVyaW9kaWNXYXZlKHQpe3JldHVybiB0aGlzLl9vc2NpbGxhdG9yLnNldFBlcmlvZGljV2F2ZSh0KSx0aGlzfWdldCB0eXBlKCl7cmV0dXJuIHRoaXMuX29zY2lsbGF0b3IudHlwZX1zZXQgdHlwZSh0KXt0aGlzLl9vc2NpbGxhdG9yLnR5cGU9dH1kaXNwb3NlKCl7cmV0dXJuIHN1cGVyLmRpc3Bvc2UoKSxcInN0YXJ0ZWRcIj09PXRoaXMuc3RhdGUmJnRoaXMuc3RvcCgpLHRoaXMuX29zY2lsbGF0b3IuZGlzY29ubmVjdCgpLHRoaXMuZnJlcXVlbmN5LmRpc3Bvc2UoKSx0aGlzLmRldHVuZS5kaXNwb3NlKCksdGhpc319Y2xhc3MgaXIgZXh0ZW5kcyBIb3tjb25zdHJ1Y3Rvcigpe3N1cGVyKERpKGlyLmdldERlZmF1bHRzKCksYXJndW1lbnRzLFtcImZyZXF1ZW5jeVwiLFwidHlwZVwiXSkpLHRoaXMubmFtZT1cIk9zY2lsbGF0b3JcIix0aGlzLl9vc2NpbGxhdG9yPW51bGw7Y29uc3QgdD1EaShpci5nZXREZWZhdWx0cygpLGFyZ3VtZW50cyxbXCJmcmVxdWVuY3lcIixcInR5cGVcIl0pO3RoaXMuZnJlcXVlbmN5PW5ldyBEbyh7Y29udGV4dDp0aGlzLmNvbnRleHQsdW5pdHM6XCJmcmVxdWVuY3lcIix2YWx1ZTp0LmZyZXF1ZW5jeX0pLFVpKHRoaXMsXCJmcmVxdWVuY3lcIiksdGhpcy5kZXR1bmU9bmV3IERvKHtjb250ZXh0OnRoaXMuY29udGV4dCx1bml0czpcImNlbnRzXCIsdmFsdWU6dC5kZXR1bmV9KSxVaSh0aGlzLFwiZGV0dW5lXCIpLHRoaXMuX3BhcnRpYWxzPXQucGFydGlhbHMsdGhpcy5fcGFydGlhbENvdW50PXQucGFydGlhbENvdW50LHRoaXMuX3R5cGU9dC50eXBlLHQucGFydGlhbENvdW50JiZcImN1c3RvbVwiIT09dC50eXBlJiYodGhpcy5fdHlwZT10aGlzLmJhc2VUeXBlK3QucGFydGlhbENvdW50LnRvU3RyaW5nKCkpLHRoaXMucGhhc2U9dC5waGFzZX1zdGF0aWMgZ2V0RGVmYXVsdHMoKXtyZXR1cm4gT2JqZWN0LmFzc2lnbihIby5nZXREZWZhdWx0cygpLHtkZXR1bmU6MCxmcmVxdWVuY3k6NDQwLHBhcnRpYWxDb3VudDowLHBhcnRpYWxzOltdLHBoYXNlOjAsdHlwZTpcInNpbmVcIn0pfV9zdGFydCh0KXtjb25zdCBlPXRoaXMudG9TZWNvbmRzKHQpLHM9bmV3IG5yKHtjb250ZXh0OnRoaXMuY29udGV4dCxvbmVuZGVkOigpPT50aGlzLm9uc3RvcCh0aGlzKX0pO3RoaXMuX29zY2lsbGF0b3I9cyx0aGlzLl93YXZlP3RoaXMuX29zY2lsbGF0b3Iuc2V0UGVyaW9kaWNXYXZlKHRoaXMuX3dhdmUpOnRoaXMuX29zY2lsbGF0b3IudHlwZT10aGlzLl90eXBlLHRoaXMuX29zY2lsbGF0b3IuY29ubmVjdCh0aGlzLm91dHB1dCksdGhpcy5mcmVxdWVuY3kuY29ubmVjdCh0aGlzLl9vc2NpbGxhdG9yLmZyZXF1ZW5jeSksdGhpcy5kZXR1bmUuY29ubmVjdCh0aGlzLl9vc2NpbGxhdG9yLmRldHVuZSksdGhpcy5fb3NjaWxsYXRvci5zdGFydChlKX1fc3RvcCh0KXtjb25zdCBlPXRoaXMudG9TZWNvbmRzKHQpO3RoaXMuX29zY2lsbGF0b3ImJnRoaXMuX29zY2lsbGF0b3Iuc3RvcChlKX1fcmVzdGFydCh0KXtjb25zdCBlPXRoaXMudG9TZWNvbmRzKHQpO3JldHVybiB0aGlzLmxvZyhcInJlc3RhcnRcIixlKSx0aGlzLl9vc2NpbGxhdG9yJiZ0aGlzLl9vc2NpbGxhdG9yLmNhbmNlbFN0b3AoKSx0aGlzLl9zdGF0ZS5jYW5jZWwoZSksdGhpc31zeW5jRnJlcXVlbmN5KCl7cmV0dXJuIHRoaXMuY29udGV4dC50cmFuc3BvcnQuc3luY1NpZ25hbCh0aGlzLmZyZXF1ZW5jeSksdGhpc311bnN5bmNGcmVxdWVuY3koKXtyZXR1cm4gdGhpcy5jb250ZXh0LnRyYW5zcG9ydC51bnN5bmNTaWduYWwodGhpcy5mcmVxdWVuY3kpLHRoaXN9X2dldENhY2hlZFBlcmlvZGljV2F2ZSgpe2lmKFwiY3VzdG9tXCI9PT10aGlzLl90eXBlKXtyZXR1cm4gaXIuX3BlcmlvZGljV2F2ZUNhY2hlLmZpbmQodD0+e3JldHVybiB0LnBoYXNlPT09dGhpcy5fcGhhc2UmJihlPXQucGFydGlhbHMscz10aGlzLl9wYXJ0aWFscyxlLmxlbmd0aD09PXMubGVuZ3RoJiZlLmV2ZXJ5KCh0LGUpPT5zW2VdPT09dCkpO3ZhciBlLHN9KX17Y29uc3QgdD1pci5fcGVyaW9kaWNXYXZlQ2FjaGUuZmluZCh0PT50LnR5cGU9PT10aGlzLl90eXBlJiZ0LnBoYXNlPT09dGhpcy5fcGhhc2UpO3JldHVybiB0aGlzLl9wYXJ0aWFsQ291bnQ9dD90LnBhcnRpYWxDb3VudDp0aGlzLl9wYXJ0aWFsQ291bnQsdH19Z2V0IHR5cGUoKXtyZXR1cm4gdGhpcy5fdHlwZX1zZXQgdHlwZSh0KXt0aGlzLl90eXBlPXQ7Y29uc3QgZT0tMSE9PVtcInNpbmVcIixcInNxdWFyZVwiLFwic2F3dG9vdGhcIixcInRyaWFuZ2xlXCJdLmluZGV4T2YodCk7aWYoMD09PXRoaXMuX3BoYXNlJiZlKXRoaXMuX3dhdmU9dm9pZCAwLHRoaXMuX3BhcnRpYWxDb3VudD0wLG51bGwhPT10aGlzLl9vc2NpbGxhdG9yJiYodGhpcy5fb3NjaWxsYXRvci50eXBlPXQpO2Vsc2V7Y29uc3QgZT10aGlzLl9nZXRDYWNoZWRQZXJpb2RpY1dhdmUoKTtpZihjaShlKSl7Y29uc3R7cGFydGlhbHM6dCx3YXZlOnN9PWU7dGhpcy5fd2F2ZT1zLHRoaXMuX3BhcnRpYWxzPXQsbnVsbCE9PXRoaXMuX29zY2lsbGF0b3ImJnRoaXMuX29zY2lsbGF0b3Iuc2V0UGVyaW9kaWNXYXZlKHRoaXMuX3dhdmUpfWVsc2V7Y29uc3RbZSxzXT10aGlzLl9nZXRSZWFsSW1hZ2luYXJ5KHQsdGhpcy5fcGhhc2UpLG49dGhpcy5jb250ZXh0LmNyZWF0ZVBlcmlvZGljV2F2ZShlLHMpO3RoaXMuX3dhdmU9bixudWxsIT09dGhpcy5fb3NjaWxsYXRvciYmdGhpcy5fb3NjaWxsYXRvci5zZXRQZXJpb2RpY1dhdmUodGhpcy5fd2F2ZSksaXIuX3BlcmlvZGljV2F2ZUNhY2hlLnB1c2goe2ltYWc6cyxwYXJ0aWFsQ291bnQ6dGhpcy5fcGFydGlhbENvdW50LHBhcnRpYWxzOnRoaXMuX3BhcnRpYWxzLHBoYXNlOnRoaXMuX3BoYXNlLHJlYWw6ZSx0eXBlOnRoaXMuX3R5cGUsd2F2ZTp0aGlzLl93YXZlfSksaXIuX3BlcmlvZGljV2F2ZUNhY2hlLmxlbmd0aD4xMDAmJmlyLl9wZXJpb2RpY1dhdmVDYWNoZS5zaGlmdCgpfX19Z2V0IGJhc2VUeXBlKCl7cmV0dXJuIHRoaXMuX3R5cGUucmVwbGFjZSh0aGlzLnBhcnRpYWxDb3VudC50b1N0cmluZygpLFwiXCIpfXNldCBiYXNlVHlwZSh0KXt0aGlzLnBhcnRpYWxDb3VudCYmXCJjdXN0b21cIiE9PXRoaXMuX3R5cGUmJlwiY3VzdG9tXCIhPT10P3RoaXMudHlwZT10K3RoaXMucGFydGlhbENvdW50OnRoaXMudHlwZT10fWdldCBwYXJ0aWFsQ291bnQoKXtyZXR1cm4gdGhpcy5fcGFydGlhbENvdW50fXNldCBwYXJ0aWFsQ291bnQodCl7ZWkodCwwKTtsZXQgZT10aGlzLl90eXBlO2NvbnN0IHM9L14oc2luZXx0cmlhbmdsZXxzcXVhcmV8c2F3dG9vdGgpKFxcZCspJC8uZXhlYyh0aGlzLl90eXBlKTtpZihzJiYoZT1zWzFdKSxcImN1c3RvbVwiIT09dGhpcy5fdHlwZSl0aGlzLnR5cGU9MD09PXQ/ZTplK3QudG9TdHJpbmcoKTtlbHNle2NvbnN0IGU9bmV3IEZsb2F0MzJBcnJheSh0KTt0aGlzLl9wYXJ0aWFscy5mb3JFYWNoKCh0LHMpPT5lW3NdPXQpLHRoaXMuX3BhcnRpYWxzPUFycmF5LmZyb20oZSksdGhpcy50eXBlPXRoaXMuX3R5cGV9fV9nZXRSZWFsSW1hZ2luYXJ5KHQsZSl7bGV0IHM9MjA0ODtjb25zdCBuPW5ldyBGbG9hdDMyQXJyYXkocyksaT1uZXcgRmxvYXQzMkFycmF5KHMpO2xldCBvPTE7aWYoXCJjdXN0b21cIj09PXQpe2lmKG89dGhpcy5fcGFydGlhbHMubGVuZ3RoKzEsdGhpcy5fcGFydGlhbENvdW50PXRoaXMuX3BhcnRpYWxzLmxlbmd0aCxzPW8sMD09PXRoaXMuX3BhcnRpYWxzLmxlbmd0aClyZXR1cm5bbixpXX1lbHNle2NvbnN0IGU9L14oc2luZXx0cmlhbmdsZXxzcXVhcmV8c2F3dG9vdGgpKFxcZCspJC8uZXhlYyh0KTtlPyhvPXBhcnNlSW50KGVbMl0sMTApKzEsdGhpcy5fcGFydGlhbENvdW50PXBhcnNlSW50KGVbMl0sMTApLHQ9ZVsxXSxvPU1hdGgubWF4KG8sMikscz1vKTp0aGlzLl9wYXJ0aWFsQ291bnQ9MCx0aGlzLl9wYXJ0aWFscz1bXX1mb3IobGV0IHI9MTtyPHM7KytyKXtjb25zdCBzPTIvKHIqTWF0aC5QSSk7bGV0IGE7c3dpdGNoKHQpe2Nhc2VcInNpbmVcIjphPXI8PW8/MTowLHRoaXMuX3BhcnRpYWxzW3ItMV09YTticmVhaztjYXNlXCJzcXVhcmVcIjphPTEmcj8yKnM6MCx0aGlzLl9wYXJ0aWFsc1tyLTFdPWE7YnJlYWs7Y2FzZVwic2F3dG9vdGhcIjphPXMqKDEmcj8xOi0xKSx0aGlzLl9wYXJ0aWFsc1tyLTFdPWE7YnJlYWs7Y2FzZVwidHJpYW5nbGVcIjphPTEmcj9zKnMqMiooci0xPj4xJjE/LTE6MSk6MCx0aGlzLl9wYXJ0aWFsc1tyLTFdPWE7YnJlYWs7Y2FzZVwiY3VzdG9tXCI6YT10aGlzLl9wYXJ0aWFsc1tyLTFdO2JyZWFrO2RlZmF1bHQ6dGhyb3cgbmV3IFR5cGVFcnJvcihcIk9zY2lsbGF0b3I6IGludmFsaWQgdHlwZTogXCIrdCl9MCE9PWE/KG5bcl09LWEqTWF0aC5zaW4oZSpyKSxpW3JdPWEqTWF0aC5jb3MoZSpyKSk6KG5bcl09MCxpW3JdPTApfXJldHVybltuLGldfV9pbnZlcnNlRkZUKHQsZSxzKXtsZXQgbj0wO2NvbnN0IGk9dC5sZW5ndGg7Zm9yKGxldCBvPTA7bzxpO28rKyluKz10W29dKk1hdGguY29zKG8qcykrZVtvXSpNYXRoLnNpbihvKnMpO3JldHVybiBufWdldEluaXRpYWxWYWx1ZSgpe2NvbnN0W3QsZV09dGhpcy5fZ2V0UmVhbEltYWdpbmFyeSh0aGlzLl90eXBlLDApO2xldCBzPTA7Y29uc3Qgbj0yKk1hdGguUEk7Zm9yKGxldCBpPTA7aTwzMjtpKyspcz1NYXRoLm1heCh0aGlzLl9pbnZlcnNlRkZUKHQsZSxpLzMyKm4pLHMpO3JldHVybiBWaSgtdGhpcy5faW52ZXJzZUZGVCh0LGUsdGhpcy5fcGhhc2UpL3MsLTEsMSl9Z2V0IHBhcnRpYWxzKCl7cmV0dXJuIHRoaXMuX3BhcnRpYWxzLnNsaWNlKDAsdGhpcy5wYXJ0aWFsQ291bnQpfXNldCBwYXJ0aWFscyh0KXt0aGlzLl9wYXJ0aWFscz10LHRoaXMuX3BhcnRpYWxDb3VudD10aGlzLl9wYXJ0aWFscy5sZW5ndGgsdC5sZW5ndGgmJih0aGlzLnR5cGU9XCJjdXN0b21cIil9Z2V0IHBoYXNlKCl7cmV0dXJuIHRoaXMuX3BoYXNlKigxODAvTWF0aC5QSSl9c2V0IHBoYXNlKHQpe3RoaXMuX3BoYXNlPXQqTWF0aC5QSS8xODAsdGhpcy50eXBlPXRoaXMuX3R5cGV9YXNBcnJheSh0PTEwMjQpe3JldHVybiB5aSh0aGlzLHZvaWQgMCx2b2lkIDAsKGZ1bmN0aW9uKigpe3JldHVybiBzcih0aGlzLHQpfSkpfWRpc3Bvc2UoKXtyZXR1cm4gc3VwZXIuZGlzcG9zZSgpLG51bGwhPT10aGlzLl9vc2NpbGxhdG9yJiZ0aGlzLl9vc2NpbGxhdG9yLmRpc3Bvc2UoKSx0aGlzLl93YXZlPXZvaWQgMCx0aGlzLmZyZXF1ZW5jeS5kaXNwb3NlKCksdGhpcy5kZXR1bmUuZGlzcG9zZSgpLHRoaXN9fWlyLl9wZXJpb2RpY1dhdmVDYWNoZT1bXTtjbGFzcyBvciBleHRlbmRzIHdve2NvbnN0cnVjdG9yKCl7c3VwZXIoT2JqZWN0LmFzc2lnbihEaShvci5nZXREZWZhdWx0cygpLGFyZ3VtZW50cyxbXCJjb250ZXh0XCJdKSkpfWNvbm5lY3QodCxlPTAscz0wKXtyZXR1cm4gT28odGhpcyx0LGUscyksdGhpc319Y2xhc3MgcnIgZXh0ZW5kcyBvcntjb25zdHJ1Y3Rvcigpe3N1cGVyKE9iamVjdC5hc3NpZ24oRGkocnIuZ2V0RGVmYXVsdHMoKSxhcmd1bWVudHMsW1wibWFwcGluZ1wiLFwibGVuZ3RoXCJdKSkpLHRoaXMubmFtZT1cIldhdmVTaGFwZXJcIix0aGlzLl9zaGFwZXI9dGhpcy5jb250ZXh0LmNyZWF0ZVdhdmVTaGFwZXIoKSx0aGlzLmlucHV0PXRoaXMuX3NoYXBlcix0aGlzLm91dHB1dD10aGlzLl9zaGFwZXI7Y29uc3QgdD1EaShyci5nZXREZWZhdWx0cygpLGFyZ3VtZW50cyxbXCJtYXBwaW5nXCIsXCJsZW5ndGhcIl0pO2RpKHQubWFwcGluZyl8fHQubWFwcGluZyBpbnN0YW5jZW9mIEZsb2F0MzJBcnJheT90aGlzLmN1cnZlPUZsb2F0MzJBcnJheS5mcm9tKHQubWFwcGluZyk6aGkodC5tYXBwaW5nKSYmdGhpcy5zZXRNYXAodC5tYXBwaW5nLHQubGVuZ3RoKX1zdGF0aWMgZ2V0RGVmYXVsdHMoKXtyZXR1cm4gT2JqZWN0LmFzc2lnbihEby5nZXREZWZhdWx0cygpLHtsZW5ndGg6MTAyNH0pfXNldE1hcCh0LGU9MTAyNCl7Y29uc3Qgcz1uZXcgRmxvYXQzMkFycmF5KGUpO2ZvcihsZXQgbj0wLGk9ZTtuPGk7bisrKXtjb25zdCBlPW4vKGktMSkqMi0xO3Nbbl09dChlLG4pfXJldHVybiB0aGlzLmN1cnZlPXMsdGhpc31nZXQgY3VydmUoKXtyZXR1cm4gdGhpcy5fc2hhcGVyLmN1cnZlfXNldCBjdXJ2ZSh0KXt0aGlzLl9zaGFwZXIuY3VydmU9dH1nZXQgb3ZlcnNhbXBsZSgpe3JldHVybiB0aGlzLl9zaGFwZXIub3ZlcnNhbXBsZX1zZXQgb3ZlcnNhbXBsZSh0KXt0aShbXCJub25lXCIsXCIyeFwiLFwiNHhcIl0uc29tZShlPT5lLmluY2x1ZGVzKHQpKSxcIm92ZXJzYW1wbGluZyBtdXN0IGJlIGVpdGhlciAnbm9uZScsICcyeCcsIG9yICc0eCdcIiksdGhpcy5fc2hhcGVyLm92ZXJzYW1wbGU9dH1kaXNwb3NlKCl7cmV0dXJuIHN1cGVyLmRpc3Bvc2UoKSx0aGlzLl9zaGFwZXIuZGlzY29ubmVjdCgpLHRoaXN9fWNsYXNzIGFyIGV4dGVuZHMgb3J7Y29uc3RydWN0b3IoKXtzdXBlciguLi5hcmd1bWVudHMpLHRoaXMubmFtZT1cIkF1ZGlvVG9HYWluXCIsdGhpcy5fbm9ybT1uZXcgcnIoe2NvbnRleHQ6dGhpcy5jb250ZXh0LG1hcHBpbmc6dD0+KHQrMSkvMn0pLHRoaXMuaW5wdXQ9dGhpcy5fbm9ybSx0aGlzLm91dHB1dD10aGlzLl9ub3JtfWRpc3Bvc2UoKXtyZXR1cm4gc3VwZXIuZGlzcG9zZSgpLHRoaXMuX25vcm0uZGlzcG9zZSgpLHRoaXN9fWNsYXNzIGNyIGV4dGVuZHMgRG97Y29uc3RydWN0b3IoKXtzdXBlcihPYmplY3QuYXNzaWduKERpKGNyLmdldERlZmF1bHRzKCksYXJndW1lbnRzLFtcInZhbHVlXCJdKSkpLHRoaXMubmFtZT1cIk11bHRpcGx5XCIsdGhpcy5vdmVycmlkZT0hMTtjb25zdCB0PURpKGNyLmdldERlZmF1bHRzKCksYXJndW1lbnRzLFtcInZhbHVlXCJdKTt0aGlzLl9tdWx0PXRoaXMuaW5wdXQ9dGhpcy5vdXRwdXQ9bmV3IGtvKHtjb250ZXh0OnRoaXMuY29udGV4dCxtaW5WYWx1ZTp0Lm1pblZhbHVlLG1heFZhbHVlOnQubWF4VmFsdWV9KSx0aGlzLmZhY3Rvcj10aGlzLl9wYXJhbT10aGlzLl9tdWx0LmdhaW4sdGhpcy5mYWN0b3Iuc2V0VmFsdWVBdFRpbWUodC52YWx1ZSwwKX1zdGF0aWMgZ2V0RGVmYXVsdHMoKXtyZXR1cm4gT2JqZWN0LmFzc2lnbihEby5nZXREZWZhdWx0cygpLHt2YWx1ZTowfSl9ZGlzcG9zZSgpe3JldHVybiBzdXBlci5kaXNwb3NlKCksdGhpcy5fbXVsdC5kaXNwb3NlKCksdGhpc319Y2xhc3MgaHIgZXh0ZW5kcyBIb3tjb25zdHJ1Y3Rvcigpe3N1cGVyKERpKGhyLmdldERlZmF1bHRzKCksYXJndW1lbnRzLFtcImZyZXF1ZW5jeVwiLFwidHlwZVwiLFwibW9kdWxhdGlvblR5cGVcIl0pKSx0aGlzLm5hbWU9XCJBTU9zY2lsbGF0b3JcIix0aGlzLl9tb2R1bGF0aW9uU2NhbGU9bmV3IGFyKHtjb250ZXh0OnRoaXMuY29udGV4dH0pLHRoaXMuX21vZHVsYXRpb25Ob2RlPW5ldyBrbyh7Y29udGV4dDp0aGlzLmNvbnRleHR9KTtjb25zdCB0PURpKGhyLmdldERlZmF1bHRzKCksYXJndW1lbnRzLFtcImZyZXF1ZW5jeVwiLFwidHlwZVwiLFwibW9kdWxhdGlvblR5cGVcIl0pO3RoaXMuX2NhcnJpZXI9bmV3IGlyKHtjb250ZXh0OnRoaXMuY29udGV4dCxkZXR1bmU6dC5kZXR1bmUsZnJlcXVlbmN5OnQuZnJlcXVlbmN5LG9uc3RvcDooKT0+dGhpcy5vbnN0b3AodGhpcykscGhhc2U6dC5waGFzZSx0eXBlOnQudHlwZX0pLHRoaXMuZnJlcXVlbmN5PXRoaXMuX2NhcnJpZXIuZnJlcXVlbmN5LHRoaXMuZGV0dW5lPXRoaXMuX2NhcnJpZXIuZGV0dW5lLHRoaXMuX21vZHVsYXRvcj1uZXcgaXIoe2NvbnRleHQ6dGhpcy5jb250ZXh0LHBoYXNlOnQucGhhc2UsdHlwZTp0Lm1vZHVsYXRpb25UeXBlfSksdGhpcy5oYXJtb25pY2l0eT1uZXcgY3Ioe2NvbnRleHQ6dGhpcy5jb250ZXh0LHVuaXRzOlwicG9zaXRpdmVcIix2YWx1ZTp0Lmhhcm1vbmljaXR5fSksdGhpcy5mcmVxdWVuY3kuY2hhaW4odGhpcy5oYXJtb25pY2l0eSx0aGlzLl9tb2R1bGF0b3IuZnJlcXVlbmN5KSx0aGlzLl9tb2R1bGF0b3IuY2hhaW4odGhpcy5fbW9kdWxhdGlvblNjYWxlLHRoaXMuX21vZHVsYXRpb25Ob2RlLmdhaW4pLHRoaXMuX2NhcnJpZXIuY2hhaW4odGhpcy5fbW9kdWxhdGlvbk5vZGUsdGhpcy5vdXRwdXQpLFVpKHRoaXMsW1wiZnJlcXVlbmN5XCIsXCJkZXR1bmVcIixcImhhcm1vbmljaXR5XCJdKX1zdGF0aWMgZ2V0RGVmYXVsdHMoKXtyZXR1cm4gT2JqZWN0LmFzc2lnbihpci5nZXREZWZhdWx0cygpLHtoYXJtb25pY2l0eToxLG1vZHVsYXRpb25UeXBlOlwic3F1YXJlXCJ9KX1fc3RhcnQodCl7dGhpcy5fbW9kdWxhdG9yLnN0YXJ0KHQpLHRoaXMuX2NhcnJpZXIuc3RhcnQodCl9X3N0b3AodCl7dGhpcy5fbW9kdWxhdG9yLnN0b3AodCksdGhpcy5fY2Fycmllci5zdG9wKHQpfV9yZXN0YXJ0KHQpe3RoaXMuX21vZHVsYXRvci5yZXN0YXJ0KHQpLHRoaXMuX2NhcnJpZXIucmVzdGFydCh0KX1nZXQgdHlwZSgpe3JldHVybiB0aGlzLl9jYXJyaWVyLnR5cGV9c2V0IHR5cGUodCl7dGhpcy5fY2Fycmllci50eXBlPXR9Z2V0IGJhc2VUeXBlKCl7cmV0dXJuIHRoaXMuX2NhcnJpZXIuYmFzZVR5cGV9c2V0IGJhc2VUeXBlKHQpe3RoaXMuX2NhcnJpZXIuYmFzZVR5cGU9dH1nZXQgcGFydGlhbENvdW50KCl7cmV0dXJuIHRoaXMuX2NhcnJpZXIucGFydGlhbENvdW50fXNldCBwYXJ0aWFsQ291bnQodCl7dGhpcy5fY2Fycmllci5wYXJ0aWFsQ291bnQ9dH1nZXQgbW9kdWxhdGlvblR5cGUoKXtyZXR1cm4gdGhpcy5fbW9kdWxhdG9yLnR5cGV9c2V0IG1vZHVsYXRpb25UeXBlKHQpe3RoaXMuX21vZHVsYXRvci50eXBlPXR9Z2V0IHBoYXNlKCl7cmV0dXJuIHRoaXMuX2NhcnJpZXIucGhhc2V9c2V0IHBoYXNlKHQpe3RoaXMuX2NhcnJpZXIucGhhc2U9dCx0aGlzLl9tb2R1bGF0b3IucGhhc2U9dH1nZXQgcGFydGlhbHMoKXtyZXR1cm4gdGhpcy5fY2Fycmllci5wYXJ0aWFsc31zZXQgcGFydGlhbHModCl7dGhpcy5fY2Fycmllci5wYXJ0aWFscz10fWFzQXJyYXkodD0xMDI0KXtyZXR1cm4geWkodGhpcyx2b2lkIDAsdm9pZCAwLChmdW5jdGlvbiooKXtyZXR1cm4gc3IodGhpcyx0KX0pKX1kaXNwb3NlKCl7cmV0dXJuIHN1cGVyLmRpc3Bvc2UoKSx0aGlzLmZyZXF1ZW5jeS5kaXNwb3NlKCksdGhpcy5kZXR1bmUuZGlzcG9zZSgpLHRoaXMuaGFybW9uaWNpdHkuZGlzcG9zZSgpLHRoaXMuX2NhcnJpZXIuZGlzcG9zZSgpLHRoaXMuX21vZHVsYXRvci5kaXNwb3NlKCksdGhpcy5fbW9kdWxhdGlvbk5vZGUuZGlzcG9zZSgpLHRoaXMuX21vZHVsYXRpb25TY2FsZS5kaXNwb3NlKCksdGhpc319Y2xhc3MgdXIgZXh0ZW5kcyBIb3tjb25zdHJ1Y3Rvcigpe3N1cGVyKERpKHVyLmdldERlZmF1bHRzKCksYXJndW1lbnRzLFtcImZyZXF1ZW5jeVwiLFwidHlwZVwiLFwibW9kdWxhdGlvblR5cGVcIl0pKSx0aGlzLm5hbWU9XCJGTU9zY2lsbGF0b3JcIix0aGlzLl9tb2R1bGF0aW9uTm9kZT1uZXcga28oe2NvbnRleHQ6dGhpcy5jb250ZXh0LGdhaW46MH0pO2NvbnN0IHQ9RGkodXIuZ2V0RGVmYXVsdHMoKSxhcmd1bWVudHMsW1wiZnJlcXVlbmN5XCIsXCJ0eXBlXCIsXCJtb2R1bGF0aW9uVHlwZVwiXSk7dGhpcy5fY2Fycmllcj1uZXcgaXIoe2NvbnRleHQ6dGhpcy5jb250ZXh0LGRldHVuZTp0LmRldHVuZSxmcmVxdWVuY3k6MCxvbnN0b3A6KCk9PnRoaXMub25zdG9wKHRoaXMpLHBoYXNlOnQucGhhc2UsdHlwZTp0LnR5cGV9KSx0aGlzLmRldHVuZT10aGlzLl9jYXJyaWVyLmRldHVuZSx0aGlzLmZyZXF1ZW5jeT1uZXcgRG8oe2NvbnRleHQ6dGhpcy5jb250ZXh0LHVuaXRzOlwiZnJlcXVlbmN5XCIsdmFsdWU6dC5mcmVxdWVuY3l9KSx0aGlzLl9tb2R1bGF0b3I9bmV3IGlyKHtjb250ZXh0OnRoaXMuY29udGV4dCxwaGFzZTp0LnBoYXNlLHR5cGU6dC5tb2R1bGF0aW9uVHlwZX0pLHRoaXMuaGFybW9uaWNpdHk9bmV3IGNyKHtjb250ZXh0OnRoaXMuY29udGV4dCx1bml0czpcInBvc2l0aXZlXCIsdmFsdWU6dC5oYXJtb25pY2l0eX0pLHRoaXMubW9kdWxhdGlvbkluZGV4PW5ldyBjcih7Y29udGV4dDp0aGlzLmNvbnRleHQsdW5pdHM6XCJwb3NpdGl2ZVwiLHZhbHVlOnQubW9kdWxhdGlvbkluZGV4fSksdGhpcy5mcmVxdWVuY3kuY29ubmVjdCh0aGlzLl9jYXJyaWVyLmZyZXF1ZW5jeSksdGhpcy5mcmVxdWVuY3kuY2hhaW4odGhpcy5oYXJtb25pY2l0eSx0aGlzLl9tb2R1bGF0b3IuZnJlcXVlbmN5KSx0aGlzLmZyZXF1ZW5jeS5jaGFpbih0aGlzLm1vZHVsYXRpb25JbmRleCx0aGlzLl9tb2R1bGF0aW9uTm9kZSksdGhpcy5fbW9kdWxhdG9yLmNvbm5lY3QodGhpcy5fbW9kdWxhdGlvbk5vZGUuZ2FpbiksdGhpcy5fbW9kdWxhdGlvbk5vZGUuY29ubmVjdCh0aGlzLl9jYXJyaWVyLmZyZXF1ZW5jeSksdGhpcy5fY2Fycmllci5jb25uZWN0KHRoaXMub3V0cHV0KSx0aGlzLmRldHVuZS5jb25uZWN0KHRoaXMuX21vZHVsYXRvci5kZXR1bmUpLFVpKHRoaXMsW1wibW9kdWxhdGlvbkluZGV4XCIsXCJmcmVxdWVuY3lcIixcImRldHVuZVwiLFwiaGFybW9uaWNpdHlcIl0pfXN0YXRpYyBnZXREZWZhdWx0cygpe3JldHVybiBPYmplY3QuYXNzaWduKGlyLmdldERlZmF1bHRzKCkse2hhcm1vbmljaXR5OjEsbW9kdWxhdGlvbkluZGV4OjIsbW9kdWxhdGlvblR5cGU6XCJzcXVhcmVcIn0pfV9zdGFydCh0KXt0aGlzLl9tb2R1bGF0b3Iuc3RhcnQodCksdGhpcy5fY2Fycmllci5zdGFydCh0KX1fc3RvcCh0KXt0aGlzLl9tb2R1bGF0b3Iuc3RvcCh0KSx0aGlzLl9jYXJyaWVyLnN0b3AodCl9X3Jlc3RhcnQodCl7cmV0dXJuIHRoaXMuX21vZHVsYXRvci5yZXN0YXJ0KHQpLHRoaXMuX2NhcnJpZXIucmVzdGFydCh0KSx0aGlzfWdldCB0eXBlKCl7cmV0dXJuIHRoaXMuX2NhcnJpZXIudHlwZX1zZXQgdHlwZSh0KXt0aGlzLl9jYXJyaWVyLnR5cGU9dH1nZXQgYmFzZVR5cGUoKXtyZXR1cm4gdGhpcy5fY2Fycmllci5iYXNlVHlwZX1zZXQgYmFzZVR5cGUodCl7dGhpcy5fY2Fycmllci5iYXNlVHlwZT10fWdldCBwYXJ0aWFsQ291bnQoKXtyZXR1cm4gdGhpcy5fY2Fycmllci5wYXJ0aWFsQ291bnR9c2V0IHBhcnRpYWxDb3VudCh0KXt0aGlzLl9jYXJyaWVyLnBhcnRpYWxDb3VudD10fWdldCBtb2R1bGF0aW9uVHlwZSgpe3JldHVybiB0aGlzLl9tb2R1bGF0b3IudHlwZX1zZXQgbW9kdWxhdGlvblR5cGUodCl7dGhpcy5fbW9kdWxhdG9yLnR5cGU9dH1nZXQgcGhhc2UoKXtyZXR1cm4gdGhpcy5fY2Fycmllci5waGFzZX1zZXQgcGhhc2UodCl7dGhpcy5fY2Fycmllci5waGFzZT10LHRoaXMuX21vZHVsYXRvci5waGFzZT10fWdldCBwYXJ0aWFscygpe3JldHVybiB0aGlzLl9jYXJyaWVyLnBhcnRpYWxzfXNldCBwYXJ0aWFscyh0KXt0aGlzLl9jYXJyaWVyLnBhcnRpYWxzPXR9YXNBcnJheSh0PTEwMjQpe3JldHVybiB5aSh0aGlzLHZvaWQgMCx2b2lkIDAsKGZ1bmN0aW9uKigpe3JldHVybiBzcih0aGlzLHQpfSkpfWRpc3Bvc2UoKXtyZXR1cm4gc3VwZXIuZGlzcG9zZSgpLHRoaXMuZnJlcXVlbmN5LmRpc3Bvc2UoKSx0aGlzLmhhcm1vbmljaXR5LmRpc3Bvc2UoKSx0aGlzLl9jYXJyaWVyLmRpc3Bvc2UoKSx0aGlzLl9tb2R1bGF0b3IuZGlzcG9zZSgpLHRoaXMuX21vZHVsYXRpb25Ob2RlLmRpc3Bvc2UoKSx0aGlzLm1vZHVsYXRpb25JbmRleC5kaXNwb3NlKCksdGhpc319Y2xhc3MgbHIgZXh0ZW5kcyBIb3tjb25zdHJ1Y3Rvcigpe3N1cGVyKERpKGxyLmdldERlZmF1bHRzKCksYXJndW1lbnRzLFtcImZyZXF1ZW5jeVwiLFwid2lkdGhcIl0pKSx0aGlzLm5hbWU9XCJQdWxzZU9zY2lsbGF0b3JcIix0aGlzLl93aWR0aEdhdGU9bmV3IGtvKHtjb250ZXh0OnRoaXMuY29udGV4dCxnYWluOjB9KSx0aGlzLl90aHJlc2g9bmV3IHJyKHtjb250ZXh0OnRoaXMuY29udGV4dCxtYXBwaW5nOnQ9PnQ8PTA/LTE6MX0pO2NvbnN0IHQ9RGkobHIuZ2V0RGVmYXVsdHMoKSxhcmd1bWVudHMsW1wiZnJlcXVlbmN5XCIsXCJ3aWR0aFwiXSk7dGhpcy53aWR0aD1uZXcgRG8oe2NvbnRleHQ6dGhpcy5jb250ZXh0LHVuaXRzOlwiYXVkaW9SYW5nZVwiLHZhbHVlOnQud2lkdGh9KSx0aGlzLl90cmlhbmdsZT1uZXcgaXIoe2NvbnRleHQ6dGhpcy5jb250ZXh0LGRldHVuZTp0LmRldHVuZSxmcmVxdWVuY3k6dC5mcmVxdWVuY3ksb25zdG9wOigpPT50aGlzLm9uc3RvcCh0aGlzKSxwaGFzZTp0LnBoYXNlLHR5cGU6XCJ0cmlhbmdsZVwifSksdGhpcy5mcmVxdWVuY3k9dGhpcy5fdHJpYW5nbGUuZnJlcXVlbmN5LHRoaXMuZGV0dW5lPXRoaXMuX3RyaWFuZ2xlLmRldHVuZSx0aGlzLl90cmlhbmdsZS5jaGFpbih0aGlzLl90aHJlc2gsdGhpcy5vdXRwdXQpLHRoaXMud2lkdGguY2hhaW4odGhpcy5fd2lkdGhHYXRlLHRoaXMuX3RocmVzaCksVWkodGhpcyxbXCJ3aWR0aFwiLFwiZnJlcXVlbmN5XCIsXCJkZXR1bmVcIl0pfXN0YXRpYyBnZXREZWZhdWx0cygpe3JldHVybiBPYmplY3QuYXNzaWduKEhvLmdldERlZmF1bHRzKCkse2RldHVuZTowLGZyZXF1ZW5jeTo0NDAscGhhc2U6MCx0eXBlOlwicHVsc2VcIix3aWR0aDouMn0pfV9zdGFydCh0KXt0PXRoaXMudG9TZWNvbmRzKHQpLHRoaXMuX3RyaWFuZ2xlLnN0YXJ0KHQpLHRoaXMuX3dpZHRoR2F0ZS5nYWluLnNldFZhbHVlQXRUaW1lKDEsdCl9X3N0b3AodCl7dD10aGlzLnRvU2Vjb25kcyh0KSx0aGlzLl90cmlhbmdsZS5zdG9wKHQpLHRoaXMuX3dpZHRoR2F0ZS5nYWluLmNhbmNlbFNjaGVkdWxlZFZhbHVlcyh0KSx0aGlzLl93aWR0aEdhdGUuZ2Fpbi5zZXRWYWx1ZUF0VGltZSgwLHQpfV9yZXN0YXJ0KHQpe3RoaXMuX3RyaWFuZ2xlLnJlc3RhcnQodCksdGhpcy5fd2lkdGhHYXRlLmdhaW4uY2FuY2VsU2NoZWR1bGVkVmFsdWVzKHQpLHRoaXMuX3dpZHRoR2F0ZS5nYWluLnNldFZhbHVlQXRUaW1lKDEsdCl9Z2V0IHBoYXNlKCl7cmV0dXJuIHRoaXMuX3RyaWFuZ2xlLnBoYXNlfXNldCBwaGFzZSh0KXt0aGlzLl90cmlhbmdsZS5waGFzZT10fWdldCB0eXBlKCl7cmV0dXJuXCJwdWxzZVwifWdldCBiYXNlVHlwZSgpe3JldHVyblwicHVsc2VcIn1nZXQgcGFydGlhbHMoKXtyZXR1cm5bXX1nZXQgcGFydGlhbENvdW50KCl7cmV0dXJuIDB9c2V0IGNhcnJpZXJUeXBlKHQpe3RoaXMuX3RyaWFuZ2xlLnR5cGU9dH1hc0FycmF5KHQ9MTAyNCl7cmV0dXJuIHlpKHRoaXMsdm9pZCAwLHZvaWQgMCwoZnVuY3Rpb24qKCl7cmV0dXJuIHNyKHRoaXMsdCl9KSl9ZGlzcG9zZSgpe3JldHVybiBzdXBlci5kaXNwb3NlKCksdGhpcy5fdHJpYW5nbGUuZGlzcG9zZSgpLHRoaXMud2lkdGguZGlzcG9zZSgpLHRoaXMuX3dpZHRoR2F0ZS5kaXNwb3NlKCksdGhpcy5fdGhyZXNoLmRpc3Bvc2UoKSx0aGlzfX1jbGFzcyBwciBleHRlbmRzIEhve2NvbnN0cnVjdG9yKCl7c3VwZXIoRGkocHIuZ2V0RGVmYXVsdHMoKSxhcmd1bWVudHMsW1wiZnJlcXVlbmN5XCIsXCJ0eXBlXCIsXCJzcHJlYWRcIl0pKSx0aGlzLm5hbWU9XCJGYXRPc2NpbGxhdG9yXCIsdGhpcy5fb3NjaWxsYXRvcnM9W107Y29uc3QgdD1EaShwci5nZXREZWZhdWx0cygpLGFyZ3VtZW50cyxbXCJmcmVxdWVuY3lcIixcInR5cGVcIixcInNwcmVhZFwiXSk7dGhpcy5mcmVxdWVuY3k9bmV3IERvKHtjb250ZXh0OnRoaXMuY29udGV4dCx1bml0czpcImZyZXF1ZW5jeVwiLHZhbHVlOnQuZnJlcXVlbmN5fSksdGhpcy5kZXR1bmU9bmV3IERvKHtjb250ZXh0OnRoaXMuY29udGV4dCx1bml0czpcImNlbnRzXCIsdmFsdWU6dC5kZXR1bmV9KSx0aGlzLl9zcHJlYWQ9dC5zcHJlYWQsdGhpcy5fdHlwZT10LnR5cGUsdGhpcy5fcGhhc2U9dC5waGFzZSx0aGlzLl9wYXJ0aWFscz10LnBhcnRpYWxzLHRoaXMuX3BhcnRpYWxDb3VudD10LnBhcnRpYWxDb3VudCx0aGlzLmNvdW50PXQuY291bnQsVWkodGhpcyxbXCJmcmVxdWVuY3lcIixcImRldHVuZVwiXSl9c3RhdGljIGdldERlZmF1bHRzKCl7cmV0dXJuIE9iamVjdC5hc3NpZ24oaXIuZ2V0RGVmYXVsdHMoKSx7Y291bnQ6MyxzcHJlYWQ6MjAsdHlwZTpcInNhd3Rvb3RoXCJ9KX1fc3RhcnQodCl7dD10aGlzLnRvU2Vjb25kcyh0KSx0aGlzLl9mb3JFYWNoKGU9PmUuc3RhcnQodCkpfV9zdG9wKHQpe3Q9dGhpcy50b1NlY29uZHModCksdGhpcy5fZm9yRWFjaChlPT5lLnN0b3AodCkpfV9yZXN0YXJ0KHQpe3RoaXMuX2ZvckVhY2goZT0+ZS5yZXN0YXJ0KHQpKX1fZm9yRWFjaCh0KXtmb3IobGV0IGU9MDtlPHRoaXMuX29zY2lsbGF0b3JzLmxlbmd0aDtlKyspdCh0aGlzLl9vc2NpbGxhdG9yc1tlXSxlKX1nZXQgdHlwZSgpe3JldHVybiB0aGlzLl90eXBlfXNldCB0eXBlKHQpe3RoaXMuX3R5cGU9dCx0aGlzLl9mb3JFYWNoKGU9PmUudHlwZT10KX1nZXQgc3ByZWFkKCl7cmV0dXJuIHRoaXMuX3NwcmVhZH1zZXQgc3ByZWFkKHQpe2lmKHRoaXMuX3NwcmVhZD10LHRoaXMuX29zY2lsbGF0b3JzLmxlbmd0aD4xKXtjb25zdCBlPS10LzIscz10Lyh0aGlzLl9vc2NpbGxhdG9ycy5sZW5ndGgtMSk7dGhpcy5fZm9yRWFjaCgodCxuKT0+dC5kZXR1bmUudmFsdWU9ZStzKm4pfX1nZXQgY291bnQoKXtyZXR1cm4gdGhpcy5fb3NjaWxsYXRvcnMubGVuZ3RofXNldCBjb3VudCh0KXtpZihlaSh0LDEpLHRoaXMuX29zY2lsbGF0b3JzLmxlbmd0aCE9PXQpe3RoaXMuX2ZvckVhY2godD0+dC5kaXNwb3NlKCkpLHRoaXMuX29zY2lsbGF0b3JzPVtdO2ZvcihsZXQgZT0wO2U8dDtlKyspe2NvbnN0IHM9bmV3IGlyKHtjb250ZXh0OnRoaXMuY29udGV4dCx2b2x1bWU6LTYtMS4xKnQsdHlwZTp0aGlzLl90eXBlLHBoYXNlOnRoaXMuX3BoYXNlK2UvdCozNjAscGFydGlhbENvdW50OnRoaXMuX3BhcnRpYWxDb3VudCxvbnN0b3A6MD09PWU/KCk9PnRoaXMub25zdG9wKHRoaXMpOlppfSk7XCJjdXN0b21cIj09PXRoaXMudHlwZSYmKHMucGFydGlhbHM9dGhpcy5fcGFydGlhbHMpLHRoaXMuZnJlcXVlbmN5LmNvbm5lY3Qocy5mcmVxdWVuY3kpLHRoaXMuZGV0dW5lLmNvbm5lY3Qocy5kZXR1bmUpLHMuZGV0dW5lLm92ZXJyaWRkZW49ITEscy5jb25uZWN0KHRoaXMub3V0cHV0KSx0aGlzLl9vc2NpbGxhdG9yc1tlXT1zfXRoaXMuc3ByZWFkPXRoaXMuX3NwcmVhZCxcInN0YXJ0ZWRcIj09PXRoaXMuc3RhdGUmJnRoaXMuX2ZvckVhY2godD0+dC5zdGFydCgpKX19Z2V0IHBoYXNlKCl7cmV0dXJuIHRoaXMuX3BoYXNlfXNldCBwaGFzZSh0KXt0aGlzLl9waGFzZT10LHRoaXMuX2ZvckVhY2goKHQsZSk9PnQucGhhc2U9dGhpcy5fcGhhc2UrZS90aGlzLmNvdW50KjM2MCl9Z2V0IGJhc2VUeXBlKCl7cmV0dXJuIHRoaXMuX29zY2lsbGF0b3JzWzBdLmJhc2VUeXBlfXNldCBiYXNlVHlwZSh0KXt0aGlzLl9mb3JFYWNoKGU9PmUuYmFzZVR5cGU9dCksdGhpcy5fdHlwZT10aGlzLl9vc2NpbGxhdG9yc1swXS50eXBlfWdldCBwYXJ0aWFscygpe3JldHVybiB0aGlzLl9vc2NpbGxhdG9yc1swXS5wYXJ0aWFsc31zZXQgcGFydGlhbHModCl7dGhpcy5fcGFydGlhbHM9dCx0aGlzLl9wYXJ0aWFsQ291bnQ9dGhpcy5fcGFydGlhbHMubGVuZ3RoLHQubGVuZ3RoJiYodGhpcy5fdHlwZT1cImN1c3RvbVwiLHRoaXMuX2ZvckVhY2goZT0+ZS5wYXJ0aWFscz10KSl9Z2V0IHBhcnRpYWxDb3VudCgpe3JldHVybiB0aGlzLl9vc2NpbGxhdG9yc1swXS5wYXJ0aWFsQ291bnR9c2V0IHBhcnRpYWxDb3VudCh0KXt0aGlzLl9wYXJ0aWFsQ291bnQ9dCx0aGlzLl9mb3JFYWNoKGU9PmUucGFydGlhbENvdW50PXQpLHRoaXMuX3R5cGU9dGhpcy5fb3NjaWxsYXRvcnNbMF0udHlwZX1hc0FycmF5KHQ9MTAyNCl7cmV0dXJuIHlpKHRoaXMsdm9pZCAwLHZvaWQgMCwoZnVuY3Rpb24qKCl7cmV0dXJuIHNyKHRoaXMsdCl9KSl9ZGlzcG9zZSgpe3JldHVybiBzdXBlci5kaXNwb3NlKCksdGhpcy5mcmVxdWVuY3kuZGlzcG9zZSgpLHRoaXMuZGV0dW5lLmRpc3Bvc2UoKSx0aGlzLl9mb3JFYWNoKHQ9PnQuZGlzcG9zZSgpKSx0aGlzfX1jbGFzcyBkciBleHRlbmRzIEhve2NvbnN0cnVjdG9yKCl7c3VwZXIoRGkoZHIuZ2V0RGVmYXVsdHMoKSxhcmd1bWVudHMsW1wiZnJlcXVlbmN5XCIsXCJtb2R1bGF0aW9uRnJlcXVlbmN5XCJdKSksdGhpcy5uYW1lPVwiUFdNT3NjaWxsYXRvclwiLHRoaXMuc291cmNlVHlwZT1cInB3bVwiLHRoaXMuX3NjYWxlPW5ldyBjcih7Y29udGV4dDp0aGlzLmNvbnRleHQsdmFsdWU6Mn0pO2NvbnN0IHQ9RGkoZHIuZ2V0RGVmYXVsdHMoKSxhcmd1bWVudHMsW1wiZnJlcXVlbmN5XCIsXCJtb2R1bGF0aW9uRnJlcXVlbmN5XCJdKTt0aGlzLl9wdWxzZT1uZXcgbHIoe2NvbnRleHQ6dGhpcy5jb250ZXh0LGZyZXF1ZW5jeTp0Lm1vZHVsYXRpb25GcmVxdWVuY3l9KSx0aGlzLl9wdWxzZS5jYXJyaWVyVHlwZT1cInNpbmVcIix0aGlzLm1vZHVsYXRpb25GcmVxdWVuY3k9dGhpcy5fcHVsc2UuZnJlcXVlbmN5LHRoaXMuX21vZHVsYXRvcj1uZXcgaXIoe2NvbnRleHQ6dGhpcy5jb250ZXh0LGRldHVuZTp0LmRldHVuZSxmcmVxdWVuY3k6dC5mcmVxdWVuY3ksb25zdG9wOigpPT50aGlzLm9uc3RvcCh0aGlzKSxwaGFzZTp0LnBoYXNlfSksdGhpcy5mcmVxdWVuY3k9dGhpcy5fbW9kdWxhdG9yLmZyZXF1ZW5jeSx0aGlzLmRldHVuZT10aGlzLl9tb2R1bGF0b3IuZGV0dW5lLHRoaXMuX21vZHVsYXRvci5jaGFpbih0aGlzLl9zY2FsZSx0aGlzLl9wdWxzZS53aWR0aCksdGhpcy5fcHVsc2UuY29ubmVjdCh0aGlzLm91dHB1dCksVWkodGhpcyxbXCJtb2R1bGF0aW9uRnJlcXVlbmN5XCIsXCJmcmVxdWVuY3lcIixcImRldHVuZVwiXSl9c3RhdGljIGdldERlZmF1bHRzKCl7cmV0dXJuIE9iamVjdC5hc3NpZ24oSG8uZ2V0RGVmYXVsdHMoKSx7ZGV0dW5lOjAsZnJlcXVlbmN5OjQ0MCxtb2R1bGF0aW9uRnJlcXVlbmN5Oi40LHBoYXNlOjAsdHlwZTpcInB3bVwifSl9X3N0YXJ0KHQpe3Q9dGhpcy50b1NlY29uZHModCksdGhpcy5fbW9kdWxhdG9yLnN0YXJ0KHQpLHRoaXMuX3B1bHNlLnN0YXJ0KHQpfV9zdG9wKHQpe3Q9dGhpcy50b1NlY29uZHModCksdGhpcy5fbW9kdWxhdG9yLnN0b3AodCksdGhpcy5fcHVsc2Uuc3RvcCh0KX1fcmVzdGFydCh0KXt0aGlzLl9tb2R1bGF0b3IucmVzdGFydCh0KSx0aGlzLl9wdWxzZS5yZXN0YXJ0KHQpfWdldCB0eXBlKCl7cmV0dXJuXCJwd21cIn1nZXQgYmFzZVR5cGUoKXtyZXR1cm5cInB3bVwifWdldCBwYXJ0aWFscygpe3JldHVybltdfWdldCBwYXJ0aWFsQ291bnQoKXtyZXR1cm4gMH1nZXQgcGhhc2UoKXtyZXR1cm4gdGhpcy5fbW9kdWxhdG9yLnBoYXNlfXNldCBwaGFzZSh0KXt0aGlzLl9tb2R1bGF0b3IucGhhc2U9dH1hc0FycmF5KHQ9MTAyNCl7cmV0dXJuIHlpKHRoaXMsdm9pZCAwLHZvaWQgMCwoZnVuY3Rpb24qKCl7cmV0dXJuIHNyKHRoaXMsdCl9KSl9ZGlzcG9zZSgpe3JldHVybiBzdXBlci5kaXNwb3NlKCksdGhpcy5fcHVsc2UuZGlzcG9zZSgpLHRoaXMuX3NjYWxlLmRpc3Bvc2UoKSx0aGlzLl9tb2R1bGF0b3IuZGlzcG9zZSgpLHRoaXN9fWNvbnN0IGZyPXthbTpocixmYXQ6cHIsZm06dXIsb3NjaWxsYXRvcjppcixwdWxzZTpscixwd206ZHJ9O2NsYXNzIF9yIGV4dGVuZHMgSG97Y29uc3RydWN0b3IoKXtzdXBlcihEaShfci5nZXREZWZhdWx0cygpLGFyZ3VtZW50cyxbXCJmcmVxdWVuY3lcIixcInR5cGVcIl0pKSx0aGlzLm5hbWU9XCJPbW5pT3NjaWxsYXRvclwiO2NvbnN0IHQ9RGkoX3IuZ2V0RGVmYXVsdHMoKSxhcmd1bWVudHMsW1wiZnJlcXVlbmN5XCIsXCJ0eXBlXCJdKTt0aGlzLmZyZXF1ZW5jeT1uZXcgRG8oe2NvbnRleHQ6dGhpcy5jb250ZXh0LHVuaXRzOlwiZnJlcXVlbmN5XCIsdmFsdWU6dC5mcmVxdWVuY3l9KSx0aGlzLmRldHVuZT1uZXcgRG8oe2NvbnRleHQ6dGhpcy5jb250ZXh0LHVuaXRzOlwiY2VudHNcIix2YWx1ZTp0LmRldHVuZX0pLFVpKHRoaXMsW1wiZnJlcXVlbmN5XCIsXCJkZXR1bmVcIl0pLHRoaXMuc2V0KHQpfXN0YXRpYyBnZXREZWZhdWx0cygpe3JldHVybiBPYmplY3QuYXNzaWduKGlyLmdldERlZmF1bHRzKCksdXIuZ2V0RGVmYXVsdHMoKSxoci5nZXREZWZhdWx0cygpLHByLmdldERlZmF1bHRzKCksbHIuZ2V0RGVmYXVsdHMoKSxkci5nZXREZWZhdWx0cygpKX1fc3RhcnQodCl7dGhpcy5fb3NjaWxsYXRvci5zdGFydCh0KX1fc3RvcCh0KXt0aGlzLl9vc2NpbGxhdG9yLnN0b3AodCl9X3Jlc3RhcnQodCl7cmV0dXJuIHRoaXMuX29zY2lsbGF0b3IucmVzdGFydCh0KSx0aGlzfWdldCB0eXBlKCl7bGV0IHQ9XCJcIjtyZXR1cm5bXCJhbVwiLFwiZm1cIixcImZhdFwiXS5zb21lKHQ9PnRoaXMuX3NvdXJjZVR5cGU9PT10KSYmKHQ9dGhpcy5fc291cmNlVHlwZSksdCt0aGlzLl9vc2NpbGxhdG9yLnR5cGV9c2V0IHR5cGUodCl7XCJmbVwiPT09dC5zdWJzdHIoMCwyKT8odGhpcy5fY3JlYXRlTmV3T3NjaWxsYXRvcihcImZtXCIpLHRoaXMuX29zY2lsbGF0b3I9dGhpcy5fb3NjaWxsYXRvcix0aGlzLl9vc2NpbGxhdG9yLnR5cGU9dC5zdWJzdHIoMikpOlwiYW1cIj09PXQuc3Vic3RyKDAsMik/KHRoaXMuX2NyZWF0ZU5ld09zY2lsbGF0b3IoXCJhbVwiKSx0aGlzLl9vc2NpbGxhdG9yPXRoaXMuX29zY2lsbGF0b3IsdGhpcy5fb3NjaWxsYXRvci50eXBlPXQuc3Vic3RyKDIpKTpcImZhdFwiPT09dC5zdWJzdHIoMCwzKT8odGhpcy5fY3JlYXRlTmV3T3NjaWxsYXRvcihcImZhdFwiKSx0aGlzLl9vc2NpbGxhdG9yPXRoaXMuX29zY2lsbGF0b3IsdGhpcy5fb3NjaWxsYXRvci50eXBlPXQuc3Vic3RyKDMpKTpcInB3bVwiPT09dD8odGhpcy5fY3JlYXRlTmV3T3NjaWxsYXRvcihcInB3bVwiKSx0aGlzLl9vc2NpbGxhdG9yPXRoaXMuX29zY2lsbGF0b3IpOlwicHVsc2VcIj09PXQ/dGhpcy5fY3JlYXRlTmV3T3NjaWxsYXRvcihcInB1bHNlXCIpOih0aGlzLl9jcmVhdGVOZXdPc2NpbGxhdG9yKFwib3NjaWxsYXRvclwiKSx0aGlzLl9vc2NpbGxhdG9yPXRoaXMuX29zY2lsbGF0b3IsdGhpcy5fb3NjaWxsYXRvci50eXBlPXQpfWdldCBwYXJ0aWFscygpe3JldHVybiB0aGlzLl9vc2NpbGxhdG9yLnBhcnRpYWxzfXNldCBwYXJ0aWFscyh0KXt0aGlzLl9nZXRPc2NUeXBlKHRoaXMuX29zY2lsbGF0b3IsXCJwdWxzZVwiKXx8dGhpcy5fZ2V0T3NjVHlwZSh0aGlzLl9vc2NpbGxhdG9yLFwicHdtXCIpfHwodGhpcy5fb3NjaWxsYXRvci5wYXJ0aWFscz10KX1nZXQgcGFydGlhbENvdW50KCl7cmV0dXJuIHRoaXMuX29zY2lsbGF0b3IucGFydGlhbENvdW50fXNldCBwYXJ0aWFsQ291bnQodCl7dGhpcy5fZ2V0T3NjVHlwZSh0aGlzLl9vc2NpbGxhdG9yLFwicHVsc2VcIil8fHRoaXMuX2dldE9zY1R5cGUodGhpcy5fb3NjaWxsYXRvcixcInB3bVwiKXx8KHRoaXMuX29zY2lsbGF0b3IucGFydGlhbENvdW50PXQpfXNldCh0KXtyZXR1cm4gUmVmbGVjdC5oYXModCxcInR5cGVcIikmJnQudHlwZSYmKHRoaXMudHlwZT10LnR5cGUpLHN1cGVyLnNldCh0KSx0aGlzfV9jcmVhdGVOZXdPc2NpbGxhdG9yKHQpe2lmKHQhPT10aGlzLl9zb3VyY2VUeXBlKXt0aGlzLl9zb3VyY2VUeXBlPXQ7Y29uc3QgZT1mclt0XSxzPXRoaXMubm93KCk7aWYodGhpcy5fb3NjaWxsYXRvcil7Y29uc3QgdD10aGlzLl9vc2NpbGxhdG9yO3Quc3RvcChzKSx0aGlzLmNvbnRleHQuc2V0VGltZW91dCgoKT0+dC5kaXNwb3NlKCksdGhpcy5ibG9ja1RpbWUpfXRoaXMuX29zY2lsbGF0b3I9bmV3IGUoe2NvbnRleHQ6dGhpcy5jb250ZXh0fSksdGhpcy5mcmVxdWVuY3kuY29ubmVjdCh0aGlzLl9vc2NpbGxhdG9yLmZyZXF1ZW5jeSksdGhpcy5kZXR1bmUuY29ubmVjdCh0aGlzLl9vc2NpbGxhdG9yLmRldHVuZSksdGhpcy5fb3NjaWxsYXRvci5jb25uZWN0KHRoaXMub3V0cHV0KSx0aGlzLl9vc2NpbGxhdG9yLm9uc3RvcD0oKT0+dGhpcy5vbnN0b3AodGhpcyksXCJzdGFydGVkXCI9PT10aGlzLnN0YXRlJiZ0aGlzLl9vc2NpbGxhdG9yLnN0YXJ0KHMpfX1nZXQgcGhhc2UoKXtyZXR1cm4gdGhpcy5fb3NjaWxsYXRvci5waGFzZX1zZXQgcGhhc2UodCl7dGhpcy5fb3NjaWxsYXRvci5waGFzZT10fWdldCBzb3VyY2VUeXBlKCl7cmV0dXJuIHRoaXMuX3NvdXJjZVR5cGV9c2V0IHNvdXJjZVR5cGUodCl7bGV0IGU9XCJzaW5lXCI7XCJwd21cIiE9PXRoaXMuX29zY2lsbGF0b3IudHlwZSYmXCJwdWxzZVwiIT09dGhpcy5fb3NjaWxsYXRvci50eXBlJiYoZT10aGlzLl9vc2NpbGxhdG9yLnR5cGUpLFwiZm1cIj09PXQ/dGhpcy50eXBlPVwiZm1cIitlOlwiYW1cIj09PXQ/dGhpcy50eXBlPVwiYW1cIitlOlwiZmF0XCI9PT10P3RoaXMudHlwZT1cImZhdFwiK2U6XCJvc2NpbGxhdG9yXCI9PT10P3RoaXMudHlwZT1lOlwicHVsc2VcIj09PXQ/dGhpcy50eXBlPVwicHVsc2VcIjpcInB3bVwiPT09dCYmKHRoaXMudHlwZT1cInB3bVwiKX1fZ2V0T3NjVHlwZSh0LGUpe3JldHVybiB0IGluc3RhbmNlb2YgZnJbZV19Z2V0IGJhc2VUeXBlKCl7cmV0dXJuIHRoaXMuX29zY2lsbGF0b3IuYmFzZVR5cGV9c2V0IGJhc2VUeXBlKHQpe3RoaXMuX2dldE9zY1R5cGUodGhpcy5fb3NjaWxsYXRvcixcInB1bHNlXCIpfHx0aGlzLl9nZXRPc2NUeXBlKHRoaXMuX29zY2lsbGF0b3IsXCJwd21cIil8fFwicHVsc2VcIj09PXR8fFwicHdtXCI9PT10fHwodGhpcy5fb3NjaWxsYXRvci5iYXNlVHlwZT10KX1nZXQgd2lkdGgoKXtyZXR1cm4gdGhpcy5fZ2V0T3NjVHlwZSh0aGlzLl9vc2NpbGxhdG9yLFwicHVsc2VcIik/dGhpcy5fb3NjaWxsYXRvci53aWR0aDp2b2lkIDB9Z2V0IGNvdW50KCl7cmV0dXJuIHRoaXMuX2dldE9zY1R5cGUodGhpcy5fb3NjaWxsYXRvcixcImZhdFwiKT90aGlzLl9vc2NpbGxhdG9yLmNvdW50OnZvaWQgMH1zZXQgY291bnQodCl7dGhpcy5fZ2V0T3NjVHlwZSh0aGlzLl9vc2NpbGxhdG9yLFwiZmF0XCIpJiZ1aSh0KSYmKHRoaXMuX29zY2lsbGF0b3IuY291bnQ9dCl9Z2V0IHNwcmVhZCgpe3JldHVybiB0aGlzLl9nZXRPc2NUeXBlKHRoaXMuX29zY2lsbGF0b3IsXCJmYXRcIik/dGhpcy5fb3NjaWxsYXRvci5zcHJlYWQ6dm9pZCAwfXNldCBzcHJlYWQodCl7dGhpcy5fZ2V0T3NjVHlwZSh0aGlzLl9vc2NpbGxhdG9yLFwiZmF0XCIpJiZ1aSh0KSYmKHRoaXMuX29zY2lsbGF0b3Iuc3ByZWFkPXQpfWdldCBtb2R1bGF0aW9uVHlwZSgpe3JldHVybiB0aGlzLl9nZXRPc2NUeXBlKHRoaXMuX29zY2lsbGF0b3IsXCJmbVwiKXx8dGhpcy5fZ2V0T3NjVHlwZSh0aGlzLl9vc2NpbGxhdG9yLFwiYW1cIik/dGhpcy5fb3NjaWxsYXRvci5tb2R1bGF0aW9uVHlwZTp2b2lkIDB9c2V0IG1vZHVsYXRpb25UeXBlKHQpeyh0aGlzLl9nZXRPc2NUeXBlKHRoaXMuX29zY2lsbGF0b3IsXCJmbVwiKXx8dGhpcy5fZ2V0T3NjVHlwZSh0aGlzLl9vc2NpbGxhdG9yLFwiYW1cIikpJiZmaSh0KSYmKHRoaXMuX29zY2lsbGF0b3IubW9kdWxhdGlvblR5cGU9dCl9Z2V0IG1vZHVsYXRpb25JbmRleCgpe3JldHVybiB0aGlzLl9nZXRPc2NUeXBlKHRoaXMuX29zY2lsbGF0b3IsXCJmbVwiKT90aGlzLl9vc2NpbGxhdG9yLm1vZHVsYXRpb25JbmRleDp2b2lkIDB9Z2V0IGhhcm1vbmljaXR5KCl7cmV0dXJuIHRoaXMuX2dldE9zY1R5cGUodGhpcy5fb3NjaWxsYXRvcixcImZtXCIpfHx0aGlzLl9nZXRPc2NUeXBlKHRoaXMuX29zY2lsbGF0b3IsXCJhbVwiKT90aGlzLl9vc2NpbGxhdG9yLmhhcm1vbmljaXR5OnZvaWQgMH1nZXQgbW9kdWxhdGlvbkZyZXF1ZW5jeSgpe3JldHVybiB0aGlzLl9nZXRPc2NUeXBlKHRoaXMuX29zY2lsbGF0b3IsXCJwd21cIik/dGhpcy5fb3NjaWxsYXRvci5tb2R1bGF0aW9uRnJlcXVlbmN5OnZvaWQgMH1hc0FycmF5KHQ9MTAyNCl7cmV0dXJuIHlpKHRoaXMsdm9pZCAwLHZvaWQgMCwoZnVuY3Rpb24qKCl7cmV0dXJuIHNyKHRoaXMsdCl9KSl9ZGlzcG9zZSgpe3JldHVybiBzdXBlci5kaXNwb3NlKCksdGhpcy5kZXR1bmUuZGlzcG9zZSgpLHRoaXMuZnJlcXVlbmN5LmRpc3Bvc2UoKSx0aGlzLl9vc2NpbGxhdG9yLmRpc3Bvc2UoKSx0aGlzfX1jbGFzcyBtciBleHRlbmRzIERve2NvbnN0cnVjdG9yKCl7c3VwZXIoT2JqZWN0LmFzc2lnbihEaShtci5nZXREZWZhdWx0cygpLGFyZ3VtZW50cyxbXCJ2YWx1ZVwiXSkpKSx0aGlzLm92ZXJyaWRlPSExLHRoaXMubmFtZT1cIkFkZFwiLHRoaXMuX3N1bT1uZXcga28oe2NvbnRleHQ6dGhpcy5jb250ZXh0fSksdGhpcy5pbnB1dD10aGlzLl9zdW0sdGhpcy5vdXRwdXQ9dGhpcy5fc3VtLHRoaXMuYWRkZW5kPXRoaXMuX3BhcmFtLGJvKHRoaXMuX2NvbnN0YW50U291cmNlLHRoaXMuX3N1bSl9c3RhdGljIGdldERlZmF1bHRzKCl7cmV0dXJuIE9iamVjdC5hc3NpZ24oRG8uZ2V0RGVmYXVsdHMoKSx7dmFsdWU6MH0pfWRpc3Bvc2UoKXtyZXR1cm4gc3VwZXIuZGlzcG9zZSgpLHRoaXMuX3N1bS5kaXNwb3NlKCksdGhpc319Y2xhc3MgZ3IgZXh0ZW5kcyBvcntjb25zdHJ1Y3Rvcigpe3N1cGVyKE9iamVjdC5hc3NpZ24oRGkoZ3IuZ2V0RGVmYXVsdHMoKSxhcmd1bWVudHMsW1wibWluXCIsXCJtYXhcIl0pKSksdGhpcy5uYW1lPVwiU2NhbGVcIjtjb25zdCB0PURpKGdyLmdldERlZmF1bHRzKCksYXJndW1lbnRzLFtcIm1pblwiLFwibWF4XCJdKTt0aGlzLl9tdWx0PXRoaXMuaW5wdXQ9bmV3IGNyKHtjb250ZXh0OnRoaXMuY29udGV4dCx2YWx1ZTp0Lm1heC10Lm1pbn0pLHRoaXMuX2FkZD10aGlzLm91dHB1dD1uZXcgbXIoe2NvbnRleHQ6dGhpcy5jb250ZXh0LHZhbHVlOnQubWlufSksdGhpcy5fbWluPXQubWluLHRoaXMuX21heD10Lm1heCx0aGlzLmlucHV0LmNvbm5lY3QodGhpcy5vdXRwdXQpfXN0YXRpYyBnZXREZWZhdWx0cygpe3JldHVybiBPYmplY3QuYXNzaWduKG9yLmdldERlZmF1bHRzKCkse21heDoxLG1pbjowfSl9Z2V0IG1pbigpe3JldHVybiB0aGlzLl9taW59c2V0IG1pbih0KXt0aGlzLl9taW49dCx0aGlzLl9zZXRSYW5nZSgpfWdldCBtYXgoKXtyZXR1cm4gdGhpcy5fbWF4fXNldCBtYXgodCl7dGhpcy5fbWF4PXQsdGhpcy5fc2V0UmFuZ2UoKX1fc2V0UmFuZ2UoKXt0aGlzLl9hZGQudmFsdWU9dGhpcy5fbWluLHRoaXMuX211bHQudmFsdWU9dGhpcy5fbWF4LXRoaXMuX21pbn1kaXNwb3NlKCl7cmV0dXJuIHN1cGVyLmRpc3Bvc2UoKSx0aGlzLl9hZGQuZGlzcG9zZSgpLHRoaXMuX211bHQuZGlzcG9zZSgpLHRoaXN9fWNsYXNzIHZyIGV4dGVuZHMgb3J7Y29uc3RydWN0b3IoKXtzdXBlcihPYmplY3QuYXNzaWduKERpKHZyLmdldERlZmF1bHRzKCksYXJndW1lbnRzKSkpLHRoaXMubmFtZT1cIlplcm9cIix0aGlzLl9nYWluPW5ldyBrbyh7Y29udGV4dDp0aGlzLmNvbnRleHR9KSx0aGlzLm91dHB1dD10aGlzLl9nYWluLHRoaXMuaW5wdXQ9dm9pZCAwLFRvKHRoaXMuY29udGV4dC5nZXRDb25zdGFudCgwKSx0aGlzLl9nYWluKX1kaXNwb3NlKCl7cmV0dXJuIHN1cGVyLmRpc3Bvc2UoKSxTbyh0aGlzLmNvbnRleHQuZ2V0Q29uc3RhbnQoMCksdGhpcy5fZ2FpbiksdGhpc319Y2xhc3MgeXIgZXh0ZW5kcyB3b3tjb25zdHJ1Y3Rvcigpe3N1cGVyKERpKHlyLmdldERlZmF1bHRzKCksYXJndW1lbnRzLFtcImZyZXF1ZW5jeVwiLFwibWluXCIsXCJtYXhcIl0pKSx0aGlzLm5hbWU9XCJMRk9cIix0aGlzLl9zdG9wcGVkVmFsdWU9MCx0aGlzLl91bml0cz1cIm51bWJlclwiLHRoaXMuY29udmVydD0hMCx0aGlzLl9mcm9tVHlwZT14by5wcm90b3R5cGUuX2Zyb21UeXBlLHRoaXMuX3RvVHlwZT14by5wcm90b3R5cGUuX3RvVHlwZSx0aGlzLl9pcz14by5wcm90b3R5cGUuX2lzLHRoaXMuX2NsYW1wVmFsdWU9eG8ucHJvdG90eXBlLl9jbGFtcFZhbHVlO2NvbnN0IHQ9RGkoeXIuZ2V0RGVmYXVsdHMoKSxhcmd1bWVudHMsW1wiZnJlcXVlbmN5XCIsXCJtaW5cIixcIm1heFwiXSk7dGhpcy5fb3NjaWxsYXRvcj1uZXcgaXIodCksdGhpcy5mcmVxdWVuY3k9dGhpcy5fb3NjaWxsYXRvci5mcmVxdWVuY3ksdGhpcy5fYW1wbGl0dWRlR2Fpbj1uZXcga28oe2NvbnRleHQ6dGhpcy5jb250ZXh0LGdhaW46dC5hbXBsaXR1ZGUsdW5pdHM6XCJub3JtYWxSYW5nZVwifSksdGhpcy5hbXBsaXR1ZGU9dGhpcy5fYW1wbGl0dWRlR2Fpbi5nYWluLHRoaXMuX3N0b3BwZWRTaWduYWw9bmV3IERvKHtjb250ZXh0OnRoaXMuY29udGV4dCx1bml0czpcImF1ZGlvUmFuZ2VcIix2YWx1ZTowfSksdGhpcy5femVyb3M9bmV3IHZyKHtjb250ZXh0OnRoaXMuY29udGV4dH0pLHRoaXMuX2EyZz1uZXcgYXIoe2NvbnRleHQ6dGhpcy5jb250ZXh0fSksdGhpcy5fc2NhbGVyPXRoaXMub3V0cHV0PW5ldyBncih7Y29udGV4dDp0aGlzLmNvbnRleHQsbWF4OnQubWF4LG1pbjp0Lm1pbn0pLHRoaXMudW5pdHM9dC51bml0cyx0aGlzLm1pbj10Lm1pbix0aGlzLm1heD10Lm1heCx0aGlzLl9vc2NpbGxhdG9yLmNoYWluKHRoaXMuX2FtcGxpdHVkZUdhaW4sdGhpcy5fYTJnLHRoaXMuX3NjYWxlciksdGhpcy5femVyb3MuY29ubmVjdCh0aGlzLl9hMmcpLHRoaXMuX3N0b3BwZWRTaWduYWwuY29ubmVjdCh0aGlzLl9hMmcpLFVpKHRoaXMsW1wiYW1wbGl0dWRlXCIsXCJmcmVxdWVuY3lcIl0pLHRoaXMucGhhc2U9dC5waGFzZX1zdGF0aWMgZ2V0RGVmYXVsdHMoKXtyZXR1cm4gT2JqZWN0LmFzc2lnbihpci5nZXREZWZhdWx0cygpLHthbXBsaXR1ZGU6MSxmcmVxdWVuY3k6XCI0blwiLG1heDoxLG1pbjowLHR5cGU6XCJzaW5lXCIsdW5pdHM6XCJudW1iZXJcIn0pfXN0YXJ0KHQpe3JldHVybiB0PXRoaXMudG9TZWNvbmRzKHQpLHRoaXMuX3N0b3BwZWRTaWduYWwuc2V0VmFsdWVBdFRpbWUoMCx0KSx0aGlzLl9vc2NpbGxhdG9yLnN0YXJ0KHQpLHRoaXN9c3RvcCh0KXtyZXR1cm4gdD10aGlzLnRvU2Vjb25kcyh0KSx0aGlzLl9zdG9wcGVkU2lnbmFsLnNldFZhbHVlQXRUaW1lKHRoaXMuX3N0b3BwZWRWYWx1ZSx0KSx0aGlzLl9vc2NpbGxhdG9yLnN0b3AodCksdGhpc31zeW5jKCl7cmV0dXJuIHRoaXMuX29zY2lsbGF0b3Iuc3luYygpLHRoaXMuX29zY2lsbGF0b3Iuc3luY0ZyZXF1ZW5jeSgpLHRoaXN9dW5zeW5jKCl7cmV0dXJuIHRoaXMuX29zY2lsbGF0b3IudW5zeW5jKCksdGhpcy5fb3NjaWxsYXRvci51bnN5bmNGcmVxdWVuY3koKSx0aGlzfV9zZXRTdG9wcGVkVmFsdWUoKXt0aGlzLl9zdG9wcGVkVmFsdWU9dGhpcy5fb3NjaWxsYXRvci5nZXRJbml0aWFsVmFsdWUoKSx0aGlzLl9zdG9wcGVkU2lnbmFsLnZhbHVlPXRoaXMuX3N0b3BwZWRWYWx1ZX1nZXQgbWluKCl7cmV0dXJuIHRoaXMuX3RvVHlwZSh0aGlzLl9zY2FsZXIubWluKX1zZXQgbWluKHQpe3Q9dGhpcy5fZnJvbVR5cGUodCksdGhpcy5fc2NhbGVyLm1pbj10fWdldCBtYXgoKXtyZXR1cm4gdGhpcy5fdG9UeXBlKHRoaXMuX3NjYWxlci5tYXgpfXNldCBtYXgodCl7dD10aGlzLl9mcm9tVHlwZSh0KSx0aGlzLl9zY2FsZXIubWF4PXR9Z2V0IHR5cGUoKXtyZXR1cm4gdGhpcy5fb3NjaWxsYXRvci50eXBlfXNldCB0eXBlKHQpe3RoaXMuX29zY2lsbGF0b3IudHlwZT10LHRoaXMuX3NldFN0b3BwZWRWYWx1ZSgpfWdldCBwYXJ0aWFscygpe3JldHVybiB0aGlzLl9vc2NpbGxhdG9yLnBhcnRpYWxzfXNldCBwYXJ0aWFscyh0KXt0aGlzLl9vc2NpbGxhdG9yLnBhcnRpYWxzPXQsdGhpcy5fc2V0U3RvcHBlZFZhbHVlKCl9Z2V0IHBoYXNlKCl7cmV0dXJuIHRoaXMuX29zY2lsbGF0b3IucGhhc2V9c2V0IHBoYXNlKHQpe3RoaXMuX29zY2lsbGF0b3IucGhhc2U9dCx0aGlzLl9zZXRTdG9wcGVkVmFsdWUoKX1nZXQgdW5pdHMoKXtyZXR1cm4gdGhpcy5fdW5pdHN9c2V0IHVuaXRzKHQpe2NvbnN0IGU9dGhpcy5taW4scz10aGlzLm1heDt0aGlzLl91bml0cz10LHRoaXMubWluPWUsdGhpcy5tYXg9c31nZXQgc3RhdGUoKXtyZXR1cm4gdGhpcy5fb3NjaWxsYXRvci5zdGF0ZX1jb25uZWN0KHQsZSxzKXtyZXR1cm4odCBpbnN0YW5jZW9mIHhvfHx0IGluc3RhbmNlb2YgRG8pJiYodGhpcy5jb252ZXJ0PXQuY29udmVydCx0aGlzLnVuaXRzPXQudW5pdHMpLE9vKHRoaXMsdCxlLHMpLHRoaXN9ZGlzcG9zZSgpe3JldHVybiBzdXBlci5kaXNwb3NlKCksdGhpcy5fb3NjaWxsYXRvci5kaXNwb3NlKCksdGhpcy5fc3RvcHBlZFNpZ25hbC5kaXNwb3NlKCksdGhpcy5femVyb3MuZGlzcG9zZSgpLHRoaXMuX3NjYWxlci5kaXNwb3NlKCksdGhpcy5fYTJnLmRpc3Bvc2UoKSx0aGlzLl9hbXBsaXR1ZGVHYWluLmRpc3Bvc2UoKSx0aGlzLmFtcGxpdHVkZS5kaXNwb3NlKCksdGhpc319ZnVuY3Rpb24geHIodCxlPTEvMCl7Y29uc3Qgcz1uZXcgV2Vha01hcDtyZXR1cm4gZnVuY3Rpb24obixpKXtSZWZsZWN0LmRlZmluZVByb3BlcnR5KG4saSx7Y29uZmlndXJhYmxlOiEwLGVudW1lcmFibGU6ITAsZ2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHMuZ2V0KHRoaXMpfSxzZXQ6ZnVuY3Rpb24obil7ZWkobix0LGUpLHMuc2V0KHRoaXMsbil9fSl9fWZ1bmN0aW9uIHdyKHQsZT0xLzApe2NvbnN0IHM9bmV3IFdlYWtNYXA7cmV0dXJuIGZ1bmN0aW9uKG4saSl7UmVmbGVjdC5kZWZpbmVQcm9wZXJ0eShuLGkse2NvbmZpZ3VyYWJsZTohMCxlbnVtZXJhYmxlOiEwLGdldDpmdW5jdGlvbigpe3JldHVybiBzLmdldCh0aGlzKX0sc2V0OmZ1bmN0aW9uKG4pe2VpKHRoaXMudG9TZWNvbmRzKG4pLHQsZSkscy5zZXQodGhpcyxuKX19KX19Y2xhc3MgYnIgZXh0ZW5kcyBIb3tjb25zdHJ1Y3Rvcigpe3N1cGVyKERpKGJyLmdldERlZmF1bHRzKCksYXJndW1lbnRzLFtcInVybFwiLFwib25sb2FkXCJdKSksdGhpcy5uYW1lPVwiUGxheWVyXCIsdGhpcy5fYWN0aXZlU291cmNlcz1uZXcgU2V0O2NvbnN0IHQ9RGkoYnIuZ2V0RGVmYXVsdHMoKSxhcmd1bWVudHMsW1widXJsXCIsXCJvbmxvYWRcIl0pO3RoaXMuX2J1ZmZlcj1uZXcgWGkoe29ubG9hZDp0aGlzLl9vbmxvYWQuYmluZCh0aGlzLHQub25sb2FkKSxvbmVycm9yOnQub25lcnJvcixyZXZlcnNlOnQucmV2ZXJzZSx1cmw6dC51cmx9KSx0aGlzLmF1dG9zdGFydD10LmF1dG9zdGFydCx0aGlzLl9sb29wPXQubG9vcCx0aGlzLl9sb29wU3RhcnQ9dC5sb29wU3RhcnQsdGhpcy5fbG9vcEVuZD10Lmxvb3BFbmQsdGhpcy5fcGxheWJhY2tSYXRlPXQucGxheWJhY2tSYXRlLHRoaXMuZmFkZUluPXQuZmFkZUluLHRoaXMuZmFkZU91dD10LmZhZGVPdXR9c3RhdGljIGdldERlZmF1bHRzKCl7cmV0dXJuIE9iamVjdC5hc3NpZ24oSG8uZ2V0RGVmYXVsdHMoKSx7YXV0b3N0YXJ0OiExLGZhZGVJbjowLGZhZGVPdXQ6MCxsb29wOiExLGxvb3BFbmQ6MCxsb29wU3RhcnQ6MCxvbmxvYWQ6Wmksb25lcnJvcjpaaSxwbGF5YmFja1JhdGU6MSxyZXZlcnNlOiExfSl9bG9hZCh0KXtyZXR1cm4geWkodGhpcyx2b2lkIDAsdm9pZCAwLChmdW5jdGlvbiooKXtyZXR1cm4geWllbGQgdGhpcy5fYnVmZmVyLmxvYWQodCksdGhpcy5fb25sb2FkKCksdGhpc30pKX1fb25sb2FkKHQ9Wmkpe3QoKSx0aGlzLmF1dG9zdGFydCYmdGhpcy5zdGFydCgpfV9vblNvdXJjZUVuZCh0KXt0aGlzLm9uc3RvcCh0aGlzKSx0aGlzLl9hY3RpdmVTb3VyY2VzLmRlbGV0ZSh0KSwwIT09dGhpcy5fYWN0aXZlU291cmNlcy5zaXplfHx0aGlzLl9zeW5jZWR8fFwic3RhcnRlZFwiIT09dGhpcy5fc3RhdGUuZ2V0VmFsdWVBdFRpbWUodGhpcy5ub3coKSl8fCh0aGlzLl9zdGF0ZS5jYW5jZWwodGhpcy5ub3coKSksdGhpcy5fc3RhdGUuc2V0U3RhdGVBdFRpbWUoXCJzdG9wcGVkXCIsdGhpcy5ub3coKSkpfXN0YXJ0KHQsZSxzKXtyZXR1cm4gc3VwZXIuc3RhcnQodCxlLHMpLHRoaXN9X3N0YXJ0KHQsZSxzKXtlPXRoaXMuX2xvb3A/T2koZSx0aGlzLl9sb29wU3RhcnQpOk9pKGUsMCk7Y29uc3Qgbj10aGlzLnRvU2Vjb25kcyhlKSxpPXM7cz1PaShzLE1hdGgubWF4KHRoaXMuX2J1ZmZlci5kdXJhdGlvbi1uLDApKTtsZXQgbz10aGlzLnRvU2Vjb25kcyhzKTtvLz10aGlzLl9wbGF5YmFja1JhdGUsdD10aGlzLnRvU2Vjb25kcyh0KTtjb25zdCByPW5ldyAkbyh7dXJsOnRoaXMuX2J1ZmZlcixjb250ZXh0OnRoaXMuY29udGV4dCxmYWRlSW46dGhpcy5mYWRlSW4sZmFkZU91dDp0aGlzLmZhZGVPdXQsbG9vcDp0aGlzLl9sb29wLGxvb3BFbmQ6dGhpcy5fbG9vcEVuZCxsb29wU3RhcnQ6dGhpcy5fbG9vcFN0YXJ0LG9uZW5kZWQ6dGhpcy5fb25Tb3VyY2VFbmQuYmluZCh0aGlzKSxwbGF5YmFja1JhdGU6dGhpcy5fcGxheWJhY2tSYXRlfSkuY29ubmVjdCh0aGlzLm91dHB1dCk7dGhpcy5fbG9vcHx8dGhpcy5fc3luY2VkfHwodGhpcy5fc3RhdGUuY2FuY2VsKHQrbyksdGhpcy5fc3RhdGUuc2V0U3RhdGVBdFRpbWUoXCJzdG9wcGVkXCIsdCtvLHtpbXBsaWNpdEVuZDohMH0pKSx0aGlzLl9hY3RpdmVTb3VyY2VzLmFkZChyKSx0aGlzLl9sb29wJiZhaShpKT9yLnN0YXJ0KHQsbik6ci5zdGFydCh0LG4sby10aGlzLnRvU2Vjb25kcyh0aGlzLmZhZGVPdXQpKX1fc3RvcCh0KXtjb25zdCBlPXRoaXMudG9TZWNvbmRzKHQpO3RoaXMuX2FjdGl2ZVNvdXJjZXMuZm9yRWFjaCh0PT50LnN0b3AoZSkpfXJlc3RhcnQodCxlLHMpe3JldHVybiBzdXBlci5yZXN0YXJ0KHQsZSxzKSx0aGlzfV9yZXN0YXJ0KHQsZSxzKXt0aGlzLl9zdG9wKHQpLHRoaXMuX3N0YXJ0KHQsZSxzKX1zZWVrKHQsZSl7Y29uc3Qgcz10aGlzLnRvU2Vjb25kcyhlKTtpZihcInN0YXJ0ZWRcIj09PXRoaXMuX3N0YXRlLmdldFZhbHVlQXRUaW1lKHMpKXtjb25zdCBlPXRoaXMudG9TZWNvbmRzKHQpO3RoaXMuX3N0b3AocyksdGhpcy5fc3RhcnQocyxlKX1yZXR1cm4gdGhpc31zZXRMb29wUG9pbnRzKHQsZSl7cmV0dXJuIHRoaXMubG9vcFN0YXJ0PXQsdGhpcy5sb29wRW5kPWUsdGhpc31nZXQgbG9vcFN0YXJ0KCl7cmV0dXJuIHRoaXMuX2xvb3BTdGFydH1zZXQgbG9vcFN0YXJ0KHQpe3RoaXMuX2xvb3BTdGFydD10LHRoaXMuYnVmZmVyLmxvYWRlZCYmZWkodGhpcy50b1NlY29uZHModCksMCx0aGlzLmJ1ZmZlci5kdXJhdGlvbiksdGhpcy5fYWN0aXZlU291cmNlcy5mb3JFYWNoKGU9PntlLmxvb3BTdGFydD10fSl9Z2V0IGxvb3BFbmQoKXtyZXR1cm4gdGhpcy5fbG9vcEVuZH1zZXQgbG9vcEVuZCh0KXt0aGlzLl9sb29wRW5kPXQsdGhpcy5idWZmZXIubG9hZGVkJiZlaSh0aGlzLnRvU2Vjb25kcyh0KSwwLHRoaXMuYnVmZmVyLmR1cmF0aW9uKSx0aGlzLl9hY3RpdmVTb3VyY2VzLmZvckVhY2goZT0+e2UubG9vcEVuZD10fSl9Z2V0IGJ1ZmZlcigpe3JldHVybiB0aGlzLl9idWZmZXJ9c2V0IGJ1ZmZlcih0KXt0aGlzLl9idWZmZXIuc2V0KHQpfWdldCBsb29wKCl7cmV0dXJuIHRoaXMuX2xvb3B9c2V0IGxvb3AodCl7aWYodGhpcy5fbG9vcCE9PXQmJih0aGlzLl9sb29wPXQsdGhpcy5fYWN0aXZlU291cmNlcy5mb3JFYWNoKGU9PntlLmxvb3A9dH0pLHQpKXtjb25zdCB0PXRoaXMuX3N0YXRlLmdldE5leHRTdGF0ZShcInN0b3BwZWRcIix0aGlzLm5vdygpKTt0JiZ0aGlzLl9zdGF0ZS5jYW5jZWwodC50aW1lKX19Z2V0IHBsYXliYWNrUmF0ZSgpe3JldHVybiB0aGlzLl9wbGF5YmFja1JhdGV9c2V0IHBsYXliYWNrUmF0ZSh0KXt0aGlzLl9wbGF5YmFja1JhdGU9dDtjb25zdCBlPXRoaXMubm93KCkscz10aGlzLl9zdGF0ZS5nZXROZXh0U3RhdGUoXCJzdG9wcGVkXCIsZSk7cyYmcy5pbXBsaWNpdEVuZCYmKHRoaXMuX3N0YXRlLmNhbmNlbChzLnRpbWUpLHRoaXMuX2FjdGl2ZVNvdXJjZXMuZm9yRWFjaCh0PT50LmNhbmNlbFN0b3AoKSkpLHRoaXMuX2FjdGl2ZVNvdXJjZXMuZm9yRWFjaChzPT57cy5wbGF5YmFja1JhdGUuc2V0VmFsdWVBdFRpbWUodCxlKX0pfWdldCByZXZlcnNlKCl7cmV0dXJuIHRoaXMuX2J1ZmZlci5yZXZlcnNlfXNldCByZXZlcnNlKHQpe3RoaXMuX2J1ZmZlci5yZXZlcnNlPXR9Z2V0IGxvYWRlZCgpe3JldHVybiB0aGlzLl9idWZmZXIubG9hZGVkfWRpc3Bvc2UoKXtyZXR1cm4gc3VwZXIuZGlzcG9zZSgpLHRoaXMuX2FjdGl2ZVNvdXJjZXMuZm9yRWFjaCh0PT50LmRpc3Bvc2UoKSksdGhpcy5fYWN0aXZlU291cmNlcy5jbGVhcigpLHRoaXMuX2J1ZmZlci5kaXNwb3NlKCksdGhpc319dmkoW3dyKDApXSxici5wcm90b3R5cGUsXCJmYWRlSW5cIix2b2lkIDApLHZpKFt3cigwKV0sYnIucHJvdG90eXBlLFwiZmFkZU91dFwiLHZvaWQgMCk7Y2xhc3MgVHIgZXh0ZW5kcyB3b3tjb25zdHJ1Y3Rvcigpe3N1cGVyKERpKFRyLmdldERlZmF1bHRzKCksYXJndW1lbnRzLFtcInVybHNcIixcIm9ubG9hZFwiXSxcInVybHNcIikpLHRoaXMubmFtZT1cIlBsYXllcnNcIix0aGlzLmlucHV0PXZvaWQgMCx0aGlzLl9wbGF5ZXJzPW5ldyBNYXA7Y29uc3QgdD1EaShUci5nZXREZWZhdWx0cygpLGFyZ3VtZW50cyxbXCJ1cmxzXCIsXCJvbmxvYWRcIl0sXCJ1cmxzXCIpO3RoaXMuX3ZvbHVtZT10aGlzLm91dHB1dD1uZXcgR28oe2NvbnRleHQ6dGhpcy5jb250ZXh0LHZvbHVtZTp0LnZvbHVtZX0pLHRoaXMudm9sdW1lPXRoaXMuX3ZvbHVtZS52b2x1bWUsVWkodGhpcyxcInZvbHVtZVwiKSx0aGlzLl9idWZmZXJzPW5ldyBWbyh7dXJsczp0LnVybHMsb25sb2FkOnQub25sb2FkLGJhc2VVcmw6dC5iYXNlVXJsLG9uZXJyb3I6dC5vbmVycm9yfSksdGhpcy5tdXRlPXQubXV0ZSx0aGlzLl9mYWRlSW49dC5mYWRlSW4sdGhpcy5fZmFkZU91dD10LmZhZGVPdXR9c3RhdGljIGdldERlZmF1bHRzKCl7cmV0dXJuIE9iamVjdC5hc3NpZ24oSG8uZ2V0RGVmYXVsdHMoKSx7YmFzZVVybDpcIlwiLGZhZGVJbjowLGZhZGVPdXQ6MCxtdXRlOiExLG9ubG9hZDpaaSxvbmVycm9yOlppLHVybHM6e30sdm9sdW1lOjB9KX1nZXQgbXV0ZSgpe3JldHVybiB0aGlzLl92b2x1bWUubXV0ZX1zZXQgbXV0ZSh0KXt0aGlzLl92b2x1bWUubXV0ZT10fWdldCBmYWRlSW4oKXtyZXR1cm4gdGhpcy5fZmFkZUlufXNldCBmYWRlSW4odCl7dGhpcy5fZmFkZUluPXQsdGhpcy5fcGxheWVycy5mb3JFYWNoKGU9PntlLmZhZGVJbj10fSl9Z2V0IGZhZGVPdXQoKXtyZXR1cm4gdGhpcy5fZmFkZU91dH1zZXQgZmFkZU91dCh0KXt0aGlzLl9mYWRlT3V0PXQsdGhpcy5fcGxheWVycy5mb3JFYWNoKGU9PntlLmZhZGVPdXQ9dH0pfWdldCBzdGF0ZSgpe3JldHVybiBBcnJheS5mcm9tKHRoaXMuX3BsYXllcnMpLnNvbWUoKFt0LGVdKT0+XCJzdGFydGVkXCI9PT1lLnN0YXRlKT9cInN0YXJ0ZWRcIjpcInN0b3BwZWRcIn1oYXModCl7cmV0dXJuIHRoaXMuX2J1ZmZlcnMuaGFzKHQpfXBsYXllcih0KXtpZih0aSh0aGlzLmhhcyh0KSxgTm8gUGxheWVyIHdpdGggdGhlIG5hbWUgJHt0fSBleGlzdHMgb24gdGhpcyBvYmplY3RgKSwhdGhpcy5fcGxheWVycy5oYXModCkpe2NvbnN0IGU9bmV3IGJyKHtjb250ZXh0OnRoaXMuY29udGV4dCxmYWRlSW46dGhpcy5fZmFkZUluLGZhZGVPdXQ6dGhpcy5fZmFkZU91dCx1cmw6dGhpcy5fYnVmZmVycy5nZXQodCl9KS5jb25uZWN0KHRoaXMub3V0cHV0KTt0aGlzLl9wbGF5ZXJzLnNldCh0LGUpfXJldHVybiB0aGlzLl9wbGF5ZXJzLmdldCh0KX1nZXQgbG9hZGVkKCl7cmV0dXJuIHRoaXMuX2J1ZmZlcnMubG9hZGVkfWFkZCh0LGUscyl7cmV0dXJuIHRpKCF0aGlzLl9idWZmZXJzLmhhcyh0KSxcIkEgYnVmZmVyIHdpdGggdGhhdCBuYW1lIGFscmVhZHkgZXhpc3RzIG9uIHRoaXMgb2JqZWN0XCIpLHRoaXMuX2J1ZmZlcnMuYWRkKHQsZSxzKSx0aGlzfXN0b3BBbGwodCl7cmV0dXJuIHRoaXMuX3BsYXllcnMuZm9yRWFjaChlPT5lLnN0b3AodCkpLHRoaXN9ZGlzcG9zZSgpe3JldHVybiBzdXBlci5kaXNwb3NlKCksdGhpcy5fdm9sdW1lLmRpc3Bvc2UoKSx0aGlzLnZvbHVtZS5kaXNwb3NlKCksdGhpcy5fcGxheWVycy5mb3JFYWNoKHQ9PnQuZGlzcG9zZSgpKSx0aGlzLl9idWZmZXJzLmRpc3Bvc2UoKSx0aGlzfX1jbGFzcyBTciBleHRlbmRzIEhve2NvbnN0cnVjdG9yKCl7c3VwZXIoRGkoU3IuZ2V0RGVmYXVsdHMoKSxhcmd1bWVudHMsW1widXJsXCIsXCJvbmxvYWRcIl0pKSx0aGlzLm5hbWU9XCJHcmFpblBsYXllclwiLHRoaXMuX2xvb3BTdGFydD0wLHRoaXMuX2xvb3BFbmQ9MCx0aGlzLl9hY3RpdmVTb3VyY2VzPVtdO2NvbnN0IHQ9RGkoU3IuZ2V0RGVmYXVsdHMoKSxhcmd1bWVudHMsW1widXJsXCIsXCJvbmxvYWRcIl0pO3RoaXMuYnVmZmVyPW5ldyBYaSh7b25sb2FkOnQub25sb2FkLG9uZXJyb3I6dC5vbmVycm9yLHJldmVyc2U6dC5yZXZlcnNlLHVybDp0LnVybH0pLHRoaXMuX2Nsb2NrPW5ldyBxbyh7Y29udGV4dDp0aGlzLmNvbnRleHQsY2FsbGJhY2s6dGhpcy5fdGljay5iaW5kKHRoaXMpLGZyZXF1ZW5jeToxL3QuZ3JhaW5TaXplfSksdGhpcy5fcGxheWJhY2tSYXRlPXQucGxheWJhY2tSYXRlLHRoaXMuX2dyYWluU2l6ZT10LmdyYWluU2l6ZSx0aGlzLl9vdmVybGFwPXQub3ZlcmxhcCx0aGlzLmRldHVuZT10LmRldHVuZSx0aGlzLm92ZXJsYXA9dC5vdmVybGFwLHRoaXMubG9vcD10Lmxvb3AsdGhpcy5wbGF5YmFja1JhdGU9dC5wbGF5YmFja1JhdGUsdGhpcy5ncmFpblNpemU9dC5ncmFpblNpemUsdGhpcy5sb29wU3RhcnQ9dC5sb29wU3RhcnQsdGhpcy5sb29wRW5kPXQubG9vcEVuZCx0aGlzLnJldmVyc2U9dC5yZXZlcnNlLHRoaXMuX2Nsb2NrLm9uKFwic3RvcFwiLHRoaXMuX29uc3RvcC5iaW5kKHRoaXMpKX1zdGF0aWMgZ2V0RGVmYXVsdHMoKXtyZXR1cm4gT2JqZWN0LmFzc2lnbihIby5nZXREZWZhdWx0cygpLHtvbmxvYWQ6Wmksb25lcnJvcjpaaSxvdmVybGFwOi4xLGdyYWluU2l6ZTouMixwbGF5YmFja1JhdGU6MSxkZXR1bmU6MCxsb29wOiExLGxvb3BTdGFydDowLGxvb3BFbmQ6MCxyZXZlcnNlOiExfSl9X3N0YXJ0KHQsZSxzKXtlPU9pKGUsMCksZT10aGlzLnRvU2Vjb25kcyhlKSx0PXRoaXMudG9TZWNvbmRzKHQpO2NvbnN0IG49MS90aGlzLl9jbG9jay5mcmVxdWVuY3kuZ2V0VmFsdWVBdFRpbWUodCk7dGhpcy5fY2xvY2suc3RhcnQodCxlL24pLHMmJnRoaXMuc3RvcCh0K3RoaXMudG9TZWNvbmRzKHMpKX1yZXN0YXJ0KHQsZSxzKXtyZXR1cm4gc3VwZXIucmVzdGFydCh0LGUscyksdGhpc31fcmVzdGFydCh0LGUscyl7dGhpcy5fc3RvcCh0KSx0aGlzLl9zdGFydCh0LGUscyl9X3N0b3AodCl7dGhpcy5fY2xvY2suc3RvcCh0KX1fb25zdG9wKHQpe3RoaXMuX2FjdGl2ZVNvdXJjZXMuZm9yRWFjaChlPT57ZS5mYWRlT3V0PTAsZS5zdG9wKHQpfSksdGhpcy5vbnN0b3AodGhpcyl9X3RpY2sodCl7Y29uc3QgZT10aGlzLl9jbG9jay5nZXRUaWNrc0F0VGltZSh0KSxzPWUqdGhpcy5fZ3JhaW5TaXplO2lmKHRoaXMubG9nKFwib2Zmc2V0XCIscyksIXRoaXMubG9vcCYmcz50aGlzLmJ1ZmZlci5kdXJhdGlvbilyZXR1cm4gdm9pZCB0aGlzLnN0b3AodCk7Y29uc3Qgbj1zPHRoaXMuX292ZXJsYXA/MDp0aGlzLl9vdmVybGFwLGk9bmV3ICRvKHtjb250ZXh0OnRoaXMuY29udGV4dCx1cmw6dGhpcy5idWZmZXIsZmFkZUluOm4sZmFkZU91dDp0aGlzLl9vdmVybGFwLGxvb3A6dGhpcy5sb29wLGxvb3BTdGFydDp0aGlzLl9sb29wU3RhcnQsbG9vcEVuZDp0aGlzLl9sb29wRW5kLHBsYXliYWNrUmF0ZTpubyh0aGlzLmRldHVuZS8xMDApfSkuY29ubmVjdCh0aGlzLm91dHB1dCk7aS5zdGFydCh0LHRoaXMuX2dyYWluU2l6ZSplKSxpLnN0b3AodCt0aGlzLl9ncmFpblNpemUvdGhpcy5wbGF5YmFja1JhdGUpLHRoaXMuX2FjdGl2ZVNvdXJjZXMucHVzaChpKSxpLm9uZW5kZWQ9KCk9Pntjb25zdCB0PXRoaXMuX2FjdGl2ZVNvdXJjZXMuaW5kZXhPZihpKTstMSE9PXQmJnRoaXMuX2FjdGl2ZVNvdXJjZXMuc3BsaWNlKHQsMSl9fWdldCBwbGF5YmFja1JhdGUoKXtyZXR1cm4gdGhpcy5fcGxheWJhY2tSYXRlfXNldCBwbGF5YmFja1JhdGUodCl7ZWkodCwuMDAxKSx0aGlzLl9wbGF5YmFja1JhdGU9dCx0aGlzLmdyYWluU2l6ZT10aGlzLl9ncmFpblNpemV9Z2V0IGxvb3BTdGFydCgpe3JldHVybiB0aGlzLl9sb29wU3RhcnR9c2V0IGxvb3BTdGFydCh0KXt0aGlzLmJ1ZmZlci5sb2FkZWQmJmVpKHRoaXMudG9TZWNvbmRzKHQpLDAsdGhpcy5idWZmZXIuZHVyYXRpb24pLHRoaXMuX2xvb3BTdGFydD10aGlzLnRvU2Vjb25kcyh0KX1nZXQgbG9vcEVuZCgpe3JldHVybiB0aGlzLl9sb29wRW5kfXNldCBsb29wRW5kKHQpe3RoaXMuYnVmZmVyLmxvYWRlZCYmZWkodGhpcy50b1NlY29uZHModCksMCx0aGlzLmJ1ZmZlci5kdXJhdGlvbiksdGhpcy5fbG9vcEVuZD10aGlzLnRvU2Vjb25kcyh0KX1nZXQgcmV2ZXJzZSgpe3JldHVybiB0aGlzLmJ1ZmZlci5yZXZlcnNlfXNldCByZXZlcnNlKHQpe3RoaXMuYnVmZmVyLnJldmVyc2U9dH1nZXQgZ3JhaW5TaXplKCl7cmV0dXJuIHRoaXMuX2dyYWluU2l6ZX1zZXQgZ3JhaW5TaXplKHQpe3RoaXMuX2dyYWluU2l6ZT10aGlzLnRvU2Vjb25kcyh0KSx0aGlzLl9jbG9jay5mcmVxdWVuY3kuc2V0VmFsdWVBdFRpbWUodGhpcy5fcGxheWJhY2tSYXRlL3RoaXMuX2dyYWluU2l6ZSx0aGlzLm5vdygpKX1nZXQgb3ZlcmxhcCgpe3JldHVybiB0aGlzLl9vdmVybGFwfXNldCBvdmVybGFwKHQpe2NvbnN0IGU9dGhpcy50b1NlY29uZHModCk7ZWkoZSwwKSx0aGlzLl9vdmVybGFwPWV9Z2V0IGxvYWRlZCgpe3JldHVybiB0aGlzLmJ1ZmZlci5sb2FkZWR9ZGlzcG9zZSgpe3JldHVybiBzdXBlci5kaXNwb3NlKCksdGhpcy5idWZmZXIuZGlzcG9zZSgpLHRoaXMuX2Nsb2NrLmRpc3Bvc2UoKSx0aGlzLl9hY3RpdmVTb3VyY2VzLmZvckVhY2godD0+dC5kaXNwb3NlKCkpLHRoaXN9fWNsYXNzIGtyIGV4dGVuZHMgb3J7Y29uc3RydWN0b3IoKXtzdXBlciguLi5hcmd1bWVudHMpLHRoaXMubmFtZT1cIkFic1wiLHRoaXMuX2Ficz1uZXcgcnIoe2NvbnRleHQ6dGhpcy5jb250ZXh0LG1hcHBpbmc6dD0+TWF0aC5hYnModCk8LjAwMT8wOk1hdGguYWJzKHQpfSksdGhpcy5pbnB1dD10aGlzLl9hYnMsdGhpcy5vdXRwdXQ9dGhpcy5fYWJzfWRpc3Bvc2UoKXtyZXR1cm4gc3VwZXIuZGlzcG9zZSgpLHRoaXMuX2Ficy5kaXNwb3NlKCksdGhpc319Y2xhc3MgQ3IgZXh0ZW5kcyBvcntjb25zdHJ1Y3Rvcigpe3N1cGVyKC4uLmFyZ3VtZW50cyksdGhpcy5uYW1lPVwiR2FpblRvQXVkaW9cIix0aGlzLl9ub3JtPW5ldyBycih7Y29udGV4dDp0aGlzLmNvbnRleHQsbWFwcGluZzp0PT4yKk1hdGguYWJzKHQpLTF9KSx0aGlzLmlucHV0PXRoaXMuX25vcm0sdGhpcy5vdXRwdXQ9dGhpcy5fbm9ybX1kaXNwb3NlKCl7cmV0dXJuIHN1cGVyLmRpc3Bvc2UoKSx0aGlzLl9ub3JtLmRpc3Bvc2UoKSx0aGlzfX1jbGFzcyBBciBleHRlbmRzIG9ye2NvbnN0cnVjdG9yKCl7c3VwZXIoLi4uYXJndW1lbnRzKSx0aGlzLm5hbWU9XCJOZWdhdGVcIix0aGlzLl9tdWx0aXBseT1uZXcgY3Ioe2NvbnRleHQ6dGhpcy5jb250ZXh0LHZhbHVlOi0xfSksdGhpcy5pbnB1dD10aGlzLl9tdWx0aXBseSx0aGlzLm91dHB1dD10aGlzLl9tdWx0aXBseX1kaXNwb3NlKCl7cmV0dXJuIHN1cGVyLmRpc3Bvc2UoKSx0aGlzLl9tdWx0aXBseS5kaXNwb3NlKCksdGhpc319Y2xhc3MgRHIgZXh0ZW5kcyBEb3tjb25zdHJ1Y3Rvcigpe3N1cGVyKE9iamVjdC5hc3NpZ24oRGkoRHIuZ2V0RGVmYXVsdHMoKSxhcmd1bWVudHMsW1widmFsdWVcIl0pKSksdGhpcy5vdmVycmlkZT0hMSx0aGlzLm5hbWU9XCJTdWJ0cmFjdFwiLHRoaXMuX3N1bT1uZXcga28oe2NvbnRleHQ6dGhpcy5jb250ZXh0fSksdGhpcy5pbnB1dD10aGlzLl9zdW0sdGhpcy5vdXRwdXQ9dGhpcy5fc3VtLHRoaXMuX25lZz1uZXcgQXIoe2NvbnRleHQ6dGhpcy5jb250ZXh0fSksdGhpcy5zdWJ0cmFoZW5kPXRoaXMuX3BhcmFtLGJvKHRoaXMuX2NvbnN0YW50U291cmNlLHRoaXMuX25lZyx0aGlzLl9zdW0pfXN0YXRpYyBnZXREZWZhdWx0cygpe3JldHVybiBPYmplY3QuYXNzaWduKERvLmdldERlZmF1bHRzKCkse3ZhbHVlOjB9KX1kaXNwb3NlKCl7cmV0dXJuIHN1cGVyLmRpc3Bvc2UoKSx0aGlzLl9uZWcuZGlzcG9zZSgpLHRoaXMuX3N1bS5kaXNwb3NlKCksdGhpc319Y2xhc3MgT3IgZXh0ZW5kcyBvcntjb25zdHJ1Y3Rvcigpe3N1cGVyKE9iamVjdC5hc3NpZ24oRGkoT3IuZ2V0RGVmYXVsdHMoKSxhcmd1bWVudHMpKSksdGhpcy5uYW1lPVwiR3JlYXRlclRoYW5aZXJvXCIsdGhpcy5fdGhyZXNoPXRoaXMub3V0cHV0PW5ldyBycih7Y29udGV4dDp0aGlzLmNvbnRleHQsbGVuZ3RoOjEyNyxtYXBwaW5nOnQ9PnQ8PTA/MDoxfSksdGhpcy5fc2NhbGU9dGhpcy5pbnB1dD1uZXcgY3Ioe2NvbnRleHQ6dGhpcy5jb250ZXh0LHZhbHVlOjFlNH0pLHRoaXMuX3NjYWxlLmNvbm5lY3QodGhpcy5fdGhyZXNoKX1kaXNwb3NlKCl7cmV0dXJuIHN1cGVyLmRpc3Bvc2UoKSx0aGlzLl9zY2FsZS5kaXNwb3NlKCksdGhpcy5fdGhyZXNoLmRpc3Bvc2UoKSx0aGlzfX1jbGFzcyBNciBleHRlbmRzIERve2NvbnN0cnVjdG9yKCl7c3VwZXIoT2JqZWN0LmFzc2lnbihEaShNci5nZXREZWZhdWx0cygpLGFyZ3VtZW50cyxbXCJ2YWx1ZVwiXSkpKSx0aGlzLm5hbWU9XCJHcmVhdGVyVGhhblwiLHRoaXMub3ZlcnJpZGU9ITE7Y29uc3QgdD1EaShNci5nZXREZWZhdWx0cygpLGFyZ3VtZW50cyxbXCJ2YWx1ZVwiXSk7dGhpcy5fc3VidHJhY3Q9dGhpcy5pbnB1dD1uZXcgRHIoe2NvbnRleHQ6dGhpcy5jb250ZXh0LHZhbHVlOnQudmFsdWV9KSx0aGlzLl9ndHo9dGhpcy5vdXRwdXQ9bmV3IE9yKHtjb250ZXh0OnRoaXMuY29udGV4dH0pLHRoaXMuY29tcGFyYXRvcj10aGlzLl9wYXJhbT10aGlzLl9zdWJ0cmFjdC5zdWJ0cmFoZW5kLFVpKHRoaXMsXCJjb21wYXJhdG9yXCIpLHRoaXMuX3N1YnRyYWN0LmNvbm5lY3QodGhpcy5fZ3R6KX1zdGF0aWMgZ2V0RGVmYXVsdHMoKXtyZXR1cm4gT2JqZWN0LmFzc2lnbihEby5nZXREZWZhdWx0cygpLHt2YWx1ZTowfSl9ZGlzcG9zZSgpe3JldHVybiBzdXBlci5kaXNwb3NlKCksdGhpcy5fZ3R6LmRpc3Bvc2UoKSx0aGlzLl9zdWJ0cmFjdC5kaXNwb3NlKCksdGhpcy5jb21wYXJhdG9yLmRpc3Bvc2UoKSx0aGlzfX1jbGFzcyBFciBleHRlbmRzIG9ye2NvbnN0cnVjdG9yKCl7c3VwZXIoT2JqZWN0LmFzc2lnbihEaShFci5nZXREZWZhdWx0cygpLGFyZ3VtZW50cyxbXCJ2YWx1ZVwiXSkpKSx0aGlzLm5hbWU9XCJQb3dcIjtjb25zdCB0PURpKEVyLmdldERlZmF1bHRzKCksYXJndW1lbnRzLFtcInZhbHVlXCJdKTt0aGlzLl9leHBvbmVudFNjYWxlcj10aGlzLmlucHV0PXRoaXMub3V0cHV0PW5ldyBycih7Y29udGV4dDp0aGlzLmNvbnRleHQsbWFwcGluZzp0aGlzLl9leHBGdW5jKHQudmFsdWUpLGxlbmd0aDo4MTkyfSksdGhpcy5fZXhwb25lbnQ9dC52YWx1ZX1zdGF0aWMgZ2V0RGVmYXVsdHMoKXtyZXR1cm4gT2JqZWN0LmFzc2lnbihvci5nZXREZWZhdWx0cygpLHt2YWx1ZToxfSl9X2V4cEZ1bmModCl7cmV0dXJuIGU9Pk1hdGgucG93KE1hdGguYWJzKGUpLHQpfWdldCB2YWx1ZSgpe3JldHVybiB0aGlzLl9leHBvbmVudH1zZXQgdmFsdWUodCl7dGhpcy5fZXhwb25lbnQ9dCx0aGlzLl9leHBvbmVudFNjYWxlci5zZXRNYXAodGhpcy5fZXhwRnVuYyh0aGlzLl9leHBvbmVudCkpfWRpc3Bvc2UoKXtyZXR1cm4gc3VwZXIuZGlzcG9zZSgpLHRoaXMuX2V4cG9uZW50U2NhbGVyLmRpc3Bvc2UoKSx0aGlzfX1jbGFzcyBSciBleHRlbmRzIGdye2NvbnN0cnVjdG9yKCl7c3VwZXIoT2JqZWN0LmFzc2lnbihEaShSci5nZXREZWZhdWx0cygpLGFyZ3VtZW50cyxbXCJtaW5cIixcIm1heFwiLFwiZXhwb25lbnRcIl0pKSksdGhpcy5uYW1lPVwiU2NhbGVFeHBcIjtjb25zdCB0PURpKFJyLmdldERlZmF1bHRzKCksYXJndW1lbnRzLFtcIm1pblwiLFwibWF4XCIsXCJleHBvbmVudFwiXSk7dGhpcy5pbnB1dD10aGlzLl9leHA9bmV3IEVyKHtjb250ZXh0OnRoaXMuY29udGV4dCx2YWx1ZTp0LmV4cG9uZW50fSksdGhpcy5fZXhwLmNvbm5lY3QodGhpcy5fbXVsdCl9c3RhdGljIGdldERlZmF1bHRzKCl7cmV0dXJuIE9iamVjdC5hc3NpZ24oZ3IuZ2V0RGVmYXVsdHMoKSx7ZXhwb25lbnQ6MX0pfWdldCBleHBvbmVudCgpe3JldHVybiB0aGlzLl9leHAudmFsdWV9c2V0IGV4cG9uZW50KHQpe3RoaXMuX2V4cC52YWx1ZT10fWRpc3Bvc2UoKXtyZXR1cm4gc3VwZXIuZGlzcG9zZSgpLHRoaXMuX2V4cC5kaXNwb3NlKCksdGhpc319Y2xhc3MgcXIgZXh0ZW5kcyBEb3tjb25zdHJ1Y3Rvcigpe3N1cGVyKERpKERvLmdldERlZmF1bHRzKCksYXJndW1lbnRzLFtcInZhbHVlXCIsXCJ1bml0c1wiXSkpLHRoaXMubmFtZT1cIlN5bmNlZFNpZ25hbFwiLHRoaXMub3ZlcnJpZGU9ITE7Y29uc3QgdD1EaShEby5nZXREZWZhdWx0cygpLGFyZ3VtZW50cyxbXCJ2YWx1ZVwiLFwidW5pdHNcIl0pO3RoaXMuX2xhc3RWYWw9dC52YWx1ZSx0aGlzLl9zeW5jZWQ9dGhpcy5jb250ZXh0LnRyYW5zcG9ydC5zY2hlZHVsZVJlcGVhdCh0aGlzLl9vblRpY2suYmluZCh0aGlzKSxcIjFpXCIpLHRoaXMuX3N5bmNlZENhbGxiYWNrPXRoaXMuX2FuY2hvclZhbHVlLmJpbmQodGhpcyksdGhpcy5jb250ZXh0LnRyYW5zcG9ydC5vbihcInN0YXJ0XCIsdGhpcy5fc3luY2VkQ2FsbGJhY2spLHRoaXMuY29udGV4dC50cmFuc3BvcnQub24oXCJwYXVzZVwiLHRoaXMuX3N5bmNlZENhbGxiYWNrKSx0aGlzLmNvbnRleHQudHJhbnNwb3J0Lm9uKFwic3RvcFwiLHRoaXMuX3N5bmNlZENhbGxiYWNrKSx0aGlzLl9jb25zdGFudFNvdXJjZS5kaXNjb25uZWN0KCksdGhpcy5fY29uc3RhbnRTb3VyY2Uuc3RvcCgwKSx0aGlzLl9jb25zdGFudFNvdXJjZT10aGlzLm91dHB1dD1uZXcgQW8oe2NvbnRleHQ6dGhpcy5jb250ZXh0LG9mZnNldDp0LnZhbHVlLHVuaXRzOnQudW5pdHN9KS5zdGFydCgwKSx0aGlzLnNldFZhbHVlQXRUaW1lKHQudmFsdWUsMCl9X29uVGljayh0KXtjb25zdCBlPXN1cGVyLmdldFZhbHVlQXRUaW1lKHRoaXMuY29udGV4dC50cmFuc3BvcnQuc2Vjb25kcyk7dGhpcy5fbGFzdFZhbCE9PWUmJih0aGlzLl9sYXN0VmFsPWUsdGhpcy5fY29uc3RhbnRTb3VyY2Uub2Zmc2V0LnNldFZhbHVlQXRUaW1lKGUsdCkpfV9hbmNob3JWYWx1ZSh0KXtjb25zdCBlPXN1cGVyLmdldFZhbHVlQXRUaW1lKHRoaXMuY29udGV4dC50cmFuc3BvcnQuc2Vjb25kcyk7dGhpcy5fbGFzdFZhbD1lLHRoaXMuX2NvbnN0YW50U291cmNlLm9mZnNldC5jYW5jZWxBbmRIb2xkQXRUaW1lKHQpLHRoaXMuX2NvbnN0YW50U291cmNlLm9mZnNldC5zZXRWYWx1ZUF0VGltZShlLHQpfWdldFZhbHVlQXRUaW1lKHQpe2NvbnN0IGU9bmV3IG1vKHRoaXMuY29udGV4dCx0KS50b1NlY29uZHMoKTtyZXR1cm4gc3VwZXIuZ2V0VmFsdWVBdFRpbWUoZSl9c2V0VmFsdWVBdFRpbWUodCxlKXtjb25zdCBzPW5ldyBtbyh0aGlzLmNvbnRleHQsZSkudG9TZWNvbmRzKCk7cmV0dXJuIHN1cGVyLnNldFZhbHVlQXRUaW1lKHQscyksdGhpc31saW5lYXJSYW1wVG9WYWx1ZUF0VGltZSh0LGUpe2NvbnN0IHM9bmV3IG1vKHRoaXMuY29udGV4dCxlKS50b1NlY29uZHMoKTtyZXR1cm4gc3VwZXIubGluZWFyUmFtcFRvVmFsdWVBdFRpbWUodCxzKSx0aGlzfWV4cG9uZW50aWFsUmFtcFRvVmFsdWVBdFRpbWUodCxlKXtjb25zdCBzPW5ldyBtbyh0aGlzLmNvbnRleHQsZSkudG9TZWNvbmRzKCk7cmV0dXJuIHN1cGVyLmV4cG9uZW50aWFsUmFtcFRvVmFsdWVBdFRpbWUodCxzKSx0aGlzfXNldFRhcmdldEF0VGltZSh0LGUscyl7Y29uc3Qgbj1uZXcgbW8odGhpcy5jb250ZXh0LGUpLnRvU2Vjb25kcygpO3JldHVybiBzdXBlci5zZXRUYXJnZXRBdFRpbWUodCxuLHMpLHRoaXN9Y2FuY2VsU2NoZWR1bGVkVmFsdWVzKHQpe2NvbnN0IGU9bmV3IG1vKHRoaXMuY29udGV4dCx0KS50b1NlY29uZHMoKTtyZXR1cm4gc3VwZXIuY2FuY2VsU2NoZWR1bGVkVmFsdWVzKGUpLHRoaXN9c2V0VmFsdWVDdXJ2ZUF0VGltZSh0LGUscyxuKXtjb25zdCBpPW5ldyBtbyh0aGlzLmNvbnRleHQsZSkudG9TZWNvbmRzKCk7cmV0dXJuIHM9dGhpcy50b1NlY29uZHMocyksc3VwZXIuc2V0VmFsdWVDdXJ2ZUF0VGltZSh0LGkscyxuKSx0aGlzfWNhbmNlbEFuZEhvbGRBdFRpbWUodCl7Y29uc3QgZT1uZXcgbW8odGhpcy5jb250ZXh0LHQpLnRvU2Vjb25kcygpO3JldHVybiBzdXBlci5jYW5jZWxBbmRIb2xkQXRUaW1lKGUpLHRoaXN9c2V0UmFtcFBvaW50KHQpe2NvbnN0IGU9bmV3IG1vKHRoaXMuY29udGV4dCx0KS50b1NlY29uZHMoKTtyZXR1cm4gc3VwZXIuc2V0UmFtcFBvaW50KGUpLHRoaXN9ZXhwb25lbnRpYWxSYW1wVG8odCxlLHMpe2NvbnN0IG49bmV3IG1vKHRoaXMuY29udGV4dCxzKS50b1NlY29uZHMoKTtyZXR1cm4gc3VwZXIuZXhwb25lbnRpYWxSYW1wVG8odCxlLG4pLHRoaXN9bGluZWFyUmFtcFRvKHQsZSxzKXtjb25zdCBuPW5ldyBtbyh0aGlzLmNvbnRleHQscykudG9TZWNvbmRzKCk7cmV0dXJuIHN1cGVyLmxpbmVhclJhbXBUbyh0LGUsbiksdGhpc310YXJnZXRSYW1wVG8odCxlLHMpe2NvbnN0IG49bmV3IG1vKHRoaXMuY29udGV4dCxzKS50b1NlY29uZHMoKTtyZXR1cm4gc3VwZXIudGFyZ2V0UmFtcFRvKHQsZSxuKSx0aGlzfWRpc3Bvc2UoKXtyZXR1cm4gc3VwZXIuZGlzcG9zZSgpLHRoaXMuY29udGV4dC50cmFuc3BvcnQuY2xlYXIodGhpcy5fc3luY2VkKSx0aGlzLmNvbnRleHQudHJhbnNwb3J0Lm9mZihcInN0YXJ0XCIsdGhpcy5fc3luY2VkQ2FsbGJhY2spLHRoaXMuY29udGV4dC50cmFuc3BvcnQub2ZmKFwicGF1c2VcIix0aGlzLl9zeW5jZWRDYWxsYmFjayksdGhpcy5jb250ZXh0LnRyYW5zcG9ydC5vZmYoXCJzdG9wXCIsdGhpcy5fc3luY2VkQ2FsbGJhY2spLHRoaXMuX2NvbnN0YW50U291cmNlLmRpc3Bvc2UoKSx0aGlzfX1jbGFzcyBGciBleHRlbmRzIHdve2NvbnN0cnVjdG9yKCl7c3VwZXIoRGkoRnIuZ2V0RGVmYXVsdHMoKSxhcmd1bWVudHMsW1wiYXR0YWNrXCIsXCJkZWNheVwiLFwic3VzdGFpblwiLFwicmVsZWFzZVwiXSkpLHRoaXMubmFtZT1cIkVudmVsb3BlXCIsdGhpcy5fc2lnPW5ldyBEbyh7Y29udGV4dDp0aGlzLmNvbnRleHQsdmFsdWU6MH0pLHRoaXMub3V0cHV0PXRoaXMuX3NpZyx0aGlzLmlucHV0PXZvaWQgMDtjb25zdCB0PURpKEZyLmdldERlZmF1bHRzKCksYXJndW1lbnRzLFtcImF0dGFja1wiLFwiZGVjYXlcIixcInN1c3RhaW5cIixcInJlbGVhc2VcIl0pO3RoaXMuYXR0YWNrPXQuYXR0YWNrLHRoaXMuZGVjYXk9dC5kZWNheSx0aGlzLnN1c3RhaW49dC5zdXN0YWluLHRoaXMucmVsZWFzZT10LnJlbGVhc2UsdGhpcy5hdHRhY2tDdXJ2ZT10LmF0dGFja0N1cnZlLHRoaXMucmVsZWFzZUN1cnZlPXQucmVsZWFzZUN1cnZlLHRoaXMuZGVjYXlDdXJ2ZT10LmRlY2F5Q3VydmV9c3RhdGljIGdldERlZmF1bHRzKCl7cmV0dXJuIE9iamVjdC5hc3NpZ24od28uZ2V0RGVmYXVsdHMoKSx7YXR0YWNrOi4wMSxhdHRhY2tDdXJ2ZTpcImxpbmVhclwiLGRlY2F5Oi4xLGRlY2F5Q3VydmU6XCJleHBvbmVudGlhbFwiLHJlbGVhc2U6MSxyZWxlYXNlQ3VydmU6XCJleHBvbmVudGlhbFwiLHN1c3RhaW46LjV9KX1nZXQgdmFsdWUoKXtyZXR1cm4gdGhpcy5nZXRWYWx1ZUF0VGltZSh0aGlzLm5vdygpKX1fZ2V0Q3VydmUodCxlKXtpZihmaSh0KSlyZXR1cm4gdDt7bGV0IHM7Zm9yKHMgaW4gSXIpaWYoSXJbc11bZV09PT10KXJldHVybiBzO3JldHVybiB0fX1fc2V0Q3VydmUodCxlLHMpe2lmKGZpKHMpJiZSZWZsZWN0LmhhcyhJcixzKSl7Y29uc3Qgbj1JcltzXTtsaShuKT9cIl9kZWNheUN1cnZlXCIhPT10JiYodGhpc1t0XT1uW2VdKTp0aGlzW3RdPW59ZWxzZXtpZighZGkocyl8fFwiX2RlY2F5Q3VydmVcIj09PXQpdGhyb3cgbmV3IEVycm9yKFwiRW52ZWxvcGU6IGludmFsaWQgY3VydmU6IFwiK3MpO3RoaXNbdF09c319Z2V0IGF0dGFja0N1cnZlKCl7cmV0dXJuIHRoaXMuX2dldEN1cnZlKHRoaXMuX2F0dGFja0N1cnZlLFwiSW5cIil9c2V0IGF0dGFja0N1cnZlKHQpe3RoaXMuX3NldEN1cnZlKFwiX2F0dGFja0N1cnZlXCIsXCJJblwiLHQpfWdldCByZWxlYXNlQ3VydmUoKXtyZXR1cm4gdGhpcy5fZ2V0Q3VydmUodGhpcy5fcmVsZWFzZUN1cnZlLFwiT3V0XCIpfXNldCByZWxlYXNlQ3VydmUodCl7dGhpcy5fc2V0Q3VydmUoXCJfcmVsZWFzZUN1cnZlXCIsXCJPdXRcIix0KX1nZXQgZGVjYXlDdXJ2ZSgpe3JldHVybiB0aGlzLl9kZWNheUN1cnZlfXNldCBkZWNheUN1cnZlKHQpe3RpKFtcImxpbmVhclwiLFwiZXhwb25lbnRpYWxcIl0uc29tZShlPT5lPT09dCksXCJJbnZhbGlkIGVudmVsb3BlIGN1cnZlOiBcIit0KSx0aGlzLl9kZWNheUN1cnZlPXR9dHJpZ2dlckF0dGFjayh0LGU9MSl7dGhpcy5sb2coXCJ0cmlnZ2VyQXR0YWNrXCIsdCxlKSx0PXRoaXMudG9TZWNvbmRzKHQpO2xldCBzPXRoaXMudG9TZWNvbmRzKHRoaXMuYXR0YWNrKTtjb25zdCBuPXRoaXMudG9TZWNvbmRzKHRoaXMuZGVjYXkpLGk9dGhpcy5nZXRWYWx1ZUF0VGltZSh0KTtpZihpPjApe3M9KDEtaSkvKDEvcyl9aWYoczx0aGlzLnNhbXBsZVRpbWUpdGhpcy5fc2lnLmNhbmNlbFNjaGVkdWxlZFZhbHVlcyh0KSx0aGlzLl9zaWcuc2V0VmFsdWVBdFRpbWUoZSx0KTtlbHNlIGlmKFwibGluZWFyXCI9PT10aGlzLl9hdHRhY2tDdXJ2ZSl0aGlzLl9zaWcubGluZWFyUmFtcFRvKGUscyx0KTtlbHNlIGlmKFwiZXhwb25lbnRpYWxcIj09PXRoaXMuX2F0dGFja0N1cnZlKXRoaXMuX3NpZy50YXJnZXRSYW1wVG8oZSxzLHQpO2Vsc2V7dGhpcy5fc2lnLmNhbmNlbEFuZEhvbGRBdFRpbWUodCk7bGV0IG49dGhpcy5fYXR0YWNrQ3VydmU7Zm9yKGxldCB0PTE7dDxuLmxlbmd0aDt0KyspaWYoblt0LTFdPD1pJiZpPD1uW3RdKXtuPXRoaXMuX2F0dGFja0N1cnZlLnNsaWNlKHQpLG5bMF09aTticmVha310aGlzLl9zaWcuc2V0VmFsdWVDdXJ2ZUF0VGltZShuLHQscyxlKX1pZihuJiZ0aGlzLnN1c3RhaW48MSl7Y29uc3QgaT1lKnRoaXMuc3VzdGFpbixvPXQrczt0aGlzLmxvZyhcImRlY2F5XCIsbyksXCJsaW5lYXJcIj09PXRoaXMuX2RlY2F5Q3VydmU/dGhpcy5fc2lnLmxpbmVhclJhbXBUb1ZhbHVlQXRUaW1lKGksbitvKTp0aGlzLl9zaWcuZXhwb25lbnRpYWxBcHByb2FjaFZhbHVlQXRUaW1lKGksbyxuKX1yZXR1cm4gdGhpc310cmlnZ2VyUmVsZWFzZSh0KXt0aGlzLmxvZyhcInRyaWdnZXJSZWxlYXNlXCIsdCksdD10aGlzLnRvU2Vjb25kcyh0KTtjb25zdCBlPXRoaXMuZ2V0VmFsdWVBdFRpbWUodCk7aWYoZT4wKXtjb25zdCBzPXRoaXMudG9TZWNvbmRzKHRoaXMucmVsZWFzZSk7czx0aGlzLnNhbXBsZVRpbWU/dGhpcy5fc2lnLnNldFZhbHVlQXRUaW1lKDAsdCk6XCJsaW5lYXJcIj09PXRoaXMuX3JlbGVhc2VDdXJ2ZT90aGlzLl9zaWcubGluZWFyUmFtcFRvKDAscyx0KTpcImV4cG9uZW50aWFsXCI9PT10aGlzLl9yZWxlYXNlQ3VydmU/dGhpcy5fc2lnLnRhcmdldFJhbXBUbygwLHMsdCk6KHRpKGRpKHRoaXMuX3JlbGVhc2VDdXJ2ZSksXCJyZWxlYXNlQ3VydmUgbXVzdCBiZSBlaXRoZXIgJ2xpbmVhcicsICdleHBvbmVudGlhbCcgb3IgYW4gYXJyYXlcIiksdGhpcy5fc2lnLmNhbmNlbEFuZEhvbGRBdFRpbWUodCksdGhpcy5fc2lnLnNldFZhbHVlQ3VydmVBdFRpbWUodGhpcy5fcmVsZWFzZUN1cnZlLHQscyxlKSl9cmV0dXJuIHRoaXN9Z2V0VmFsdWVBdFRpbWUodCl7cmV0dXJuIHRoaXMuX3NpZy5nZXRWYWx1ZUF0VGltZSh0KX10cmlnZ2VyQXR0YWNrUmVsZWFzZSh0LGUscz0xKXtyZXR1cm4gZT10aGlzLnRvU2Vjb25kcyhlKSx0aGlzLnRyaWdnZXJBdHRhY2soZSxzKSx0aGlzLnRyaWdnZXJSZWxlYXNlKGUrdGhpcy50b1NlY29uZHModCkpLHRoaXN9Y2FuY2VsKHQpe3JldHVybiB0aGlzLl9zaWcuY2FuY2VsU2NoZWR1bGVkVmFsdWVzKHRoaXMudG9TZWNvbmRzKHQpKSx0aGlzfWNvbm5lY3QodCxlPTAscz0wKXtyZXR1cm4gT28odGhpcyx0LGUscyksdGhpc31hc0FycmF5KHQ9MTAyNCl7cmV0dXJuIHlpKHRoaXMsdm9pZCAwLHZvaWQgMCwoZnVuY3Rpb24qKCl7Y29uc3QgZT10L3RoaXMuY29udGV4dC5zYW1wbGVSYXRlLHM9bmV3IFlpKDEsZSx0aGlzLmNvbnRleHQuc2FtcGxlUmF0ZSksbj10aGlzLnRvU2Vjb25kcyh0aGlzLmF0dGFjaykrdGhpcy50b1NlY29uZHModGhpcy5kZWNheSksaT1uK3RoaXMudG9TZWNvbmRzKHRoaXMucmVsZWFzZSksbz0uMSppLHI9aStvLGE9bmV3IHRoaXMuY29uc3RydWN0b3IoT2JqZWN0LmFzc2lnbih0aGlzLmdldCgpLHthdHRhY2s6ZSp0aGlzLnRvU2Vjb25kcyh0aGlzLmF0dGFjaykvcixkZWNheTplKnRoaXMudG9TZWNvbmRzKHRoaXMuZGVjYXkpL3IscmVsZWFzZTplKnRoaXMudG9TZWNvbmRzKHRoaXMucmVsZWFzZSkvcixjb250ZXh0OnN9KSk7YS5fc2lnLnRvRGVzdGluYXRpb24oKSxhLnRyaWdnZXJBdHRhY2tSZWxlYXNlKGUqKG4rbykvciwwKTtyZXR1cm4oeWllbGQgcy5yZW5kZXIoKSkuZ2V0Q2hhbm5lbERhdGEoMCl9KSl9ZGlzcG9zZSgpe3JldHVybiBzdXBlci5kaXNwb3NlKCksdGhpcy5fc2lnLmRpc3Bvc2UoKSx0aGlzfX12aShbd3IoMCldLEZyLnByb3RvdHlwZSxcImF0dGFja1wiLHZvaWQgMCksdmkoW3dyKDApXSxGci5wcm90b3R5cGUsXCJkZWNheVwiLHZvaWQgMCksdmkoW3hyKDAsMSldLEZyLnByb3RvdHlwZSxcInN1c3RhaW5cIix2b2lkIDApLHZpKFt3cigwKV0sRnIucHJvdG90eXBlLFwicmVsZWFzZVwiLHZvaWQgMCk7Y29uc3QgSXI9KCgpPT57bGV0IHQsZTtjb25zdCBzPVtdO2Zvcih0PTA7dDwxMjg7dCsrKXNbdF09TWF0aC5zaW4odC8xMjcqKE1hdGguUEkvMikpO2NvbnN0IG49W107Zm9yKHQ9MDt0PDEyNzt0Kyspe2U9dC8xMjc7Y29uc3Qgcz1NYXRoLnNpbihlKigyKk1hdGguUEkpKjYuNC1NYXRoLlBJLzIpKzE7blt0XT1zLzEwKy44MyplfW5bMTI3XT0xO2NvbnN0IGk9W107Zm9yKHQ9MDt0PDEyODt0KyspaVt0XT1NYXRoLmNlaWwodC8xMjcqNSkvNTtjb25zdCBvPVtdO2Zvcih0PTA7dDwxMjg7dCsrKWU9dC8xMjcsb1t0XT0uNSooMS1NYXRoLmNvcyhNYXRoLlBJKmUpKTtjb25zdCByPVtdO2Zvcih0PTA7dDwxMjg7dCsrKXtlPXQvMTI3O2NvbnN0IHM9NCpNYXRoLnBvdyhlLDMpKy4yLG49TWF0aC5jb3MocypNYXRoLlBJKjIqZSk7clt0XT1NYXRoLmFicyhuKigxLWUpKX1mdW5jdGlvbiBhKHQpe2NvbnN0IGU9bmV3IEFycmF5KHQubGVuZ3RoKTtmb3IobGV0IHM9MDtzPHQubGVuZ3RoO3MrKyllW3NdPTEtdFtzXTtyZXR1cm4gZX1yZXR1cm57Ym91bmNlOntJbjphKHIpLE91dDpyfSxjb3NpbmU6e0luOnMsT3V0OihjPXMsYy5zbGljZSgwKS5yZXZlcnNlKCkpfSxleHBvbmVudGlhbDpcImV4cG9uZW50aWFsXCIsbGluZWFyOlwibGluZWFyXCIscmlwcGxlOntJbjpuLE91dDphKG4pfSxzaW5lOntJbjpvLE91dDphKG8pfSxzdGVwOntJbjppLE91dDphKGkpfX07dmFyIGN9KSgpO2NsYXNzIFZyIGV4dGVuZHMgd297Y29uc3RydWN0b3IoKXtzdXBlcihEaShWci5nZXREZWZhdWx0cygpLGFyZ3VtZW50cykpLHRoaXMuX3NjaGVkdWxlZEV2ZW50cz1bXSx0aGlzLl9zeW5jZWQ9ITEsdGhpcy5fb3JpZ2luYWxfdHJpZ2dlckF0dGFjaz10aGlzLnRyaWdnZXJBdHRhY2ssdGhpcy5fb3JpZ2luYWxfdHJpZ2dlclJlbGVhc2U9dGhpcy50cmlnZ2VyUmVsZWFzZTtjb25zdCB0PURpKFZyLmdldERlZmF1bHRzKCksYXJndW1lbnRzKTt0aGlzLl92b2x1bWU9dGhpcy5vdXRwdXQ9bmV3IEdvKHtjb250ZXh0OnRoaXMuY29udGV4dCx2b2x1bWU6dC52b2x1bWV9KSx0aGlzLnZvbHVtZT10aGlzLl92b2x1bWUudm9sdW1lLFVpKHRoaXMsXCJ2b2x1bWVcIil9c3RhdGljIGdldERlZmF1bHRzKCl7cmV0dXJuIE9iamVjdC5hc3NpZ24od28uZ2V0RGVmYXVsdHMoKSx7dm9sdW1lOjB9KX1zeW5jKCl7cmV0dXJuIHRoaXMuX3N5bmNTdGF0ZSgpJiYodGhpcy5fc3luY01ldGhvZChcInRyaWdnZXJBdHRhY2tcIiwxKSx0aGlzLl9zeW5jTWV0aG9kKFwidHJpZ2dlclJlbGVhc2VcIiwwKSksdGhpc31fc3luY1N0YXRlKCl7bGV0IHQ9ITE7cmV0dXJuIHRoaXMuX3N5bmNlZHx8KHRoaXMuX3N5bmNlZD0hMCx0PSEwKSx0fV9zeW5jTWV0aG9kKHQsZSl7Y29uc3Qgcz10aGlzW1wiX29yaWdpbmFsX1wiK3RdPXRoaXNbdF07dGhpc1t0XT0oLi4udCk9Pntjb25zdCBuPXRbZV0saT10aGlzLmNvbnRleHQudHJhbnNwb3J0LnNjaGVkdWxlKG49Pnt0W2VdPW4scy5hcHBseSh0aGlzLHQpfSxuKTt0aGlzLl9zY2hlZHVsZWRFdmVudHMucHVzaChpKX19dW5zeW5jKCl7cmV0dXJuIHRoaXMuX3NjaGVkdWxlZEV2ZW50cy5mb3JFYWNoKHQ9PnRoaXMuY29udGV4dC50cmFuc3BvcnQuY2xlYXIodCkpLHRoaXMuX3NjaGVkdWxlZEV2ZW50cz1bXSx0aGlzLl9zeW5jZWQmJih0aGlzLl9zeW5jZWQ9ITEsdGhpcy50cmlnZ2VyQXR0YWNrPXRoaXMuX29yaWdpbmFsX3RyaWdnZXJBdHRhY2ssdGhpcy50cmlnZ2VyUmVsZWFzZT10aGlzLl9vcmlnaW5hbF90cmlnZ2VyUmVsZWFzZSksdGhpc310cmlnZ2VyQXR0YWNrUmVsZWFzZSh0LGUscyxuKXtjb25zdCBpPXRoaXMudG9TZWNvbmRzKHMpLG89dGhpcy50b1NlY29uZHMoZSk7cmV0dXJuIHRoaXMudHJpZ2dlckF0dGFjayh0LGksbiksdGhpcy50cmlnZ2VyUmVsZWFzZShpK28pLHRoaXN9ZGlzcG9zZSgpe3JldHVybiBzdXBlci5kaXNwb3NlKCksdGhpcy5fdm9sdW1lLmRpc3Bvc2UoKSx0aGlzLnVuc3luYygpLHRoaXMuX3NjaGVkdWxlZEV2ZW50cz1bXSx0aGlzfX1jbGFzcyBOciBleHRlbmRzIFZye2NvbnN0cnVjdG9yKCl7c3VwZXIoRGkoTnIuZ2V0RGVmYXVsdHMoKSxhcmd1bWVudHMpKTtjb25zdCB0PURpKE5yLmdldERlZmF1bHRzKCksYXJndW1lbnRzKTt0aGlzLnBvcnRhbWVudG89dC5wb3J0YW1lbnRvLHRoaXMub25zaWxlbmNlPXQub25zaWxlbmNlfXN0YXRpYyBnZXREZWZhdWx0cygpe3JldHVybiBPYmplY3QuYXNzaWduKFZyLmdldERlZmF1bHRzKCkse2RldHVuZTowLG9uc2lsZW5jZTpaaSxwb3J0YW1lbnRvOjB9KX10cmlnZ2VyQXR0YWNrKHQsZSxzPTEpe3RoaXMubG9nKFwidHJpZ2dlckF0dGFja1wiLHQsZSxzKTtjb25zdCBuPXRoaXMudG9TZWNvbmRzKGUpO3JldHVybiB0aGlzLl90cmlnZ2VyRW52ZWxvcGVBdHRhY2sobixzKSx0aGlzLnNldE5vdGUodCxuKSx0aGlzfXRyaWdnZXJSZWxlYXNlKHQpe3RoaXMubG9nKFwidHJpZ2dlclJlbGVhc2VcIix0KTtjb25zdCBlPXRoaXMudG9TZWNvbmRzKHQpO3JldHVybiB0aGlzLl90cmlnZ2VyRW52ZWxvcGVSZWxlYXNlKGUpLHRoaXN9c2V0Tm90ZSh0LGUpe2NvbnN0IHM9dGhpcy50b1NlY29uZHMoZSksbj10IGluc3RhbmNlb2YgbG8/dC50b0ZyZXF1ZW5jeSgpOnQ7aWYodGhpcy5wb3J0YW1lbnRvPjAmJnRoaXMuZ2V0TGV2ZWxBdFRpbWUocyk+LjA1KXtjb25zdCB0PXRoaXMudG9TZWNvbmRzKHRoaXMucG9ydGFtZW50byk7dGhpcy5mcmVxdWVuY3kuZXhwb25lbnRpYWxSYW1wVG8obix0LHMpfWVsc2UgdGhpcy5mcmVxdWVuY3kuc2V0VmFsdWVBdFRpbWUobixzKTtyZXR1cm4gdGhpc319dmkoW3dyKDApXSxOci5wcm90b3R5cGUsXCJwb3J0YW1lbnRvXCIsdm9pZCAwKTtjbGFzcyBQciBleHRlbmRzIEZye2NvbnN0cnVjdG9yKCl7c3VwZXIoRGkoUHIuZ2V0RGVmYXVsdHMoKSxhcmd1bWVudHMsW1wiYXR0YWNrXCIsXCJkZWNheVwiLFwic3VzdGFpblwiLFwicmVsZWFzZVwiXSkpLHRoaXMubmFtZT1cIkFtcGxpdHVkZUVudmVsb3BlXCIsdGhpcy5fZ2Fpbk5vZGU9bmV3IGtvKHtjb250ZXh0OnRoaXMuY29udGV4dCxnYWluOjB9KSx0aGlzLm91dHB1dD10aGlzLl9nYWluTm9kZSx0aGlzLmlucHV0PXRoaXMuX2dhaW5Ob2RlLHRoaXMuX3NpZy5jb25uZWN0KHRoaXMuX2dhaW5Ob2RlLmdhaW4pLHRoaXMub3V0cHV0PXRoaXMuX2dhaW5Ob2RlLHRoaXMuaW5wdXQ9dGhpcy5fZ2Fpbk5vZGV9ZGlzcG9zZSgpe3JldHVybiBzdXBlci5kaXNwb3NlKCksdGhpcy5fZ2Fpbk5vZGUuZGlzcG9zZSgpLHRoaXN9fWNsYXNzIGpyIGV4dGVuZHMgTnJ7Y29uc3RydWN0b3IoKXtzdXBlcihEaShqci5nZXREZWZhdWx0cygpLGFyZ3VtZW50cykpLHRoaXMubmFtZT1cIlN5bnRoXCI7Y29uc3QgdD1EaShqci5nZXREZWZhdWx0cygpLGFyZ3VtZW50cyk7dGhpcy5vc2NpbGxhdG9yPW5ldyBfcihPYmplY3QuYXNzaWduKHtjb250ZXh0OnRoaXMuY29udGV4dCxkZXR1bmU6dC5kZXR1bmUsb25zdG9wOigpPT50aGlzLm9uc2lsZW5jZSh0aGlzKX0sdC5vc2NpbGxhdG9yKSksdGhpcy5mcmVxdWVuY3k9dGhpcy5vc2NpbGxhdG9yLmZyZXF1ZW5jeSx0aGlzLmRldHVuZT10aGlzLm9zY2lsbGF0b3IuZGV0dW5lLHRoaXMuZW52ZWxvcGU9bmV3IFByKE9iamVjdC5hc3NpZ24oe2NvbnRleHQ6dGhpcy5jb250ZXh0fSx0LmVudmVsb3BlKSksdGhpcy5vc2NpbGxhdG9yLmNoYWluKHRoaXMuZW52ZWxvcGUsdGhpcy5vdXRwdXQpLFVpKHRoaXMsW1wib3NjaWxsYXRvclwiLFwiZnJlcXVlbmN5XCIsXCJkZXR1bmVcIixcImVudmVsb3BlXCJdKX1zdGF0aWMgZ2V0RGVmYXVsdHMoKXtyZXR1cm4gT2JqZWN0LmFzc2lnbihOci5nZXREZWZhdWx0cygpLHtlbnZlbG9wZTpPYmplY3QuYXNzaWduKE1pKEZyLmdldERlZmF1bHRzKCksT2JqZWN0LmtleXMod28uZ2V0RGVmYXVsdHMoKSkpLHthdHRhY2s6LjAwNSxkZWNheTouMSxyZWxlYXNlOjEsc3VzdGFpbjouM30pLG9zY2lsbGF0b3I6T2JqZWN0LmFzc2lnbihNaShfci5nZXREZWZhdWx0cygpLFsuLi5PYmplY3Qua2V5cyhIby5nZXREZWZhdWx0cygpKSxcImZyZXF1ZW5jeVwiLFwiZGV0dW5lXCJdKSx7dHlwZTpcInRyaWFuZ2xlXCJ9KX0pfV90cmlnZ2VyRW52ZWxvcGVBdHRhY2sodCxlKXtpZih0aGlzLmVudmVsb3BlLnRyaWdnZXJBdHRhY2sodCxlKSx0aGlzLm9zY2lsbGF0b3Iuc3RhcnQodCksMD09PXRoaXMuZW52ZWxvcGUuc3VzdGFpbil7Y29uc3QgZT10aGlzLnRvU2Vjb25kcyh0aGlzLmVudmVsb3BlLmF0dGFjaykscz10aGlzLnRvU2Vjb25kcyh0aGlzLmVudmVsb3BlLmRlY2F5KTt0aGlzLm9zY2lsbGF0b3Iuc3RvcCh0K2Urcyl9fV90cmlnZ2VyRW52ZWxvcGVSZWxlYXNlKHQpe3RoaXMuZW52ZWxvcGUudHJpZ2dlclJlbGVhc2UodCksdGhpcy5vc2NpbGxhdG9yLnN0b3AodCt0aGlzLnRvU2Vjb25kcyh0aGlzLmVudmVsb3BlLnJlbGVhc2UpKX1nZXRMZXZlbEF0VGltZSh0KXtyZXR1cm4gdD10aGlzLnRvU2Vjb25kcyh0KSx0aGlzLmVudmVsb3BlLmdldFZhbHVlQXRUaW1lKHQpfWRpc3Bvc2UoKXtyZXR1cm4gc3VwZXIuZGlzcG9zZSgpLHRoaXMub3NjaWxsYXRvci5kaXNwb3NlKCksdGhpcy5lbnZlbG9wZS5kaXNwb3NlKCksdGhpc319Y2xhc3MgTHIgZXh0ZW5kcyBOcntjb25zdHJ1Y3Rvcigpe3N1cGVyKERpKExyLmdldERlZmF1bHRzKCksYXJndW1lbnRzKSksdGhpcy5uYW1lPVwiTW9kdWxhdGlvblN5bnRoXCI7Y29uc3QgdD1EaShMci5nZXREZWZhdWx0cygpLGFyZ3VtZW50cyk7dGhpcy5fY2Fycmllcj1uZXcganIoe2NvbnRleHQ6dGhpcy5jb250ZXh0LG9zY2lsbGF0b3I6dC5vc2NpbGxhdG9yLGVudmVsb3BlOnQuZW52ZWxvcGUsb25zaWxlbmNlOigpPT50aGlzLm9uc2lsZW5jZSh0aGlzKSx2b2x1bWU6LTEwfSksdGhpcy5fbW9kdWxhdG9yPW5ldyBqcih7Y29udGV4dDp0aGlzLmNvbnRleHQsb3NjaWxsYXRvcjp0Lm1vZHVsYXRpb24sZW52ZWxvcGU6dC5tb2R1bGF0aW9uRW52ZWxvcGUsdm9sdW1lOi0xMH0pLHRoaXMub3NjaWxsYXRvcj10aGlzLl9jYXJyaWVyLm9zY2lsbGF0b3IsdGhpcy5lbnZlbG9wZT10aGlzLl9jYXJyaWVyLmVudmVsb3BlLHRoaXMubW9kdWxhdGlvbj10aGlzLl9tb2R1bGF0b3Iub3NjaWxsYXRvcix0aGlzLm1vZHVsYXRpb25FbnZlbG9wZT10aGlzLl9tb2R1bGF0b3IuZW52ZWxvcGUsdGhpcy5mcmVxdWVuY3k9bmV3IERvKHtjb250ZXh0OnRoaXMuY29udGV4dCx1bml0czpcImZyZXF1ZW5jeVwifSksdGhpcy5kZXR1bmU9bmV3IERvKHtjb250ZXh0OnRoaXMuY29udGV4dCx2YWx1ZTp0LmRldHVuZSx1bml0czpcImNlbnRzXCJ9KSx0aGlzLmhhcm1vbmljaXR5PW5ldyBjcih7Y29udGV4dDp0aGlzLmNvbnRleHQsdmFsdWU6dC5oYXJtb25pY2l0eSxtaW5WYWx1ZTowfSksdGhpcy5fbW9kdWxhdGlvbk5vZGU9bmV3IGtvKHtjb250ZXh0OnRoaXMuY29udGV4dCxnYWluOjB9KSxVaSh0aGlzLFtcImZyZXF1ZW5jeVwiLFwiaGFybW9uaWNpdHlcIixcIm9zY2lsbGF0b3JcIixcImVudmVsb3BlXCIsXCJtb2R1bGF0aW9uXCIsXCJtb2R1bGF0aW9uRW52ZWxvcGVcIixcImRldHVuZVwiXSl9c3RhdGljIGdldERlZmF1bHRzKCl7cmV0dXJuIE9iamVjdC5hc3NpZ24oTnIuZ2V0RGVmYXVsdHMoKSx7aGFybW9uaWNpdHk6Myxvc2NpbGxhdG9yOk9iamVjdC5hc3NpZ24oTWkoX3IuZ2V0RGVmYXVsdHMoKSxbLi4uT2JqZWN0LmtleXMoSG8uZ2V0RGVmYXVsdHMoKSksXCJmcmVxdWVuY3lcIixcImRldHVuZVwiXSkse3R5cGU6XCJzaW5lXCJ9KSxlbnZlbG9wZTpPYmplY3QuYXNzaWduKE1pKEZyLmdldERlZmF1bHRzKCksT2JqZWN0LmtleXMod28uZ2V0RGVmYXVsdHMoKSkpLHthdHRhY2s6LjAxLGRlY2F5Oi4wMSxzdXN0YWluOjEscmVsZWFzZTouNX0pLG1vZHVsYXRpb246T2JqZWN0LmFzc2lnbihNaShfci5nZXREZWZhdWx0cygpLFsuLi5PYmplY3Qua2V5cyhIby5nZXREZWZhdWx0cygpKSxcImZyZXF1ZW5jeVwiLFwiZGV0dW5lXCJdKSx7dHlwZTpcInNxdWFyZVwifSksbW9kdWxhdGlvbkVudmVsb3BlOk9iamVjdC5hc3NpZ24oTWkoRnIuZ2V0RGVmYXVsdHMoKSxPYmplY3Qua2V5cyh3by5nZXREZWZhdWx0cygpKSkse2F0dGFjazouNSxkZWNheTowLHN1c3RhaW46MSxyZWxlYXNlOi41fSl9KX1fdHJpZ2dlckVudmVsb3BlQXR0YWNrKHQsZSl7dGhpcy5fY2Fycmllci5fdHJpZ2dlckVudmVsb3BlQXR0YWNrKHQsZSksdGhpcy5fbW9kdWxhdG9yLl90cmlnZ2VyRW52ZWxvcGVBdHRhY2sodCxlKX1fdHJpZ2dlckVudmVsb3BlUmVsZWFzZSh0KXtyZXR1cm4gdGhpcy5fY2Fycmllci5fdHJpZ2dlckVudmVsb3BlUmVsZWFzZSh0KSx0aGlzLl9tb2R1bGF0b3IuX3RyaWdnZXJFbnZlbG9wZVJlbGVhc2UodCksdGhpc31nZXRMZXZlbEF0VGltZSh0KXtyZXR1cm4gdD10aGlzLnRvU2Vjb25kcyh0KSx0aGlzLmVudmVsb3BlLmdldFZhbHVlQXRUaW1lKHQpfWRpc3Bvc2UoKXtyZXR1cm4gc3VwZXIuZGlzcG9zZSgpLHRoaXMuX2NhcnJpZXIuZGlzcG9zZSgpLHRoaXMuX21vZHVsYXRvci5kaXNwb3NlKCksdGhpcy5mcmVxdWVuY3kuZGlzcG9zZSgpLHRoaXMuZGV0dW5lLmRpc3Bvc2UoKSx0aGlzLmhhcm1vbmljaXR5LmRpc3Bvc2UoKSx0aGlzLl9tb2R1bGF0aW9uTm9kZS5kaXNwb3NlKCksdGhpc319Y2xhc3MgenIgZXh0ZW5kcyBMcntjb25zdHJ1Y3Rvcigpe3N1cGVyKERpKHpyLmdldERlZmF1bHRzKCksYXJndW1lbnRzKSksdGhpcy5uYW1lPVwiQU1TeW50aFwiLHRoaXMuX21vZHVsYXRpb25TY2FsZT1uZXcgYXIoe2NvbnRleHQ6dGhpcy5jb250ZXh0fSksdGhpcy5mcmVxdWVuY3kuY29ubmVjdCh0aGlzLl9jYXJyaWVyLmZyZXF1ZW5jeSksdGhpcy5mcmVxdWVuY3kuY2hhaW4odGhpcy5oYXJtb25pY2l0eSx0aGlzLl9tb2R1bGF0b3IuZnJlcXVlbmN5KSx0aGlzLmRldHVuZS5mYW4odGhpcy5fY2Fycmllci5kZXR1bmUsdGhpcy5fbW9kdWxhdG9yLmRldHVuZSksdGhpcy5fbW9kdWxhdG9yLmNoYWluKHRoaXMuX21vZHVsYXRpb25TY2FsZSx0aGlzLl9tb2R1bGF0aW9uTm9kZS5nYWluKSx0aGlzLl9jYXJyaWVyLmNoYWluKHRoaXMuX21vZHVsYXRpb25Ob2RlLHRoaXMub3V0cHV0KX1kaXNwb3NlKCl7cmV0dXJuIHN1cGVyLmRpc3Bvc2UoKSx0aGlzLl9tb2R1bGF0aW9uU2NhbGUuZGlzcG9zZSgpLHRoaXN9fWNsYXNzIEJyIGV4dGVuZHMgd297Y29uc3RydWN0b3IoKXtzdXBlcihEaShCci5nZXREZWZhdWx0cygpLGFyZ3VtZW50cyxbXCJmcmVxdWVuY3lcIixcInR5cGVcIl0pKSx0aGlzLm5hbWU9XCJCaXF1YWRGaWx0ZXJcIjtjb25zdCB0PURpKEJyLmdldERlZmF1bHRzKCksYXJndW1lbnRzLFtcImZyZXF1ZW5jeVwiLFwidHlwZVwiXSk7dGhpcy5fZmlsdGVyPXRoaXMuY29udGV4dC5jcmVhdGVCaXF1YWRGaWx0ZXIoKSx0aGlzLmlucHV0PXRoaXMub3V0cHV0PXRoaXMuX2ZpbHRlcix0aGlzLlE9bmV3IHhvKHtjb250ZXh0OnRoaXMuY29udGV4dCx1bml0czpcIm51bWJlclwiLHZhbHVlOnQuUSxwYXJhbTp0aGlzLl9maWx0ZXIuUX0pLHRoaXMuZnJlcXVlbmN5PW5ldyB4byh7Y29udGV4dDp0aGlzLmNvbnRleHQsdW5pdHM6XCJmcmVxdWVuY3lcIix2YWx1ZTp0LmZyZXF1ZW5jeSxwYXJhbTp0aGlzLl9maWx0ZXIuZnJlcXVlbmN5fSksdGhpcy5kZXR1bmU9bmV3IHhvKHtjb250ZXh0OnRoaXMuY29udGV4dCx1bml0czpcImNlbnRzXCIsdmFsdWU6dC5kZXR1bmUscGFyYW06dGhpcy5fZmlsdGVyLmRldHVuZX0pLHRoaXMuZ2Fpbj1uZXcgeG8oe2NvbnRleHQ6dGhpcy5jb250ZXh0LHVuaXRzOlwiZGVjaWJlbHNcIixjb252ZXJ0OiExLHZhbHVlOnQuZ2FpbixwYXJhbTp0aGlzLl9maWx0ZXIuZ2Fpbn0pLHRoaXMudHlwZT10LnR5cGV9c3RhdGljIGdldERlZmF1bHRzKCl7cmV0dXJuIE9iamVjdC5hc3NpZ24od28uZ2V0RGVmYXVsdHMoKSx7UToxLHR5cGU6XCJsb3dwYXNzXCIsZnJlcXVlbmN5OjM1MCxkZXR1bmU6MCxnYWluOjB9KX1nZXQgdHlwZSgpe3JldHVybiB0aGlzLl9maWx0ZXIudHlwZX1zZXQgdHlwZSh0KXt0aSgtMSE9PVtcImxvd3Bhc3NcIixcImhpZ2hwYXNzXCIsXCJiYW5kcGFzc1wiLFwibG93c2hlbGZcIixcImhpZ2hzaGVsZlwiLFwibm90Y2hcIixcImFsbHBhc3NcIixcInBlYWtpbmdcIl0uaW5kZXhPZih0KSxcIkludmFsaWQgZmlsdGVyIHR5cGU6IFwiK3QpLHRoaXMuX2ZpbHRlci50eXBlPXR9Z2V0RnJlcXVlbmN5UmVzcG9uc2UodD0xMjgpe2NvbnN0IGU9bmV3IEZsb2F0MzJBcnJheSh0KTtmb3IobGV0IHM9MDtzPHQ7cysrKXtjb25zdCBuPTE5OTgwKk1hdGgucG93KHMvdCwyKSsyMDtlW3NdPW59Y29uc3Qgcz1uZXcgRmxvYXQzMkFycmF5KHQpLG49bmV3IEZsb2F0MzJBcnJheSh0KSxpPXRoaXMuY29udGV4dC5jcmVhdGVCaXF1YWRGaWx0ZXIoKTtyZXR1cm4gaS50eXBlPXRoaXMudHlwZSxpLlEudmFsdWU9dGhpcy5RLnZhbHVlLGkuZnJlcXVlbmN5LnZhbHVlPXRoaXMuZnJlcXVlbmN5LnZhbHVlLGkuZ2Fpbi52YWx1ZT10aGlzLmdhaW4udmFsdWUsaS5nZXRGcmVxdWVuY3lSZXNwb25zZShlLHMsbiksc31kaXNwb3NlKCl7cmV0dXJuIHN1cGVyLmRpc3Bvc2UoKSx0aGlzLl9maWx0ZXIuZGlzY29ubmVjdCgpLHRoaXMuUS5kaXNwb3NlKCksdGhpcy5mcmVxdWVuY3kuZGlzcG9zZSgpLHRoaXMuZ2Fpbi5kaXNwb3NlKCksdGhpcy5kZXR1bmUuZGlzcG9zZSgpLHRoaXN9fWNsYXNzIFdyIGV4dGVuZHMgd297Y29uc3RydWN0b3IoKXtzdXBlcihEaShXci5nZXREZWZhdWx0cygpLGFyZ3VtZW50cyxbXCJmcmVxdWVuY3lcIixcInR5cGVcIixcInJvbGxvZmZcIl0pKSx0aGlzLm5hbWU9XCJGaWx0ZXJcIix0aGlzLmlucHV0PW5ldyBrbyh7Y29udGV4dDp0aGlzLmNvbnRleHR9KSx0aGlzLm91dHB1dD1uZXcga28oe2NvbnRleHQ6dGhpcy5jb250ZXh0fSksdGhpcy5fZmlsdGVycz1bXTtjb25zdCB0PURpKFdyLmdldERlZmF1bHRzKCksYXJndW1lbnRzLFtcImZyZXF1ZW5jeVwiLFwidHlwZVwiLFwicm9sbG9mZlwiXSk7dGhpcy5fZmlsdGVycz1bXSx0aGlzLlE9bmV3IERvKHtjb250ZXh0OnRoaXMuY29udGV4dCx1bml0czpcInBvc2l0aXZlXCIsdmFsdWU6dC5RfSksdGhpcy5mcmVxdWVuY3k9bmV3IERvKHtjb250ZXh0OnRoaXMuY29udGV4dCx1bml0czpcImZyZXF1ZW5jeVwiLHZhbHVlOnQuZnJlcXVlbmN5fSksdGhpcy5kZXR1bmU9bmV3IERvKHtjb250ZXh0OnRoaXMuY29udGV4dCx1bml0czpcImNlbnRzXCIsdmFsdWU6dC5kZXR1bmV9KSx0aGlzLmdhaW49bmV3IERvKHtjb250ZXh0OnRoaXMuY29udGV4dCx1bml0czpcImRlY2liZWxzXCIsY29udmVydDohMSx2YWx1ZTp0LmdhaW59KSx0aGlzLl90eXBlPXQudHlwZSx0aGlzLnJvbGxvZmY9dC5yb2xsb2ZmLFVpKHRoaXMsW1wiZGV0dW5lXCIsXCJmcmVxdWVuY3lcIixcImdhaW5cIixcIlFcIl0pfXN0YXRpYyBnZXREZWZhdWx0cygpe3JldHVybiBPYmplY3QuYXNzaWduKHdvLmdldERlZmF1bHRzKCkse1E6MSxkZXR1bmU6MCxmcmVxdWVuY3k6MzUwLGdhaW46MCxyb2xsb2ZmOi0xMix0eXBlOlwibG93cGFzc1wifSl9Z2V0IHR5cGUoKXtyZXR1cm4gdGhpcy5fdHlwZX1zZXQgdHlwZSh0KXt0aSgtMSE9PVtcImxvd3Bhc3NcIixcImhpZ2hwYXNzXCIsXCJiYW5kcGFzc1wiLFwibG93c2hlbGZcIixcImhpZ2hzaGVsZlwiLFwibm90Y2hcIixcImFsbHBhc3NcIixcInBlYWtpbmdcIl0uaW5kZXhPZih0KSxcIkludmFsaWQgZmlsdGVyIHR5cGU6IFwiK3QpLHRoaXMuX3R5cGU9dCx0aGlzLl9maWx0ZXJzLmZvckVhY2goZT0+ZS50eXBlPXQpfWdldCByb2xsb2ZmKCl7cmV0dXJuIHRoaXMuX3JvbGxvZmZ9c2V0IHJvbGxvZmYodCl7Y29uc3QgZT11aSh0KT90OnBhcnNlSW50KHQsMTApLHM9Wy0xMiwtMjQsLTQ4LC05Nl07bGV0IG49cy5pbmRleE9mKGUpO3RpKC0xIT09bixcInJvbGxvZmYgY2FuIG9ubHkgYmUgXCIrcy5qb2luKFwiLCBcIikpLG4rPTEsdGhpcy5fcm9sbG9mZj1lLHRoaXMuaW5wdXQuZGlzY29ubmVjdCgpLHRoaXMuX2ZpbHRlcnMuZm9yRWFjaCh0PT50LmRpc2Nvbm5lY3QoKSksdGhpcy5fZmlsdGVycz1uZXcgQXJyYXkobik7Zm9yKGxldCB0PTA7dDxuO3QrKyl7Y29uc3QgZT1uZXcgQnIoe2NvbnRleHQ6dGhpcy5jb250ZXh0fSk7ZS50eXBlPXRoaXMuX3R5cGUsdGhpcy5mcmVxdWVuY3kuY29ubmVjdChlLmZyZXF1ZW5jeSksdGhpcy5kZXR1bmUuY29ubmVjdChlLmRldHVuZSksdGhpcy5RLmNvbm5lY3QoZS5RKSx0aGlzLmdhaW4uY29ubmVjdChlLmdhaW4pLHRoaXMuX2ZpbHRlcnNbdF09ZX10aGlzLl9pbnRlcm5hbENoYW5uZWxzPXRoaXMuX2ZpbHRlcnMsYm8odGhpcy5pbnB1dCwuLi50aGlzLl9pbnRlcm5hbENoYW5uZWxzLHRoaXMub3V0cHV0KX1nZXRGcmVxdWVuY3lSZXNwb25zZSh0PTEyOCl7Y29uc3QgZT1uZXcgQnIoe2ZyZXF1ZW5jeTp0aGlzLmZyZXF1ZW5jeS52YWx1ZSxnYWluOnRoaXMuZ2Fpbi52YWx1ZSxROnRoaXMuUS52YWx1ZSx0eXBlOnRoaXMuX3R5cGUsZGV0dW5lOnRoaXMuZGV0dW5lLnZhbHVlfSkscz1uZXcgRmxvYXQzMkFycmF5KHQpLm1hcCgoKT0+MSk7cmV0dXJuIHRoaXMuX2ZpbHRlcnMuZm9yRWFjaCgoKT0+e2UuZ2V0RnJlcXVlbmN5UmVzcG9uc2UodCkuZm9yRWFjaCgodCxlKT0+c1tlXSo9dCl9KSxlLmRpc3Bvc2UoKSxzfWRpc3Bvc2UoKXtyZXR1cm4gc3VwZXIuZGlzcG9zZSgpLHRoaXMuX2ZpbHRlcnMuZm9yRWFjaCh0PT57dC5kaXNwb3NlKCl9KSxRaSh0aGlzLFtcImRldHVuZVwiLFwiZnJlcXVlbmN5XCIsXCJnYWluXCIsXCJRXCJdKSx0aGlzLmZyZXF1ZW5jeS5kaXNwb3NlKCksdGhpcy5RLmRpc3Bvc2UoKSx0aGlzLmRldHVuZS5kaXNwb3NlKCksdGhpcy5nYWluLmRpc3Bvc2UoKSx0aGlzfX1jbGFzcyBHciBleHRlbmRzIEZye2NvbnN0cnVjdG9yKCl7c3VwZXIoRGkoR3IuZ2V0RGVmYXVsdHMoKSxhcmd1bWVudHMsW1wiYXR0YWNrXCIsXCJkZWNheVwiLFwic3VzdGFpblwiLFwicmVsZWFzZVwiXSkpLHRoaXMubmFtZT1cIkZyZXF1ZW5jeUVudmVsb3BlXCI7Y29uc3QgdD1EaShHci5nZXREZWZhdWx0cygpLGFyZ3VtZW50cyxbXCJhdHRhY2tcIixcImRlY2F5XCIsXCJzdXN0YWluXCIsXCJyZWxlYXNlXCJdKTt0aGlzLl9vY3RhdmVzPXQub2N0YXZlcyx0aGlzLl9iYXNlRnJlcXVlbmN5PXRoaXMudG9GcmVxdWVuY3kodC5iYXNlRnJlcXVlbmN5KSx0aGlzLl9leHBvbmVudD10aGlzLmlucHV0PW5ldyBFcih7Y29udGV4dDp0aGlzLmNvbnRleHQsdmFsdWU6dC5leHBvbmVudH0pLHRoaXMuX3NjYWxlPXRoaXMub3V0cHV0PW5ldyBncih7Y29udGV4dDp0aGlzLmNvbnRleHQsbWluOnRoaXMuX2Jhc2VGcmVxdWVuY3ksbWF4OnRoaXMuX2Jhc2VGcmVxdWVuY3kqTWF0aC5wb3coMix0aGlzLl9vY3RhdmVzKX0pLHRoaXMuX3NpZy5jaGFpbih0aGlzLl9leHBvbmVudCx0aGlzLl9zY2FsZSl9c3RhdGljIGdldERlZmF1bHRzKCl7cmV0dXJuIE9iamVjdC5hc3NpZ24oRnIuZ2V0RGVmYXVsdHMoKSx7YmFzZUZyZXF1ZW5jeToyMDAsZXhwb25lbnQ6MSxvY3RhdmVzOjR9KX1nZXQgYmFzZUZyZXF1ZW5jeSgpe3JldHVybiB0aGlzLl9iYXNlRnJlcXVlbmN5fXNldCBiYXNlRnJlcXVlbmN5KHQpe2NvbnN0IGU9dGhpcy50b0ZyZXF1ZW5jeSh0KTtlaShlLDApLHRoaXMuX2Jhc2VGcmVxdWVuY3k9ZSx0aGlzLl9zY2FsZS5taW49dGhpcy5fYmFzZUZyZXF1ZW5jeSx0aGlzLm9jdGF2ZXM9dGhpcy5fb2N0YXZlc31nZXQgb2N0YXZlcygpe3JldHVybiB0aGlzLl9vY3RhdmVzfXNldCBvY3RhdmVzKHQpe3RoaXMuX29jdGF2ZXM9dCx0aGlzLl9zY2FsZS5tYXg9dGhpcy5fYmFzZUZyZXF1ZW5jeSpNYXRoLnBvdygyLHQpfWdldCBleHBvbmVudCgpe3JldHVybiB0aGlzLl9leHBvbmVudC52YWx1ZX1zZXQgZXhwb25lbnQodCl7dGhpcy5fZXhwb25lbnQudmFsdWU9dH1kaXNwb3NlKCl7cmV0dXJuIHN1cGVyLmRpc3Bvc2UoKSx0aGlzLl9leHBvbmVudC5kaXNwb3NlKCksdGhpcy5fc2NhbGUuZGlzcG9zZSgpLHRoaXN9fWNsYXNzIFVyIGV4dGVuZHMgTnJ7Y29uc3RydWN0b3IoKXtzdXBlcihEaShVci5nZXREZWZhdWx0cygpLGFyZ3VtZW50cykpLHRoaXMubmFtZT1cIk1vbm9TeW50aFwiO2NvbnN0IHQ9RGkoVXIuZ2V0RGVmYXVsdHMoKSxhcmd1bWVudHMpO3RoaXMub3NjaWxsYXRvcj1uZXcgX3IoT2JqZWN0LmFzc2lnbih0Lm9zY2lsbGF0b3Ise2NvbnRleHQ6dGhpcy5jb250ZXh0LGRldHVuZTp0LmRldHVuZSxvbnN0b3A6KCk9PnRoaXMub25zaWxlbmNlKHRoaXMpfSkpLHRoaXMuZnJlcXVlbmN5PXRoaXMub3NjaWxsYXRvci5mcmVxdWVuY3ksdGhpcy5kZXR1bmU9dGhpcy5vc2NpbGxhdG9yLmRldHVuZSx0aGlzLmZpbHRlcj1uZXcgV3IoT2JqZWN0LmFzc2lnbih0LmZpbHRlcix7Y29udGV4dDp0aGlzLmNvbnRleHR9KSksdGhpcy5maWx0ZXJFbnZlbG9wZT1uZXcgR3IoT2JqZWN0LmFzc2lnbih0LmZpbHRlckVudmVsb3BlLHtjb250ZXh0OnRoaXMuY29udGV4dH0pKSx0aGlzLmVudmVsb3BlPW5ldyBQcihPYmplY3QuYXNzaWduKHQuZW52ZWxvcGUse2NvbnRleHQ6dGhpcy5jb250ZXh0fSkpLHRoaXMub3NjaWxsYXRvci5jaGFpbih0aGlzLmZpbHRlcix0aGlzLmVudmVsb3BlLHRoaXMub3V0cHV0KSx0aGlzLmZpbHRlckVudmVsb3BlLmNvbm5lY3QodGhpcy5maWx0ZXIuZnJlcXVlbmN5KSxVaSh0aGlzLFtcIm9zY2lsbGF0b3JcIixcImZyZXF1ZW5jeVwiLFwiZGV0dW5lXCIsXCJmaWx0ZXJcIixcImZpbHRlckVudmVsb3BlXCIsXCJlbnZlbG9wZVwiXSl9c3RhdGljIGdldERlZmF1bHRzKCl7cmV0dXJuIE9iamVjdC5hc3NpZ24oTnIuZ2V0RGVmYXVsdHMoKSx7ZW52ZWxvcGU6T2JqZWN0LmFzc2lnbihNaShGci5nZXREZWZhdWx0cygpLE9iamVjdC5rZXlzKHdvLmdldERlZmF1bHRzKCkpKSx7YXR0YWNrOi4wMDUsZGVjYXk6LjEscmVsZWFzZToxLHN1c3RhaW46Ljl9KSxmaWx0ZXI6T2JqZWN0LmFzc2lnbihNaShXci5nZXREZWZhdWx0cygpLE9iamVjdC5rZXlzKHdvLmdldERlZmF1bHRzKCkpKSx7UToxLHJvbGxvZmY6LTEyLHR5cGU6XCJsb3dwYXNzXCJ9KSxmaWx0ZXJFbnZlbG9wZTpPYmplY3QuYXNzaWduKE1pKEdyLmdldERlZmF1bHRzKCksT2JqZWN0LmtleXMod28uZ2V0RGVmYXVsdHMoKSkpLHthdHRhY2s6LjYsYmFzZUZyZXF1ZW5jeToyMDAsZGVjYXk6LjIsZXhwb25lbnQ6MixvY3RhdmVzOjMscmVsZWFzZToyLHN1c3RhaW46LjV9KSxvc2NpbGxhdG9yOk9iamVjdC5hc3NpZ24oTWkoX3IuZ2V0RGVmYXVsdHMoKSxPYmplY3Qua2V5cyhIby5nZXREZWZhdWx0cygpKSkse3R5cGU6XCJzYXd0b290aFwifSl9KX1fdHJpZ2dlckVudmVsb3BlQXR0YWNrKHQsZT0xKXtpZih0aGlzLmVudmVsb3BlLnRyaWdnZXJBdHRhY2sodCxlKSx0aGlzLmZpbHRlckVudmVsb3BlLnRyaWdnZXJBdHRhY2sodCksdGhpcy5vc2NpbGxhdG9yLnN0YXJ0KHQpLDA9PT10aGlzLmVudmVsb3BlLnN1c3RhaW4pe2NvbnN0IGU9dGhpcy50b1NlY29uZHModGhpcy5lbnZlbG9wZS5hdHRhY2spLHM9dGhpcy50b1NlY29uZHModGhpcy5lbnZlbG9wZS5kZWNheSk7dGhpcy5vc2NpbGxhdG9yLnN0b3AodCtlK3MpfX1fdHJpZ2dlckVudmVsb3BlUmVsZWFzZSh0KXt0aGlzLmVudmVsb3BlLnRyaWdnZXJSZWxlYXNlKHQpLHRoaXMuZmlsdGVyRW52ZWxvcGUudHJpZ2dlclJlbGVhc2UodCksdGhpcy5vc2NpbGxhdG9yLnN0b3AodCt0aGlzLnRvU2Vjb25kcyh0aGlzLmVudmVsb3BlLnJlbGVhc2UpKX1nZXRMZXZlbEF0VGltZSh0KXtyZXR1cm4gdD10aGlzLnRvU2Vjb25kcyh0KSx0aGlzLmVudmVsb3BlLmdldFZhbHVlQXRUaW1lKHQpfWRpc3Bvc2UoKXtyZXR1cm4gc3VwZXIuZGlzcG9zZSgpLHRoaXMub3NjaWxsYXRvci5kaXNwb3NlKCksdGhpcy5lbnZlbG9wZS5kaXNwb3NlKCksdGhpcy5maWx0ZXJFbnZlbG9wZS5kaXNwb3NlKCksdGhpcy5maWx0ZXIuZGlzcG9zZSgpLHRoaXN9fWNsYXNzIFFyIGV4dGVuZHMgTnJ7Y29uc3RydWN0b3IoKXtzdXBlcihEaShRci5nZXREZWZhdWx0cygpLGFyZ3VtZW50cykpLHRoaXMubmFtZT1cIkR1b1N5bnRoXCI7Y29uc3QgdD1EaShRci5nZXREZWZhdWx0cygpLGFyZ3VtZW50cyk7dGhpcy52b2ljZTA9bmV3IFVyKE9iamVjdC5hc3NpZ24odC52b2ljZTAse2NvbnRleHQ6dGhpcy5jb250ZXh0LG9uc2lsZW5jZTooKT0+dGhpcy5vbnNpbGVuY2UodGhpcyl9KSksdGhpcy52b2ljZTE9bmV3IFVyKE9iamVjdC5hc3NpZ24odC52b2ljZTEse2NvbnRleHQ6dGhpcy5jb250ZXh0fSkpLHRoaXMuaGFybW9uaWNpdHk9bmV3IGNyKHtjb250ZXh0OnRoaXMuY29udGV4dCx1bml0czpcInBvc2l0aXZlXCIsdmFsdWU6dC5oYXJtb25pY2l0eX0pLHRoaXMuX3ZpYnJhdG89bmV3IHlyKHtmcmVxdWVuY3k6dC52aWJyYXRvUmF0ZSxjb250ZXh0OnRoaXMuY29udGV4dCxtaW46LTUwLG1heDo1MH0pLHRoaXMuX3ZpYnJhdG8uc3RhcnQoKSx0aGlzLnZpYnJhdG9SYXRlPXRoaXMuX3ZpYnJhdG8uZnJlcXVlbmN5LHRoaXMuX3ZpYnJhdG9HYWluPW5ldyBrbyh7Y29udGV4dDp0aGlzLmNvbnRleHQsdW5pdHM6XCJub3JtYWxSYW5nZVwiLGdhaW46dC52aWJyYXRvQW1vdW50fSksdGhpcy52aWJyYXRvQW1vdW50PXRoaXMuX3ZpYnJhdG9HYWluLmdhaW4sdGhpcy5mcmVxdWVuY3k9bmV3IERvKHtjb250ZXh0OnRoaXMuY29udGV4dCx1bml0czpcImZyZXF1ZW5jeVwiLHZhbHVlOjQ0MH0pLHRoaXMuZGV0dW5lPW5ldyBEbyh7Y29udGV4dDp0aGlzLmNvbnRleHQsdW5pdHM6XCJjZW50c1wiLHZhbHVlOnQuZGV0dW5lfSksdGhpcy5mcmVxdWVuY3kuY29ubmVjdCh0aGlzLnZvaWNlMC5mcmVxdWVuY3kpLHRoaXMuZnJlcXVlbmN5LmNoYWluKHRoaXMuaGFybW9uaWNpdHksdGhpcy52b2ljZTEuZnJlcXVlbmN5KSx0aGlzLl92aWJyYXRvLmNvbm5lY3QodGhpcy5fdmlicmF0b0dhaW4pLHRoaXMuX3ZpYnJhdG9HYWluLmZhbih0aGlzLnZvaWNlMC5kZXR1bmUsdGhpcy52b2ljZTEuZGV0dW5lKSx0aGlzLmRldHVuZS5mYW4odGhpcy52b2ljZTAuZGV0dW5lLHRoaXMudm9pY2UxLmRldHVuZSksdGhpcy52b2ljZTAuY29ubmVjdCh0aGlzLm91dHB1dCksdGhpcy52b2ljZTEuY29ubmVjdCh0aGlzLm91dHB1dCksVWkodGhpcyxbXCJ2b2ljZTBcIixcInZvaWNlMVwiLFwiZnJlcXVlbmN5XCIsXCJ2aWJyYXRvQW1vdW50XCIsXCJ2aWJyYXRvUmF0ZVwiXSl9Z2V0TGV2ZWxBdFRpbWUodCl7cmV0dXJuIHQ9dGhpcy50b1NlY29uZHModCksdGhpcy52b2ljZTAuZW52ZWxvcGUuZ2V0VmFsdWVBdFRpbWUodCkrdGhpcy52b2ljZTEuZW52ZWxvcGUuZ2V0VmFsdWVBdFRpbWUodCl9c3RhdGljIGdldERlZmF1bHRzKCl7cmV0dXJuIEFpKE5yLmdldERlZmF1bHRzKCkse3ZpYnJhdG9BbW91bnQ6LjUsdmlicmF0b1JhdGU6NSxoYXJtb25pY2l0eToxLjUsdm9pY2UwOkFpKE1pKFVyLmdldERlZmF1bHRzKCksT2JqZWN0LmtleXMoTnIuZ2V0RGVmYXVsdHMoKSkpLHtmaWx0ZXJFbnZlbG9wZTp7YXR0YWNrOi4wMSxkZWNheTowLHN1c3RhaW46MSxyZWxlYXNlOi41fSxlbnZlbG9wZTp7YXR0YWNrOi4wMSxkZWNheTowLHN1c3RhaW46MSxyZWxlYXNlOi41fX0pLHZvaWNlMTpBaShNaShVci5nZXREZWZhdWx0cygpLE9iamVjdC5rZXlzKE5yLmdldERlZmF1bHRzKCkpKSx7ZmlsdGVyRW52ZWxvcGU6e2F0dGFjazouMDEsZGVjYXk6MCxzdXN0YWluOjEscmVsZWFzZTouNX0sZW52ZWxvcGU6e2F0dGFjazouMDEsZGVjYXk6MCxzdXN0YWluOjEscmVsZWFzZTouNX19KX0pfV90cmlnZ2VyRW52ZWxvcGVBdHRhY2sodCxlKXt0aGlzLnZvaWNlMC5fdHJpZ2dlckVudmVsb3BlQXR0YWNrKHQsZSksdGhpcy52b2ljZTEuX3RyaWdnZXJFbnZlbG9wZUF0dGFjayh0LGUpfV90cmlnZ2VyRW52ZWxvcGVSZWxlYXNlKHQpe3JldHVybiB0aGlzLnZvaWNlMC5fdHJpZ2dlckVudmVsb3BlUmVsZWFzZSh0KSx0aGlzLnZvaWNlMS5fdHJpZ2dlckVudmVsb3BlUmVsZWFzZSh0KSx0aGlzfWRpc3Bvc2UoKXtyZXR1cm4gc3VwZXIuZGlzcG9zZSgpLHRoaXMudm9pY2UwLmRpc3Bvc2UoKSx0aGlzLnZvaWNlMS5kaXNwb3NlKCksdGhpcy5mcmVxdWVuY3kuZGlzcG9zZSgpLHRoaXMuZGV0dW5lLmRpc3Bvc2UoKSx0aGlzLl92aWJyYXRvLmRpc3Bvc2UoKSx0aGlzLnZpYnJhdG9SYXRlLmRpc3Bvc2UoKSx0aGlzLl92aWJyYXRvR2Fpbi5kaXNwb3NlKCksdGhpcy5oYXJtb25pY2l0eS5kaXNwb3NlKCksdGhpc319Y2xhc3MgWnIgZXh0ZW5kcyBMcntjb25zdHJ1Y3Rvcigpe3N1cGVyKERpKFpyLmdldERlZmF1bHRzKCksYXJndW1lbnRzKSksdGhpcy5uYW1lPVwiRk1TeW50aFwiO2NvbnN0IHQ9RGkoWnIuZ2V0RGVmYXVsdHMoKSxhcmd1bWVudHMpO3RoaXMubW9kdWxhdGlvbkluZGV4PW5ldyBjcih7Y29udGV4dDp0aGlzLmNvbnRleHQsdmFsdWU6dC5tb2R1bGF0aW9uSW5kZXh9KSx0aGlzLmZyZXF1ZW5jeS5jb25uZWN0KHRoaXMuX2NhcnJpZXIuZnJlcXVlbmN5KSx0aGlzLmZyZXF1ZW5jeS5jaGFpbih0aGlzLmhhcm1vbmljaXR5LHRoaXMuX21vZHVsYXRvci5mcmVxdWVuY3kpLHRoaXMuZnJlcXVlbmN5LmNoYWluKHRoaXMubW9kdWxhdGlvbkluZGV4LHRoaXMuX21vZHVsYXRpb25Ob2RlKSx0aGlzLmRldHVuZS5mYW4odGhpcy5fY2Fycmllci5kZXR1bmUsdGhpcy5fbW9kdWxhdG9yLmRldHVuZSksdGhpcy5fbW9kdWxhdG9yLmNvbm5lY3QodGhpcy5fbW9kdWxhdGlvbk5vZGUuZ2FpbiksdGhpcy5fbW9kdWxhdGlvbk5vZGUuY29ubmVjdCh0aGlzLl9jYXJyaWVyLmZyZXF1ZW5jeSksdGhpcy5fY2Fycmllci5jb25uZWN0KHRoaXMub3V0cHV0KX1zdGF0aWMgZ2V0RGVmYXVsdHMoKXtyZXR1cm4gT2JqZWN0LmFzc2lnbihMci5nZXREZWZhdWx0cygpLHttb2R1bGF0aW9uSW5kZXg6MTB9KX1kaXNwb3NlKCl7cmV0dXJuIHN1cGVyLmRpc3Bvc2UoKSx0aGlzLm1vZHVsYXRpb25JbmRleC5kaXNwb3NlKCksdGhpc319Y29uc3QgWHI9WzEsMS40ODMsMS45MzIsMi41NDYsMi42MywzLjg5N107Y2xhc3MgWXIgZXh0ZW5kcyBOcntjb25zdHJ1Y3Rvcigpe3N1cGVyKERpKFlyLmdldERlZmF1bHRzKCksYXJndW1lbnRzKSksdGhpcy5uYW1lPVwiTWV0YWxTeW50aFwiLHRoaXMuX29zY2lsbGF0b3JzPVtdLHRoaXMuX2ZyZXFNdWx0aXBsaWVycz1bXTtjb25zdCB0PURpKFlyLmdldERlZmF1bHRzKCksYXJndW1lbnRzKTt0aGlzLmRldHVuZT1uZXcgRG8oe2NvbnRleHQ6dGhpcy5jb250ZXh0LHVuaXRzOlwiY2VudHNcIix2YWx1ZTp0LmRldHVuZX0pLHRoaXMuZnJlcXVlbmN5PW5ldyBEbyh7Y29udGV4dDp0aGlzLmNvbnRleHQsdW5pdHM6XCJmcmVxdWVuY3lcIn0pLHRoaXMuX2FtcGxpdHVkZT1uZXcga28oe2NvbnRleHQ6dGhpcy5jb250ZXh0LGdhaW46MH0pLmNvbm5lY3QodGhpcy5vdXRwdXQpLHRoaXMuX2hpZ2hwYXNzPW5ldyBXcih7UTowLGNvbnRleHQ6dGhpcy5jb250ZXh0LHR5cGU6XCJoaWdocGFzc1wifSkuY29ubmVjdCh0aGlzLl9hbXBsaXR1ZGUpO2ZvcihsZXQgZT0wO2U8WHIubGVuZ3RoO2UrKyl7Y29uc3Qgcz1uZXcgdXIoe2NvbnRleHQ6dGhpcy5jb250ZXh0LGhhcm1vbmljaXR5OnQuaGFybW9uaWNpdHksbW9kdWxhdGlvbkluZGV4OnQubW9kdWxhdGlvbkluZGV4LG1vZHVsYXRpb25UeXBlOlwic3F1YXJlXCIsb25zdG9wOjA9PT1lPygpPT50aGlzLm9uc2lsZW5jZSh0aGlzKTpaaSx0eXBlOlwic3F1YXJlXCJ9KTtzLmNvbm5lY3QodGhpcy5faGlnaHBhc3MpLHRoaXMuX29zY2lsbGF0b3JzW2VdPXM7Y29uc3Qgbj1uZXcgY3Ioe2NvbnRleHQ6dGhpcy5jb250ZXh0LHZhbHVlOlhyW2VdfSk7dGhpcy5fZnJlcU11bHRpcGxpZXJzW2VdPW4sdGhpcy5mcmVxdWVuY3kuY2hhaW4obixzLmZyZXF1ZW5jeSksdGhpcy5kZXR1bmUuY29ubmVjdChzLmRldHVuZSl9dGhpcy5fZmlsdGVyRnJlcVNjYWxlcj1uZXcgZ3Ioe2NvbnRleHQ6dGhpcy5jb250ZXh0LG1heDo3ZTMsbWluOnRoaXMudG9GcmVxdWVuY3kodC5yZXNvbmFuY2UpfSksdGhpcy5lbnZlbG9wZT1uZXcgRnIoe2F0dGFjazp0LmVudmVsb3BlLmF0dGFjayxhdHRhY2tDdXJ2ZTpcImxpbmVhclwiLGNvbnRleHQ6dGhpcy5jb250ZXh0LGRlY2F5OnQuZW52ZWxvcGUuZGVjYXkscmVsZWFzZTp0LmVudmVsb3BlLnJlbGVhc2Usc3VzdGFpbjowfSksdGhpcy5lbnZlbG9wZS5jaGFpbih0aGlzLl9maWx0ZXJGcmVxU2NhbGVyLHRoaXMuX2hpZ2hwYXNzLmZyZXF1ZW5jeSksdGhpcy5lbnZlbG9wZS5jb25uZWN0KHRoaXMuX2FtcGxpdHVkZS5nYWluKSx0aGlzLl9vY3RhdmVzPXQub2N0YXZlcyx0aGlzLm9jdGF2ZXM9dC5vY3RhdmVzfXN0YXRpYyBnZXREZWZhdWx0cygpe3JldHVybiBBaShOci5nZXREZWZhdWx0cygpLHtlbnZlbG9wZTpPYmplY3QuYXNzaWduKE1pKEZyLmdldERlZmF1bHRzKCksT2JqZWN0LmtleXMod28uZ2V0RGVmYXVsdHMoKSkpLHthdHRhY2s6LjAwMSxkZWNheToxLjQscmVsZWFzZTouMn0pLGhhcm1vbmljaXR5OjUuMSxtb2R1bGF0aW9uSW5kZXg6MzIsb2N0YXZlczoxLjUscmVzb25hbmNlOjRlM30pfV90cmlnZ2VyRW52ZWxvcGVBdHRhY2sodCxlPTEpe3JldHVybiB0aGlzLmVudmVsb3BlLnRyaWdnZXJBdHRhY2sodCxlKSx0aGlzLl9vc2NpbGxhdG9ycy5mb3JFYWNoKGU9PmUuc3RhcnQodCkpLDA9PT10aGlzLmVudmVsb3BlLnN1c3RhaW4mJnRoaXMuX29zY2lsbGF0b3JzLmZvckVhY2goZT0+e2Uuc3RvcCh0K3RoaXMudG9TZWNvbmRzKHRoaXMuZW52ZWxvcGUuYXR0YWNrKSt0aGlzLnRvU2Vjb25kcyh0aGlzLmVudmVsb3BlLmRlY2F5KSl9KSx0aGlzfV90cmlnZ2VyRW52ZWxvcGVSZWxlYXNlKHQpe3JldHVybiB0aGlzLmVudmVsb3BlLnRyaWdnZXJSZWxlYXNlKHQpLHRoaXMuX29zY2lsbGF0b3JzLmZvckVhY2goZT0+ZS5zdG9wKHQrdGhpcy50b1NlY29uZHModGhpcy5lbnZlbG9wZS5yZWxlYXNlKSkpLHRoaXN9Z2V0TGV2ZWxBdFRpbWUodCl7cmV0dXJuIHQ9dGhpcy50b1NlY29uZHModCksdGhpcy5lbnZlbG9wZS5nZXRWYWx1ZUF0VGltZSh0KX1nZXQgbW9kdWxhdGlvbkluZGV4KCl7cmV0dXJuIHRoaXMuX29zY2lsbGF0b3JzWzBdLm1vZHVsYXRpb25JbmRleC52YWx1ZX1zZXQgbW9kdWxhdGlvbkluZGV4KHQpe3RoaXMuX29zY2lsbGF0b3JzLmZvckVhY2goZT0+ZS5tb2R1bGF0aW9uSW5kZXgudmFsdWU9dCl9Z2V0IGhhcm1vbmljaXR5KCl7cmV0dXJuIHRoaXMuX29zY2lsbGF0b3JzWzBdLmhhcm1vbmljaXR5LnZhbHVlfXNldCBoYXJtb25pY2l0eSh0KXt0aGlzLl9vc2NpbGxhdG9ycy5mb3JFYWNoKGU9PmUuaGFybW9uaWNpdHkudmFsdWU9dCl9Z2V0IHJlc29uYW5jZSgpe3JldHVybiB0aGlzLl9maWx0ZXJGcmVxU2NhbGVyLm1pbn1zZXQgcmVzb25hbmNlKHQpe3RoaXMuX2ZpbHRlckZyZXFTY2FsZXIubWluPXRoaXMudG9GcmVxdWVuY3kodCksdGhpcy5vY3RhdmVzPXRoaXMuX29jdGF2ZXN9Z2V0IG9jdGF2ZXMoKXtyZXR1cm4gdGhpcy5fb2N0YXZlc31zZXQgb2N0YXZlcyh0KXt0aGlzLl9vY3RhdmVzPXQsdGhpcy5fZmlsdGVyRnJlcVNjYWxlci5tYXg9dGhpcy5fZmlsdGVyRnJlcVNjYWxlci5taW4qTWF0aC5wb3coMix0KX1kaXNwb3NlKCl7cmV0dXJuIHN1cGVyLmRpc3Bvc2UoKSx0aGlzLl9vc2NpbGxhdG9ycy5mb3JFYWNoKHQ9PnQuZGlzcG9zZSgpKSx0aGlzLl9mcmVxTXVsdGlwbGllcnMuZm9yRWFjaCh0PT50LmRpc3Bvc2UoKSksdGhpcy5mcmVxdWVuY3kuZGlzcG9zZSgpLHRoaXMuZGV0dW5lLmRpc3Bvc2UoKSx0aGlzLl9maWx0ZXJGcmVxU2NhbGVyLmRpc3Bvc2UoKSx0aGlzLl9hbXBsaXR1ZGUuZGlzcG9zZSgpLHRoaXMuZW52ZWxvcGUuZGlzcG9zZSgpLHRoaXMuX2hpZ2hwYXNzLmRpc3Bvc2UoKSx0aGlzfX1jbGFzcyBIciBleHRlbmRzIGpye2NvbnN0cnVjdG9yKCl7c3VwZXIoRGkoSHIuZ2V0RGVmYXVsdHMoKSxhcmd1bWVudHMpKSx0aGlzLm5hbWU9XCJNZW1icmFuZVN5bnRoXCIsdGhpcy5wb3J0YW1lbnRvPTA7Y29uc3QgdD1EaShIci5nZXREZWZhdWx0cygpLGFyZ3VtZW50cyk7dGhpcy5waXRjaERlY2F5PXQucGl0Y2hEZWNheSx0aGlzLm9jdGF2ZXM9dC5vY3RhdmVzLFVpKHRoaXMsW1wib3NjaWxsYXRvclwiLFwiZW52ZWxvcGVcIl0pfXN0YXRpYyBnZXREZWZhdWx0cygpe3JldHVybiBBaShOci5nZXREZWZhdWx0cygpLGpyLmdldERlZmF1bHRzKCkse2VudmVsb3BlOnthdHRhY2s6LjAwMSxhdHRhY2tDdXJ2ZTpcImV4cG9uZW50aWFsXCIsZGVjYXk6LjQscmVsZWFzZToxLjQsc3VzdGFpbjouMDF9LG9jdGF2ZXM6MTAsb3NjaWxsYXRvcjp7dHlwZTpcInNpbmVcIn0scGl0Y2hEZWNheTouMDV9KX1zZXROb3RlKHQsZSl7Y29uc3Qgcz10aGlzLnRvU2Vjb25kcyhlKSxuPXRoaXMudG9GcmVxdWVuY3kodCBpbnN0YW5jZW9mIGxvP3QudG9GcmVxdWVuY3koKTp0KSxpPW4qdGhpcy5vY3RhdmVzO3JldHVybiB0aGlzLm9zY2lsbGF0b3IuZnJlcXVlbmN5LnNldFZhbHVlQXRUaW1lKGkscyksdGhpcy5vc2NpbGxhdG9yLmZyZXF1ZW5jeS5leHBvbmVudGlhbFJhbXBUb1ZhbHVlQXRUaW1lKG4scyt0aGlzLnRvU2Vjb25kcyh0aGlzLnBpdGNoRGVjYXkpKSx0aGlzfWRpc3Bvc2UoKXtyZXR1cm4gc3VwZXIuZGlzcG9zZSgpLHRoaXN9fXZpKFt4cigwKV0sSHIucHJvdG90eXBlLFwib2N0YXZlc1wiLHZvaWQgMCksdmkoW3dyKDApXSxIci5wcm90b3R5cGUsXCJwaXRjaERlY2F5XCIsdm9pZCAwKTtjbGFzcyAkciBleHRlbmRzIFZye2NvbnN0cnVjdG9yKCl7c3VwZXIoRGkoJHIuZ2V0RGVmYXVsdHMoKSxhcmd1bWVudHMpKSx0aGlzLm5hbWU9XCJOb2lzZVN5bnRoXCI7Y29uc3QgdD1EaSgkci5nZXREZWZhdWx0cygpLGFyZ3VtZW50cyk7dGhpcy5ub2lzZT1uZXcgSm8oT2JqZWN0LmFzc2lnbih7Y29udGV4dDp0aGlzLmNvbnRleHR9LHQubm9pc2UpKSx0aGlzLmVudmVsb3BlPW5ldyBQcihPYmplY3QuYXNzaWduKHtjb250ZXh0OnRoaXMuY29udGV4dH0sdC5lbnZlbG9wZSkpLHRoaXMubm9pc2UuY2hhaW4odGhpcy5lbnZlbG9wZSx0aGlzLm91dHB1dCl9c3RhdGljIGdldERlZmF1bHRzKCl7cmV0dXJuIE9iamVjdC5hc3NpZ24oVnIuZ2V0RGVmYXVsdHMoKSx7ZW52ZWxvcGU6T2JqZWN0LmFzc2lnbihNaShGci5nZXREZWZhdWx0cygpLE9iamVjdC5rZXlzKHdvLmdldERlZmF1bHRzKCkpKSx7ZGVjYXk6LjEsc3VzdGFpbjowfSksbm9pc2U6T2JqZWN0LmFzc2lnbihNaShKby5nZXREZWZhdWx0cygpLE9iamVjdC5rZXlzKEhvLmdldERlZmF1bHRzKCkpKSx7dHlwZTpcIndoaXRlXCJ9KX0pfXRyaWdnZXJBdHRhY2sodCxlPTEpe3JldHVybiB0PXRoaXMudG9TZWNvbmRzKHQpLHRoaXMuZW52ZWxvcGUudHJpZ2dlckF0dGFjayh0LGUpLHRoaXMubm9pc2Uuc3RhcnQodCksMD09PXRoaXMuZW52ZWxvcGUuc3VzdGFpbiYmdGhpcy5ub2lzZS5zdG9wKHQrdGhpcy50b1NlY29uZHModGhpcy5lbnZlbG9wZS5hdHRhY2spK3RoaXMudG9TZWNvbmRzKHRoaXMuZW52ZWxvcGUuZGVjYXkpKSx0aGlzfXRyaWdnZXJSZWxlYXNlKHQpe3JldHVybiB0PXRoaXMudG9TZWNvbmRzKHQpLHRoaXMuZW52ZWxvcGUudHJpZ2dlclJlbGVhc2UodCksdGhpcy5ub2lzZS5zdG9wKHQrdGhpcy50b1NlY29uZHModGhpcy5lbnZlbG9wZS5yZWxlYXNlKSksdGhpc31zeW5jKCl7cmV0dXJuIHRoaXMuX3N5bmNTdGF0ZSgpJiYodGhpcy5fc3luY01ldGhvZChcInRyaWdnZXJBdHRhY2tcIiwwKSx0aGlzLl9zeW5jTWV0aG9kKFwidHJpZ2dlclJlbGVhc2VcIiwwKSksdGhpc310cmlnZ2VyQXR0YWNrUmVsZWFzZSh0LGUscz0xKXtyZXR1cm4gZT10aGlzLnRvU2Vjb25kcyhlKSx0PXRoaXMudG9TZWNvbmRzKHQpLHRoaXMudHJpZ2dlckF0dGFjayhlLHMpLHRoaXMudHJpZ2dlclJlbGVhc2UoZSt0KSx0aGlzfWRpc3Bvc2UoKXtyZXR1cm4gc3VwZXIuZGlzcG9zZSgpLHRoaXMubm9pc2UuZGlzcG9zZSgpLHRoaXMuZW52ZWxvcGUuZGlzcG9zZSgpLHRoaXN9fWNvbnN0IEpyPW5ldyBTZXQ7ZnVuY3Rpb24gS3IodCl7SnIuYWRkKHQpfWZ1bmN0aW9uIHRhKHQsZSl7Y29uc3Qgcz1gcmVnaXN0ZXJQcm9jZXNzb3IoXCIke3R9XCIsICR7ZX0pYDtKci5hZGQocyl9Y2xhc3MgZWEgZXh0ZW5kcyB3b3tjb25zdHJ1Y3Rvcih0KXtzdXBlcih0KSx0aGlzLm5hbWU9XCJUb25lQXVkaW9Xb3JrbGV0XCIsdGhpcy53b3JrbGV0T3B0aW9ucz17fSx0aGlzLm9ucHJvY2Vzc29yZXJyb3I9Wmk7Y29uc3QgZT1VUkwuY3JlYXRlT2JqZWN0VVJMKG5ldyBCbG9iKFtBcnJheS5mcm9tKEpyKS5qb2luKFwiXFxuXCIpXSx7dHlwZTpcInRleHQvamF2YXNjcmlwdFwifSkpLHM9dGhpcy5fYXVkaW9Xb3JrbGV0TmFtZSgpO3RoaXMuX2R1bW15R2Fpbj10aGlzLmNvbnRleHQuY3JlYXRlR2FpbigpLHRoaXMuX2R1bW15UGFyYW09dGhpcy5fZHVtbXlHYWluLmdhaW4sdGhpcy5jb250ZXh0LmFkZEF1ZGlvV29ya2xldE1vZHVsZShlLHMpLnRoZW4oKCk9Pnt0aGlzLmRpc3Bvc2VkfHwodGhpcy5fd29ya2xldD10aGlzLmNvbnRleHQuY3JlYXRlQXVkaW9Xb3JrbGV0Tm9kZShzLHRoaXMud29ya2xldE9wdGlvbnMpLHRoaXMuX3dvcmtsZXQub25wcm9jZXNzb3JlcnJvcj10aGlzLm9ucHJvY2Vzc29yZXJyb3IuYmluZCh0aGlzKSx0aGlzLm9uUmVhZHkodGhpcy5fd29ya2xldCkpfSl9ZGlzcG9zZSgpe3JldHVybiBzdXBlci5kaXNwb3NlKCksdGhpcy5fZHVtbXlHYWluLmRpc2Nvbm5lY3QoKSx0aGlzLl93b3JrbGV0JiYodGhpcy5fd29ya2xldC5wb3J0LnBvc3RNZXNzYWdlKFwiZGlzcG9zZVwiKSx0aGlzLl93b3JrbGV0LmRpc2Nvbm5lY3QoKSksdGhpc319S3IoJ1xcblxcdC8qKlxcblxcdCAqIFRoZSBiYXNlIEF1ZGlvV29ya2xldFByb2Nlc3NvciBmb3IgdXNlIGluIFRvbmUuanMuIFdvcmtzIHdpdGggdGhlIFtbVG9uZUF1ZGlvV29ya2xldF1dLiBcXG5cXHQgKi9cXG5cXHRjbGFzcyBUb25lQXVkaW9Xb3JrbGV0UHJvY2Vzc29yIGV4dGVuZHMgQXVkaW9Xb3JrbGV0UHJvY2Vzc29yIHtcXG5cXG5cXHRcXHRjb25zdHJ1Y3RvcihvcHRpb25zKSB7XFxuXFx0XFx0XFx0XFxuXFx0XFx0XFx0c3VwZXIob3B0aW9ucyk7XFxuXFx0XFx0XFx0LyoqXFxuXFx0XFx0XFx0ICogSWYgdGhlIHByb2Nlc3NvciB3YXMgZGlzcG9zZWQgb3Igbm90LiBLZWVwIGFsaXZlIHVudGlsIGl0XFwncyBkaXNwb3NlZC5cXG5cXHRcXHRcXHQgKi9cXG5cXHRcXHRcXHR0aGlzLmRpc3Bvc2VkID0gZmFsc2U7XFxuXFx0XFx0ICAgXFx0LyoqIFxcblxcdFxcdFxcdCAqIFRoZSBudW1iZXIgb2Ygc2FtcGxlcyBpbiB0aGUgcHJvY2Vzc2luZyBibG9ja1xcblxcdFxcdFxcdCAqL1xcblxcdFxcdFxcdHRoaXMuYmxvY2tTaXplID0gMTI4O1xcblxcdFxcdFxcdC8qKlxcblxcdFxcdFxcdCAqIHRoZSBzYW1wbGUgcmF0ZVxcblxcdFxcdFxcdCAqL1xcblxcdFxcdFxcdHRoaXMuc2FtcGxlUmF0ZSA9IHNhbXBsZVJhdGU7XFxuXFxuXFx0XFx0XFx0dGhpcy5wb3J0Lm9ubWVzc2FnZSA9IChldmVudCkgPT4ge1xcblxcdFxcdFxcdFxcdC8vIHdoZW4gaXQgcmVjZWl2ZXMgYSBkaXNwb3NlIFxcblxcdFxcdFxcdFxcdGlmIChldmVudC5kYXRhID09PSBcImRpc3Bvc2VcIikge1xcblxcdFxcdFxcdFxcdFxcdHRoaXMuZGlzcG9zZWQgPSB0cnVlO1xcblxcdFxcdFxcdFxcdH1cXG5cXHRcXHRcXHR9O1xcblxcdFxcdH1cXG5cXHR9XFxuJyk7S3IoXCJcXG5cXHQvKipcXG5cXHQgKiBBYnN0cmFjdCBjbGFzcyBmb3IgYSBzaW5nbGUgaW5wdXQvb3V0cHV0IHByb2Nlc3Nvci4gXFxuXFx0ICogaGFzIGEgJ2dlbmVyYXRlJyBmdW5jdGlvbiB3aGljaCBwcm9jZXNzZXMgb25lIHNhbXBsZSBhdCBhIHRpbWVcXG5cXHQgKi9cXG5cXHRjbGFzcyBTaW5nbGVJT1Byb2Nlc3NvciBleHRlbmRzIFRvbmVBdWRpb1dvcmtsZXRQcm9jZXNzb3Ige1xcblxcblxcdFxcdGNvbnN0cnVjdG9yKG9wdGlvbnMpIHtcXG5cXHRcXHRcXHRzdXBlcihPYmplY3QuYXNzaWduKG9wdGlvbnMsIHtcXG5cXHRcXHRcXHRcXHRudW1iZXJPZklucHV0czogMSxcXG5cXHRcXHRcXHRcXHRudW1iZXJPZk91dHB1dHM6IDFcXG5cXHRcXHRcXHR9KSk7XFxuXFx0XFx0XFx0LyoqXFxuXFx0XFx0XFx0ICogSG9sZHMgdGhlIG5hbWUgb2YgdGhlIHBhcmFtZXRlciBhbmQgYSBzaW5nbGUgdmFsdWUgb2YgdGhhdFxcblxcdFxcdFxcdCAqIHBhcmFtZXRlciBhdCB0aGUgY3VycmVudCBzYW1wbGVcXG5cXHRcXHRcXHQgKiBAdHlwZSB7IFtuYW1lOiBzdHJpbmddOiBudW1iZXIgfVxcblxcdFxcdFxcdCAqL1xcblxcdFxcdFxcdHRoaXMucGFyYW1zID0ge31cXG5cXHRcXHR9XFxuXFxuXFx0XFx0LyoqXFxuXFx0XFx0ICogR2VuZXJhdGUgYW4gb3V0cHV0IHNhbXBsZSBmcm9tIHRoZSBpbnB1dCBzYW1wbGUgYW5kIHBhcmFtZXRlcnNcXG5cXHRcXHQgKiBAYWJzdHJhY3RcXG5cXHRcXHQgKiBAcGFyYW0gaW5wdXQgbnVtYmVyXFxuXFx0XFx0ICogQHBhcmFtIGNoYW5uZWwgbnVtYmVyXFxuXFx0XFx0ICogQHBhcmFtIHBhcmFtZXRlcnMgeyBbbmFtZTogc3RyaW5nXTogbnVtYmVyIH1cXG5cXHRcXHQgKiBAcmV0dXJucyBudW1iZXJcXG5cXHRcXHQgKi9cXG5cXHRcXHRnZW5lcmF0ZSgpe31cXG5cXG5cXHRcXHQvKipcXG5cXHRcXHQgKiBVcGRhdGUgdGhlIHByaXZhdGUgcGFyYW1zIG9iamVjdCB3aXRoIHRoZSBcXG5cXHRcXHQgKiB2YWx1ZXMgb2YgdGhlIHBhcmFtZXRlcnMgYXQgdGhlIGdpdmVuIGluZGV4XFxuXFx0XFx0ICogQHBhcmFtIHBhcmFtZXRlcnMgeyBbbmFtZTogc3RyaW5nXTogRmxvYXQzMkFycmF5IH0sXFxuXFx0XFx0ICogQHBhcmFtIGluZGV4IG51bWJlclxcblxcdFxcdCAqL1xcblxcdFxcdHVwZGF0ZVBhcmFtcyhwYXJhbWV0ZXJzLCBpbmRleCkge1xcblxcdFxcdFxcdGZvciAoY29uc3QgcGFyYW1OYW1lIGluIHBhcmFtZXRlcnMpIHtcXG5cXHRcXHRcXHRcXHRjb25zdCBwYXJhbSA9IHBhcmFtZXRlcnNbcGFyYW1OYW1lXTtcXG5cXHRcXHRcXHRcXHRpZiAocGFyYW0ubGVuZ3RoID4gMSkge1xcblxcdFxcdFxcdFxcdFxcdHRoaXMucGFyYW1zW3BhcmFtTmFtZV0gPSBwYXJhbWV0ZXJzW3BhcmFtTmFtZV1baW5kZXhdO1xcblxcdFxcdFxcdFxcdH0gZWxzZSB7XFxuXFx0XFx0XFx0XFx0XFx0dGhpcy5wYXJhbXNbcGFyYW1OYW1lXSA9IHBhcmFtZXRlcnNbcGFyYW1OYW1lXVswXTtcXG5cXHRcXHRcXHRcXHR9XFxuXFx0XFx0XFx0fVxcblxcdFxcdH1cXG5cXG5cXHRcXHQvKipcXG5cXHRcXHQgKiBQcm9jZXNzIGEgc2luZ2xlIGZyYW1lIG9mIHRoZSBhdWRpb1xcblxcdFxcdCAqIEBwYXJhbSBpbnB1dHMgRmxvYXQzMkFycmF5W11bXVxcblxcdFxcdCAqIEBwYXJhbSBvdXRwdXRzIEZsb2F0MzJBcnJheVtdW11cXG5cXHRcXHQgKi9cXG5cXHRcXHRwcm9jZXNzKGlucHV0cywgb3V0cHV0cywgcGFyYW1ldGVycykge1xcblxcdFxcdFxcdGNvbnN0IGlucHV0ID0gaW5wdXRzWzBdO1xcblxcdFxcdFxcdGNvbnN0IG91dHB1dCA9IG91dHB1dHNbMF07XFxuXFx0XFx0XFx0Ly8gZ2V0IHRoZSBwYXJhbWV0ZXIgdmFsdWVzXFxuXFx0XFx0XFx0Y29uc3QgY2hhbm5lbENvdW50ID0gTWF0aC5tYXgoaW5wdXQgJiYgaW5wdXQubGVuZ3RoIHx8IDAsIG91dHB1dC5sZW5ndGgpO1xcblxcdFxcdFxcdGZvciAobGV0IHNhbXBsZSA9IDA7IHNhbXBsZSA8IHRoaXMuYmxvY2tTaXplOyBzYW1wbGUrKykge1xcblxcdFxcdFxcdFxcdHRoaXMudXBkYXRlUGFyYW1zKHBhcmFtZXRlcnMsIHNhbXBsZSk7XFxuXFx0XFx0XFx0XFx0Zm9yIChsZXQgY2hhbm5lbCA9IDA7IGNoYW5uZWwgPCBjaGFubmVsQ291bnQ7IGNoYW5uZWwrKykge1xcblxcdFxcdFxcdFxcdFxcdGNvbnN0IGlucHV0U2FtcGxlID0gaW5wdXQgJiYgaW5wdXQubGVuZ3RoID8gaW5wdXRbY2hhbm5lbF1bc2FtcGxlXSA6IDA7XFxuXFx0XFx0XFx0XFx0XFx0b3V0cHV0W2NoYW5uZWxdW3NhbXBsZV0gPSB0aGlzLmdlbmVyYXRlKGlucHV0U2FtcGxlLCBjaGFubmVsLCB0aGlzLnBhcmFtcyk7XFxuXFx0XFx0XFx0XFx0fVxcblxcdFxcdFxcdH1cXG5cXHRcXHRcXHRyZXR1cm4gIXRoaXMuZGlzcG9zZWQ7XFxuXFx0XFx0fVxcblxcdH07XFxuXCIpO0tyKFwiXFxuXFx0LyoqXFxuXFx0ICogQSBtdWx0aWNoYW5uZWwgYnVmZmVyIGZvciB1c2Ugd2l0aGluIGFuIEF1ZGlvV29ya2xldFByb2Nlc3NvciBhcyBhIGRlbGF5IGxpbmVcXG5cXHQgKi9cXG5cXHRjbGFzcyBEZWxheUxpbmUge1xcblxcdFxcdFxcblxcdFxcdGNvbnN0cnVjdG9yKHNpemUsIGNoYW5uZWxzKSB7XFxuXFx0XFx0XFx0dGhpcy5idWZmZXIgPSBbXTtcXG5cXHRcXHRcXHR0aGlzLndyaXRlSGVhZCA9IFtdXFxuXFx0XFx0XFx0dGhpcy5zaXplID0gc2l6ZTtcXG5cXG5cXHRcXHRcXHQvLyBjcmVhdGUgdGhlIGVtcHR5IGNoYW5uZWxzXFxuXFx0XFx0XFx0Zm9yIChsZXQgaSA9IDA7IGkgPCBjaGFubmVsczsgaSsrKSB7XFxuXFx0XFx0XFx0XFx0dGhpcy5idWZmZXJbaV0gPSBuZXcgRmxvYXQzMkFycmF5KHRoaXMuc2l6ZSk7XFxuXFx0XFx0XFx0XFx0dGhpcy53cml0ZUhlYWRbaV0gPSAwO1xcblxcdFxcdFxcdH1cXG5cXHRcXHR9XFxuXFxuXFx0XFx0LyoqXFxuXFx0XFx0ICogUHVzaCBhIHZhbHVlIG9udG8gdGhlIGVuZFxcblxcdFxcdCAqIEBwYXJhbSBjaGFubmVsIG51bWJlclxcblxcdFxcdCAqIEBwYXJhbSB2YWx1ZSBudW1iZXJcXG5cXHRcXHQgKi9cXG5cXHRcXHRwdXNoKGNoYW5uZWwsIHZhbHVlKSB7XFxuXFx0XFx0XFx0dGhpcy53cml0ZUhlYWRbY2hhbm5lbF0gKz0gMTtcXG5cXHRcXHRcXHRpZiAodGhpcy53cml0ZUhlYWRbY2hhbm5lbF0gPiB0aGlzLnNpemUpIHtcXG5cXHRcXHRcXHRcXHR0aGlzLndyaXRlSGVhZFtjaGFubmVsXSA9IDA7XFxuXFx0XFx0XFx0fVxcblxcdFxcdFxcdHRoaXMuYnVmZmVyW2NoYW5uZWxdW3RoaXMud3JpdGVIZWFkW2NoYW5uZWxdXSA9IHZhbHVlO1xcblxcdFxcdH1cXG5cXG5cXHRcXHQvKipcXG5cXHRcXHQgKiBHZXQgdGhlIHJlY29yZGVkIHZhbHVlIG9mIHRoZSBjaGFubmVsIGdpdmVuIHRoZSBkZWxheVxcblxcdFxcdCAqIEBwYXJhbSBjaGFubmVsIG51bWJlclxcblxcdFxcdCAqIEBwYXJhbSBkZWxheSBudW1iZXIgZGVsYXkgc2FtcGxlc1xcblxcdFxcdCAqL1xcblxcdFxcdGdldChjaGFubmVsLCBkZWxheSkge1xcblxcdFxcdFxcdGxldCByZWFkSGVhZCA9IHRoaXMud3JpdGVIZWFkW2NoYW5uZWxdIC0gTWF0aC5mbG9vcihkZWxheSk7XFxuXFx0XFx0XFx0aWYgKHJlYWRIZWFkIDwgMCkge1xcblxcdFxcdFxcdFxcdHJlYWRIZWFkICs9IHRoaXMuc2l6ZTtcXG5cXHRcXHRcXHR9XFxuXFx0XFx0XFx0cmV0dXJuIHRoaXMuYnVmZmVyW2NoYW5uZWxdW3JlYWRIZWFkXTtcXG5cXHRcXHR9XFxuXFx0fVxcblwiKTt0YShcImZlZWRiYWNrLWNvbWItZmlsdGVyXCIsJ1xcblxcdGNsYXNzIEZlZWRiYWNrQ29tYkZpbHRlcldvcmtsZXQgZXh0ZW5kcyBTaW5nbGVJT1Byb2Nlc3NvciB7XFxuXFxuXFx0XFx0Y29uc3RydWN0b3Iob3B0aW9ucykge1xcblxcdFxcdFxcdHN1cGVyKG9wdGlvbnMpO1xcblxcdFxcdFxcdHRoaXMuZGVsYXlMaW5lID0gbmV3IERlbGF5TGluZSh0aGlzLnNhbXBsZVJhdGUsIG9wdGlvbnMuY2hhbm5lbENvdW50IHx8IDIpO1xcblxcdFxcdH1cXG5cXG5cXHRcXHRzdGF0aWMgZ2V0IHBhcmFtZXRlckRlc2NyaXB0b3JzKCkge1xcblxcdFxcdFxcdHJldHVybiBbe1xcblxcdFxcdFxcdFxcdG5hbWU6IFwiZGVsYXlUaW1lXCIsXFxuXFx0XFx0XFx0XFx0ZGVmYXVsdFZhbHVlOiAwLjEsXFxuXFx0XFx0XFx0XFx0bWluVmFsdWU6IDAsXFxuXFx0XFx0XFx0XFx0bWF4VmFsdWU6IDEsXFxuXFx0XFx0XFx0XFx0YXV0b21hdGlvblJhdGU6IFwiay1yYXRlXCJcXG5cXHRcXHRcXHR9LCB7XFxuXFx0XFx0XFx0XFx0bmFtZTogXCJmZWVkYmFja1wiLFxcblxcdFxcdFxcdFxcdGRlZmF1bHRWYWx1ZTogMC41LFxcblxcdFxcdFxcdFxcdG1pblZhbHVlOiAwLFxcblxcdFxcdFxcdFxcdG1heFZhbHVlOiAwLjk5OTksXFxuXFx0XFx0XFx0XFx0YXV0b21hdGlvblJhdGU6IFwiay1yYXRlXCJcXG5cXHRcXHRcXHR9XTtcXG5cXHRcXHR9XFxuXFxuXFx0XFx0Z2VuZXJhdGUoaW5wdXQsIGNoYW5uZWwsIHBhcmFtZXRlcnMpIHtcXG5cXHRcXHRcXHRjb25zdCBkZWxheWVkU2FtcGxlID0gdGhpcy5kZWxheUxpbmUuZ2V0KGNoYW5uZWwsIHBhcmFtZXRlcnMuZGVsYXlUaW1lICogdGhpcy5zYW1wbGVSYXRlKTtcXG5cXHRcXHRcXHR0aGlzLmRlbGF5TGluZS5wdXNoKGNoYW5uZWwsIGlucHV0ICsgZGVsYXllZFNhbXBsZSAqIHBhcmFtZXRlcnMuZmVlZGJhY2spO1xcblxcdFxcdFxcdHJldHVybiBkZWxheWVkU2FtcGxlO1xcblxcdFxcdH1cXG5cXHR9XFxuJyk7Y2xhc3Mgc2EgZXh0ZW5kcyBlYXtjb25zdHJ1Y3Rvcigpe3N1cGVyKERpKHNhLmdldERlZmF1bHRzKCksYXJndW1lbnRzLFtcImRlbGF5VGltZVwiLFwicmVzb25hbmNlXCJdKSksdGhpcy5uYW1lPVwiRmVlZGJhY2tDb21iRmlsdGVyXCI7Y29uc3QgdD1EaShzYS5nZXREZWZhdWx0cygpLGFyZ3VtZW50cyxbXCJkZWxheVRpbWVcIixcInJlc29uYW5jZVwiXSk7dGhpcy5pbnB1dD1uZXcga28oe2NvbnRleHQ6dGhpcy5jb250ZXh0fSksdGhpcy5vdXRwdXQ9bmV3IGtvKHtjb250ZXh0OnRoaXMuY29udGV4dH0pLHRoaXMuZGVsYXlUaW1lPW5ldyB4byh7Y29udGV4dDp0aGlzLmNvbnRleHQsdmFsdWU6dC5kZWxheVRpbWUsdW5pdHM6XCJ0aW1lXCIsbWluVmFsdWU6MCxtYXhWYWx1ZToxLHBhcmFtOnRoaXMuX2R1bW15UGFyYW0sc3dhcHBhYmxlOiEwfSksdGhpcy5yZXNvbmFuY2U9bmV3IHhvKHtjb250ZXh0OnRoaXMuY29udGV4dCx2YWx1ZTp0LnJlc29uYW5jZSx1bml0czpcIm5vcm1hbFJhbmdlXCIscGFyYW06dGhpcy5fZHVtbXlQYXJhbSxzd2FwcGFibGU6ITB9KSxVaSh0aGlzLFtcInJlc29uYW5jZVwiLFwiZGVsYXlUaW1lXCJdKX1fYXVkaW9Xb3JrbGV0TmFtZSgpe3JldHVyblwiZmVlZGJhY2stY29tYi1maWx0ZXJcIn1zdGF0aWMgZ2V0RGVmYXVsdHMoKXtyZXR1cm4gT2JqZWN0LmFzc2lnbih3by5nZXREZWZhdWx0cygpLHtkZWxheVRpbWU6LjEscmVzb25hbmNlOi41fSl9b25SZWFkeSh0KXtibyh0aGlzLmlucHV0LHQsdGhpcy5vdXRwdXQpO2NvbnN0IGU9dC5wYXJhbWV0ZXJzLmdldChcImRlbGF5VGltZVwiKTt0aGlzLmRlbGF5VGltZS5zZXRQYXJhbShlKTtjb25zdCBzPXQucGFyYW1ldGVycy5nZXQoXCJmZWVkYmFja1wiKTt0aGlzLnJlc29uYW5jZS5zZXRQYXJhbShzKX1kaXNwb3NlKCl7cmV0dXJuIHN1cGVyLmRpc3Bvc2UoKSx0aGlzLmlucHV0LmRpc3Bvc2UoKSx0aGlzLm91dHB1dC5kaXNwb3NlKCksdGhpcy5kZWxheVRpbWUuZGlzcG9zZSgpLHRoaXMucmVzb25hbmNlLmRpc3Bvc2UoKSx0aGlzfX1jbGFzcyBuYSBleHRlbmRzIHdve2NvbnN0cnVjdG9yKCl7c3VwZXIoRGkobmEuZ2V0RGVmYXVsdHMoKSxhcmd1bWVudHMsW1wiZnJlcXVlbmN5XCIsXCJ0eXBlXCJdKSksdGhpcy5uYW1lPVwiT25lUG9sZUZpbHRlclwiO2NvbnN0IHQ9RGkobmEuZ2V0RGVmYXVsdHMoKSxhcmd1bWVudHMsW1wiZnJlcXVlbmN5XCIsXCJ0eXBlXCJdKTt0aGlzLl9mcmVxdWVuY3k9dC5mcmVxdWVuY3ksdGhpcy5fdHlwZT10LnR5cGUsdGhpcy5pbnB1dD1uZXcga28oe2NvbnRleHQ6dGhpcy5jb250ZXh0fSksdGhpcy5vdXRwdXQ9bmV3IGtvKHtjb250ZXh0OnRoaXMuY29udGV4dH0pLHRoaXMuX2NyZWF0ZUZpbHRlcigpfXN0YXRpYyBnZXREZWZhdWx0cygpe3JldHVybiBPYmplY3QuYXNzaWduKHdvLmdldERlZmF1bHRzKCkse2ZyZXF1ZW5jeTo4ODAsdHlwZTpcImxvd3Bhc3NcIn0pfV9jcmVhdGVGaWx0ZXIoKXtjb25zdCB0PXRoaXMuX2ZpbHRlcixlPXRoaXMudG9GcmVxdWVuY3kodGhpcy5fZnJlcXVlbmN5KSxzPTEvKDIqTWF0aC5QSSplKTtpZihcImxvd3Bhc3NcIj09PXRoaXMuX3R5cGUpe2NvbnN0IHQ9MS8ocyp0aGlzLmNvbnRleHQuc2FtcGxlUmF0ZSksZT10LTE7dGhpcy5fZmlsdGVyPXRoaXMuY29udGV4dC5jcmVhdGVJSVJGaWx0ZXIoW3QsMF0sWzEsZV0pfWVsc2V7Y29uc3QgdD0xLyhzKnRoaXMuY29udGV4dC5zYW1wbGVSYXRlKS0xO3RoaXMuX2ZpbHRlcj10aGlzLmNvbnRleHQuY3JlYXRlSUlSRmlsdGVyKFsxLC0xXSxbMSx0XSl9dGhpcy5pbnB1dC5jaGFpbih0aGlzLl9maWx0ZXIsdGhpcy5vdXRwdXQpLHQmJnRoaXMuY29udGV4dC5zZXRUaW1lb3V0KCgpPT57dGhpcy5kaXNwb3NlZHx8KHRoaXMuaW5wdXQuZGlzY29ubmVjdCh0KSx0LmRpc2Nvbm5lY3QoKSl9LHRoaXMuYmxvY2tUaW1lKX1nZXQgZnJlcXVlbmN5KCl7cmV0dXJuIHRoaXMuX2ZyZXF1ZW5jeX1zZXQgZnJlcXVlbmN5KHQpe3RoaXMuX2ZyZXF1ZW5jeT10LHRoaXMuX2NyZWF0ZUZpbHRlcigpfWdldCB0eXBlKCl7cmV0dXJuIHRoaXMuX3R5cGV9c2V0IHR5cGUodCl7dGhpcy5fdHlwZT10LHRoaXMuX2NyZWF0ZUZpbHRlcigpfWdldEZyZXF1ZW5jeVJlc3BvbnNlKHQ9MTI4KXtjb25zdCBlPW5ldyBGbG9hdDMyQXJyYXkodCk7Zm9yKGxldCBzPTA7czx0O3MrKyl7Y29uc3Qgbj0xOTk4MCpNYXRoLnBvdyhzL3QsMikrMjA7ZVtzXT1ufWNvbnN0IHM9bmV3IEZsb2F0MzJBcnJheSh0KSxuPW5ldyBGbG9hdDMyQXJyYXkodCk7cmV0dXJuIHRoaXMuX2ZpbHRlci5nZXRGcmVxdWVuY3lSZXNwb25zZShlLHMsbiksc31kaXNwb3NlKCl7cmV0dXJuIHN1cGVyLmRpc3Bvc2UoKSx0aGlzLmlucHV0LmRpc3Bvc2UoKSx0aGlzLm91dHB1dC5kaXNwb3NlKCksdGhpcy5fZmlsdGVyLmRpc2Nvbm5lY3QoKSx0aGlzfX1jbGFzcyBpYSBleHRlbmRzIHdve2NvbnN0cnVjdG9yKCl7c3VwZXIoRGkoaWEuZ2V0RGVmYXVsdHMoKSxhcmd1bWVudHMsW1wiZGVsYXlUaW1lXCIsXCJyZXNvbmFuY2VcIixcImRhbXBlbmluZ1wiXSkpLHRoaXMubmFtZT1cIkxvd3Bhc3NDb21iRmlsdGVyXCI7Y29uc3QgdD1EaShpYS5nZXREZWZhdWx0cygpLGFyZ3VtZW50cyxbXCJkZWxheVRpbWVcIixcInJlc29uYW5jZVwiLFwiZGFtcGVuaW5nXCJdKTt0aGlzLl9jb21iRmlsdGVyPXRoaXMub3V0cHV0PW5ldyBzYSh7Y29udGV4dDp0aGlzLmNvbnRleHQsZGVsYXlUaW1lOnQuZGVsYXlUaW1lLHJlc29uYW5jZTp0LnJlc29uYW5jZX0pLHRoaXMuZGVsYXlUaW1lPXRoaXMuX2NvbWJGaWx0ZXIuZGVsYXlUaW1lLHRoaXMucmVzb25hbmNlPXRoaXMuX2NvbWJGaWx0ZXIucmVzb25hbmNlLHRoaXMuX2xvd3Bhc3M9dGhpcy5pbnB1dD1uZXcgbmEoe2NvbnRleHQ6dGhpcy5jb250ZXh0LGZyZXF1ZW5jeTp0LmRhbXBlbmluZyx0eXBlOlwibG93cGFzc1wifSksdGhpcy5fbG93cGFzcy5jb25uZWN0KHRoaXMuX2NvbWJGaWx0ZXIpfXN0YXRpYyBnZXREZWZhdWx0cygpe3JldHVybiBPYmplY3QuYXNzaWduKHdvLmdldERlZmF1bHRzKCkse2RhbXBlbmluZzozZTMsZGVsYXlUaW1lOi4xLHJlc29uYW5jZTouNX0pfWdldCBkYW1wZW5pbmcoKXtyZXR1cm4gdGhpcy5fbG93cGFzcy5mcmVxdWVuY3l9c2V0IGRhbXBlbmluZyh0KXt0aGlzLl9sb3dwYXNzLmZyZXF1ZW5jeT10fWRpc3Bvc2UoKXtyZXR1cm4gc3VwZXIuZGlzcG9zZSgpLHRoaXMuX2NvbWJGaWx0ZXIuZGlzcG9zZSgpLHRoaXMuX2xvd3Bhc3MuZGlzcG9zZSgpLHRoaXN9fWNsYXNzIG9hIGV4dGVuZHMgVnJ7Y29uc3RydWN0b3IoKXtzdXBlcihEaShvYS5nZXREZWZhdWx0cygpLGFyZ3VtZW50cykpLHRoaXMubmFtZT1cIlBsdWNrU3ludGhcIjtjb25zdCB0PURpKG9hLmdldERlZmF1bHRzKCksYXJndW1lbnRzKTt0aGlzLl9ub2lzZT1uZXcgSm8oe2NvbnRleHQ6dGhpcy5jb250ZXh0LHR5cGU6XCJwaW5rXCJ9KSx0aGlzLmF0dGFja05vaXNlPXQuYXR0YWNrTm9pc2UsdGhpcy5fbGZjZj1uZXcgaWEoe2NvbnRleHQ6dGhpcy5jb250ZXh0LGRhbXBlbmluZzp0LmRhbXBlbmluZyxyZXNvbmFuY2U6dC5yZXNvbmFuY2V9KSx0aGlzLnJlc29uYW5jZT10LnJlc29uYW5jZSx0aGlzLnJlbGVhc2U9dC5yZWxlYXNlLHRoaXMuX25vaXNlLmNvbm5lY3QodGhpcy5fbGZjZiksdGhpcy5fbGZjZi5jb25uZWN0KHRoaXMub3V0cHV0KX1zdGF0aWMgZ2V0RGVmYXVsdHMoKXtyZXR1cm4gQWkoVnIuZ2V0RGVmYXVsdHMoKSx7YXR0YWNrTm9pc2U6MSxkYW1wZW5pbmc6NGUzLHJlc29uYW5jZTouNyxyZWxlYXNlOjF9KX1nZXQgZGFtcGVuaW5nKCl7cmV0dXJuIHRoaXMuX2xmY2YuZGFtcGVuaW5nfXNldCBkYW1wZW5pbmcodCl7dGhpcy5fbGZjZi5kYW1wZW5pbmc9dH10cmlnZ2VyQXR0YWNrKHQsZSl7Y29uc3Qgcz10aGlzLnRvRnJlcXVlbmN5KHQpO2U9dGhpcy50b1NlY29uZHMoZSk7Y29uc3Qgbj0xL3M7cmV0dXJuIHRoaXMuX2xmY2YuZGVsYXlUaW1lLnNldFZhbHVlQXRUaW1lKG4sZSksdGhpcy5fbm9pc2Uuc3RhcnQoZSksdGhpcy5fbm9pc2Uuc3RvcChlK24qdGhpcy5hdHRhY2tOb2lzZSksdGhpcy5fbGZjZi5yZXNvbmFuY2UuY2FuY2VsU2NoZWR1bGVkVmFsdWVzKGUpLHRoaXMuX2xmY2YucmVzb25hbmNlLnNldFZhbHVlQXRUaW1lKHRoaXMucmVzb25hbmNlLGUpLHRoaXN9dHJpZ2dlclJlbGVhc2UodCl7cmV0dXJuIHRoaXMuX2xmY2YucmVzb25hbmNlLmxpbmVhclJhbXBUbygwLHRoaXMucmVsZWFzZSx0KSx0aGlzfWRpc3Bvc2UoKXtyZXR1cm4gc3VwZXIuZGlzcG9zZSgpLHRoaXMuX25vaXNlLmRpc3Bvc2UoKSx0aGlzLl9sZmNmLmRpc3Bvc2UoKSx0aGlzfX1jbGFzcyByYSBleHRlbmRzIFZye2NvbnN0cnVjdG9yKCl7c3VwZXIoRGkocmEuZ2V0RGVmYXVsdHMoKSxhcmd1bWVudHMsW1widm9pY2VcIixcIm9wdGlvbnNcIl0pKSx0aGlzLm5hbWU9XCJQb2x5U3ludGhcIix0aGlzLl9hdmFpbGFibGVWb2ljZXM9W10sdGhpcy5fYWN0aXZlVm9pY2VzPVtdLHRoaXMuX3ZvaWNlcz1bXSx0aGlzLl9nY1RpbWVvdXQ9LTEsdGhpcy5fYXZlcmFnZUFjdGl2ZVZvaWNlcz0wO2NvbnN0IHQ9RGkocmEuZ2V0RGVmYXVsdHMoKSxhcmd1bWVudHMsW1widm9pY2VcIixcIm9wdGlvbnNcIl0pO3RpKCF1aSh0LnZvaWNlKSxcIkRFUFJFQ0FURUQ6IFRoZSBwb2x5cGhvbnkgY291bnQgaXMgbm8gbG9uZ2VyIHRoZSBmaXJzdCBhcmd1bWVudC5cIik7Y29uc3QgZT10LnZvaWNlLmdldERlZmF1bHRzKCk7dGhpcy5vcHRpb25zPU9iamVjdC5hc3NpZ24oZSx0Lm9wdGlvbnMpLHRoaXMudm9pY2U9dC52b2ljZSx0aGlzLm1heFBvbHlwaG9ueT10Lm1heFBvbHlwaG9ueSx0aGlzLl9kdW1teVZvaWNlPXRoaXMuX2dldE5leHRBdmFpbGFibGVWb2ljZSgpO2NvbnN0IHM9dGhpcy5fdm9pY2VzLmluZGV4T2YodGhpcy5fZHVtbXlWb2ljZSk7dGhpcy5fdm9pY2VzLnNwbGljZShzLDEpLHRoaXMuX2djVGltZW91dD10aGlzLmNvbnRleHQuc2V0SW50ZXJ2YWwodGhpcy5fY29sbGVjdEdhcmJhZ2UuYmluZCh0aGlzKSwxKX1zdGF0aWMgZ2V0RGVmYXVsdHMoKXtyZXR1cm4gT2JqZWN0LmFzc2lnbihWci5nZXREZWZhdWx0cygpLHttYXhQb2x5cGhvbnk6MzIsb3B0aW9uczp7fSx2b2ljZTpqcn0pfWdldCBhY3RpdmVWb2ljZXMoKXtyZXR1cm4gdGhpcy5fYWN0aXZlVm9pY2VzLmxlbmd0aH1fbWFrZVZvaWNlQXZhaWxhYmxlKHQpe3RoaXMuX2F2YWlsYWJsZVZvaWNlcy5wdXNoKHQpO2NvbnN0IGU9dGhpcy5fYWN0aXZlVm9pY2VzLmZpbmRJbmRleChlPT5lLnZvaWNlPT09dCk7dGhpcy5fYWN0aXZlVm9pY2VzLnNwbGljZShlLDEpfV9nZXROZXh0QXZhaWxhYmxlVm9pY2UoKXtpZih0aGlzLl9hdmFpbGFibGVWb2ljZXMubGVuZ3RoKXJldHVybiB0aGlzLl9hdmFpbGFibGVWb2ljZXMuc2hpZnQoKTtpZih0aGlzLl92b2ljZXMubGVuZ3RoPHRoaXMubWF4UG9seXBob255KXtjb25zdCB0PW5ldyB0aGlzLnZvaWNlKE9iamVjdC5hc3NpZ24odGhpcy5vcHRpb25zLHtjb250ZXh0OnRoaXMuY29udGV4dCxvbnNpbGVuY2U6dGhpcy5fbWFrZVZvaWNlQXZhaWxhYmxlLmJpbmQodGhpcyl9KSk7cmV0dXJuIHQuY29ubmVjdCh0aGlzLm91dHB1dCksdGhpcy5fdm9pY2VzLnB1c2godCksdH1yaShcIk1heCBwb2x5cGhvbnkgZXhjZWVkZWQuIE5vdGUgZHJvcHBlZC5cIil9X2NvbGxlY3RHYXJiYWdlKCl7aWYodGhpcy5fYXZlcmFnZUFjdGl2ZVZvaWNlcz1NYXRoLm1heCguOTUqdGhpcy5fYXZlcmFnZUFjdGl2ZVZvaWNlcyx0aGlzLmFjdGl2ZVZvaWNlcyksdGhpcy5fYXZhaWxhYmxlVm9pY2VzLmxlbmd0aCYmdGhpcy5fdm9pY2VzLmxlbmd0aD5NYXRoLmNlaWwodGhpcy5fYXZlcmFnZUFjdGl2ZVZvaWNlcysxKSl7Y29uc3QgdD10aGlzLl9hdmFpbGFibGVWb2ljZXMuc2hpZnQoKSxlPXRoaXMuX3ZvaWNlcy5pbmRleE9mKHQpO3RoaXMuX3ZvaWNlcy5zcGxpY2UoZSwxKSx0aGlzLmNvbnRleHQuaXNPZmZsaW5lfHx0LmRpc3Bvc2UoKX19X3RyaWdnZXJBdHRhY2sodCxlLHMpe3QuZm9yRWFjaCh0PT57Y29uc3Qgbj1uZXcgTm8odGhpcy5jb250ZXh0LHQpLnRvTWlkaSgpLGk9dGhpcy5fZ2V0TmV4dEF2YWlsYWJsZVZvaWNlKCk7aSYmKGkudHJpZ2dlckF0dGFjayh0LGUscyksdGhpcy5fYWN0aXZlVm9pY2VzLnB1c2goe21pZGk6bix2b2ljZTppLHJlbGVhc2VkOiExfSksdGhpcy5sb2coXCJ0cmlnZ2VyQXR0YWNrXCIsdCxlKSl9KX1fdHJpZ2dlclJlbGVhc2UodCxlKXt0LmZvckVhY2godD0+e2NvbnN0IHM9bmV3IE5vKHRoaXMuY29udGV4dCx0KS50b01pZGkoKSxuPXRoaXMuX2FjdGl2ZVZvaWNlcy5maW5kKCh7bWlkaTp0LHJlbGVhc2VkOmV9KT0+dD09PXMmJiFlKTtuJiYobi52b2ljZS50cmlnZ2VyUmVsZWFzZShlKSxuLnJlbGVhc2VkPSEwLHRoaXMubG9nKFwidHJpZ2dlclJlbGVhc2VcIix0LGUpKX0pfV9zY2hlZHVsZUV2ZW50KHQsZSxzLG4pe3RpKCF0aGlzLmRpc3Bvc2VkLFwiU3ludGggd2FzIGFscmVhZHkgZGlzcG9zZWRcIiksczw9dGhpcy5ub3coKT9cImF0dGFja1wiPT09dD90aGlzLl90cmlnZ2VyQXR0YWNrKGUscyxuKTp0aGlzLl90cmlnZ2VyUmVsZWFzZShlLHMpOnRoaXMuY29udGV4dC5zZXRUaW1lb3V0KCgpPT57dGhpcy5fc2NoZWR1bGVFdmVudCh0LGUscyxuKX0scy10aGlzLm5vdygpKX10cmlnZ2VyQXR0YWNrKHQsZSxzKXtBcnJheS5pc0FycmF5KHQpfHwodD1bdF0pO2NvbnN0IG49dGhpcy50b1NlY29uZHMoZSk7cmV0dXJuIHRoaXMuX3NjaGVkdWxlRXZlbnQoXCJhdHRhY2tcIix0LG4scyksdGhpc310cmlnZ2VyUmVsZWFzZSh0LGUpe0FycmF5LmlzQXJyYXkodCl8fCh0PVt0XSk7Y29uc3Qgcz10aGlzLnRvU2Vjb25kcyhlKTtyZXR1cm4gdGhpcy5fc2NoZWR1bGVFdmVudChcInJlbGVhc2VcIix0LHMpLHRoaXN9dHJpZ2dlckF0dGFja1JlbGVhc2UodCxlLHMsbil7Y29uc3QgaT10aGlzLnRvU2Vjb25kcyhzKTtpZih0aGlzLnRyaWdnZXJBdHRhY2sodCxpLG4pLGRpKGUpKXt0aShkaSh0KSxcIklmIHRoZSBkdXJhdGlvbiBpcyBhbiBhcnJheSwgdGhlIG5vdGVzIG11c3QgYWxzbyBiZSBhbiBhcnJheVwiKSx0PXQ7Zm9yKGxldCBzPTA7czx0Lmxlbmd0aDtzKyspe2NvbnN0IG49ZVtNYXRoLm1pbihzLGUubGVuZ3RoLTEpXSxvPXRoaXMudG9TZWNvbmRzKG4pO3RpKG8+MCxcIlRoZSBkdXJhdGlvbiBtdXN0IGJlIGdyZWF0ZXIgdGhhbiAwXCIpLHRoaXMudHJpZ2dlclJlbGVhc2UodFtzXSxpK28pfX1lbHNle2NvbnN0IHM9dGhpcy50b1NlY29uZHMoZSk7dGkocz4wLFwiVGhlIGR1cmF0aW9uIG11c3QgYmUgZ3JlYXRlciB0aGFuIDBcIiksdGhpcy50cmlnZ2VyUmVsZWFzZSh0LGkrcyl9cmV0dXJuIHRoaXN9c3luYygpe3JldHVybiB0aGlzLl9zeW5jU3RhdGUoKSYmKHRoaXMuX3N5bmNNZXRob2QoXCJ0cmlnZ2VyQXR0YWNrXCIsMSksdGhpcy5fc3luY01ldGhvZChcInRyaWdnZXJSZWxlYXNlXCIsMSkpLHRoaXN9c2V0KHQpe2NvbnN0IGU9TWkodCxbXCJvbnNpbGVuY2VcIixcImNvbnRleHRcIl0pO3JldHVybiB0aGlzLm9wdGlvbnM9QWkodGhpcy5vcHRpb25zLGUpLHRoaXMuX3ZvaWNlcy5mb3JFYWNoKHQ9PnQuc2V0KGUpKSx0aGlzLl9kdW1teVZvaWNlLnNldChlKSx0aGlzfWdldCgpe3JldHVybiB0aGlzLl9kdW1teVZvaWNlLmdldCgpfXJlbGVhc2VBbGwodCl7Y29uc3QgZT10aGlzLnRvU2Vjb25kcyh0KTtyZXR1cm4gdGhpcy5fYWN0aXZlVm9pY2VzLmZvckVhY2goKHt2b2ljZTp0fSk9Pnt0LnRyaWdnZXJSZWxlYXNlKGUpfSksdGhpc31kaXNwb3NlKCl7cmV0dXJuIHN1cGVyLmRpc3Bvc2UoKSx0aGlzLl9kdW1teVZvaWNlLmRpc3Bvc2UoKSx0aGlzLl92b2ljZXMuZm9yRWFjaCh0PT50LmRpc3Bvc2UoKSksdGhpcy5fYWN0aXZlVm9pY2VzPVtdLHRoaXMuX2F2YWlsYWJsZVZvaWNlcz1bXSx0aGlzLmNvbnRleHQuY2xlYXJJbnRlcnZhbCh0aGlzLl9nY1RpbWVvdXQpLHRoaXN9fWNsYXNzIGFhIGV4dGVuZHMgVnJ7Y29uc3RydWN0b3IoKXtzdXBlcihEaShhYS5nZXREZWZhdWx0cygpLGFyZ3VtZW50cyxbXCJ1cmxzXCIsXCJvbmxvYWRcIixcImJhc2VVcmxcIl0sXCJ1cmxzXCIpKSx0aGlzLm5hbWU9XCJTYW1wbGVyXCIsdGhpcy5fYWN0aXZlU291cmNlcz1uZXcgTWFwO2NvbnN0IHQ9RGkoYWEuZ2V0RGVmYXVsdHMoKSxhcmd1bWVudHMsW1widXJsc1wiLFwib25sb2FkXCIsXCJiYXNlVXJsXCJdLFwidXJsc1wiKSxlPXt9O09iamVjdC5rZXlzKHQudXJscykuZm9yRWFjaChzPT57Y29uc3Qgbj1wYXJzZUludChzLDEwKTtpZih0aShfaShzKXx8dWkobikmJmlzRmluaXRlKG4pLFwidXJsIGtleSBpcyBuZWl0aGVyIGEgbm90ZSBvciBtaWRpIHBpdGNoOiBcIitzKSxfaShzKSl7Y29uc3Qgbj1uZXcgbG8odGhpcy5jb250ZXh0LHMpLnRvTWlkaSgpO2Vbbl09dC51cmxzW3NdfWVsc2UgdWkobikmJmlzRmluaXRlKG4pJiYoZVtuXT10LnVybHNbbl0pfSksdGhpcy5fYnVmZmVycz1uZXcgVm8oe3VybHM6ZSxvbmxvYWQ6dC5vbmxvYWQsYmFzZVVybDp0LmJhc2VVcmwsb25lcnJvcjp0Lm9uZXJyb3J9KSx0aGlzLmF0dGFjaz10LmF0dGFjayx0aGlzLnJlbGVhc2U9dC5yZWxlYXNlLHRoaXMuY3VydmU9dC5jdXJ2ZSx0aGlzLl9idWZmZXJzLmxvYWRlZCYmUHJvbWlzZS5yZXNvbHZlKCkudGhlbih0Lm9ubG9hZCl9c3RhdGljIGdldERlZmF1bHRzKCl7cmV0dXJuIE9iamVjdC5hc3NpZ24oVnIuZ2V0RGVmYXVsdHMoKSx7YXR0YWNrOjAsYmFzZVVybDpcIlwiLGN1cnZlOlwiZXhwb25lbnRpYWxcIixvbmxvYWQ6Wmksb25lcnJvcjpaaSxyZWxlYXNlOi4xLHVybHM6e319KX1fZmluZENsb3Nlc3QodCl7bGV0IGU9MDtmb3IoO2U8OTY7KXtpZih0aGlzLl9idWZmZXJzLmhhcyh0K2UpKXJldHVybi1lO2lmKHRoaXMuX2J1ZmZlcnMuaGFzKHQtZSkpcmV0dXJuIGU7ZSsrfXRocm93IG5ldyBFcnJvcihcIk5vIGF2YWlsYWJsZSBidWZmZXJzIGZvciBub3RlOiBcIit0KX10cmlnZ2VyQXR0YWNrKHQsZSxzPTEpe3JldHVybiB0aGlzLmxvZyhcInRyaWdnZXJBdHRhY2tcIix0LGUscyksQXJyYXkuaXNBcnJheSh0KXx8KHQ9W3RdKSx0LmZvckVhY2godD0+e2NvbnN0IG49cm8obmV3IGxvKHRoaXMuY29udGV4dCx0KS50b0ZyZXF1ZW5jeSgpKSxpPU1hdGgucm91bmQobiksbz1uLWkscj10aGlzLl9maW5kQ2xvc2VzdChpKSxhPWktcixjPXRoaXMuX2J1ZmZlcnMuZ2V0KGEpLGg9bm8ocitvKSx1PW5ldyAkbyh7dXJsOmMsY29udGV4dDp0aGlzLmNvbnRleHQsY3VydmU6dGhpcy5jdXJ2ZSxmYWRlSW46dGhpcy5hdHRhY2ssZmFkZU91dDp0aGlzLnJlbGVhc2UscGxheWJhY2tSYXRlOmh9KS5jb25uZWN0KHRoaXMub3V0cHV0KTt1LnN0YXJ0KGUsMCxjLmR1cmF0aW9uL2gscyksZGkodGhpcy5fYWN0aXZlU291cmNlcy5nZXQoaSkpfHx0aGlzLl9hY3RpdmVTb3VyY2VzLnNldChpLFtdKSx0aGlzLl9hY3RpdmVTb3VyY2VzLmdldChpKS5wdXNoKHUpLHUub25lbmRlZD0oKT0+e2lmKHRoaXMuX2FjdGl2ZVNvdXJjZXMmJnRoaXMuX2FjdGl2ZVNvdXJjZXMuaGFzKGkpKXtjb25zdCB0PXRoaXMuX2FjdGl2ZVNvdXJjZXMuZ2V0KGkpLGU9dC5pbmRleE9mKHUpOy0xIT09ZSYmdC5zcGxpY2UoZSwxKX19fSksdGhpc310cmlnZ2VyUmVsZWFzZSh0LGUpe3JldHVybiB0aGlzLmxvZyhcInRyaWdnZXJSZWxlYXNlXCIsdCxlKSxBcnJheS5pc0FycmF5KHQpfHwodD1bdF0pLHQuZm9yRWFjaCh0PT57Y29uc3Qgcz1uZXcgbG8odGhpcy5jb250ZXh0LHQpLnRvTWlkaSgpO2lmKHRoaXMuX2FjdGl2ZVNvdXJjZXMuaGFzKHMpJiZ0aGlzLl9hY3RpdmVTb3VyY2VzLmdldChzKS5sZW5ndGgpe2NvbnN0IHQ9dGhpcy5fYWN0aXZlU291cmNlcy5nZXQocyk7ZT10aGlzLnRvU2Vjb25kcyhlKSx0LmZvckVhY2godD0+e3Quc3RvcChlKX0pLHRoaXMuX2FjdGl2ZVNvdXJjZXMuc2V0KHMsW10pfX0pLHRoaXN9cmVsZWFzZUFsbCh0KXtjb25zdCBlPXRoaXMudG9TZWNvbmRzKHQpO3JldHVybiB0aGlzLl9hY3RpdmVTb3VyY2VzLmZvckVhY2godD0+e2Zvcig7dC5sZW5ndGg7KXt0LnNoaWZ0KCkuc3RvcChlKX19KSx0aGlzfXN5bmMoKXtyZXR1cm4gdGhpcy5fc3luY1N0YXRlKCkmJih0aGlzLl9zeW5jTWV0aG9kKFwidHJpZ2dlckF0dGFja1wiLDEpLHRoaXMuX3N5bmNNZXRob2QoXCJ0cmlnZ2VyUmVsZWFzZVwiLDEpKSx0aGlzfXRyaWdnZXJBdHRhY2tSZWxlYXNlKHQsZSxzLG49MSl7Y29uc3QgaT10aGlzLnRvU2Vjb25kcyhzKTtyZXR1cm4gdGhpcy50cmlnZ2VyQXR0YWNrKHQsaSxuKSxkaShlKT8odGkoZGkodCksXCJub3RlcyBtdXN0IGJlIGFuIGFycmF5IHdoZW4gZHVyYXRpb24gaXMgYXJyYXlcIiksdC5mb3JFYWNoKCh0LHMpPT57Y29uc3Qgbj1lW01hdGgubWluKHMsZS5sZW5ndGgtMSldO3RoaXMudHJpZ2dlclJlbGVhc2UodCxpK3RoaXMudG9TZWNvbmRzKG4pKX0pKTp0aGlzLnRyaWdnZXJSZWxlYXNlKHQsaSt0aGlzLnRvU2Vjb25kcyhlKSksdGhpc31hZGQodCxlLHMpe2lmKHRpKF9pKHQpfHxpc0Zpbml0ZSh0KSxcIm5vdGUgbXVzdCBiZSBhIHBpdGNoIG9yIG1pZGk6IFwiK3QpLF9pKHQpKXtjb25zdCBuPW5ldyBsbyh0aGlzLmNvbnRleHQsdCkudG9NaWRpKCk7dGhpcy5fYnVmZmVycy5hZGQobixlLHMpfWVsc2UgdGhpcy5fYnVmZmVycy5hZGQodCxlLHMpO3JldHVybiB0aGlzfWdldCBsb2FkZWQoKXtyZXR1cm4gdGhpcy5fYnVmZmVycy5sb2FkZWR9ZGlzcG9zZSgpe3JldHVybiBzdXBlci5kaXNwb3NlKCksdGhpcy5fYnVmZmVycy5kaXNwb3NlKCksdGhpcy5fYWN0aXZlU291cmNlcy5mb3JFYWNoKHQ9Pnt0LmZvckVhY2godD0+dC5kaXNwb3NlKCkpfSksdGhpcy5fYWN0aXZlU291cmNlcy5jbGVhcigpLHRoaXN9fXZpKFt3cigwKV0sYWEucHJvdG90eXBlLFwiYXR0YWNrXCIsdm9pZCAwKSx2aShbd3IoMCldLGFhLnByb3RvdHlwZSxcInJlbGVhc2VcIix2b2lkIDApO2NsYXNzIGNhIGV4dGVuZHMgdm97Y29uc3RydWN0b3IoKXtzdXBlcihEaShjYS5nZXREZWZhdWx0cygpLGFyZ3VtZW50cyxbXCJjYWxsYmFja1wiLFwidmFsdWVcIl0pKSx0aGlzLm5hbWU9XCJUb25lRXZlbnRcIix0aGlzLl9zdGF0ZT1uZXcgeW8oXCJzdG9wcGVkXCIpLHRoaXMuX3N0YXJ0T2Zmc2V0PTA7Y29uc3QgdD1EaShjYS5nZXREZWZhdWx0cygpLGFyZ3VtZW50cyxbXCJjYWxsYmFja1wiLFwidmFsdWVcIl0pO3RoaXMuX2xvb3A9dC5sb29wLHRoaXMuY2FsbGJhY2s9dC5jYWxsYmFjayx0aGlzLnZhbHVlPXQudmFsdWUsdGhpcy5fbG9vcFN0YXJ0PXRoaXMudG9UaWNrcyh0Lmxvb3BTdGFydCksdGhpcy5fbG9vcEVuZD10aGlzLnRvVGlja3ModC5sb29wRW5kKSx0aGlzLl9wbGF5YmFja1JhdGU9dC5wbGF5YmFja1JhdGUsdGhpcy5fcHJvYmFiaWxpdHk9dC5wcm9iYWJpbGl0eSx0aGlzLl9odW1hbml6ZT10Lmh1bWFuaXplLHRoaXMubXV0ZT10Lm11dGUsdGhpcy5fcGxheWJhY2tSYXRlPXQucGxheWJhY2tSYXRlLHRoaXMuX3N0YXRlLmluY3JlYXNpbmc9ITAsdGhpcy5fcmVzY2hlZHVsZUV2ZW50cygpfXN0YXRpYyBnZXREZWZhdWx0cygpe3JldHVybiBPYmplY3QuYXNzaWduKHZvLmdldERlZmF1bHRzKCkse2NhbGxiYWNrOlppLGh1bWFuaXplOiExLGxvb3A6ITEsbG9vcEVuZDpcIjFtXCIsbG9vcFN0YXJ0OjAsbXV0ZTohMSxwbGF5YmFja1JhdGU6MSxwcm9iYWJpbGl0eToxLHZhbHVlOm51bGx9KX1fcmVzY2hlZHVsZUV2ZW50cyh0PS0xKXt0aGlzLl9zdGF0ZS5mb3JFYWNoRnJvbSh0LHQ9PntsZXQgZTtpZihcInN0YXJ0ZWRcIj09PXQuc3RhdGUpey0xIT09dC5pZCYmdGhpcy5jb250ZXh0LnRyYW5zcG9ydC5jbGVhcih0LmlkKTtjb25zdCBzPXQudGltZStNYXRoLnJvdW5kKHRoaXMuc3RhcnRPZmZzZXQvdGhpcy5fcGxheWJhY2tSYXRlKTtpZighMD09PXRoaXMuX2xvb3B8fHVpKHRoaXMuX2xvb3ApJiZ0aGlzLl9sb29wPjEpe2U9MS8wLHVpKHRoaXMuX2xvb3ApJiYoZT10aGlzLl9sb29wKnRoaXMuX2dldExvb3BEdXJhdGlvbigpKTtjb25zdCBuPXRoaXMuX3N0YXRlLmdldEFmdGVyKHMpO251bGwhPT1uJiYoZT1NYXRoLm1pbihlLG4udGltZS1zKSksZSE9PTEvMCYmKHRoaXMuX3N0YXRlLnNldFN0YXRlQXRUaW1lKFwic3RvcHBlZFwiLHMrZSsxLHtpZDotMX0pLGU9bmV3IGpvKHRoaXMuY29udGV4dCxlKSk7Y29uc3QgaT1uZXcgam8odGhpcy5jb250ZXh0LHRoaXMuX2dldExvb3BEdXJhdGlvbigpKTt0LmlkPXRoaXMuY29udGV4dC50cmFuc3BvcnQuc2NoZWR1bGVSZXBlYXQodGhpcy5fdGljay5iaW5kKHRoaXMpLGksbmV3IGpvKHRoaXMuY29udGV4dCxzKSxlKX1lbHNlIHQuaWQ9dGhpcy5jb250ZXh0LnRyYW5zcG9ydC5zY2hlZHVsZSh0aGlzLl90aWNrLmJpbmQodGhpcyksbmV3IGpvKHRoaXMuY29udGV4dCxzKSl9fSl9Z2V0IHN0YXRlKCl7cmV0dXJuIHRoaXMuX3N0YXRlLmdldFZhbHVlQXRUaW1lKHRoaXMuY29udGV4dC50cmFuc3BvcnQudGlja3MpfWdldCBzdGFydE9mZnNldCgpe3JldHVybiB0aGlzLl9zdGFydE9mZnNldH1zZXQgc3RhcnRPZmZzZXQodCl7dGhpcy5fc3RhcnRPZmZzZXQ9dH1nZXQgcHJvYmFiaWxpdHkoKXtyZXR1cm4gdGhpcy5fcHJvYmFiaWxpdHl9c2V0IHByb2JhYmlsaXR5KHQpe3RoaXMuX3Byb2JhYmlsaXR5PXR9Z2V0IGh1bWFuaXplKCl7cmV0dXJuIHRoaXMuX2h1bWFuaXplfXNldCBodW1hbml6ZSh0KXt0aGlzLl9odW1hbml6ZT10fXN0YXJ0KHQpe2NvbnN0IGU9dGhpcy50b1RpY2tzKHQpO3JldHVyblwic3RvcHBlZFwiPT09dGhpcy5fc3RhdGUuZ2V0VmFsdWVBdFRpbWUoZSkmJih0aGlzLl9zdGF0ZS5hZGQoe2lkOi0xLHN0YXRlOlwic3RhcnRlZFwiLHRpbWU6ZX0pLHRoaXMuX3Jlc2NoZWR1bGVFdmVudHMoZSkpLHRoaXN9c3RvcCh0KXt0aGlzLmNhbmNlbCh0KTtjb25zdCBlPXRoaXMudG9UaWNrcyh0KTtpZihcInN0YXJ0ZWRcIj09PXRoaXMuX3N0YXRlLmdldFZhbHVlQXRUaW1lKGUpKXt0aGlzLl9zdGF0ZS5zZXRTdGF0ZUF0VGltZShcInN0b3BwZWRcIixlLHtpZDotMX0pO2NvbnN0IHQ9dGhpcy5fc3RhdGUuZ2V0QmVmb3JlKGUpO2xldCBzPWU7bnVsbCE9PXQmJihzPXQudGltZSksdGhpcy5fcmVzY2hlZHVsZUV2ZW50cyhzKX1yZXR1cm4gdGhpc31jYW5jZWwodCl7dD1PaSh0LC0xLzApO2NvbnN0IGU9dGhpcy50b1RpY2tzKHQpO3JldHVybiB0aGlzLl9zdGF0ZS5mb3JFYWNoRnJvbShlLHQ9Pnt0aGlzLmNvbnRleHQudHJhbnNwb3J0LmNsZWFyKHQuaWQpfSksdGhpcy5fc3RhdGUuY2FuY2VsKGUpLHRoaXN9X3RpY2sodCl7Y29uc3QgZT10aGlzLmNvbnRleHQudHJhbnNwb3J0LmdldFRpY2tzQXRUaW1lKHQpO2lmKCF0aGlzLm11dGUmJlwic3RhcnRlZFwiPT09dGhpcy5fc3RhdGUuZ2V0VmFsdWVBdFRpbWUoZSkpe2lmKHRoaXMucHJvYmFiaWxpdHk8MSYmTWF0aC5yYW5kb20oKT50aGlzLnByb2JhYmlsaXR5KXJldHVybjtpZih0aGlzLmh1bWFuaXplKXtsZXQgZT0uMDI7cGkodGhpcy5odW1hbml6ZSl8fChlPXRoaXMudG9TZWNvbmRzKHRoaXMuaHVtYW5pemUpKSx0Kz0oMipNYXRoLnJhbmRvbSgpLTEpKmV9dGhpcy5jYWxsYmFjayh0LHRoaXMudmFsdWUpfX1fZ2V0TG9vcER1cmF0aW9uKCl7cmV0dXJuIE1hdGgucm91bmQoKHRoaXMuX2xvb3BFbmQtdGhpcy5fbG9vcFN0YXJ0KS90aGlzLl9wbGF5YmFja1JhdGUpfWdldCBsb29wKCl7cmV0dXJuIHRoaXMuX2xvb3B9c2V0IGxvb3AodCl7dGhpcy5fbG9vcD10LHRoaXMuX3Jlc2NoZWR1bGVFdmVudHMoKX1nZXQgcGxheWJhY2tSYXRlKCl7cmV0dXJuIHRoaXMuX3BsYXliYWNrUmF0ZX1zZXQgcGxheWJhY2tSYXRlKHQpe3RoaXMuX3BsYXliYWNrUmF0ZT10LHRoaXMuX3Jlc2NoZWR1bGVFdmVudHMoKX1nZXQgbG9vcEVuZCgpe3JldHVybiBuZXcgam8odGhpcy5jb250ZXh0LHRoaXMuX2xvb3BFbmQpLnRvU2Vjb25kcygpfXNldCBsb29wRW5kKHQpe3RoaXMuX2xvb3BFbmQ9dGhpcy50b1RpY2tzKHQpLHRoaXMuX2xvb3AmJnRoaXMuX3Jlc2NoZWR1bGVFdmVudHMoKX1nZXQgbG9vcFN0YXJ0KCl7cmV0dXJuIG5ldyBqbyh0aGlzLmNvbnRleHQsdGhpcy5fbG9vcFN0YXJ0KS50b1NlY29uZHMoKX1zZXQgbG9vcFN0YXJ0KHQpe3RoaXMuX2xvb3BTdGFydD10aGlzLnRvVGlja3ModCksdGhpcy5fbG9vcCYmdGhpcy5fcmVzY2hlZHVsZUV2ZW50cygpfWdldCBwcm9ncmVzcygpe2lmKHRoaXMuX2xvb3Ape2NvbnN0IHQ9dGhpcy5jb250ZXh0LnRyYW5zcG9ydC50aWNrcyxlPXRoaXMuX3N0YXRlLmdldCh0KTtpZihudWxsIT09ZSYmXCJzdGFydGVkXCI9PT1lLnN0YXRlKXtjb25zdCBzPXRoaXMuX2dldExvb3BEdXJhdGlvbigpO3JldHVybih0LWUudGltZSklcy9zfXJldHVybiAwfXJldHVybiAwfWRpc3Bvc2UoKXtyZXR1cm4gc3VwZXIuZGlzcG9zZSgpLHRoaXMuY2FuY2VsKCksdGhpcy5fc3RhdGUuZGlzcG9zZSgpLHRoaXN9fWNsYXNzIGhhIGV4dGVuZHMgdm97Y29uc3RydWN0b3IoKXtzdXBlcihEaShoYS5nZXREZWZhdWx0cygpLGFyZ3VtZW50cyxbXCJjYWxsYmFja1wiLFwiaW50ZXJ2YWxcIl0pKSx0aGlzLm5hbWU9XCJMb29wXCI7Y29uc3QgdD1EaShoYS5nZXREZWZhdWx0cygpLGFyZ3VtZW50cyxbXCJjYWxsYmFja1wiLFwiaW50ZXJ2YWxcIl0pO3RoaXMuX2V2ZW50PW5ldyBjYSh7Y29udGV4dDp0aGlzLmNvbnRleHQsY2FsbGJhY2s6dGhpcy5fdGljay5iaW5kKHRoaXMpLGxvb3A6ITAsbG9vcEVuZDp0LmludGVydmFsLHBsYXliYWNrUmF0ZTp0LnBsYXliYWNrUmF0ZSxwcm9iYWJpbGl0eTp0LnByb2JhYmlsaXR5fSksdGhpcy5jYWxsYmFjaz10LmNhbGxiYWNrLHRoaXMuaXRlcmF0aW9ucz10Lml0ZXJhdGlvbnN9c3RhdGljIGdldERlZmF1bHRzKCl7cmV0dXJuIE9iamVjdC5hc3NpZ24odm8uZ2V0RGVmYXVsdHMoKSx7aW50ZXJ2YWw6XCI0blwiLGNhbGxiYWNrOlppLHBsYXliYWNrUmF0ZToxLGl0ZXJhdGlvbnM6MS8wLHByb2JhYmlsaXR5OjEsbXV0ZTohMSxodW1hbml6ZTohMX0pfXN0YXJ0KHQpe3JldHVybiB0aGlzLl9ldmVudC5zdGFydCh0KSx0aGlzfXN0b3AodCl7cmV0dXJuIHRoaXMuX2V2ZW50LnN0b3AodCksdGhpc31jYW5jZWwodCl7cmV0dXJuIHRoaXMuX2V2ZW50LmNhbmNlbCh0KSx0aGlzfV90aWNrKHQpe3RoaXMuY2FsbGJhY2sodCl9Z2V0IHN0YXRlKCl7cmV0dXJuIHRoaXMuX2V2ZW50LnN0YXRlfWdldCBwcm9ncmVzcygpe3JldHVybiB0aGlzLl9ldmVudC5wcm9ncmVzc31nZXQgaW50ZXJ2YWwoKXtyZXR1cm4gdGhpcy5fZXZlbnQubG9vcEVuZH1zZXQgaW50ZXJ2YWwodCl7dGhpcy5fZXZlbnQubG9vcEVuZD10fWdldCBwbGF5YmFja1JhdGUoKXtyZXR1cm4gdGhpcy5fZXZlbnQucGxheWJhY2tSYXRlfXNldCBwbGF5YmFja1JhdGUodCl7dGhpcy5fZXZlbnQucGxheWJhY2tSYXRlPXR9Z2V0IGh1bWFuaXplKCl7cmV0dXJuIHRoaXMuX2V2ZW50Lmh1bWFuaXplfXNldCBodW1hbml6ZSh0KXt0aGlzLl9ldmVudC5odW1hbml6ZT10fWdldCBwcm9iYWJpbGl0eSgpe3JldHVybiB0aGlzLl9ldmVudC5wcm9iYWJpbGl0eX1zZXQgcHJvYmFiaWxpdHkodCl7dGhpcy5fZXZlbnQucHJvYmFiaWxpdHk9dH1nZXQgbXV0ZSgpe3JldHVybiB0aGlzLl9ldmVudC5tdXRlfXNldCBtdXRlKHQpe3RoaXMuX2V2ZW50Lm11dGU9dH1nZXQgaXRlcmF0aW9ucygpe3JldHVybiEwPT09dGhpcy5fZXZlbnQubG9vcD8xLzA6dGhpcy5fZXZlbnQubG9vcH1zZXQgaXRlcmF0aW9ucyh0KXt0aGlzLl9ldmVudC5sb29wPXQ9PT0xLzB8fHR9ZGlzcG9zZSgpe3JldHVybiBzdXBlci5kaXNwb3NlKCksdGhpcy5fZXZlbnQuZGlzcG9zZSgpLHRoaXN9fWNsYXNzIHVhIGV4dGVuZHMgY2F7Y29uc3RydWN0b3IoKXtzdXBlcihEaSh1YS5nZXREZWZhdWx0cygpLGFyZ3VtZW50cyxbXCJjYWxsYmFja1wiLFwiZXZlbnRzXCJdKSksdGhpcy5uYW1lPVwiUGFydFwiLHRoaXMuX3N0YXRlPW5ldyB5byhcInN0b3BwZWRcIiksdGhpcy5fZXZlbnRzPW5ldyBTZXQ7Y29uc3QgdD1EaSh1YS5nZXREZWZhdWx0cygpLGFyZ3VtZW50cyxbXCJjYWxsYmFja1wiLFwiZXZlbnRzXCJdKTt0aGlzLl9zdGF0ZS5pbmNyZWFzaW5nPSEwLHQuZXZlbnRzLmZvckVhY2godD0+e2RpKHQpP3RoaXMuYWRkKHRbMF0sdFsxXSk6dGhpcy5hZGQodCl9KX1zdGF0aWMgZ2V0RGVmYXVsdHMoKXtyZXR1cm4gT2JqZWN0LmFzc2lnbihjYS5nZXREZWZhdWx0cygpLHtldmVudHM6W119KX1zdGFydCh0LGUpe2NvbnN0IHM9dGhpcy50b1RpY2tzKHQpO2lmKFwic3RhcnRlZFwiIT09dGhpcy5fc3RhdGUuZ2V0VmFsdWVBdFRpbWUocykpe2U9T2koZSx0aGlzLl9sb29wP3RoaXMuX2xvb3BTdGFydDowKSxlPXRoaXMuX2xvb3A/T2koZSx0aGlzLl9sb29wU3RhcnQpOk9pKGUsMCk7Y29uc3QgdD10aGlzLnRvVGlja3MoZSk7dGhpcy5fc3RhdGUuYWRkKHtpZDotMSxvZmZzZXQ6dCxzdGF0ZTpcInN0YXJ0ZWRcIix0aW1lOnN9KSx0aGlzLl9mb3JFYWNoKGU9Pnt0aGlzLl9zdGFydE5vdGUoZSxzLHQpfSl9cmV0dXJuIHRoaXN9X3N0YXJ0Tm90ZSh0LGUscyl7ZS09cyx0aGlzLl9sb29wP3Quc3RhcnRPZmZzZXQ+PXRoaXMuX2xvb3BTdGFydCYmdC5zdGFydE9mZnNldDx0aGlzLl9sb29wRW5kPyh0LnN0YXJ0T2Zmc2V0PHMmJihlKz10aGlzLl9nZXRMb29wRHVyYXRpb24oKSksdC5zdGFydChuZXcgam8odGhpcy5jb250ZXh0LGUpKSk6dC5zdGFydE9mZnNldDx0aGlzLl9sb29wU3RhcnQmJnQuc3RhcnRPZmZzZXQ+PXMmJih0Lmxvb3A9ITEsdC5zdGFydChuZXcgam8odGhpcy5jb250ZXh0LGUpKSk6dC5zdGFydE9mZnNldD49cyYmdC5zdGFydChuZXcgam8odGhpcy5jb250ZXh0LGUpKX1nZXQgc3RhcnRPZmZzZXQoKXtyZXR1cm4gdGhpcy5fc3RhcnRPZmZzZXR9c2V0IHN0YXJ0T2Zmc2V0KHQpe3RoaXMuX3N0YXJ0T2Zmc2V0PXQsdGhpcy5fZm9yRWFjaCh0PT57dC5zdGFydE9mZnNldCs9dGhpcy5fc3RhcnRPZmZzZXR9KX1zdG9wKHQpe2NvbnN0IGU9dGhpcy50b1RpY2tzKHQpO3JldHVybiB0aGlzLl9zdGF0ZS5jYW5jZWwoZSksdGhpcy5fc3RhdGUuc2V0U3RhdGVBdFRpbWUoXCJzdG9wcGVkXCIsZSksdGhpcy5fZm9yRWFjaChlPT57ZS5zdG9wKHQpfSksdGhpc31hdCh0LGUpe2NvbnN0IHM9bmV3IG1vKHRoaXMuY29udGV4dCx0KS50b1RpY2tzKCksbj1uZXcgam8odGhpcy5jb250ZXh0LDEpLnRvU2Vjb25kcygpLGk9dGhpcy5fZXZlbnRzLnZhbHVlcygpO2xldCBvPWkubmV4dCgpO2Zvcig7IW8uZG9uZTspe2NvbnN0IHQ9by52YWx1ZTtpZihNYXRoLmFicyhzLXQuc3RhcnRPZmZzZXQpPG4pcmV0dXJuIGNpKGUpJiYodC52YWx1ZT1lKSx0O289aS5uZXh0KCl9cmV0dXJuIGNpKGUpPyh0aGlzLmFkZCh0LGUpLHRoaXMuYXQodCkpOm51bGx9YWRkKHQsZSl7dCBpbnN0YW5jZW9mIE9iamVjdCYmUmVmbGVjdC5oYXModCxcInRpbWVcIikmJih0PShlPXQpLnRpbWUpO2NvbnN0IHM9dGhpcy50b1RpY2tzKHQpO2xldCBuO3JldHVybiBlIGluc3RhbmNlb2YgY2E/KG49ZSxuLmNhbGxiYWNrPXRoaXMuX3RpY2suYmluZCh0aGlzKSk6bj1uZXcgY2Eoe2NhbGxiYWNrOnRoaXMuX3RpY2suYmluZCh0aGlzKSxjb250ZXh0OnRoaXMuY29udGV4dCx2YWx1ZTplfSksbi5zdGFydE9mZnNldD1zLG4uc2V0KHtodW1hbml6ZTp0aGlzLmh1bWFuaXplLGxvb3A6dGhpcy5sb29wLGxvb3BFbmQ6dGhpcy5sb29wRW5kLGxvb3BTdGFydDp0aGlzLmxvb3BTdGFydCxwbGF5YmFja1JhdGU6dGhpcy5wbGF5YmFja1JhdGUscHJvYmFiaWxpdHk6dGhpcy5wcm9iYWJpbGl0eX0pLHRoaXMuX2V2ZW50cy5hZGQobiksdGhpcy5fcmVzdGFydEV2ZW50KG4pLHRoaXN9X3Jlc3RhcnRFdmVudCh0KXt0aGlzLl9zdGF0ZS5mb3JFYWNoKGU9PntcInN0YXJ0ZWRcIj09PWUuc3RhdGU/dGhpcy5fc3RhcnROb3RlKHQsZS50aW1lLGUub2Zmc2V0KTp0LnN0b3AobmV3IGpvKHRoaXMuY29udGV4dCxlLnRpbWUpKX0pfXJlbW92ZSh0LGUpe3JldHVybiBsaSh0KSYmdC5oYXNPd25Qcm9wZXJ0eShcInRpbWVcIikmJih0PShlPXQpLnRpbWUpLHQ9dGhpcy50b1RpY2tzKHQpLHRoaXMuX2V2ZW50cy5mb3JFYWNoKHM9PntzLnN0YXJ0T2Zmc2V0PT09dCYmKGFpKGUpfHxjaShlKSYmcy52YWx1ZT09PWUpJiYodGhpcy5fZXZlbnRzLmRlbGV0ZShzKSxzLmRpc3Bvc2UoKSl9KSx0aGlzfWNsZWFyKCl7cmV0dXJuIHRoaXMuX2ZvckVhY2godD0+dC5kaXNwb3NlKCkpLHRoaXMuX2V2ZW50cy5jbGVhcigpLHRoaXN9Y2FuY2VsKHQpe3JldHVybiB0aGlzLl9mb3JFYWNoKGU9PmUuY2FuY2VsKHQpKSx0aGlzLl9zdGF0ZS5jYW5jZWwodGhpcy50b1RpY2tzKHQpKSx0aGlzfV9mb3JFYWNoKHQpe3JldHVybiB0aGlzLl9ldmVudHMmJnRoaXMuX2V2ZW50cy5mb3JFYWNoKGU9PntlIGluc3RhbmNlb2YgdWE/ZS5fZm9yRWFjaCh0KTp0KGUpfSksdGhpc31fc2V0QWxsKHQsZSl7dGhpcy5fZm9yRWFjaChzPT57c1t0XT1lfSl9X3RpY2sodCxlKXt0aGlzLm11dGV8fHRoaXMuY2FsbGJhY2sodCxlKX1fdGVzdExvb3BCb3VuZHJpZXModCl7dGhpcy5fbG9vcCYmKHQuc3RhcnRPZmZzZXQ8dGhpcy5fbG9vcFN0YXJ0fHx0LnN0YXJ0T2Zmc2V0Pj10aGlzLl9sb29wRW5kKT90LmNhbmNlbCgwKTpcInN0b3BwZWRcIj09PXQuc3RhdGUmJnRoaXMuX3Jlc3RhcnRFdmVudCh0KX1nZXQgcHJvYmFiaWxpdHkoKXtyZXR1cm4gdGhpcy5fcHJvYmFiaWxpdHl9c2V0IHByb2JhYmlsaXR5KHQpe3RoaXMuX3Byb2JhYmlsaXR5PXQsdGhpcy5fc2V0QWxsKFwicHJvYmFiaWxpdHlcIix0KX1nZXQgaHVtYW5pemUoKXtyZXR1cm4gdGhpcy5faHVtYW5pemV9c2V0IGh1bWFuaXplKHQpe3RoaXMuX2h1bWFuaXplPXQsdGhpcy5fc2V0QWxsKFwiaHVtYW5pemVcIix0KX1nZXQgbG9vcCgpe3JldHVybiB0aGlzLl9sb29wfXNldCBsb29wKHQpe3RoaXMuX2xvb3A9dCx0aGlzLl9mb3JFYWNoKGU9PntlLmxvb3BTdGFydD10aGlzLmxvb3BTdGFydCxlLmxvb3BFbmQ9dGhpcy5sb29wRW5kLGUubG9vcD10LHRoaXMuX3Rlc3RMb29wQm91bmRyaWVzKGUpfSl9Z2V0IGxvb3BFbmQoKXtyZXR1cm4gbmV3IGpvKHRoaXMuY29udGV4dCx0aGlzLl9sb29wRW5kKS50b1NlY29uZHMoKX1zZXQgbG9vcEVuZCh0KXt0aGlzLl9sb29wRW5kPXRoaXMudG9UaWNrcyh0KSx0aGlzLl9sb29wJiZ0aGlzLl9mb3JFYWNoKGU9PntlLmxvb3BFbmQ9dCx0aGlzLl90ZXN0TG9vcEJvdW5kcmllcyhlKX0pfWdldCBsb29wU3RhcnQoKXtyZXR1cm4gbmV3IGpvKHRoaXMuY29udGV4dCx0aGlzLl9sb29wU3RhcnQpLnRvU2Vjb25kcygpfXNldCBsb29wU3RhcnQodCl7dGhpcy5fbG9vcFN0YXJ0PXRoaXMudG9UaWNrcyh0KSx0aGlzLl9sb29wJiZ0aGlzLl9mb3JFYWNoKHQ9Pnt0Lmxvb3BTdGFydD10aGlzLmxvb3BTdGFydCx0aGlzLl90ZXN0TG9vcEJvdW5kcmllcyh0KX0pfWdldCBwbGF5YmFja1JhdGUoKXtyZXR1cm4gdGhpcy5fcGxheWJhY2tSYXRlfXNldCBwbGF5YmFja1JhdGUodCl7dGhpcy5fcGxheWJhY2tSYXRlPXQsdGhpcy5fc2V0QWxsKFwicGxheWJhY2tSYXRlXCIsdCl9Z2V0IGxlbmd0aCgpe3JldHVybiB0aGlzLl9ldmVudHMuc2l6ZX1kaXNwb3NlKCl7cmV0dXJuIHN1cGVyLmRpc3Bvc2UoKSx0aGlzLmNsZWFyKCksdGhpc319ZnVuY3Rpb24qbGEodCl7bGV0IGU9MDtmb3IoO2U8dC5sZW5ndGg7KWU9ZmEoZSx0KSx5aWVsZCB0W2VdLGUrK31mdW5jdGlvbipwYSh0KXtsZXQgZT10Lmxlbmd0aC0xO2Zvcig7ZT49MDspZT1mYShlLHQpLHlpZWxkIHRbZV0sZS0tfWZ1bmN0aW9uKmRhKHQsZSl7Zm9yKDs7KXlpZWxkKmUodCl9ZnVuY3Rpb24gZmEodCxlKXtyZXR1cm4gVmkodCwwLGUubGVuZ3RoLTEpfWZ1bmN0aW9uKl9hKHQsZSl7bGV0IHM9ZT8wOnQubGVuZ3RoLTE7Zm9yKDs7KXM9ZmEocyx0KSx5aWVsZCB0W3NdLGU/KHMrKyxzPj10Lmxlbmd0aC0xJiYoZT0hMSkpOihzLS0sczw9MCYmKGU9ITApKX1mdW5jdGlvbiptYSh0KXtsZXQgZT0wLHM9MDtmb3IoO2U8dC5sZW5ndGg7KWU9ZmEoZSx0KSx5aWVsZCB0W2VdLHMrKyxlKz1zJTI/MjotMX1mdW5jdGlvbipnYSh0KXtsZXQgZT10Lmxlbmd0aC0xLHM9MDtmb3IoO2U+PTA7KWU9ZmEoZSx0KSx5aWVsZCB0W2VdLHMrKyxlKz1zJTI/LTI6MX1mdW5jdGlvbip2YSh0KXtjb25zdCBlPVtdO2ZvcihsZXQgcz0wO3M8dC5sZW5ndGg7cysrKWUucHVzaChzKTtmb3IoO2UubGVuZ3RoPjA7KXtjb25zdCBzPWZhKGUuc3BsaWNlKE1hdGguZmxvb3IoZS5sZW5ndGgqTWF0aC5yYW5kb20oKSksMSlbMF0sdCk7eWllbGQgdFtzXX19ZnVuY3Rpb24qeWEodCxlPVwidXBcIixzPTApe3N3aXRjaCh0aSh0Lmxlbmd0aD4wLFwiVGhlIGFycmF5IG11c3QgaGF2ZSBtb3JlIHRoYW4gb25lIHZhbHVlIGluIGl0XCIpLGUpe2Nhc2VcInVwXCI6eWllbGQqZGEodCxsYSk7Y2FzZVwiZG93blwiOnlpZWxkKmRhKHQscGEpO2Nhc2VcInVwRG93blwiOnlpZWxkKl9hKHQsITApO2Nhc2VcImRvd25VcFwiOnlpZWxkKl9hKHQsITEpO2Nhc2VcImFsdGVybmF0ZVVwXCI6eWllbGQqZGEodCxtYSk7Y2FzZVwiYWx0ZXJuYXRlRG93blwiOnlpZWxkKmRhKHQsZ2EpO2Nhc2VcInJhbmRvbVwiOnlpZWxkKmZ1bmN0aW9uKih0KXtmb3IoOzspe2NvbnN0IGU9TWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpKnQubGVuZ3RoKTt5aWVsZCB0W2VdfX0odCk7Y2FzZVwicmFuZG9tT25jZVwiOnlpZWxkKmRhKHQsdmEpO2Nhc2VcInJhbmRvbVdhbGtcIjp5aWVsZCpmdW5jdGlvbioodCl7bGV0IGU9TWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpKnQubGVuZ3RoKTtmb3IoOzspMD09PWU/ZSsrOmU9PT10Lmxlbmd0aC0xfHxNYXRoLnJhbmRvbSgpPC41P2UtLTplKysseWllbGQgdFtlXX0odCl9fWNsYXNzIHhhIGV4dGVuZHMgaGF7Y29uc3RydWN0b3IoKXtzdXBlcihEaSh4YS5nZXREZWZhdWx0cygpLGFyZ3VtZW50cyxbXCJjYWxsYmFja1wiLFwidmFsdWVzXCIsXCJwYXR0ZXJuXCJdKSksdGhpcy5uYW1lPVwiUGF0dGVyblwiO2NvbnN0IHQ9RGkoeGEuZ2V0RGVmYXVsdHMoKSxhcmd1bWVudHMsW1wiY2FsbGJhY2tcIixcInZhbHVlc1wiLFwicGF0dGVyblwiXSk7dGhpcy5jYWxsYmFjaz10LmNhbGxiYWNrLHRoaXMuX3ZhbHVlcz10LnZhbHVlcyx0aGlzLl9wYXR0ZXJuPXlhKHQudmFsdWVzLHQucGF0dGVybiksdGhpcy5fdHlwZT10LnBhdHRlcm59c3RhdGljIGdldERlZmF1bHRzKCl7cmV0dXJuIE9iamVjdC5hc3NpZ24oaGEuZ2V0RGVmYXVsdHMoKSx7cGF0dGVybjpcInVwXCIsdmFsdWVzOltdLGNhbGxiYWNrOlppfSl9X3RpY2sodCl7Y29uc3QgZT10aGlzLl9wYXR0ZXJuLm5leHQoKTt0aGlzLl92YWx1ZT1lLnZhbHVlLHRoaXMuY2FsbGJhY2sodCx0aGlzLl92YWx1ZSl9Z2V0IHZhbHVlcygpe3JldHVybiB0aGlzLl92YWx1ZXN9c2V0IHZhbHVlcyh0KXt0aGlzLl92YWx1ZXM9dCx0aGlzLnBhdHRlcm49dGhpcy5fdHlwZX1nZXQgdmFsdWUoKXtyZXR1cm4gdGhpcy5fdmFsdWV9Z2V0IHBhdHRlcm4oKXtyZXR1cm4gdGhpcy5fdHlwZX1zZXQgcGF0dGVybih0KXt0aGlzLl90eXBlPXQsdGhpcy5fcGF0dGVybj15YSh0aGlzLl92YWx1ZXMsdGhpcy5fdHlwZSl9fWNsYXNzIHdhIGV4dGVuZHMgY2F7Y29uc3RydWN0b3IoKXtzdXBlcihEaSh3YS5nZXREZWZhdWx0cygpLGFyZ3VtZW50cyxbXCJjYWxsYmFja1wiLFwiZXZlbnRzXCIsXCJzdWJkaXZpc2lvblwiXSkpLHRoaXMubmFtZT1cIlNlcXVlbmNlXCIsdGhpcy5fcGFydD1uZXcgdWEoe2NhbGxiYWNrOnRoaXMuX3NlcUNhbGxiYWNrLmJpbmQodGhpcyksY29udGV4dDp0aGlzLmNvbnRleHR9KSx0aGlzLl9ldmVudHM9W10sdGhpcy5fZXZlbnRzQXJyYXk9W107Y29uc3QgdD1EaSh3YS5nZXREZWZhdWx0cygpLGFyZ3VtZW50cyxbXCJjYWxsYmFja1wiLFwiZXZlbnRzXCIsXCJzdWJkaXZpc2lvblwiXSk7dGhpcy5fc3ViZGl2aXNpb249dGhpcy50b1RpY2tzKHQuc3ViZGl2aXNpb24pLHRoaXMuZXZlbnRzPXQuZXZlbnRzLHRoaXMubG9vcD10Lmxvb3AsdGhpcy5sb29wU3RhcnQ9dC5sb29wU3RhcnQsdGhpcy5sb29wRW5kPXQubG9vcEVuZCx0aGlzLnBsYXliYWNrUmF0ZT10LnBsYXliYWNrUmF0ZSx0aGlzLnByb2JhYmlsaXR5PXQucHJvYmFiaWxpdHksdGhpcy5odW1hbml6ZT10Lmh1bWFuaXplLHRoaXMubXV0ZT10Lm11dGUsdGhpcy5wbGF5YmFja1JhdGU9dC5wbGF5YmFja1JhdGV9c3RhdGljIGdldERlZmF1bHRzKCl7cmV0dXJuIE9iamVjdC5hc3NpZ24oTWkoY2EuZ2V0RGVmYXVsdHMoKSxbXCJ2YWx1ZVwiXSkse2V2ZW50czpbXSxsb29wOiEwLGxvb3BFbmQ6MCxsb29wU3RhcnQ6MCxzdWJkaXZpc2lvbjpcIjhuXCJ9KX1fc2VxQ2FsbGJhY2sodCxlKXtudWxsIT09ZSYmdGhpcy5jYWxsYmFjayh0LGUpfWdldCBldmVudHMoKXtyZXR1cm4gdGhpcy5fZXZlbnRzfXNldCBldmVudHModCl7dGhpcy5jbGVhcigpLHRoaXMuX2V2ZW50c0FycmF5PXQsdGhpcy5fZXZlbnRzPXRoaXMuX2NyZWF0ZVNlcXVlbmNlKHRoaXMuX2V2ZW50c0FycmF5KSx0aGlzLl9ldmVudHNVcGRhdGVkKCl9c3RhcnQodCxlKXtyZXR1cm4gdGhpcy5fcGFydC5zdGFydCh0LGU/dGhpcy5faW5kZXhUaW1lKGUpOmUpLHRoaXN9c3RvcCh0KXtyZXR1cm4gdGhpcy5fcGFydC5zdG9wKHQpLHRoaXN9Z2V0IHN1YmRpdmlzaW9uKCl7cmV0dXJuIG5ldyBqbyh0aGlzLmNvbnRleHQsdGhpcy5fc3ViZGl2aXNpb24pLnRvU2Vjb25kcygpfV9jcmVhdGVTZXF1ZW5jZSh0KXtyZXR1cm4gbmV3IFByb3h5KHQse2dldDoodCxlKT0+dFtlXSxzZXQ6KHQsZSxzKT0+KGZpKGUpJiZpc0Zpbml0ZShwYXJzZUludChlLDEwKSkmJmRpKHMpP3RbZV09dGhpcy5fY3JlYXRlU2VxdWVuY2Uocyk6dFtlXT1zLHRoaXMuX2V2ZW50c1VwZGF0ZWQoKSwhMCl9KX1fZXZlbnRzVXBkYXRlZCgpe3RoaXMuX3BhcnQuY2xlYXIoKSx0aGlzLl9yZXNjaGVkdWxlU2VxdWVuY2UodGhpcy5fZXZlbnRzQXJyYXksdGhpcy5fc3ViZGl2aXNpb24sdGhpcy5zdGFydE9mZnNldCksdGhpcy5sb29wRW5kPXRoaXMubG9vcEVuZH1fcmVzY2hlZHVsZVNlcXVlbmNlKHQsZSxzKXt0LmZvckVhY2goKHQsbik9Pntjb25zdCBpPW4qZStzO2lmKGRpKHQpKXRoaXMuX3Jlc2NoZWR1bGVTZXF1ZW5jZSh0LGUvdC5sZW5ndGgsaSk7ZWxzZXtjb25zdCBlPW5ldyBqbyh0aGlzLmNvbnRleHQsaSxcImlcIikudG9TZWNvbmRzKCk7dGhpcy5fcGFydC5hZGQoZSx0KX19KX1faW5kZXhUaW1lKHQpe3JldHVybiBuZXcgam8odGhpcy5jb250ZXh0LHQqdGhpcy5fc3ViZGl2aXNpb24rdGhpcy5zdGFydE9mZnNldCkudG9TZWNvbmRzKCl9Y2xlYXIoKXtyZXR1cm4gdGhpcy5fcGFydC5jbGVhcigpLHRoaXN9ZGlzcG9zZSgpe3JldHVybiBzdXBlci5kaXNwb3NlKCksdGhpcy5fcGFydC5kaXNwb3NlKCksdGhpc31nZXQgbG9vcCgpe3JldHVybiB0aGlzLl9wYXJ0Lmxvb3B9c2V0IGxvb3AodCl7dGhpcy5fcGFydC5sb29wPXR9Z2V0IGxvb3BTdGFydCgpe3JldHVybiB0aGlzLl9sb29wU3RhcnR9c2V0IGxvb3BTdGFydCh0KXt0aGlzLl9sb29wU3RhcnQ9dCx0aGlzLl9wYXJ0Lmxvb3BTdGFydD10aGlzLl9pbmRleFRpbWUodCl9Z2V0IGxvb3BFbmQoKXtyZXR1cm4gdGhpcy5fbG9vcEVuZH1zZXQgbG9vcEVuZCh0KXt0aGlzLl9sb29wRW5kPXQsdGhpcy5fcGFydC5sb29wRW5kPTA9PT10P3RoaXMuX2luZGV4VGltZSh0aGlzLl9ldmVudHNBcnJheS5sZW5ndGgpOnRoaXMuX2luZGV4VGltZSh0KX1nZXQgc3RhcnRPZmZzZXQoKXtyZXR1cm4gdGhpcy5fcGFydC5zdGFydE9mZnNldH1zZXQgc3RhcnRPZmZzZXQodCl7dGhpcy5fcGFydC5zdGFydE9mZnNldD10fWdldCBwbGF5YmFja1JhdGUoKXtyZXR1cm4gdGhpcy5fcGFydC5wbGF5YmFja1JhdGV9c2V0IHBsYXliYWNrUmF0ZSh0KXt0aGlzLl9wYXJ0LnBsYXliYWNrUmF0ZT10fWdldCBwcm9iYWJpbGl0eSgpe3JldHVybiB0aGlzLl9wYXJ0LnByb2JhYmlsaXR5fXNldCBwcm9iYWJpbGl0eSh0KXt0aGlzLl9wYXJ0LnByb2JhYmlsaXR5PXR9Z2V0IHByb2dyZXNzKCl7cmV0dXJuIHRoaXMuX3BhcnQucHJvZ3Jlc3N9Z2V0IGh1bWFuaXplKCl7cmV0dXJuIHRoaXMuX3BhcnQuaHVtYW5pemV9c2V0IGh1bWFuaXplKHQpe3RoaXMuX3BhcnQuaHVtYW5pemU9dH1nZXQgbGVuZ3RoKCl7cmV0dXJuIHRoaXMuX3BhcnQubGVuZ3RofX1jbGFzcyBiYSBleHRlbmRzIHdve2NvbnN0cnVjdG9yKCl7c3VwZXIoT2JqZWN0LmFzc2lnbihEaShiYS5nZXREZWZhdWx0cygpLGFyZ3VtZW50cyxbXCJmYWRlXCJdKSkpLHRoaXMubmFtZT1cIkNyb3NzRmFkZVwiLHRoaXMuX3Bhbm5lcj10aGlzLmNvbnRleHQuY3JlYXRlU3RlcmVvUGFubmVyKCksdGhpcy5fc3BsaXQ9dGhpcy5jb250ZXh0LmNyZWF0ZUNoYW5uZWxTcGxpdHRlcigyKSx0aGlzLl9nMmE9bmV3IENyKHtjb250ZXh0OnRoaXMuY29udGV4dH0pLHRoaXMuYT1uZXcga28oe2NvbnRleHQ6dGhpcy5jb250ZXh0LGdhaW46MH0pLHRoaXMuYj1uZXcga28oe2NvbnRleHQ6dGhpcy5jb250ZXh0LGdhaW46MH0pLHRoaXMub3V0cHV0PW5ldyBrbyh7Y29udGV4dDp0aGlzLmNvbnRleHR9KSx0aGlzLl9pbnRlcm5hbENoYW5uZWxzPVt0aGlzLmEsdGhpcy5iXTtjb25zdCB0PURpKGJhLmdldERlZmF1bHRzKCksYXJndW1lbnRzLFtcImZhZGVcIl0pO3RoaXMuZmFkZT1uZXcgRG8oe2NvbnRleHQ6dGhpcy5jb250ZXh0LHVuaXRzOlwibm9ybWFsUmFuZ2VcIix2YWx1ZTp0LmZhZGV9KSxVaSh0aGlzLFwiZmFkZVwiKSx0aGlzLmNvbnRleHQuZ2V0Q29uc3RhbnQoMSkuY29ubmVjdCh0aGlzLl9wYW5uZXIpLHRoaXMuX3Bhbm5lci5jb25uZWN0KHRoaXMuX3NwbGl0KSx0aGlzLl9wYW5uZXIuY2hhbm5lbENvdW50PTEsdGhpcy5fcGFubmVyLmNoYW5uZWxDb3VudE1vZGU9XCJleHBsaWNpdFwiLFRvKHRoaXMuX3NwbGl0LHRoaXMuYS5nYWluLDApLFRvKHRoaXMuX3NwbGl0LHRoaXMuYi5nYWluLDEpLHRoaXMuZmFkZS5jaGFpbih0aGlzLl9nMmEsdGhpcy5fcGFubmVyLnBhbiksdGhpcy5hLmNvbm5lY3QodGhpcy5vdXRwdXQpLHRoaXMuYi5jb25uZWN0KHRoaXMub3V0cHV0KX1zdGF0aWMgZ2V0RGVmYXVsdHMoKXtyZXR1cm4gT2JqZWN0LmFzc2lnbih3by5nZXREZWZhdWx0cygpLHtmYWRlOi41fSl9ZGlzcG9zZSgpe3JldHVybiBzdXBlci5kaXNwb3NlKCksdGhpcy5hLmRpc3Bvc2UoKSx0aGlzLmIuZGlzcG9zZSgpLHRoaXMub3V0cHV0LmRpc3Bvc2UoKSx0aGlzLmZhZGUuZGlzcG9zZSgpLHRoaXMuX2cyYS5kaXNwb3NlKCksdGhpcy5fcGFubmVyLmRpc2Nvbm5lY3QoKSx0aGlzLl9zcGxpdC5kaXNjb25uZWN0KCksdGhpc319Y2xhc3MgVGEgZXh0ZW5kcyB3b3tjb25zdHJ1Y3Rvcih0KXtzdXBlcih0KSx0aGlzLm5hbWU9XCJFZmZlY3RcIix0aGlzLl9kcnlXZXQ9bmV3IGJhKHtjb250ZXh0OnRoaXMuY29udGV4dH0pLHRoaXMud2V0PXRoaXMuX2RyeVdldC5mYWRlLHRoaXMuZWZmZWN0U2VuZD1uZXcga28oe2NvbnRleHQ6dGhpcy5jb250ZXh0fSksdGhpcy5lZmZlY3RSZXR1cm49bmV3IGtvKHtjb250ZXh0OnRoaXMuY29udGV4dH0pLHRoaXMuaW5wdXQ9bmV3IGtvKHtjb250ZXh0OnRoaXMuY29udGV4dH0pLHRoaXMub3V0cHV0PXRoaXMuX2RyeVdldCx0aGlzLmlucHV0LmZhbih0aGlzLl9kcnlXZXQuYSx0aGlzLmVmZmVjdFNlbmQpLHRoaXMuZWZmZWN0UmV0dXJuLmNvbm5lY3QodGhpcy5fZHJ5V2V0LmIpLHRoaXMud2V0LnNldFZhbHVlQXRUaW1lKHQud2V0LDApLHRoaXMuX2ludGVybmFsQ2hhbm5lbHM9W3RoaXMuZWZmZWN0UmV0dXJuLHRoaXMuZWZmZWN0U2VuZF0sVWkodGhpcyxcIndldFwiKX1zdGF0aWMgZ2V0RGVmYXVsdHMoKXtyZXR1cm4gT2JqZWN0LmFzc2lnbih3by5nZXREZWZhdWx0cygpLHt3ZXQ6MX0pfWNvbm5lY3RFZmZlY3QodCl7cmV0dXJuIHRoaXMuX2ludGVybmFsQ2hhbm5lbHMucHVzaCh0KSx0aGlzLmVmZmVjdFNlbmQuY2hhaW4odCx0aGlzLmVmZmVjdFJldHVybiksdGhpc31kaXNwb3NlKCl7cmV0dXJuIHN1cGVyLmRpc3Bvc2UoKSx0aGlzLl9kcnlXZXQuZGlzcG9zZSgpLHRoaXMuZWZmZWN0U2VuZC5kaXNwb3NlKCksdGhpcy5lZmZlY3RSZXR1cm4uZGlzcG9zZSgpLHRoaXMud2V0LmRpc3Bvc2UoKSx0aGlzfX1jbGFzcyBTYSBleHRlbmRzIFRhe2NvbnN0cnVjdG9yKHQpe3N1cGVyKHQpLHRoaXMubmFtZT1cIkxGT0VmZmVjdFwiLHRoaXMuX2xmbz1uZXcgeXIoe2NvbnRleHQ6dGhpcy5jb250ZXh0LGZyZXF1ZW5jeTp0LmZyZXF1ZW5jeSxhbXBsaXR1ZGU6dC5kZXB0aH0pLHRoaXMuZGVwdGg9dGhpcy5fbGZvLmFtcGxpdHVkZSx0aGlzLmZyZXF1ZW5jeT10aGlzLl9sZm8uZnJlcXVlbmN5LHRoaXMudHlwZT10LnR5cGUsVWkodGhpcyxbXCJmcmVxdWVuY3lcIixcImRlcHRoXCJdKX1zdGF0aWMgZ2V0RGVmYXVsdHMoKXtyZXR1cm4gT2JqZWN0LmFzc2lnbihUYS5nZXREZWZhdWx0cygpLHtmcmVxdWVuY3k6MSx0eXBlOlwic2luZVwiLGRlcHRoOjF9KX1zdGFydCh0KXtyZXR1cm4gdGhpcy5fbGZvLnN0YXJ0KHQpLHRoaXN9c3RvcCh0KXtyZXR1cm4gdGhpcy5fbGZvLnN0b3AodCksdGhpc31zeW5jKCl7cmV0dXJuIHRoaXMuX2xmby5zeW5jKCksdGhpc311bnN5bmMoKXtyZXR1cm4gdGhpcy5fbGZvLnVuc3luYygpLHRoaXN9Z2V0IHR5cGUoKXtyZXR1cm4gdGhpcy5fbGZvLnR5cGV9c2V0IHR5cGUodCl7dGhpcy5fbGZvLnR5cGU9dH1kaXNwb3NlKCl7cmV0dXJuIHN1cGVyLmRpc3Bvc2UoKSx0aGlzLl9sZm8uZGlzcG9zZSgpLHRoaXMuZnJlcXVlbmN5LmRpc3Bvc2UoKSx0aGlzLmRlcHRoLmRpc3Bvc2UoKSx0aGlzfX1jbGFzcyBrYSBleHRlbmRzIFNhe2NvbnN0cnVjdG9yKCl7c3VwZXIoRGkoa2EuZ2V0RGVmYXVsdHMoKSxhcmd1bWVudHMsW1wiZnJlcXVlbmN5XCIsXCJiYXNlRnJlcXVlbmN5XCIsXCJvY3RhdmVzXCJdKSksdGhpcy5uYW1lPVwiQXV0b0ZpbHRlclwiO2NvbnN0IHQ9RGkoa2EuZ2V0RGVmYXVsdHMoKSxhcmd1bWVudHMsW1wiZnJlcXVlbmN5XCIsXCJiYXNlRnJlcXVlbmN5XCIsXCJvY3RhdmVzXCJdKTt0aGlzLmZpbHRlcj1uZXcgV3IoT2JqZWN0LmFzc2lnbih0LmZpbHRlcix7Y29udGV4dDp0aGlzLmNvbnRleHR9KSksdGhpcy5jb25uZWN0RWZmZWN0KHRoaXMuZmlsdGVyKSx0aGlzLl9sZm8uY29ubmVjdCh0aGlzLmZpbHRlci5mcmVxdWVuY3kpLHRoaXMub2N0YXZlcz10Lm9jdGF2ZXMsdGhpcy5iYXNlRnJlcXVlbmN5PXQuYmFzZUZyZXF1ZW5jeX1zdGF0aWMgZ2V0RGVmYXVsdHMoKXtyZXR1cm4gT2JqZWN0LmFzc2lnbihTYS5nZXREZWZhdWx0cygpLHtiYXNlRnJlcXVlbmN5OjIwMCxvY3RhdmVzOjIuNixmaWx0ZXI6e3R5cGU6XCJsb3dwYXNzXCIscm9sbG9mZjotMTIsUToxfX0pfWdldCBiYXNlRnJlcXVlbmN5KCl7cmV0dXJuIHRoaXMuX2xmby5taW59c2V0IGJhc2VGcmVxdWVuY3kodCl7dGhpcy5fbGZvLm1pbj10aGlzLnRvRnJlcXVlbmN5KHQpLHRoaXMub2N0YXZlcz10aGlzLl9vY3RhdmVzfWdldCBvY3RhdmVzKCl7cmV0dXJuIHRoaXMuX29jdGF2ZXN9c2V0IG9jdGF2ZXModCl7dGhpcy5fb2N0YXZlcz10LHRoaXMuX2xmby5tYXg9dGhpcy5fbGZvLm1pbipNYXRoLnBvdygyLHQpfWRpc3Bvc2UoKXtyZXR1cm4gc3VwZXIuZGlzcG9zZSgpLHRoaXMuZmlsdGVyLmRpc3Bvc2UoKSx0aGlzfX1jbGFzcyBDYSBleHRlbmRzIHdve2NvbnN0cnVjdG9yKCl7c3VwZXIoT2JqZWN0LmFzc2lnbihEaShDYS5nZXREZWZhdWx0cygpLGFyZ3VtZW50cyxbXCJwYW5cIl0pKSksdGhpcy5uYW1lPVwiUGFubmVyXCIsdGhpcy5fcGFubmVyPXRoaXMuY29udGV4dC5jcmVhdGVTdGVyZW9QYW5uZXIoKSx0aGlzLmlucHV0PXRoaXMuX3Bhbm5lcix0aGlzLm91dHB1dD10aGlzLl9wYW5uZXI7Y29uc3QgdD1EaShDYS5nZXREZWZhdWx0cygpLGFyZ3VtZW50cyxbXCJwYW5cIl0pO3RoaXMucGFuPW5ldyB4byh7Y29udGV4dDp0aGlzLmNvbnRleHQscGFyYW06dGhpcy5fcGFubmVyLnBhbix2YWx1ZTp0LnBhbixtaW5WYWx1ZTotMSxtYXhWYWx1ZToxfSksdGhpcy5fcGFubmVyLmNoYW5uZWxDb3VudD10LmNoYW5uZWxDb3VudCx0aGlzLl9wYW5uZXIuY2hhbm5lbENvdW50TW9kZT1cImV4cGxpY2l0XCIsVWkodGhpcyxcInBhblwiKX1zdGF0aWMgZ2V0RGVmYXVsdHMoKXtyZXR1cm4gT2JqZWN0LmFzc2lnbih3by5nZXREZWZhdWx0cygpLHtwYW46MCxjaGFubmVsQ291bnQ6MX0pfWRpc3Bvc2UoKXtyZXR1cm4gc3VwZXIuZGlzcG9zZSgpLHRoaXMuX3Bhbm5lci5kaXNjb25uZWN0KCksdGhpcy5wYW4uZGlzcG9zZSgpLHRoaXN9fWNsYXNzIEFhIGV4dGVuZHMgU2F7Y29uc3RydWN0b3IoKXtzdXBlcihEaShBYS5nZXREZWZhdWx0cygpLGFyZ3VtZW50cyxbXCJmcmVxdWVuY3lcIl0pKSx0aGlzLm5hbWU9XCJBdXRvUGFubmVyXCI7Y29uc3QgdD1EaShBYS5nZXREZWZhdWx0cygpLGFyZ3VtZW50cyxbXCJmcmVxdWVuY3lcIl0pO3RoaXMuX3Bhbm5lcj1uZXcgQ2Eoe2NvbnRleHQ6dGhpcy5jb250ZXh0LGNoYW5uZWxDb3VudDp0LmNoYW5uZWxDb3VudH0pLHRoaXMuY29ubmVjdEVmZmVjdCh0aGlzLl9wYW5uZXIpLHRoaXMuX2xmby5jb25uZWN0KHRoaXMuX3Bhbm5lci5wYW4pLHRoaXMuX2xmby5taW49LTEsdGhpcy5fbGZvLm1heD0xfXN0YXRpYyBnZXREZWZhdWx0cygpe3JldHVybiBPYmplY3QuYXNzaWduKFNhLmdldERlZmF1bHRzKCkse2NoYW5uZWxDb3VudDoxfSl9ZGlzcG9zZSgpe3JldHVybiBzdXBlci5kaXNwb3NlKCksdGhpcy5fcGFubmVyLmRpc3Bvc2UoKSx0aGlzfX1jbGFzcyBEYSBleHRlbmRzIHdve2NvbnN0cnVjdG9yKCl7c3VwZXIoRGkoRGEuZ2V0RGVmYXVsdHMoKSxhcmd1bWVudHMsW1wic21vb3RoaW5nXCJdKSksdGhpcy5uYW1lPVwiRm9sbG93ZXJcIjtjb25zdCB0PURpKERhLmdldERlZmF1bHRzKCksYXJndW1lbnRzLFtcInNtb290aGluZ1wiXSk7dGhpcy5fYWJzPXRoaXMuaW5wdXQ9bmV3IGtyKHtjb250ZXh0OnRoaXMuY29udGV4dH0pLHRoaXMuX2xvd3Bhc3M9dGhpcy5vdXRwdXQ9bmV3IG5hKHtjb250ZXh0OnRoaXMuY29udGV4dCxmcmVxdWVuY3k6MS90aGlzLnRvU2Vjb25kcyh0LnNtb290aGluZyksdHlwZTpcImxvd3Bhc3NcIn0pLHRoaXMuX2Ficy5jb25uZWN0KHRoaXMuX2xvd3Bhc3MpLHRoaXMuX3Ntb290aGluZz10LnNtb290aGluZ31zdGF0aWMgZ2V0RGVmYXVsdHMoKXtyZXR1cm4gT2JqZWN0LmFzc2lnbih3by5nZXREZWZhdWx0cygpLHtzbW9vdGhpbmc6LjA1fSl9Z2V0IHNtb290aGluZygpe3JldHVybiB0aGlzLl9zbW9vdGhpbmd9c2V0IHNtb290aGluZyh0KXt0aGlzLl9zbW9vdGhpbmc9dCx0aGlzLl9sb3dwYXNzLmZyZXF1ZW5jeT0xL3RoaXMudG9TZWNvbmRzKHRoaXMuc21vb3RoaW5nKX1kaXNwb3NlKCl7cmV0dXJuIHN1cGVyLmRpc3Bvc2UoKSx0aGlzLl9hYnMuZGlzcG9zZSgpLHRoaXMuX2xvd3Bhc3MuZGlzcG9zZSgpLHRoaXN9fWNsYXNzIE9hIGV4dGVuZHMgVGF7Y29uc3RydWN0b3IoKXtzdXBlcihEaShPYS5nZXREZWZhdWx0cygpLGFyZ3VtZW50cyxbXCJiYXNlRnJlcXVlbmN5XCIsXCJvY3RhdmVzXCIsXCJzZW5zaXRpdml0eVwiXSkpLHRoaXMubmFtZT1cIkF1dG9XYWhcIjtjb25zdCB0PURpKE9hLmdldERlZmF1bHRzKCksYXJndW1lbnRzLFtcImJhc2VGcmVxdWVuY3lcIixcIm9jdGF2ZXNcIixcInNlbnNpdGl2aXR5XCJdKTt0aGlzLl9mb2xsb3dlcj1uZXcgRGEoe2NvbnRleHQ6dGhpcy5jb250ZXh0LHNtb290aGluZzp0LmZvbGxvd2VyfSksdGhpcy5fc3dlZXBSYW5nZT1uZXcgUnIoe2NvbnRleHQ6dGhpcy5jb250ZXh0LG1pbjowLG1heDoxLGV4cG9uZW50Oi41fSksdGhpcy5fYmFzZUZyZXF1ZW5jeT10aGlzLnRvRnJlcXVlbmN5KHQuYmFzZUZyZXF1ZW5jeSksdGhpcy5fb2N0YXZlcz10Lm9jdGF2ZXMsdGhpcy5faW5wdXRCb29zdD1uZXcga28oe2NvbnRleHQ6dGhpcy5jb250ZXh0fSksdGhpcy5fYmFuZHBhc3M9bmV3IFdyKHtjb250ZXh0OnRoaXMuY29udGV4dCxyb2xsb2ZmOi00OCxmcmVxdWVuY3k6MCxROnQuUX0pLHRoaXMuX3BlYWtpbmc9bmV3IFdyKHtjb250ZXh0OnRoaXMuY29udGV4dCx0eXBlOlwicGVha2luZ1wifSksdGhpcy5fcGVha2luZy5nYWluLnZhbHVlPXQuZ2Fpbix0aGlzLmdhaW49dGhpcy5fcGVha2luZy5nYWluLHRoaXMuUT10aGlzLl9iYW5kcGFzcy5RLHRoaXMuZWZmZWN0U2VuZC5jaGFpbih0aGlzLl9pbnB1dEJvb3N0LHRoaXMuX2ZvbGxvd2VyLHRoaXMuX3N3ZWVwUmFuZ2UpLHRoaXMuX3N3ZWVwUmFuZ2UuY29ubmVjdCh0aGlzLl9iYW5kcGFzcy5mcmVxdWVuY3kpLHRoaXMuX3N3ZWVwUmFuZ2UuY29ubmVjdCh0aGlzLl9wZWFraW5nLmZyZXF1ZW5jeSksdGhpcy5lZmZlY3RTZW5kLmNoYWluKHRoaXMuX2JhbmRwYXNzLHRoaXMuX3BlYWtpbmcsdGhpcy5lZmZlY3RSZXR1cm4pLHRoaXMuX3NldFN3ZWVwUmFuZ2UoKSx0aGlzLnNlbnNpdGl2aXR5PXQuc2Vuc2l0aXZpdHksVWkodGhpcyxbXCJnYWluXCIsXCJRXCJdKX1zdGF0aWMgZ2V0RGVmYXVsdHMoKXtyZXR1cm4gT2JqZWN0LmFzc2lnbihUYS5nZXREZWZhdWx0cygpLHtiYXNlRnJlcXVlbmN5OjEwMCxvY3RhdmVzOjYsc2Vuc2l0aXZpdHk6MCxROjIsZ2FpbjoyLGZvbGxvd2VyOi4yfSl9Z2V0IG9jdGF2ZXMoKXtyZXR1cm4gdGhpcy5fb2N0YXZlc31zZXQgb2N0YXZlcyh0KXt0aGlzLl9vY3RhdmVzPXQsdGhpcy5fc2V0U3dlZXBSYW5nZSgpfWdldCBmb2xsb3dlcigpe3JldHVybiB0aGlzLl9mb2xsb3dlci5zbW9vdGhpbmd9c2V0IGZvbGxvd2VyKHQpe3RoaXMuX2ZvbGxvd2VyLnNtb290aGluZz10fWdldCBiYXNlRnJlcXVlbmN5KCl7cmV0dXJuIHRoaXMuX2Jhc2VGcmVxdWVuY3l9c2V0IGJhc2VGcmVxdWVuY3kodCl7dGhpcy5fYmFzZUZyZXF1ZW5jeT10aGlzLnRvRnJlcXVlbmN5KHQpLHRoaXMuX3NldFN3ZWVwUmFuZ2UoKX1nZXQgc2Vuc2l0aXZpdHkoKXtyZXR1cm4gc28oMS90aGlzLl9pbnB1dEJvb3N0LmdhaW4udmFsdWUpfXNldCBzZW5zaXRpdml0eSh0KXt0aGlzLl9pbnB1dEJvb3N0LmdhaW4udmFsdWU9MS9lbyh0KX1fc2V0U3dlZXBSYW5nZSgpe3RoaXMuX3N3ZWVwUmFuZ2UubWluPXRoaXMuX2Jhc2VGcmVxdWVuY3ksdGhpcy5fc3dlZXBSYW5nZS5tYXg9TWF0aC5taW4odGhpcy5fYmFzZUZyZXF1ZW5jeSpNYXRoLnBvdygyLHRoaXMuX29jdGF2ZXMpLHRoaXMuY29udGV4dC5zYW1wbGVSYXRlLzIpfWRpc3Bvc2UoKXtyZXR1cm4gc3VwZXIuZGlzcG9zZSgpLHRoaXMuX2ZvbGxvd2VyLmRpc3Bvc2UoKSx0aGlzLl9zd2VlcFJhbmdlLmRpc3Bvc2UoKSx0aGlzLl9iYW5kcGFzcy5kaXNwb3NlKCksdGhpcy5fcGVha2luZy5kaXNwb3NlKCksdGhpcy5faW5wdXRCb29zdC5kaXNwb3NlKCksdGhpc319dGEoXCJiaXQtY3J1c2hlclwiLFwiXFxuXFx0Y2xhc3MgQml0Q3J1c2hlcldvcmtsZXQgZXh0ZW5kcyBTaW5nbGVJT1Byb2Nlc3NvciB7XFxuXFxuXFx0XFx0c3RhdGljIGdldCBwYXJhbWV0ZXJEZXNjcmlwdG9ycygpIHtcXG5cXHRcXHRcXHRyZXR1cm4gW3tcXG5cXHRcXHRcXHRcXHRuYW1lOiBcXFwiYml0c1xcXCIsXFxuXFx0XFx0XFx0XFx0ZGVmYXVsdFZhbHVlOiAxMixcXG5cXHRcXHRcXHRcXHRtaW5WYWx1ZTogMSxcXG5cXHRcXHRcXHRcXHRtYXhWYWx1ZTogMTYsXFxuXFx0XFx0XFx0XFx0YXV0b21hdGlvblJhdGU6ICdrLXJhdGUnXFxuXFx0XFx0XFx0fV07XFxuXFx0XFx0fVxcblxcblxcdFxcdGdlbmVyYXRlKGlucHV0LCBfY2hhbm5lbCwgcGFyYW1ldGVycykge1xcblxcdFxcdFxcdGNvbnN0IHN0ZXAgPSBNYXRoLnBvdygwLjUsIHBhcmFtZXRlcnMuYml0cyAtIDEpO1xcblxcdFxcdFxcdGNvbnN0IHZhbCA9IHN0ZXAgKiBNYXRoLmZsb29yKGlucHV0IC8gc3RlcCArIDAuNSk7XFxuXFx0XFx0XFx0cmV0dXJuIHZhbDtcXG5cXHRcXHR9XFxuXFx0fVxcblwiKTtjbGFzcyBNYSBleHRlbmRzIFRhe2NvbnN0cnVjdG9yKCl7c3VwZXIoRGkoTWEuZ2V0RGVmYXVsdHMoKSxhcmd1bWVudHMsW1wiYml0c1wiXSkpLHRoaXMubmFtZT1cIkJpdENydXNoZXJcIjtjb25zdCB0PURpKE1hLmdldERlZmF1bHRzKCksYXJndW1lbnRzLFtcImJpdHNcIl0pO3RoaXMuX2JpdENydXNoZXJXb3JrbGV0PW5ldyBFYSh7Y29udGV4dDp0aGlzLmNvbnRleHQsYml0czp0LmJpdHN9KSx0aGlzLmNvbm5lY3RFZmZlY3QodGhpcy5fYml0Q3J1c2hlcldvcmtsZXQpLHRoaXMuYml0cz10aGlzLl9iaXRDcnVzaGVyV29ya2xldC5iaXRzfXN0YXRpYyBnZXREZWZhdWx0cygpe3JldHVybiBPYmplY3QuYXNzaWduKFRhLmdldERlZmF1bHRzKCkse2JpdHM6NH0pfWRpc3Bvc2UoKXtyZXR1cm4gc3VwZXIuZGlzcG9zZSgpLHRoaXMuX2JpdENydXNoZXJXb3JrbGV0LmRpc3Bvc2UoKSx0aGlzfX1jbGFzcyBFYSBleHRlbmRzIGVhe2NvbnN0cnVjdG9yKCl7c3VwZXIoRGkoRWEuZ2V0RGVmYXVsdHMoKSxhcmd1bWVudHMpKSx0aGlzLm5hbWU9XCJCaXRDcnVzaGVyV29ya2xldFwiO2NvbnN0IHQ9RGkoRWEuZ2V0RGVmYXVsdHMoKSxhcmd1bWVudHMpO3RoaXMuaW5wdXQ9bmV3IGtvKHtjb250ZXh0OnRoaXMuY29udGV4dH0pLHRoaXMub3V0cHV0PW5ldyBrbyh7Y29udGV4dDp0aGlzLmNvbnRleHR9KSx0aGlzLmJpdHM9bmV3IHhvKHtjb250ZXh0OnRoaXMuY29udGV4dCx2YWx1ZTp0LmJpdHMsdW5pdHM6XCJwb3NpdGl2ZVwiLG1pblZhbHVlOjEsbWF4VmFsdWU6MTYscGFyYW06dGhpcy5fZHVtbXlQYXJhbSxzd2FwcGFibGU6ITB9KX1zdGF0aWMgZ2V0RGVmYXVsdHMoKXtyZXR1cm4gT2JqZWN0LmFzc2lnbihlYS5nZXREZWZhdWx0cygpLHtiaXRzOjEyfSl9X2F1ZGlvV29ya2xldE5hbWUoKXtyZXR1cm5cImJpdC1jcnVzaGVyXCJ9b25SZWFkeSh0KXtibyh0aGlzLmlucHV0LHQsdGhpcy5vdXRwdXQpO2NvbnN0IGU9dC5wYXJhbWV0ZXJzLmdldChcImJpdHNcIik7dGhpcy5iaXRzLnNldFBhcmFtKGUpfWRpc3Bvc2UoKXtyZXR1cm4gc3VwZXIuZGlzcG9zZSgpLHRoaXMuaW5wdXQuZGlzcG9zZSgpLHRoaXMub3V0cHV0LmRpc3Bvc2UoKSx0aGlzLmJpdHMuZGlzcG9zZSgpLHRoaXN9fWNsYXNzIFJhIGV4dGVuZHMgVGF7Y29uc3RydWN0b3IoKXtzdXBlcihEaShSYS5nZXREZWZhdWx0cygpLGFyZ3VtZW50cyxbXCJvcmRlclwiXSkpLHRoaXMubmFtZT1cIkNoZWJ5c2hldlwiO2NvbnN0IHQ9RGkoUmEuZ2V0RGVmYXVsdHMoKSxhcmd1bWVudHMsW1wib3JkZXJcIl0pO3RoaXMuX3NoYXBlcj1uZXcgcnIoe2NvbnRleHQ6dGhpcy5jb250ZXh0LGxlbmd0aDo0MDk2fSksdGhpcy5fb3JkZXI9dC5vcmRlcix0aGlzLmNvbm5lY3RFZmZlY3QodGhpcy5fc2hhcGVyKSx0aGlzLm9yZGVyPXQub3JkZXIsdGhpcy5vdmVyc2FtcGxlPXQub3ZlcnNhbXBsZX1zdGF0aWMgZ2V0RGVmYXVsdHMoKXtyZXR1cm4gT2JqZWN0LmFzc2lnbihUYS5nZXREZWZhdWx0cygpLHtvcmRlcjoxLG92ZXJzYW1wbGU6XCJub25lXCJ9KX1fZ2V0Q29lZmZpY2llbnQodCxlLHMpe3JldHVybiBzLmhhcyhlKXx8KDA9PT1lP3Muc2V0KGUsMCk6MT09PWU/cy5zZXQoZSx0KTpzLnNldChlLDIqdCp0aGlzLl9nZXRDb2VmZmljaWVudCh0LGUtMSxzKS10aGlzLl9nZXRDb2VmZmljaWVudCh0LGUtMixzKSkpLHMuZ2V0KGUpfWdldCBvcmRlcigpe3JldHVybiB0aGlzLl9vcmRlcn1zZXQgb3JkZXIodCl7dGhpcy5fb3JkZXI9dCx0aGlzLl9zaGFwZXIuc2V0TWFwKGU9PnRoaXMuX2dldENvZWZmaWNpZW50KGUsdCxuZXcgTWFwKSl9Z2V0IG92ZXJzYW1wbGUoKXtyZXR1cm4gdGhpcy5fc2hhcGVyLm92ZXJzYW1wbGV9c2V0IG92ZXJzYW1wbGUodCl7dGhpcy5fc2hhcGVyLm92ZXJzYW1wbGU9dH1kaXNwb3NlKCl7cmV0dXJuIHN1cGVyLmRpc3Bvc2UoKSx0aGlzLl9zaGFwZXIuZGlzcG9zZSgpLHRoaXN9fWNsYXNzIHFhIGV4dGVuZHMgd297Y29uc3RydWN0b3IoKXtzdXBlcihEaShxYS5nZXREZWZhdWx0cygpLGFyZ3VtZW50cyxbXCJjaGFubmVsc1wiXSkpLHRoaXMubmFtZT1cIlNwbGl0XCI7Y29uc3QgdD1EaShxYS5nZXREZWZhdWx0cygpLGFyZ3VtZW50cyxbXCJjaGFubmVsc1wiXSk7dGhpcy5fc3BsaXR0ZXI9dGhpcy5pbnB1dD10aGlzLm91dHB1dD10aGlzLmNvbnRleHQuY3JlYXRlQ2hhbm5lbFNwbGl0dGVyKHQuY2hhbm5lbHMpLHRoaXMuX2ludGVybmFsQ2hhbm5lbHM9W3RoaXMuX3NwbGl0dGVyXX1zdGF0aWMgZ2V0RGVmYXVsdHMoKXtyZXR1cm4gT2JqZWN0LmFzc2lnbih3by5nZXREZWZhdWx0cygpLHtjaGFubmVsczoyfSl9ZGlzcG9zZSgpe3JldHVybiBzdXBlci5kaXNwb3NlKCksdGhpcy5fc3BsaXR0ZXIuZGlzY29ubmVjdCgpLHRoaXN9fWNsYXNzIEZhIGV4dGVuZHMgd297Y29uc3RydWN0b3IoKXtzdXBlcihEaShGYS5nZXREZWZhdWx0cygpLGFyZ3VtZW50cyxbXCJjaGFubmVsc1wiXSkpLHRoaXMubmFtZT1cIk1lcmdlXCI7Y29uc3QgdD1EaShGYS5nZXREZWZhdWx0cygpLGFyZ3VtZW50cyxbXCJjaGFubmVsc1wiXSk7dGhpcy5fbWVyZ2VyPXRoaXMub3V0cHV0PXRoaXMuaW5wdXQ9dGhpcy5jb250ZXh0LmNyZWF0ZUNoYW5uZWxNZXJnZXIodC5jaGFubmVscyl9c3RhdGljIGdldERlZmF1bHRzKCl7cmV0dXJuIE9iamVjdC5hc3NpZ24od28uZ2V0RGVmYXVsdHMoKSx7Y2hhbm5lbHM6Mn0pfWRpc3Bvc2UoKXtyZXR1cm4gc3VwZXIuZGlzcG9zZSgpLHRoaXMuX21lcmdlci5kaXNjb25uZWN0KCksdGhpc319Y2xhc3MgSWEgZXh0ZW5kcyB3b3tjb25zdHJ1Y3Rvcih0KXtzdXBlcih0KSx0aGlzLm5hbWU9XCJTdGVyZW9FZmZlY3RcIix0aGlzLmlucHV0PW5ldyBrbyh7Y29udGV4dDp0aGlzLmNvbnRleHR9KSx0aGlzLmlucHV0LmNoYW5uZWxDb3VudD0yLHRoaXMuaW5wdXQuY2hhbm5lbENvdW50TW9kZT1cImV4cGxpY2l0XCIsdGhpcy5fZHJ5V2V0PXRoaXMub3V0cHV0PW5ldyBiYSh7Y29udGV4dDp0aGlzLmNvbnRleHQsZmFkZTp0LndldH0pLHRoaXMud2V0PXRoaXMuX2RyeVdldC5mYWRlLHRoaXMuX3NwbGl0PW5ldyBxYSh7Y29udGV4dDp0aGlzLmNvbnRleHQsY2hhbm5lbHM6Mn0pLHRoaXMuX21lcmdlPW5ldyBGYSh7Y29udGV4dDp0aGlzLmNvbnRleHQsY2hhbm5lbHM6Mn0pLHRoaXMuaW5wdXQuY29ubmVjdCh0aGlzLl9zcGxpdCksdGhpcy5pbnB1dC5jb25uZWN0KHRoaXMuX2RyeVdldC5hKSx0aGlzLl9tZXJnZS5jb25uZWN0KHRoaXMuX2RyeVdldC5iKSxVaSh0aGlzLFtcIndldFwiXSl9Y29ubmVjdEVmZmVjdExlZnQoLi4udCl7dGhpcy5fc3BsaXQuY29ubmVjdCh0WzBdLDAsMCksYm8oLi4udCksVG8odFt0Lmxlbmd0aC0xXSx0aGlzLl9tZXJnZSwwLDApfWNvbm5lY3RFZmZlY3RSaWdodCguLi50KXt0aGlzLl9zcGxpdC5jb25uZWN0KHRbMF0sMSwwKSxibyguLi50KSxUbyh0W3QubGVuZ3RoLTFdLHRoaXMuX21lcmdlLDAsMSl9c3RhdGljIGdldERlZmF1bHRzKCl7cmV0dXJuIE9iamVjdC5hc3NpZ24od28uZ2V0RGVmYXVsdHMoKSx7d2V0OjF9KX1kaXNwb3NlKCl7cmV0dXJuIHN1cGVyLmRpc3Bvc2UoKSx0aGlzLl9kcnlXZXQuZGlzcG9zZSgpLHRoaXMuX3NwbGl0LmRpc3Bvc2UoKSx0aGlzLl9tZXJnZS5kaXNwb3NlKCksdGhpc319Y2xhc3MgVmEgZXh0ZW5kcyBJYXtjb25zdHJ1Y3Rvcih0KXtzdXBlcih0KSx0aGlzLmZlZWRiYWNrPW5ldyBEbyh7Y29udGV4dDp0aGlzLmNvbnRleHQsdmFsdWU6dC5mZWVkYmFjayx1bml0czpcIm5vcm1hbFJhbmdlXCJ9KSx0aGlzLl9mZWVkYmFja0w9bmV3IGtvKHtjb250ZXh0OnRoaXMuY29udGV4dH0pLHRoaXMuX2ZlZWRiYWNrUj1uZXcga28oe2NvbnRleHQ6dGhpcy5jb250ZXh0fSksdGhpcy5fZmVlZGJhY2tTcGxpdD1uZXcgcWEoe2NvbnRleHQ6dGhpcy5jb250ZXh0LGNoYW5uZWxzOjJ9KSx0aGlzLl9mZWVkYmFja01lcmdlPW5ldyBGYSh7Y29udGV4dDp0aGlzLmNvbnRleHQsY2hhbm5lbHM6Mn0pLHRoaXMuX21lcmdlLmNvbm5lY3QodGhpcy5fZmVlZGJhY2tTcGxpdCksdGhpcy5fZmVlZGJhY2tNZXJnZS5jb25uZWN0KHRoaXMuX3NwbGl0KSx0aGlzLl9mZWVkYmFja1NwbGl0LmNvbm5lY3QodGhpcy5fZmVlZGJhY2tMLDAsMCksdGhpcy5fZmVlZGJhY2tMLmNvbm5lY3QodGhpcy5fZmVlZGJhY2tNZXJnZSwwLDApLHRoaXMuX2ZlZWRiYWNrU3BsaXQuY29ubmVjdCh0aGlzLl9mZWVkYmFja1IsMSwwKSx0aGlzLl9mZWVkYmFja1IuY29ubmVjdCh0aGlzLl9mZWVkYmFja01lcmdlLDAsMSksdGhpcy5mZWVkYmFjay5mYW4odGhpcy5fZmVlZGJhY2tMLmdhaW4sdGhpcy5fZmVlZGJhY2tSLmdhaW4pLFVpKHRoaXMsW1wiZmVlZGJhY2tcIl0pfXN0YXRpYyBnZXREZWZhdWx0cygpe3JldHVybiBPYmplY3QuYXNzaWduKElhLmdldERlZmF1bHRzKCkse2ZlZWRiYWNrOi41fSl9ZGlzcG9zZSgpe3JldHVybiBzdXBlci5kaXNwb3NlKCksdGhpcy5mZWVkYmFjay5kaXNwb3NlKCksdGhpcy5fZmVlZGJhY2tMLmRpc3Bvc2UoKSx0aGlzLl9mZWVkYmFja1IuZGlzcG9zZSgpLHRoaXMuX2ZlZWRiYWNrU3BsaXQuZGlzcG9zZSgpLHRoaXMuX2ZlZWRiYWNrTWVyZ2UuZGlzcG9zZSgpLHRoaXN9fWNsYXNzIE5hIGV4dGVuZHMgVmF7Y29uc3RydWN0b3IoKXtzdXBlcihEaShOYS5nZXREZWZhdWx0cygpLGFyZ3VtZW50cyxbXCJmcmVxdWVuY3lcIixcImRlbGF5VGltZVwiLFwiZGVwdGhcIl0pKSx0aGlzLm5hbWU9XCJDaG9ydXNcIjtjb25zdCB0PURpKE5hLmdldERlZmF1bHRzKCksYXJndW1lbnRzLFtcImZyZXF1ZW5jeVwiLFwiZGVsYXlUaW1lXCIsXCJkZXB0aFwiXSk7dGhpcy5fZGVwdGg9dC5kZXB0aCx0aGlzLl9kZWxheVRpbWU9dC5kZWxheVRpbWUvMWUzLHRoaXMuX2xmb0w9bmV3IHlyKHtjb250ZXh0OnRoaXMuY29udGV4dCxmcmVxdWVuY3k6dC5mcmVxdWVuY3ksbWluOjAsbWF4OjF9KSx0aGlzLl9sZm9SPW5ldyB5cih7Y29udGV4dDp0aGlzLmNvbnRleHQsZnJlcXVlbmN5OnQuZnJlcXVlbmN5LG1pbjowLG1heDoxLHBoYXNlOjE4MH0pLHRoaXMuX2RlbGF5Tm9kZUw9bmV3IEZvKHtjb250ZXh0OnRoaXMuY29udGV4dH0pLHRoaXMuX2RlbGF5Tm9kZVI9bmV3IEZvKHtjb250ZXh0OnRoaXMuY29udGV4dH0pLHRoaXMuZnJlcXVlbmN5PXRoaXMuX2xmb0wuZnJlcXVlbmN5LFVpKHRoaXMsW1wiZnJlcXVlbmN5XCJdKSx0aGlzLl9sZm9MLmZyZXF1ZW5jeS5jb25uZWN0KHRoaXMuX2xmb1IuZnJlcXVlbmN5KSx0aGlzLmNvbm5lY3RFZmZlY3RMZWZ0KHRoaXMuX2RlbGF5Tm9kZUwpLHRoaXMuY29ubmVjdEVmZmVjdFJpZ2h0KHRoaXMuX2RlbGF5Tm9kZVIpLHRoaXMuX2xmb0wuY29ubmVjdCh0aGlzLl9kZWxheU5vZGVMLmRlbGF5VGltZSksdGhpcy5fbGZvUi5jb25uZWN0KHRoaXMuX2RlbGF5Tm9kZVIuZGVsYXlUaW1lKSx0aGlzLmRlcHRoPXRoaXMuX2RlcHRoLHRoaXMudHlwZT10LnR5cGUsdGhpcy5zcHJlYWQ9dC5zcHJlYWR9c3RhdGljIGdldERlZmF1bHRzKCl7cmV0dXJuIE9iamVjdC5hc3NpZ24oVmEuZ2V0RGVmYXVsdHMoKSx7ZnJlcXVlbmN5OjEuNSxkZWxheVRpbWU6My41LGRlcHRoOi43LHR5cGU6XCJzaW5lXCIsc3ByZWFkOjE4MCxmZWVkYmFjazowLHdldDouNX0pfWdldCBkZXB0aCgpe3JldHVybiB0aGlzLl9kZXB0aH1zZXQgZGVwdGgodCl7dGhpcy5fZGVwdGg9dDtjb25zdCBlPXRoaXMuX2RlbGF5VGltZSp0O3RoaXMuX2xmb0wubWluPU1hdGgubWF4KHRoaXMuX2RlbGF5VGltZS1lLDApLHRoaXMuX2xmb0wubWF4PXRoaXMuX2RlbGF5VGltZStlLHRoaXMuX2xmb1IubWluPU1hdGgubWF4KHRoaXMuX2RlbGF5VGltZS1lLDApLHRoaXMuX2xmb1IubWF4PXRoaXMuX2RlbGF5VGltZStlfWdldCBkZWxheVRpbWUoKXtyZXR1cm4gMWUzKnRoaXMuX2RlbGF5VGltZX1zZXQgZGVsYXlUaW1lKHQpe3RoaXMuX2RlbGF5VGltZT10LzFlMyx0aGlzLmRlcHRoPXRoaXMuX2RlcHRofWdldCB0eXBlKCl7cmV0dXJuIHRoaXMuX2xmb0wudHlwZX1zZXQgdHlwZSh0KXt0aGlzLl9sZm9MLnR5cGU9dCx0aGlzLl9sZm9SLnR5cGU9dH1nZXQgc3ByZWFkKCl7cmV0dXJuIHRoaXMuX2xmb1IucGhhc2UtdGhpcy5fbGZvTC5waGFzZX1zZXQgc3ByZWFkKHQpe3RoaXMuX2xmb0wucGhhc2U9OTAtdC8yLHRoaXMuX2xmb1IucGhhc2U9dC8yKzkwfXN0YXJ0KHQpe3JldHVybiB0aGlzLl9sZm9MLnN0YXJ0KHQpLHRoaXMuX2xmb1Iuc3RhcnQodCksdGhpc31zdG9wKHQpe3JldHVybiB0aGlzLl9sZm9MLnN0b3AodCksdGhpcy5fbGZvUi5zdG9wKHQpLHRoaXN9c3luYygpe3JldHVybiB0aGlzLl9sZm9MLnN5bmMoKSx0aGlzLl9sZm9SLnN5bmMoKSx0aGlzfXVuc3luYygpe3JldHVybiB0aGlzLl9sZm9MLnVuc3luYygpLHRoaXMuX2xmb1IudW5zeW5jKCksdGhpc31kaXNwb3NlKCl7cmV0dXJuIHN1cGVyLmRpc3Bvc2UoKSx0aGlzLl9sZm9MLmRpc3Bvc2UoKSx0aGlzLl9sZm9SLmRpc3Bvc2UoKSx0aGlzLl9kZWxheU5vZGVMLmRpc3Bvc2UoKSx0aGlzLl9kZWxheU5vZGVSLmRpc3Bvc2UoKSx0aGlzLmZyZXF1ZW5jeS5kaXNwb3NlKCksdGhpc319Y2xhc3MgUGEgZXh0ZW5kcyBUYXtjb25zdHJ1Y3Rvcigpe3N1cGVyKERpKFBhLmdldERlZmF1bHRzKCksYXJndW1lbnRzLFtcImRpc3RvcnRpb25cIl0pKSx0aGlzLm5hbWU9XCJEaXN0b3J0aW9uXCI7Y29uc3QgdD1EaShQYS5nZXREZWZhdWx0cygpLGFyZ3VtZW50cyxbXCJkaXN0b3J0aW9uXCJdKTt0aGlzLl9zaGFwZXI9bmV3IHJyKHtjb250ZXh0OnRoaXMuY29udGV4dCxsZW5ndGg6NDA5Nn0pLHRoaXMuX2Rpc3RvcnRpb249dC5kaXN0b3J0aW9uLHRoaXMuY29ubmVjdEVmZmVjdCh0aGlzLl9zaGFwZXIpLHRoaXMuZGlzdG9ydGlvbj10LmRpc3RvcnRpb24sdGhpcy5vdmVyc2FtcGxlPXQub3ZlcnNhbXBsZX1zdGF0aWMgZ2V0RGVmYXVsdHMoKXtyZXR1cm4gT2JqZWN0LmFzc2lnbihUYS5nZXREZWZhdWx0cygpLHtkaXN0b3J0aW9uOi40LG92ZXJzYW1wbGU6XCJub25lXCJ9KX1nZXQgZGlzdG9ydGlvbigpe3JldHVybiB0aGlzLl9kaXN0b3J0aW9ufXNldCBkaXN0b3J0aW9uKHQpe3RoaXMuX2Rpc3RvcnRpb249dDtjb25zdCBlPTEwMCp0LHM9TWF0aC5QSS8xODA7dGhpcy5fc2hhcGVyLnNldE1hcCh0PT5NYXRoLmFicyh0KTwuMDAxPzA6KDMrZSkqdCoyMCpzLyhNYXRoLlBJK2UqTWF0aC5hYnModCkpKX1nZXQgb3ZlcnNhbXBsZSgpe3JldHVybiB0aGlzLl9zaGFwZXIub3ZlcnNhbXBsZX1zZXQgb3ZlcnNhbXBsZSh0KXt0aGlzLl9zaGFwZXIub3ZlcnNhbXBsZT10fWRpc3Bvc2UoKXtyZXR1cm4gc3VwZXIuZGlzcG9zZSgpLHRoaXMuX3NoYXBlci5kaXNwb3NlKCksdGhpc319Y2xhc3MgamEgZXh0ZW5kcyBUYXtjb25zdHJ1Y3Rvcih0KXtzdXBlcih0KSx0aGlzLm5hbWU9XCJGZWVkYmFja0VmZmVjdFwiLHRoaXMuX2ZlZWRiYWNrR2Fpbj1uZXcga28oe2NvbnRleHQ6dGhpcy5jb250ZXh0LGdhaW46dC5mZWVkYmFjayx1bml0czpcIm5vcm1hbFJhbmdlXCJ9KSx0aGlzLmZlZWRiYWNrPXRoaXMuX2ZlZWRiYWNrR2Fpbi5nYWluLFVpKHRoaXMsXCJmZWVkYmFja1wiKSx0aGlzLmVmZmVjdFJldHVybi5jaGFpbih0aGlzLl9mZWVkYmFja0dhaW4sdGhpcy5lZmZlY3RTZW5kKX1zdGF0aWMgZ2V0RGVmYXVsdHMoKXtyZXR1cm4gT2JqZWN0LmFzc2lnbihUYS5nZXREZWZhdWx0cygpLHtmZWVkYmFjazouMTI1fSl9ZGlzcG9zZSgpe3JldHVybiBzdXBlci5kaXNwb3NlKCksdGhpcy5fZmVlZGJhY2tHYWluLmRpc3Bvc2UoKSx0aGlzLmZlZWRiYWNrLmRpc3Bvc2UoKSx0aGlzfX1jbGFzcyBMYSBleHRlbmRzIGphe2NvbnN0cnVjdG9yKCl7c3VwZXIoRGkoTGEuZ2V0RGVmYXVsdHMoKSxhcmd1bWVudHMsW1wiZGVsYXlUaW1lXCIsXCJmZWVkYmFja1wiXSkpLHRoaXMubmFtZT1cIkZlZWRiYWNrRGVsYXlcIjtjb25zdCB0PURpKExhLmdldERlZmF1bHRzKCksYXJndW1lbnRzLFtcImRlbGF5VGltZVwiLFwiZmVlZGJhY2tcIl0pO3RoaXMuX2RlbGF5Tm9kZT1uZXcgRm8oe2NvbnRleHQ6dGhpcy5jb250ZXh0LGRlbGF5VGltZTp0LmRlbGF5VGltZSxtYXhEZWxheTp0Lm1heERlbGF5fSksdGhpcy5kZWxheVRpbWU9dGhpcy5fZGVsYXlOb2RlLmRlbGF5VGltZSx0aGlzLmNvbm5lY3RFZmZlY3QodGhpcy5fZGVsYXlOb2RlKSxVaSh0aGlzLFwiZGVsYXlUaW1lXCIpfXN0YXRpYyBnZXREZWZhdWx0cygpe3JldHVybiBPYmplY3QuYXNzaWduKGphLmdldERlZmF1bHRzKCkse2RlbGF5VGltZTouMjUsbWF4RGVsYXk6MX0pfWRpc3Bvc2UoKXtyZXR1cm4gc3VwZXIuZGlzcG9zZSgpLHRoaXMuX2RlbGF5Tm9kZS5kaXNwb3NlKCksdGhpcy5kZWxheVRpbWUuZGlzcG9zZSgpLHRoaXN9fWNsYXNzIHphIGV4dGVuZHMgd297Y29uc3RydWN0b3IodCl7c3VwZXIodCksdGhpcy5uYW1lPVwiUGhhc2VTaGlmdEFsbHBhc3NcIix0aGlzLmlucHV0PW5ldyBrbyh7Y29udGV4dDp0aGlzLmNvbnRleHR9KSx0aGlzLm91dHB1dD1uZXcga28oe2NvbnRleHQ6dGhpcy5jb250ZXh0fSksdGhpcy5vZmZzZXQ5MD1uZXcga28oe2NvbnRleHQ6dGhpcy5jb250ZXh0fSk7dGhpcy5fYmFuazA9dGhpcy5fY3JlYXRlQWxsUGFzc0ZpbHRlckJhbmsoWy42OTIzODc4LC45MzYwNjU0MzIyOTU5LC45ODgyMjk1MjI2ODYsLjk5ODc0ODg0NTI3MzddKSx0aGlzLl9iYW5rMT10aGlzLl9jcmVhdGVBbGxQYXNzRmlsdGVyQmFuayhbLjQwMjE5MjExNjI0MjYsLjg1NjE3MTA4ODI0MiwuOTcyMjkwOTU0NTY1MSwuOTk1Mjg4NDc5MTI3OF0pLHRoaXMuX29uZVNhbXBsZURlbGF5PXRoaXMuY29udGV4dC5jcmVhdGVJSVJGaWx0ZXIoWzAsMV0sWzEsMF0pLGJvKHRoaXMuaW5wdXQsLi4udGhpcy5fYmFuazAsdGhpcy5fb25lU2FtcGxlRGVsYXksdGhpcy5vdXRwdXQpLGJvKHRoaXMuaW5wdXQsLi4udGhpcy5fYmFuazEsdGhpcy5vZmZzZXQ5MCl9X2NyZWF0ZUFsbFBhc3NGaWx0ZXJCYW5rKHQpe3JldHVybiB0Lm1hcCh0PT57Y29uc3QgZT1bW3QqdCwwLC0xXSxbMSwwLC10KnRdXTtyZXR1cm4gdGhpcy5jb250ZXh0LmNyZWF0ZUlJUkZpbHRlcihlWzBdLGVbMV0pfSl9ZGlzcG9zZSgpe3JldHVybiBzdXBlci5kaXNwb3NlKCksdGhpcy5pbnB1dC5kaXNwb3NlKCksdGhpcy5vdXRwdXQuZGlzcG9zZSgpLHRoaXMub2Zmc2V0OTAuZGlzcG9zZSgpLHRoaXMuX2JhbmswLmZvckVhY2godD0+dC5kaXNjb25uZWN0KCkpLHRoaXMuX2JhbmsxLmZvckVhY2godD0+dC5kaXNjb25uZWN0KCkpLHRoaXMuX29uZVNhbXBsZURlbGF5LmRpc2Nvbm5lY3QoKSx0aGlzfX1jbGFzcyBCYSBleHRlbmRzIFRhe2NvbnN0cnVjdG9yKCl7c3VwZXIoRGkoQmEuZ2V0RGVmYXVsdHMoKSxhcmd1bWVudHMsW1wiZnJlcXVlbmN5XCJdKSksdGhpcy5uYW1lPVwiRnJlcXVlbmN5U2hpZnRlclwiO2NvbnN0IHQ9RGkoQmEuZ2V0RGVmYXVsdHMoKSxhcmd1bWVudHMsW1wiZnJlcXVlbmN5XCJdKTt0aGlzLmZyZXF1ZW5jeT1uZXcgRG8oe2NvbnRleHQ6dGhpcy5jb250ZXh0LHVuaXRzOlwiZnJlcXVlbmN5XCIsdmFsdWU6dC5mcmVxdWVuY3ksbWluVmFsdWU6LXRoaXMuY29udGV4dC5zYW1wbGVSYXRlLzIsbWF4VmFsdWU6dGhpcy5jb250ZXh0LnNhbXBsZVJhdGUvMn0pLHRoaXMuX3NpbmU9bmV3IG5yKHtjb250ZXh0OnRoaXMuY29udGV4dCx0eXBlOlwic2luZVwifSksdGhpcy5fY29zaW5lPW5ldyBpcih7Y29udGV4dDp0aGlzLmNvbnRleHQscGhhc2U6LTkwLHR5cGU6XCJzaW5lXCJ9KSx0aGlzLl9zaW5lTXVsdGlwbHk9bmV3IGNyKHtjb250ZXh0OnRoaXMuY29udGV4dH0pLHRoaXMuX2Nvc2luZU11bHRpcGx5PW5ldyBjcih7Y29udGV4dDp0aGlzLmNvbnRleHR9KSx0aGlzLl9uZWdhdGU9bmV3IEFyKHtjb250ZXh0OnRoaXMuY29udGV4dH0pLHRoaXMuX2FkZD1uZXcgbXIoe2NvbnRleHQ6dGhpcy5jb250ZXh0fSksdGhpcy5fcGhhc2VTaGlmdGVyPW5ldyB6YSh7Y29udGV4dDp0aGlzLmNvbnRleHR9KSx0aGlzLmVmZmVjdFNlbmQuY29ubmVjdCh0aGlzLl9waGFzZVNoaWZ0ZXIpLHRoaXMuZnJlcXVlbmN5LmZhbih0aGlzLl9zaW5lLmZyZXF1ZW5jeSx0aGlzLl9jb3NpbmUuZnJlcXVlbmN5KSx0aGlzLl9waGFzZVNoaWZ0ZXIub2Zmc2V0OTAuY29ubmVjdCh0aGlzLl9jb3NpbmVNdWx0aXBseSksdGhpcy5fY29zaW5lLmNvbm5lY3QodGhpcy5fY29zaW5lTXVsdGlwbHkuZmFjdG9yKSx0aGlzLl9waGFzZVNoaWZ0ZXIuY29ubmVjdCh0aGlzLl9zaW5lTXVsdGlwbHkpLHRoaXMuX3NpbmUuY29ubmVjdCh0aGlzLl9zaW5lTXVsdGlwbHkuZmFjdG9yKSx0aGlzLl9zaW5lTXVsdGlwbHkuY29ubmVjdCh0aGlzLl9uZWdhdGUpLHRoaXMuX2Nvc2luZU11bHRpcGx5LmNvbm5lY3QodGhpcy5fYWRkKSx0aGlzLl9uZWdhdGUuY29ubmVjdCh0aGlzLl9hZGQuYWRkZW5kKSx0aGlzLl9hZGQuY29ubmVjdCh0aGlzLmVmZmVjdFJldHVybik7Y29uc3QgZT10aGlzLmltbWVkaWF0ZSgpO3RoaXMuX3NpbmUuc3RhcnQoZSksdGhpcy5fY29zaW5lLnN0YXJ0KGUpfXN0YXRpYyBnZXREZWZhdWx0cygpe3JldHVybiBPYmplY3QuYXNzaWduKFRhLmdldERlZmF1bHRzKCkse2ZyZXF1ZW5jeTowfSl9ZGlzcG9zZSgpe3JldHVybiBzdXBlci5kaXNwb3NlKCksdGhpcy5mcmVxdWVuY3kuZGlzcG9zZSgpLHRoaXMuX2FkZC5kaXNwb3NlKCksdGhpcy5fY29zaW5lLmRpc3Bvc2UoKSx0aGlzLl9jb3NpbmVNdWx0aXBseS5kaXNwb3NlKCksdGhpcy5fbmVnYXRlLmRpc3Bvc2UoKSx0aGlzLl9waGFzZVNoaWZ0ZXIuZGlzcG9zZSgpLHRoaXMuX3NpbmUuZGlzcG9zZSgpLHRoaXMuX3NpbmVNdWx0aXBseS5kaXNwb3NlKCksdGhpc319Y29uc3QgV2E9WzE1NTcvNDQxMDAsMTYxNy80NDEwMCwxNDkxLzQ0MTAwLDE0MjIvNDQxMDAsMTI3Ny80NDEwMCwxMzU2LzQ0MTAwLDExODgvNDQxMDAsMTExNi80NDEwMF0sR2E9WzIyNSw1NTYsNDQxLDM0MV07Y2xhc3MgVWEgZXh0ZW5kcyBJYXtjb25zdHJ1Y3Rvcigpe3N1cGVyKERpKFVhLmdldERlZmF1bHRzKCksYXJndW1lbnRzLFtcInJvb21TaXplXCIsXCJkYW1wZW5pbmdcIl0pKSx0aGlzLm5hbWU9XCJGcmVldmVyYlwiLHRoaXMuX2NvbWJGaWx0ZXJzPVtdLHRoaXMuX2FsbHBhc3NGaWx0ZXJzTD1bXSx0aGlzLl9hbGxwYXNzRmlsdGVyc1I9W107Y29uc3QgdD1EaShVYS5nZXREZWZhdWx0cygpLGFyZ3VtZW50cyxbXCJyb29tU2l6ZVwiLFwiZGFtcGVuaW5nXCJdKTt0aGlzLnJvb21TaXplPW5ldyBEbyh7Y29udGV4dDp0aGlzLmNvbnRleHQsdmFsdWU6dC5yb29tU2l6ZSx1bml0czpcIm5vcm1hbFJhbmdlXCJ9KSx0aGlzLl9hbGxwYXNzRmlsdGVyc0w9R2EubWFwKHQ9Pntjb25zdCBlPXRoaXMuY29udGV4dC5jcmVhdGVCaXF1YWRGaWx0ZXIoKTtyZXR1cm4gZS50eXBlPVwiYWxscGFzc1wiLGUuZnJlcXVlbmN5LnZhbHVlPXQsZX0pLHRoaXMuX2FsbHBhc3NGaWx0ZXJzUj1HYS5tYXAodD0+e2NvbnN0IGU9dGhpcy5jb250ZXh0LmNyZWF0ZUJpcXVhZEZpbHRlcigpO3JldHVybiBlLnR5cGU9XCJhbGxwYXNzXCIsZS5mcmVxdWVuY3kudmFsdWU9dCxlfSksdGhpcy5fY29tYkZpbHRlcnM9V2EubWFwKChlLHMpPT57Y29uc3Qgbj1uZXcgaWEoe2NvbnRleHQ6dGhpcy5jb250ZXh0LGRhbXBlbmluZzp0LmRhbXBlbmluZyxkZWxheVRpbWU6ZX0pO3JldHVybiBzPFdhLmxlbmd0aC8yP3RoaXMuY29ubmVjdEVmZmVjdExlZnQobiwuLi50aGlzLl9hbGxwYXNzRmlsdGVyc0wpOnRoaXMuY29ubmVjdEVmZmVjdFJpZ2h0KG4sLi4udGhpcy5fYWxscGFzc0ZpbHRlcnNSKSx0aGlzLnJvb21TaXplLmNvbm5lY3Qobi5yZXNvbmFuY2UpLG59KSxVaSh0aGlzLFtcInJvb21TaXplXCJdKX1zdGF0aWMgZ2V0RGVmYXVsdHMoKXtyZXR1cm4gT2JqZWN0LmFzc2lnbihJYS5nZXREZWZhdWx0cygpLHtyb29tU2l6ZTouNyxkYW1wZW5pbmc6M2UzfSl9Z2V0IGRhbXBlbmluZygpe3JldHVybiB0aGlzLl9jb21iRmlsdGVyc1swXS5kYW1wZW5pbmd9c2V0IGRhbXBlbmluZyh0KXt0aGlzLl9jb21iRmlsdGVycy5mb3JFYWNoKGU9PmUuZGFtcGVuaW5nPXQpfWRpc3Bvc2UoKXtyZXR1cm4gc3VwZXIuZGlzcG9zZSgpLHRoaXMuX2FsbHBhc3NGaWx0ZXJzTC5mb3JFYWNoKHQ9PnQuZGlzY29ubmVjdCgpKSx0aGlzLl9hbGxwYXNzRmlsdGVyc1IuZm9yRWFjaCh0PT50LmRpc2Nvbm5lY3QoKSksdGhpcy5fY29tYkZpbHRlcnMuZm9yRWFjaCh0PT50LmRpc3Bvc2UoKSksdGhpcy5yb29tU2l6ZS5kaXNwb3NlKCksdGhpc319Y29uc3QgUWE9Wy4wNjc0OCwuMDY0MDQsLjA4MjEyLC4wOTAwNF0sWmE9Wy43NzMsLjgwMiwuNzUzLC43MzNdLFhhPVszNDcsMTEzLDM3XTtjbGFzcyBZYSBleHRlbmRzIElhe2NvbnN0cnVjdG9yKCl7c3VwZXIoRGkoWWEuZ2V0RGVmYXVsdHMoKSxhcmd1bWVudHMsW1wicm9vbVNpemVcIl0pKSx0aGlzLm5hbWU9XCJKQ1JldmVyYlwiLHRoaXMuX2FsbHBhc3NGaWx0ZXJzPVtdLHRoaXMuX2ZlZWRiYWNrQ29tYkZpbHRlcnM9W107Y29uc3QgdD1EaShZYS5nZXREZWZhdWx0cygpLGFyZ3VtZW50cyxbXCJyb29tU2l6ZVwiXSk7dGhpcy5yb29tU2l6ZT1uZXcgRG8oe2NvbnRleHQ6dGhpcy5jb250ZXh0LHZhbHVlOnQucm9vbVNpemUsdW5pdHM6XCJub3JtYWxSYW5nZVwifSksdGhpcy5fc2NhbGVSb29tU2l6ZT1uZXcgZ3Ioe2NvbnRleHQ6dGhpcy5jb250ZXh0LG1pbjotLjczMyxtYXg6LjE5N30pLHRoaXMuX2FsbHBhc3NGaWx0ZXJzPVhhLm1hcCh0PT57Y29uc3QgZT10aGlzLmNvbnRleHQuY3JlYXRlQmlxdWFkRmlsdGVyKCk7cmV0dXJuIGUudHlwZT1cImFsbHBhc3NcIixlLmZyZXF1ZW5jeS52YWx1ZT10LGV9KSx0aGlzLl9mZWVkYmFja0NvbWJGaWx0ZXJzPVFhLm1hcCgodCxlKT0+e2NvbnN0IHM9bmV3IHNhKHtjb250ZXh0OnRoaXMuY29udGV4dCxkZWxheVRpbWU6dH0pO3JldHVybiB0aGlzLl9zY2FsZVJvb21TaXplLmNvbm5lY3Qocy5yZXNvbmFuY2UpLHMucmVzb25hbmNlLnZhbHVlPVphW2VdLGU8UWEubGVuZ3RoLzI/dGhpcy5jb25uZWN0RWZmZWN0TGVmdCguLi50aGlzLl9hbGxwYXNzRmlsdGVycyxzKTp0aGlzLmNvbm5lY3RFZmZlY3RSaWdodCguLi50aGlzLl9hbGxwYXNzRmlsdGVycyxzKSxzfSksdGhpcy5yb29tU2l6ZS5jb25uZWN0KHRoaXMuX3NjYWxlUm9vbVNpemUpLFVpKHRoaXMsW1wicm9vbVNpemVcIl0pfXN0YXRpYyBnZXREZWZhdWx0cygpe3JldHVybiBPYmplY3QuYXNzaWduKElhLmdldERlZmF1bHRzKCkse3Jvb21TaXplOi41fSl9ZGlzcG9zZSgpe3JldHVybiBzdXBlci5kaXNwb3NlKCksdGhpcy5fYWxscGFzc0ZpbHRlcnMuZm9yRWFjaCh0PT50LmRpc2Nvbm5lY3QoKSksdGhpcy5fZmVlZGJhY2tDb21iRmlsdGVycy5mb3JFYWNoKHQ9PnQuZGlzcG9zZSgpKSx0aGlzLnJvb21TaXplLmRpc3Bvc2UoKSx0aGlzLl9zY2FsZVJvb21TaXplLmRpc3Bvc2UoKSx0aGlzfX1jbGFzcyBIYSBleHRlbmRzIFZhe2NvbnN0cnVjdG9yKHQpe3N1cGVyKHQpLHRoaXMuX2ZlZWRiYWNrTC5kaXNjb25uZWN0KCksdGhpcy5fZmVlZGJhY2tMLmNvbm5lY3QodGhpcy5fZmVlZGJhY2tNZXJnZSwwLDEpLHRoaXMuX2ZlZWRiYWNrUi5kaXNjb25uZWN0KCksdGhpcy5fZmVlZGJhY2tSLmNvbm5lY3QodGhpcy5fZmVlZGJhY2tNZXJnZSwwLDApLFVpKHRoaXMsW1wiZmVlZGJhY2tcIl0pfX1jbGFzcyAkYSBleHRlbmRzIEhhe2NvbnN0cnVjdG9yKCl7c3VwZXIoRGkoJGEuZ2V0RGVmYXVsdHMoKSxhcmd1bWVudHMsW1wiZGVsYXlUaW1lXCIsXCJmZWVkYmFja1wiXSkpLHRoaXMubmFtZT1cIlBpbmdQb25nRGVsYXlcIjtjb25zdCB0PURpKCRhLmdldERlZmF1bHRzKCksYXJndW1lbnRzLFtcImRlbGF5VGltZVwiLFwiZmVlZGJhY2tcIl0pO3RoaXMuX2xlZnREZWxheT1uZXcgRm8oe2NvbnRleHQ6dGhpcy5jb250ZXh0LG1heERlbGF5OnQubWF4RGVsYXl9KSx0aGlzLl9yaWdodERlbGF5PW5ldyBGbyh7Y29udGV4dDp0aGlzLmNvbnRleHQsbWF4RGVsYXk6dC5tYXhEZWxheX0pLHRoaXMuX3JpZ2h0UHJlRGVsYXk9bmV3IEZvKHtjb250ZXh0OnRoaXMuY29udGV4dCxtYXhEZWxheTp0Lm1heERlbGF5fSksdGhpcy5kZWxheVRpbWU9bmV3IERvKHtjb250ZXh0OnRoaXMuY29udGV4dCx1bml0czpcInRpbWVcIix2YWx1ZTp0LmRlbGF5VGltZX0pLHRoaXMuY29ubmVjdEVmZmVjdExlZnQodGhpcy5fbGVmdERlbGF5KSx0aGlzLmNvbm5lY3RFZmZlY3RSaWdodCh0aGlzLl9yaWdodFByZURlbGF5LHRoaXMuX3JpZ2h0RGVsYXkpLHRoaXMuZGVsYXlUaW1lLmZhbih0aGlzLl9sZWZ0RGVsYXkuZGVsYXlUaW1lLHRoaXMuX3JpZ2h0RGVsYXkuZGVsYXlUaW1lLHRoaXMuX3JpZ2h0UHJlRGVsYXkuZGVsYXlUaW1lKSx0aGlzLl9mZWVkYmFja0wuZGlzY29ubmVjdCgpLHRoaXMuX2ZlZWRiYWNrTC5jb25uZWN0KHRoaXMuX3JpZ2h0RGVsYXkpLFVpKHRoaXMsW1wiZGVsYXlUaW1lXCJdKX1zdGF0aWMgZ2V0RGVmYXVsdHMoKXtyZXR1cm4gT2JqZWN0LmFzc2lnbihIYS5nZXREZWZhdWx0cygpLHtkZWxheVRpbWU6LjI1LG1heERlbGF5OjF9KX1kaXNwb3NlKCl7cmV0dXJuIHN1cGVyLmRpc3Bvc2UoKSx0aGlzLl9sZWZ0RGVsYXkuZGlzcG9zZSgpLHRoaXMuX3JpZ2h0RGVsYXkuZGlzcG9zZSgpLHRoaXMuX3JpZ2h0UHJlRGVsYXkuZGlzcG9zZSgpLHRoaXMuZGVsYXlUaW1lLmRpc3Bvc2UoKSx0aGlzfX1jbGFzcyBKYSBleHRlbmRzIGphe2NvbnN0cnVjdG9yKCl7c3VwZXIoRGkoSmEuZ2V0RGVmYXVsdHMoKSxhcmd1bWVudHMsW1wicGl0Y2hcIl0pKSx0aGlzLm5hbWU9XCJQaXRjaFNoaWZ0XCI7Y29uc3QgdD1EaShKYS5nZXREZWZhdWx0cygpLGFyZ3VtZW50cyxbXCJwaXRjaFwiXSk7dGhpcy5fZnJlcXVlbmN5PW5ldyBEbyh7Y29udGV4dDp0aGlzLmNvbnRleHR9KSx0aGlzLl9kZWxheUE9bmV3IEZvKHttYXhEZWxheToxLGNvbnRleHQ6dGhpcy5jb250ZXh0fSksdGhpcy5fbGZvQT1uZXcgeXIoe2NvbnRleHQ6dGhpcy5jb250ZXh0LG1pbjowLG1heDouMSx0eXBlOlwic2F3dG9vdGhcIn0pLmNvbm5lY3QodGhpcy5fZGVsYXlBLmRlbGF5VGltZSksdGhpcy5fZGVsYXlCPW5ldyBGbyh7bWF4RGVsYXk6MSxjb250ZXh0OnRoaXMuY29udGV4dH0pLHRoaXMuX2xmb0I9bmV3IHlyKHtjb250ZXh0OnRoaXMuY29udGV4dCxtaW46MCxtYXg6LjEsdHlwZTpcInNhd3Rvb3RoXCIscGhhc2U6MTgwfSkuY29ubmVjdCh0aGlzLl9kZWxheUIuZGVsYXlUaW1lKSx0aGlzLl9jcm9zc0ZhZGU9bmV3IGJhKHtjb250ZXh0OnRoaXMuY29udGV4dH0pLHRoaXMuX2Nyb3NzRmFkZUxGTz1uZXcgeXIoe2NvbnRleHQ6dGhpcy5jb250ZXh0LG1pbjowLG1heDoxLHR5cGU6XCJ0cmlhbmdsZVwiLHBoYXNlOjkwfSkuY29ubmVjdCh0aGlzLl9jcm9zc0ZhZGUuZmFkZSksdGhpcy5fZmVlZGJhY2tEZWxheT1uZXcgRm8oe2RlbGF5VGltZTp0LmRlbGF5VGltZSxjb250ZXh0OnRoaXMuY29udGV4dH0pLHRoaXMuZGVsYXlUaW1lPXRoaXMuX2ZlZWRiYWNrRGVsYXkuZGVsYXlUaW1lLFVpKHRoaXMsXCJkZWxheVRpbWVcIiksdGhpcy5fcGl0Y2g9dC5waXRjaCx0aGlzLl93aW5kb3dTaXplPXQud2luZG93U2l6ZSx0aGlzLl9kZWxheUEuY29ubmVjdCh0aGlzLl9jcm9zc0ZhZGUuYSksdGhpcy5fZGVsYXlCLmNvbm5lY3QodGhpcy5fY3Jvc3NGYWRlLmIpLHRoaXMuX2ZyZXF1ZW5jeS5mYW4odGhpcy5fbGZvQS5mcmVxdWVuY3ksdGhpcy5fbGZvQi5mcmVxdWVuY3ksdGhpcy5fY3Jvc3NGYWRlTEZPLmZyZXF1ZW5jeSksdGhpcy5lZmZlY3RTZW5kLmZhbih0aGlzLl9kZWxheUEsdGhpcy5fZGVsYXlCKSx0aGlzLl9jcm9zc0ZhZGUuY2hhaW4odGhpcy5fZmVlZGJhY2tEZWxheSx0aGlzLmVmZmVjdFJldHVybik7Y29uc3QgZT10aGlzLm5vdygpO3RoaXMuX2xmb0Euc3RhcnQoZSksdGhpcy5fbGZvQi5zdGFydChlKSx0aGlzLl9jcm9zc0ZhZGVMRk8uc3RhcnQoZSksdGhpcy53aW5kb3dTaXplPXRoaXMuX3dpbmRvd1NpemV9c3RhdGljIGdldERlZmF1bHRzKCl7cmV0dXJuIE9iamVjdC5hc3NpZ24oamEuZ2V0RGVmYXVsdHMoKSx7cGl0Y2g6MCx3aW5kb3dTaXplOi4xLGRlbGF5VGltZTowLGZlZWRiYWNrOjB9KX1nZXQgcGl0Y2goKXtyZXR1cm4gdGhpcy5fcGl0Y2h9c2V0IHBpdGNoKHQpe3RoaXMuX3BpdGNoPXQ7bGV0IGU9MDt0PDA/KHRoaXMuX2xmb0EubWluPTAsdGhpcy5fbGZvQS5tYXg9dGhpcy5fd2luZG93U2l6ZSx0aGlzLl9sZm9CLm1pbj0wLHRoaXMuX2xmb0IubWF4PXRoaXMuX3dpbmRvd1NpemUsZT1ubyh0LTEpKzEpOih0aGlzLl9sZm9BLm1pbj10aGlzLl93aW5kb3dTaXplLHRoaXMuX2xmb0EubWF4PTAsdGhpcy5fbGZvQi5taW49dGhpcy5fd2luZG93U2l6ZSx0aGlzLl9sZm9CLm1heD0wLGU9bm8odCktMSksdGhpcy5fZnJlcXVlbmN5LnZhbHVlPWUqKDEuMi90aGlzLl93aW5kb3dTaXplKX1nZXQgd2luZG93U2l6ZSgpe3JldHVybiB0aGlzLl93aW5kb3dTaXplfXNldCB3aW5kb3dTaXplKHQpe3RoaXMuX3dpbmRvd1NpemU9dGhpcy50b1NlY29uZHModCksdGhpcy5waXRjaD10aGlzLl9waXRjaH1kaXNwb3NlKCl7cmV0dXJuIHN1cGVyLmRpc3Bvc2UoKSx0aGlzLl9mcmVxdWVuY3kuZGlzcG9zZSgpLHRoaXMuX2RlbGF5QS5kaXNwb3NlKCksdGhpcy5fZGVsYXlCLmRpc3Bvc2UoKSx0aGlzLl9sZm9BLmRpc3Bvc2UoKSx0aGlzLl9sZm9CLmRpc3Bvc2UoKSx0aGlzLl9jcm9zc0ZhZGUuZGlzcG9zZSgpLHRoaXMuX2Nyb3NzRmFkZUxGTy5kaXNwb3NlKCksdGhpcy5fZmVlZGJhY2tEZWxheS5kaXNwb3NlKCksdGhpc319Y2xhc3MgS2EgZXh0ZW5kcyBJYXtjb25zdHJ1Y3Rvcigpe3N1cGVyKERpKEthLmdldERlZmF1bHRzKCksYXJndW1lbnRzLFtcImZyZXF1ZW5jeVwiLFwib2N0YXZlc1wiLFwiYmFzZUZyZXF1ZW5jeVwiXSkpLHRoaXMubmFtZT1cIlBoYXNlclwiO2NvbnN0IHQ9RGkoS2EuZ2V0RGVmYXVsdHMoKSxhcmd1bWVudHMsW1wiZnJlcXVlbmN5XCIsXCJvY3RhdmVzXCIsXCJiYXNlRnJlcXVlbmN5XCJdKTt0aGlzLl9sZm9MPW5ldyB5cih7Y29udGV4dDp0aGlzLmNvbnRleHQsZnJlcXVlbmN5OnQuZnJlcXVlbmN5LG1pbjowLG1heDoxfSksdGhpcy5fbGZvUj1uZXcgeXIoe2NvbnRleHQ6dGhpcy5jb250ZXh0LGZyZXF1ZW5jeTp0LmZyZXF1ZW5jeSxtaW46MCxtYXg6MSxwaGFzZToxODB9KSx0aGlzLl9iYXNlRnJlcXVlbmN5PXRoaXMudG9GcmVxdWVuY3kodC5iYXNlRnJlcXVlbmN5KSx0aGlzLl9vY3RhdmVzPXQub2N0YXZlcyx0aGlzLlE9bmV3IERvKHtjb250ZXh0OnRoaXMuY29udGV4dCx2YWx1ZTp0LlEsdW5pdHM6XCJwb3NpdGl2ZVwifSksdGhpcy5fZmlsdGVyc0w9dGhpcy5fbWFrZUZpbHRlcnModC5zdGFnZXMsdGhpcy5fbGZvTCksdGhpcy5fZmlsdGVyc1I9dGhpcy5fbWFrZUZpbHRlcnModC5zdGFnZXMsdGhpcy5fbGZvUiksdGhpcy5mcmVxdWVuY3k9dGhpcy5fbGZvTC5mcmVxdWVuY3ksdGhpcy5mcmVxdWVuY3kudmFsdWU9dC5mcmVxdWVuY3ksdGhpcy5jb25uZWN0RWZmZWN0TGVmdCguLi50aGlzLl9maWx0ZXJzTCksdGhpcy5jb25uZWN0RWZmZWN0UmlnaHQoLi4udGhpcy5fZmlsdGVyc1IpLHRoaXMuX2xmb0wuZnJlcXVlbmN5LmNvbm5lY3QodGhpcy5fbGZvUi5mcmVxdWVuY3kpLHRoaXMuYmFzZUZyZXF1ZW5jeT10LmJhc2VGcmVxdWVuY3ksdGhpcy5vY3RhdmVzPXQub2N0YXZlcyx0aGlzLl9sZm9MLnN0YXJ0KCksdGhpcy5fbGZvUi5zdGFydCgpLFVpKHRoaXMsW1wiZnJlcXVlbmN5XCIsXCJRXCJdKX1zdGF0aWMgZ2V0RGVmYXVsdHMoKXtyZXR1cm4gT2JqZWN0LmFzc2lnbihJYS5nZXREZWZhdWx0cygpLHtmcmVxdWVuY3k6LjUsb2N0YXZlczozLHN0YWdlczoxMCxROjEwLGJhc2VGcmVxdWVuY3k6MzUwfSl9X21ha2VGaWx0ZXJzKHQsZSl7Y29uc3Qgcz1bXTtmb3IobGV0IG49MDtuPHQ7bisrKXtjb25zdCB0PXRoaXMuY29udGV4dC5jcmVhdGVCaXF1YWRGaWx0ZXIoKTt0LnR5cGU9XCJhbGxwYXNzXCIsdGhpcy5RLmNvbm5lY3QodC5RKSxlLmNvbm5lY3QodC5mcmVxdWVuY3kpLHMucHVzaCh0KX1yZXR1cm4gc31nZXQgb2N0YXZlcygpe3JldHVybiB0aGlzLl9vY3RhdmVzfXNldCBvY3RhdmVzKHQpe3RoaXMuX29jdGF2ZXM9dDtjb25zdCBlPXRoaXMuX2Jhc2VGcmVxdWVuY3kqTWF0aC5wb3coMix0KTt0aGlzLl9sZm9MLm1heD1lLHRoaXMuX2xmb1IubWF4PWV9Z2V0IGJhc2VGcmVxdWVuY3koKXtyZXR1cm4gdGhpcy5fYmFzZUZyZXF1ZW5jeX1zZXQgYmFzZUZyZXF1ZW5jeSh0KXt0aGlzLl9iYXNlRnJlcXVlbmN5PXRoaXMudG9GcmVxdWVuY3kodCksdGhpcy5fbGZvTC5taW49dGhpcy5fYmFzZUZyZXF1ZW5jeSx0aGlzLl9sZm9SLm1pbj10aGlzLl9iYXNlRnJlcXVlbmN5LHRoaXMub2N0YXZlcz10aGlzLl9vY3RhdmVzfWRpc3Bvc2UoKXtyZXR1cm4gc3VwZXIuZGlzcG9zZSgpLHRoaXMuUS5kaXNwb3NlKCksdGhpcy5fbGZvTC5kaXNwb3NlKCksdGhpcy5fbGZvUi5kaXNwb3NlKCksdGhpcy5fZmlsdGVyc0wuZm9yRWFjaCh0PT50LmRpc2Nvbm5lY3QoKSksdGhpcy5fZmlsdGVyc1IuZm9yRWFjaCh0PT50LmRpc2Nvbm5lY3QoKSksdGhpcy5mcmVxdWVuY3kuZGlzcG9zZSgpLHRoaXN9fWNsYXNzIHRjIGV4dGVuZHMgVGF7Y29uc3RydWN0b3IoKXtzdXBlcihEaSh0Yy5nZXREZWZhdWx0cygpLGFyZ3VtZW50cyxbXCJkZWNheVwiXSkpLHRoaXMubmFtZT1cIlJldmVyYlwiLHRoaXMuX2NvbnZvbHZlcj10aGlzLmNvbnRleHQuY3JlYXRlQ29udm9sdmVyKCksdGhpcy5yZWFkeT1Qcm9taXNlLnJlc29sdmUoKTtjb25zdCB0PURpKHRjLmdldERlZmF1bHRzKCksYXJndW1lbnRzLFtcImRlY2F5XCJdKTt0aGlzLl9kZWNheT10LmRlY2F5LHRoaXMuX3ByZURlbGF5PXQucHJlRGVsYXksdGhpcy5nZW5lcmF0ZSgpLHRoaXMuY29ubmVjdEVmZmVjdCh0aGlzLl9jb252b2x2ZXIpfXN0YXRpYyBnZXREZWZhdWx0cygpe3JldHVybiBPYmplY3QuYXNzaWduKFRhLmdldERlZmF1bHRzKCkse2RlY2F5OjEuNSxwcmVEZWxheTouMDF9KX1nZXQgZGVjYXkoKXtyZXR1cm4gdGhpcy5fZGVjYXl9c2V0IGRlY2F5KHQpe2VpKHQ9dGhpcy50b1NlY29uZHModCksLjAwMSksdGhpcy5fZGVjYXk9dCx0aGlzLmdlbmVyYXRlKCl9Z2V0IHByZURlbGF5KCl7cmV0dXJuIHRoaXMuX3ByZURlbGF5fXNldCBwcmVEZWxheSh0KXtlaSh0PXRoaXMudG9TZWNvbmRzKHQpLDApLHRoaXMuX3ByZURlbGF5PXQsdGhpcy5nZW5lcmF0ZSgpfWdlbmVyYXRlKCl7cmV0dXJuIHlpKHRoaXMsdm9pZCAwLHZvaWQgMCwoZnVuY3Rpb24qKCl7Y29uc3QgdD10aGlzLnJlYWR5LGU9bmV3IFlpKDIsdGhpcy5fZGVjYXkrdGhpcy5fcHJlRGVsYXksdGhpcy5jb250ZXh0LnNhbXBsZVJhdGUpLHM9bmV3IEpvKHtjb250ZXh0OmV9KSxuPW5ldyBKbyh7Y29udGV4dDplfSksaT1uZXcgRmEoe2NvbnRleHQ6ZX0pO3MuY29ubmVjdChpLDAsMCksbi5jb25uZWN0KGksMCwxKTtjb25zdCBvPW5ldyBrbyh7Y29udGV4dDplfSkudG9EZXN0aW5hdGlvbigpO2kuY29ubmVjdChvKSxzLnN0YXJ0KDApLG4uc3RhcnQoMCksby5nYWluLnNldFZhbHVlQXRUaW1lKDAsMCksby5nYWluLnNldFZhbHVlQXRUaW1lKDEsdGhpcy5fcHJlRGVsYXkpLG8uZ2Fpbi5leHBvbmVudGlhbEFwcHJvYWNoVmFsdWVBdFRpbWUoMCx0aGlzLl9wcmVEZWxheSx0aGlzLmRlY2F5KTtjb25zdCByPWUucmVuZGVyKCk7cmV0dXJuIHRoaXMucmVhZHk9ci50aGVuKFppKSx5aWVsZCB0LHRoaXMuX2NvbnZvbHZlci5idWZmZXI9KHlpZWxkIHIpLmdldCgpLHRoaXN9KSl9ZGlzcG9zZSgpe3JldHVybiBzdXBlci5kaXNwb3NlKCksdGhpcy5fY29udm9sdmVyLmRpc2Nvbm5lY3QoKSx0aGlzfX1jbGFzcyBlYyBleHRlbmRzIHdve2NvbnN0cnVjdG9yKCl7c3VwZXIoRGkoZWMuZ2V0RGVmYXVsdHMoKSxhcmd1bWVudHMpKSx0aGlzLm5hbWU9XCJNaWRTaWRlU3BsaXRcIix0aGlzLl9zcGxpdD10aGlzLmlucHV0PW5ldyBxYSh7Y2hhbm5lbHM6Mixjb250ZXh0OnRoaXMuY29udGV4dH0pLHRoaXMuX21pZEFkZD1uZXcgbXIoe2NvbnRleHQ6dGhpcy5jb250ZXh0fSksdGhpcy5taWQ9bmV3IGNyKHtjb250ZXh0OnRoaXMuY29udGV4dCx2YWx1ZTpNYXRoLlNRUlQxXzJ9KSx0aGlzLl9zaWRlU3VidHJhY3Q9bmV3IERyKHtjb250ZXh0OnRoaXMuY29udGV4dH0pLHRoaXMuc2lkZT1uZXcgY3Ioe2NvbnRleHQ6dGhpcy5jb250ZXh0LHZhbHVlOk1hdGguU1FSVDFfMn0pLHRoaXMuX3NwbGl0LmNvbm5lY3QodGhpcy5fbWlkQWRkLDApLHRoaXMuX3NwbGl0LmNvbm5lY3QodGhpcy5fbWlkQWRkLmFkZGVuZCwxKSx0aGlzLl9zcGxpdC5jb25uZWN0KHRoaXMuX3NpZGVTdWJ0cmFjdCwwKSx0aGlzLl9zcGxpdC5jb25uZWN0KHRoaXMuX3NpZGVTdWJ0cmFjdC5zdWJ0cmFoZW5kLDEpLHRoaXMuX21pZEFkZC5jb25uZWN0KHRoaXMubWlkKSx0aGlzLl9zaWRlU3VidHJhY3QuY29ubmVjdCh0aGlzLnNpZGUpfWRpc3Bvc2UoKXtyZXR1cm4gc3VwZXIuZGlzcG9zZSgpLHRoaXMubWlkLmRpc3Bvc2UoKSx0aGlzLnNpZGUuZGlzcG9zZSgpLHRoaXMuX21pZEFkZC5kaXNwb3NlKCksdGhpcy5fc2lkZVN1YnRyYWN0LmRpc3Bvc2UoKSx0aGlzLl9zcGxpdC5kaXNwb3NlKCksdGhpc319Y2xhc3Mgc2MgZXh0ZW5kcyB3b3tjb25zdHJ1Y3Rvcigpe3N1cGVyKERpKHNjLmdldERlZmF1bHRzKCksYXJndW1lbnRzKSksdGhpcy5uYW1lPVwiTWlkU2lkZU1lcmdlXCIsdGhpcy5taWQ9bmV3IGtvKHtjb250ZXh0OnRoaXMuY29udGV4dH0pLHRoaXMuc2lkZT1uZXcga28oe2NvbnRleHQ6dGhpcy5jb250ZXh0fSksdGhpcy5fbGVmdD1uZXcgbXIoe2NvbnRleHQ6dGhpcy5jb250ZXh0fSksdGhpcy5fbGVmdE11bHQ9bmV3IGNyKHtjb250ZXh0OnRoaXMuY29udGV4dCx2YWx1ZTpNYXRoLlNRUlQxXzJ9KSx0aGlzLl9yaWdodD1uZXcgRHIoe2NvbnRleHQ6dGhpcy5jb250ZXh0fSksdGhpcy5fcmlnaHRNdWx0PW5ldyBjcih7Y29udGV4dDp0aGlzLmNvbnRleHQsdmFsdWU6TWF0aC5TUVJUMV8yfSksdGhpcy5fbWVyZ2U9dGhpcy5vdXRwdXQ9bmV3IEZhKHtjb250ZXh0OnRoaXMuY29udGV4dH0pLHRoaXMubWlkLmZhbih0aGlzLl9sZWZ0KSx0aGlzLnNpZGUuY29ubmVjdCh0aGlzLl9sZWZ0LmFkZGVuZCksdGhpcy5taWQuY29ubmVjdCh0aGlzLl9yaWdodCksdGhpcy5zaWRlLmNvbm5lY3QodGhpcy5fcmlnaHQuc3VidHJhaGVuZCksdGhpcy5fbGVmdC5jb25uZWN0KHRoaXMuX2xlZnRNdWx0KSx0aGlzLl9yaWdodC5jb25uZWN0KHRoaXMuX3JpZ2h0TXVsdCksdGhpcy5fbGVmdE11bHQuY29ubmVjdCh0aGlzLl9tZXJnZSwwLDApLHRoaXMuX3JpZ2h0TXVsdC5jb25uZWN0KHRoaXMuX21lcmdlLDAsMSl9ZGlzcG9zZSgpe3JldHVybiBzdXBlci5kaXNwb3NlKCksdGhpcy5taWQuZGlzcG9zZSgpLHRoaXMuc2lkZS5kaXNwb3NlKCksdGhpcy5fbGVmdE11bHQuZGlzcG9zZSgpLHRoaXMuX3JpZ2h0TXVsdC5kaXNwb3NlKCksdGhpcy5fbGVmdC5kaXNwb3NlKCksdGhpcy5fcmlnaHQuZGlzcG9zZSgpLHRoaXN9fWNsYXNzIG5jIGV4dGVuZHMgVGF7Y29uc3RydWN0b3IodCl7c3VwZXIodCksdGhpcy5uYW1lPVwiTWlkU2lkZUVmZmVjdFwiLHRoaXMuX21pZFNpZGVNZXJnZT1uZXcgc2Moe2NvbnRleHQ6dGhpcy5jb250ZXh0fSksdGhpcy5fbWlkU2lkZVNwbGl0PW5ldyBlYyh7Y29udGV4dDp0aGlzLmNvbnRleHR9KSx0aGlzLl9taWRTZW5kPXRoaXMuX21pZFNpZGVTcGxpdC5taWQsdGhpcy5fc2lkZVNlbmQ9dGhpcy5fbWlkU2lkZVNwbGl0LnNpZGUsdGhpcy5fbWlkUmV0dXJuPXRoaXMuX21pZFNpZGVNZXJnZS5taWQsdGhpcy5fc2lkZVJldHVybj10aGlzLl9taWRTaWRlTWVyZ2Uuc2lkZSx0aGlzLmVmZmVjdFNlbmQuY29ubmVjdCh0aGlzLl9taWRTaWRlU3BsaXQpLHRoaXMuX21pZFNpZGVNZXJnZS5jb25uZWN0KHRoaXMuZWZmZWN0UmV0dXJuKX1jb25uZWN0RWZmZWN0TWlkKC4uLnQpe3RoaXMuX21pZFNlbmQuY2hhaW4oLi4udCx0aGlzLl9taWRSZXR1cm4pfWNvbm5lY3RFZmZlY3RTaWRlKC4uLnQpe3RoaXMuX3NpZGVTZW5kLmNoYWluKC4uLnQsdGhpcy5fc2lkZVJldHVybil9ZGlzcG9zZSgpe3JldHVybiBzdXBlci5kaXNwb3NlKCksdGhpcy5fbWlkU2lkZVNwbGl0LmRpc3Bvc2UoKSx0aGlzLl9taWRTaWRlTWVyZ2UuZGlzcG9zZSgpLHRoaXMuX21pZFNlbmQuZGlzcG9zZSgpLHRoaXMuX3NpZGVTZW5kLmRpc3Bvc2UoKSx0aGlzLl9taWRSZXR1cm4uZGlzcG9zZSgpLHRoaXMuX3NpZGVSZXR1cm4uZGlzcG9zZSgpLHRoaXN9fWNsYXNzIGljIGV4dGVuZHMgbmN7Y29uc3RydWN0b3IoKXtzdXBlcihEaShpYy5nZXREZWZhdWx0cygpLGFyZ3VtZW50cyxbXCJ3aWR0aFwiXSkpLHRoaXMubmFtZT1cIlN0ZXJlb1dpZGVuZXJcIjtjb25zdCB0PURpKGljLmdldERlZmF1bHRzKCksYXJndW1lbnRzLFtcIndpZHRoXCJdKTt0aGlzLndpZHRoPW5ldyBEbyh7Y29udGV4dDp0aGlzLmNvbnRleHQsdmFsdWU6dC53aWR0aCx1bml0czpcIm5vcm1hbFJhbmdlXCJ9KSxVaSh0aGlzLFtcIndpZHRoXCJdKSx0aGlzLl90d29UaW1lc1dpZHRoTWlkPW5ldyBjcih7Y29udGV4dDp0aGlzLmNvbnRleHQsdmFsdWU6Mn0pLHRoaXMuX3R3b1RpbWVzV2lkdGhTaWRlPW5ldyBjcih7Y29udGV4dDp0aGlzLmNvbnRleHQsdmFsdWU6Mn0pLHRoaXMuX21pZE11bHQ9bmV3IGNyKHtjb250ZXh0OnRoaXMuY29udGV4dH0pLHRoaXMuX3R3b1RpbWVzV2lkdGhNaWQuY29ubmVjdCh0aGlzLl9taWRNdWx0LmZhY3RvciksdGhpcy5jb25uZWN0RWZmZWN0TWlkKHRoaXMuX21pZE11bHQpLHRoaXMuX29uZU1pbnVzV2lkdGg9bmV3IERyKHtjb250ZXh0OnRoaXMuY29udGV4dH0pLHRoaXMuX29uZU1pbnVzV2lkdGguY29ubmVjdCh0aGlzLl90d29UaW1lc1dpZHRoTWlkKSxUbyh0aGlzLmNvbnRleHQuZ2V0Q29uc3RhbnQoMSksdGhpcy5fb25lTWludXNXaWR0aCksdGhpcy53aWR0aC5jb25uZWN0KHRoaXMuX29uZU1pbnVzV2lkdGguc3VidHJhaGVuZCksdGhpcy5fc2lkZU11bHQ9bmV3IGNyKHtjb250ZXh0OnRoaXMuY29udGV4dH0pLHRoaXMud2lkdGguY29ubmVjdCh0aGlzLl90d29UaW1lc1dpZHRoU2lkZSksdGhpcy5fdHdvVGltZXNXaWR0aFNpZGUuY29ubmVjdCh0aGlzLl9zaWRlTXVsdC5mYWN0b3IpLHRoaXMuY29ubmVjdEVmZmVjdFNpZGUodGhpcy5fc2lkZU11bHQpfXN0YXRpYyBnZXREZWZhdWx0cygpe3JldHVybiBPYmplY3QuYXNzaWduKG5jLmdldERlZmF1bHRzKCkse3dpZHRoOi41fSl9ZGlzcG9zZSgpe3JldHVybiBzdXBlci5kaXNwb3NlKCksdGhpcy53aWR0aC5kaXNwb3NlKCksdGhpcy5fbWlkTXVsdC5kaXNwb3NlKCksdGhpcy5fc2lkZU11bHQuZGlzcG9zZSgpLHRoaXMuX3R3b1RpbWVzV2lkdGhNaWQuZGlzcG9zZSgpLHRoaXMuX3R3b1RpbWVzV2lkdGhTaWRlLmRpc3Bvc2UoKSx0aGlzLl9vbmVNaW51c1dpZHRoLmRpc3Bvc2UoKSx0aGlzfX1jbGFzcyBvYyBleHRlbmRzIElhe2NvbnN0cnVjdG9yKCl7c3VwZXIoRGkob2MuZ2V0RGVmYXVsdHMoKSxhcmd1bWVudHMsW1wiZnJlcXVlbmN5XCIsXCJkZXB0aFwiXSkpLHRoaXMubmFtZT1cIlRyZW1vbG9cIjtjb25zdCB0PURpKG9jLmdldERlZmF1bHRzKCksYXJndW1lbnRzLFtcImZyZXF1ZW5jeVwiLFwiZGVwdGhcIl0pO3RoaXMuX2xmb0w9bmV3IHlyKHtjb250ZXh0OnRoaXMuY29udGV4dCx0eXBlOnQudHlwZSxtaW46MSxtYXg6MH0pLHRoaXMuX2xmb1I9bmV3IHlyKHtjb250ZXh0OnRoaXMuY29udGV4dCx0eXBlOnQudHlwZSxtaW46MSxtYXg6MH0pLHRoaXMuX2FtcGxpdHVkZUw9bmV3IGtvKHtjb250ZXh0OnRoaXMuY29udGV4dH0pLHRoaXMuX2FtcGxpdHVkZVI9bmV3IGtvKHtjb250ZXh0OnRoaXMuY29udGV4dH0pLHRoaXMuZnJlcXVlbmN5PW5ldyBEbyh7Y29udGV4dDp0aGlzLmNvbnRleHQsdmFsdWU6dC5mcmVxdWVuY3ksdW5pdHM6XCJmcmVxdWVuY3lcIn0pLHRoaXMuZGVwdGg9bmV3IERvKHtjb250ZXh0OnRoaXMuY29udGV4dCx2YWx1ZTp0LmRlcHRoLHVuaXRzOlwibm9ybWFsUmFuZ2VcIn0pLFVpKHRoaXMsW1wiZnJlcXVlbmN5XCIsXCJkZXB0aFwiXSksdGhpcy5jb25uZWN0RWZmZWN0TGVmdCh0aGlzLl9hbXBsaXR1ZGVMKSx0aGlzLmNvbm5lY3RFZmZlY3RSaWdodCh0aGlzLl9hbXBsaXR1ZGVSKSx0aGlzLl9sZm9MLmNvbm5lY3QodGhpcy5fYW1wbGl0dWRlTC5nYWluKSx0aGlzLl9sZm9SLmNvbm5lY3QodGhpcy5fYW1wbGl0dWRlUi5nYWluKSx0aGlzLmZyZXF1ZW5jeS5mYW4odGhpcy5fbGZvTC5mcmVxdWVuY3ksdGhpcy5fbGZvUi5mcmVxdWVuY3kpLHRoaXMuZGVwdGguZmFuKHRoaXMuX2xmb1IuYW1wbGl0dWRlLHRoaXMuX2xmb0wuYW1wbGl0dWRlKSx0aGlzLnNwcmVhZD10LnNwcmVhZH1zdGF0aWMgZ2V0RGVmYXVsdHMoKXtyZXR1cm4gT2JqZWN0LmFzc2lnbihJYS5nZXREZWZhdWx0cygpLHtmcmVxdWVuY3k6MTAsdHlwZTpcInNpbmVcIixkZXB0aDouNSxzcHJlYWQ6MTgwfSl9c3RhcnQodCl7cmV0dXJuIHRoaXMuX2xmb0wuc3RhcnQodCksdGhpcy5fbGZvUi5zdGFydCh0KSx0aGlzfXN0b3AodCl7cmV0dXJuIHRoaXMuX2xmb0wuc3RvcCh0KSx0aGlzLl9sZm9SLnN0b3AodCksdGhpc31zeW5jKCl7cmV0dXJuIHRoaXMuX2xmb0wuc3luYygpLHRoaXMuX2xmb1Iuc3luYygpLHRoaXMuY29udGV4dC50cmFuc3BvcnQuc3luY1NpZ25hbCh0aGlzLmZyZXF1ZW5jeSksdGhpc311bnN5bmMoKXtyZXR1cm4gdGhpcy5fbGZvTC51bnN5bmMoKSx0aGlzLl9sZm9SLnVuc3luYygpLHRoaXMuY29udGV4dC50cmFuc3BvcnQudW5zeW5jU2lnbmFsKHRoaXMuZnJlcXVlbmN5KSx0aGlzfWdldCB0eXBlKCl7cmV0dXJuIHRoaXMuX2xmb0wudHlwZX1zZXQgdHlwZSh0KXt0aGlzLl9sZm9MLnR5cGU9dCx0aGlzLl9sZm9SLnR5cGU9dH1nZXQgc3ByZWFkKCl7cmV0dXJuIHRoaXMuX2xmb1IucGhhc2UtdGhpcy5fbGZvTC5waGFzZX1zZXQgc3ByZWFkKHQpe3RoaXMuX2xmb0wucGhhc2U9OTAtdC8yLHRoaXMuX2xmb1IucGhhc2U9dC8yKzkwfWRpc3Bvc2UoKXtyZXR1cm4gc3VwZXIuZGlzcG9zZSgpLHRoaXMuX2xmb0wuZGlzcG9zZSgpLHRoaXMuX2xmb1IuZGlzcG9zZSgpLHRoaXMuX2FtcGxpdHVkZUwuZGlzcG9zZSgpLHRoaXMuX2FtcGxpdHVkZVIuZGlzcG9zZSgpLHRoaXMuZnJlcXVlbmN5LmRpc3Bvc2UoKSx0aGlzLmRlcHRoLmRpc3Bvc2UoKSx0aGlzfX1jbGFzcyByYyBleHRlbmRzIFRhe2NvbnN0cnVjdG9yKCl7c3VwZXIoRGkocmMuZ2V0RGVmYXVsdHMoKSxhcmd1bWVudHMsW1wiZnJlcXVlbmN5XCIsXCJkZXB0aFwiXSkpLHRoaXMubmFtZT1cIlZpYnJhdG9cIjtjb25zdCB0PURpKHJjLmdldERlZmF1bHRzKCksYXJndW1lbnRzLFtcImZyZXF1ZW5jeVwiLFwiZGVwdGhcIl0pO3RoaXMuX2RlbGF5Tm9kZT1uZXcgRm8oe2NvbnRleHQ6dGhpcy5jb250ZXh0LGRlbGF5VGltZTowLG1heERlbGF5OnQubWF4RGVsYXl9KSx0aGlzLl9sZm89bmV3IHlyKHtjb250ZXh0OnRoaXMuY29udGV4dCx0eXBlOnQudHlwZSxtaW46MCxtYXg6dC5tYXhEZWxheSxmcmVxdWVuY3k6dC5mcmVxdWVuY3kscGhhc2U6LTkwfSkuc3RhcnQoKS5jb25uZWN0KHRoaXMuX2RlbGF5Tm9kZS5kZWxheVRpbWUpLHRoaXMuZnJlcXVlbmN5PXRoaXMuX2xmby5mcmVxdWVuY3ksdGhpcy5kZXB0aD10aGlzLl9sZm8uYW1wbGl0dWRlLHRoaXMuZGVwdGgudmFsdWU9dC5kZXB0aCxVaSh0aGlzLFtcImZyZXF1ZW5jeVwiLFwiZGVwdGhcIl0pLHRoaXMuZWZmZWN0U2VuZC5jaGFpbih0aGlzLl9kZWxheU5vZGUsdGhpcy5lZmZlY3RSZXR1cm4pfXN0YXRpYyBnZXREZWZhdWx0cygpe3JldHVybiBPYmplY3QuYXNzaWduKFRhLmdldERlZmF1bHRzKCkse21heERlbGF5Oi4wMDUsZnJlcXVlbmN5OjUsZGVwdGg6LjEsdHlwZTpcInNpbmVcIn0pfWdldCB0eXBlKCl7cmV0dXJuIHRoaXMuX2xmby50eXBlfXNldCB0eXBlKHQpe3RoaXMuX2xmby50eXBlPXR9ZGlzcG9zZSgpe3JldHVybiBzdXBlci5kaXNwb3NlKCksdGhpcy5fZGVsYXlOb2RlLmRpc3Bvc2UoKSx0aGlzLl9sZm8uZGlzcG9zZSgpLHRoaXMuZnJlcXVlbmN5LmRpc3Bvc2UoKSx0aGlzLmRlcHRoLmRpc3Bvc2UoKSx0aGlzfX1jbGFzcyBhYyBleHRlbmRzIHdve2NvbnN0cnVjdG9yKCl7c3VwZXIoRGkoYWMuZ2V0RGVmYXVsdHMoKSxhcmd1bWVudHMsW1widHlwZVwiLFwic2l6ZVwiXSkpLHRoaXMubmFtZT1cIkFuYWx5c2VyXCIsdGhpcy5fYW5hbHlzZXJzPVtdLHRoaXMuX2J1ZmZlcnM9W107Y29uc3QgdD1EaShhYy5nZXREZWZhdWx0cygpLGFyZ3VtZW50cyxbXCJ0eXBlXCIsXCJzaXplXCJdKTt0aGlzLmlucHV0PXRoaXMub3V0cHV0PXRoaXMuX2dhaW49bmV3IGtvKHtjb250ZXh0OnRoaXMuY29udGV4dH0pLHRoaXMuX3NwbGl0PW5ldyBxYSh7Y29udGV4dDp0aGlzLmNvbnRleHQsY2hhbm5lbHM6dC5jaGFubmVsc30pLHRoaXMuaW5wdXQuY29ubmVjdCh0aGlzLl9zcGxpdCksZWkodC5jaGFubmVscywxKTtmb3IobGV0IGU9MDtlPHQuY2hhbm5lbHM7ZSsrKXRoaXMuX2FuYWx5c2Vyc1tlXT10aGlzLmNvbnRleHQuY3JlYXRlQW5hbHlzZXIoKSx0aGlzLl9zcGxpdC5jb25uZWN0KHRoaXMuX2FuYWx5c2Vyc1tlXSxlLDApO3RoaXMuc2l6ZT10LnNpemUsdGhpcy50eXBlPXQudHlwZX1zdGF0aWMgZ2V0RGVmYXVsdHMoKXtyZXR1cm4gT2JqZWN0LmFzc2lnbih3by5nZXREZWZhdWx0cygpLHtzaXplOjEwMjQsc21vb3RoaW5nOi44LHR5cGU6XCJmZnRcIixjaGFubmVsczoxfSl9Z2V0VmFsdWUoKXtyZXR1cm4gdGhpcy5fYW5hbHlzZXJzLmZvckVhY2goKHQsZSk9Pntjb25zdCBzPXRoaXMuX2J1ZmZlcnNbZV07XCJmZnRcIj09PXRoaXMuX3R5cGU/dC5nZXRGbG9hdEZyZXF1ZW5jeURhdGEocyk6XCJ3YXZlZm9ybVwiPT09dGhpcy5fdHlwZSYmdC5nZXRGbG9hdFRpbWVEb21haW5EYXRhKHMpfSksMT09PXRoaXMuY2hhbm5lbHM/dGhpcy5fYnVmZmVyc1swXTp0aGlzLl9idWZmZXJzfWdldCBzaXplKCl7cmV0dXJuIHRoaXMuX2FuYWx5c2Vyc1swXS5mcmVxdWVuY3lCaW5Db3VudH1zZXQgc2l6ZSh0KXt0aGlzLl9hbmFseXNlcnMuZm9yRWFjaCgoZSxzKT0+e2UuZmZ0U2l6ZT0yKnQsdGhpcy5fYnVmZmVyc1tzXT1uZXcgRmxvYXQzMkFycmF5KHQpfSl9Z2V0IGNoYW5uZWxzKCl7cmV0dXJuIHRoaXMuX2FuYWx5c2Vycy5sZW5ndGh9Z2V0IHR5cGUoKXtyZXR1cm4gdGhpcy5fdHlwZX1zZXQgdHlwZSh0KXt0aShcIndhdmVmb3JtXCI9PT10fHxcImZmdFwiPT09dCxcIkFuYWx5c2VyOiBpbnZhbGlkIHR5cGU6IFwiK3QpLHRoaXMuX3R5cGU9dH1nZXQgc21vb3RoaW5nKCl7cmV0dXJuIHRoaXMuX2FuYWx5c2Vyc1swXS5zbW9vdGhpbmdUaW1lQ29uc3RhbnR9c2V0IHNtb290aGluZyh0KXt0aGlzLl9hbmFseXNlcnMuZm9yRWFjaChlPT5lLnNtb290aGluZ1RpbWVDb25zdGFudD10KX1kaXNwb3NlKCl7cmV0dXJuIHN1cGVyLmRpc3Bvc2UoKSx0aGlzLl9hbmFseXNlcnMuZm9yRWFjaCh0PT50LmRpc2Nvbm5lY3QoKSksdGhpcy5fc3BsaXQuZGlzcG9zZSgpLHRoaXMuX2dhaW4uZGlzcG9zZSgpLHRoaXN9fWNsYXNzIGNjIGV4dGVuZHMgd297Y29uc3RydWN0b3IoKXtzdXBlcihEaShjYy5nZXREZWZhdWx0cygpLGFyZ3VtZW50cykpLHRoaXMubmFtZT1cIk1ldGVyQmFzZVwiLHRoaXMuaW5wdXQ9dGhpcy5vdXRwdXQ9dGhpcy5fYW5hbHlzZXI9bmV3IGFjKHtjb250ZXh0OnRoaXMuY29udGV4dCxzaXplOjI1Nix0eXBlOlwid2F2ZWZvcm1cIn0pfWRpc3Bvc2UoKXtyZXR1cm4gc3VwZXIuZGlzcG9zZSgpLHRoaXMuX2FuYWx5c2VyLmRpc3Bvc2UoKSx0aGlzfX1jbGFzcyBoYyBleHRlbmRzIGNje2NvbnN0cnVjdG9yKCl7c3VwZXIoRGkoaGMuZ2V0RGVmYXVsdHMoKSxhcmd1bWVudHMsW1wic21vb3RoaW5nXCJdKSksdGhpcy5uYW1lPVwiTWV0ZXJcIix0aGlzLl9ybXM9MDtjb25zdCB0PURpKGhjLmdldERlZmF1bHRzKCksYXJndW1lbnRzLFtcInNtb290aGluZ1wiXSk7dGhpcy5pbnB1dD10aGlzLm91dHB1dD10aGlzLl9hbmFseXNlcj1uZXcgYWMoe2NvbnRleHQ6dGhpcy5jb250ZXh0LHNpemU6MjU2LHR5cGU6XCJ3YXZlZm9ybVwiLGNoYW5uZWxzOnQuY2hhbm5lbHN9KSx0aGlzLnNtb290aGluZz10LnNtb290aGluZyx0aGlzLm5vcm1hbFJhbmdlPXQubm9ybWFsUmFuZ2V9c3RhdGljIGdldERlZmF1bHRzKCl7cmV0dXJuIE9iamVjdC5hc3NpZ24oY2MuZ2V0RGVmYXVsdHMoKSx7c21vb3RoaW5nOi44LG5vcm1hbFJhbmdlOiExLGNoYW5uZWxzOjF9KX1nZXRMZXZlbCgpe3JldHVybiByaShcIidnZXRMZXZlbCcgaGFzIGJlZW4gY2hhbmdlZCB0byAnZ2V0VmFsdWUnXCIpLHRoaXMuZ2V0VmFsdWUoKX1nZXRWYWx1ZSgpe2NvbnN0IHQ9dGhpcy5fYW5hbHlzZXIuZ2V0VmFsdWUoKSxlPSgxPT09dGhpcy5jaGFubmVscz9bdF06dCkubWFwKHQ9Pntjb25zdCBlPXQucmVkdWNlKCh0LGUpPT50K2UqZSwwKSxzPU1hdGguc3FydChlL3QubGVuZ3RoKTtyZXR1cm4gdGhpcy5fcm1zPU1hdGgubWF4KHMsdGhpcy5fcm1zKnRoaXMuc21vb3RoaW5nKSx0aGlzLm5vcm1hbFJhbmdlP3RoaXMuX3Jtczpzbyh0aGlzLl9ybXMpfSk7cmV0dXJuIDE9PT10aGlzLmNoYW5uZWxzP2VbMF06ZX1nZXQgY2hhbm5lbHMoKXtyZXR1cm4gdGhpcy5fYW5hbHlzZXIuY2hhbm5lbHN9ZGlzcG9zZSgpe3JldHVybiBzdXBlci5kaXNwb3NlKCksdGhpcy5fYW5hbHlzZXIuZGlzcG9zZSgpLHRoaXN9fWNsYXNzIHVjIGV4dGVuZHMgY2N7Y29uc3RydWN0b3IoKXtzdXBlcihEaSh1Yy5nZXREZWZhdWx0cygpLGFyZ3VtZW50cyxbXCJzaXplXCJdKSksdGhpcy5uYW1lPVwiRkZUXCI7Y29uc3QgdD1EaSh1Yy5nZXREZWZhdWx0cygpLGFyZ3VtZW50cyxbXCJzaXplXCJdKTt0aGlzLm5vcm1hbFJhbmdlPXQubm9ybWFsUmFuZ2UsdGhpcy5fYW5hbHlzZXIudHlwZT1cImZmdFwiLHRoaXMuc2l6ZT10LnNpemV9c3RhdGljIGdldERlZmF1bHRzKCl7cmV0dXJuIE9iamVjdC5hc3NpZ24od28uZ2V0RGVmYXVsdHMoKSx7bm9ybWFsUmFuZ2U6ITEsc2l6ZToxMDI0LHNtb290aGluZzouOH0pfWdldFZhbHVlKCl7cmV0dXJuIHRoaXMuX2FuYWx5c2VyLmdldFZhbHVlKCkubWFwKHQ9PnRoaXMubm9ybWFsUmFuZ2U/ZW8odCk6dCl9Z2V0IHNpemUoKXtyZXR1cm4gdGhpcy5fYW5hbHlzZXIuc2l6ZX1zZXQgc2l6ZSh0KXt0aGlzLl9hbmFseXNlci5zaXplPXR9Z2V0IHNtb290aGluZygpe3JldHVybiB0aGlzLl9hbmFseXNlci5zbW9vdGhpbmd9c2V0IHNtb290aGluZyh0KXt0aGlzLl9hbmFseXNlci5zbW9vdGhpbmc9dH1nZXRGcmVxdWVuY3lPZkluZGV4KHQpe3JldHVybiB0aSgwPD10JiZ0PHRoaXMuc2l6ZSxcImluZGV4IG11c3QgYmUgZ3JlYXRlciB0aGFuIG9yIGVxdWFsIHRvIDAgYW5kIGxlc3MgdGhhbiBcIit0aGlzLnNpemUpLHQqdGhpcy5jb250ZXh0LnNhbXBsZVJhdGUvKDIqdGhpcy5zaXplKX19Y2xhc3MgbGMgZXh0ZW5kcyBjY3tjb25zdHJ1Y3Rvcigpe3N1cGVyKERpKGxjLmdldERlZmF1bHRzKCksYXJndW1lbnRzKSksdGhpcy5uYW1lPVwiRENNZXRlclwiLHRoaXMuX2FuYWx5c2VyLnR5cGU9XCJ3YXZlZm9ybVwiLHRoaXMuX2FuYWx5c2VyLnNpemU9MjU2fWdldFZhbHVlKCl7cmV0dXJuIHRoaXMuX2FuYWx5c2VyLmdldFZhbHVlKClbMF19fWNsYXNzIHBjIGV4dGVuZHMgY2N7Y29uc3RydWN0b3IoKXtzdXBlcihEaShwYy5nZXREZWZhdWx0cygpLGFyZ3VtZW50cyxbXCJzaXplXCJdKSksdGhpcy5uYW1lPVwiV2F2ZWZvcm1cIjtjb25zdCB0PURpKHBjLmdldERlZmF1bHRzKCksYXJndW1lbnRzLFtcInNpemVcIl0pO3RoaXMuX2FuYWx5c2VyLnR5cGU9XCJ3YXZlZm9ybVwiLHRoaXMuc2l6ZT10LnNpemV9c3RhdGljIGdldERlZmF1bHRzKCl7cmV0dXJuIE9iamVjdC5hc3NpZ24oY2MuZ2V0RGVmYXVsdHMoKSx7c2l6ZToxMDI0fSl9Z2V0VmFsdWUoKXtyZXR1cm4gdGhpcy5fYW5hbHlzZXIuZ2V0VmFsdWUoKX1nZXQgc2l6ZSgpe3JldHVybiB0aGlzLl9hbmFseXNlci5zaXplfXNldCBzaXplKHQpe3RoaXMuX2FuYWx5c2VyLnNpemU9dH19Y2xhc3MgZGMgZXh0ZW5kcyB3b3tjb25zdHJ1Y3Rvcigpe3N1cGVyKERpKGRjLmdldERlZmF1bHRzKCksYXJndW1lbnRzLFtcInNvbG9cIl0pKSx0aGlzLm5hbWU9XCJTb2xvXCI7Y29uc3QgdD1EaShkYy5nZXREZWZhdWx0cygpLGFyZ3VtZW50cyxbXCJzb2xvXCJdKTt0aGlzLmlucHV0PXRoaXMub3V0cHV0PW5ldyBrbyh7Y29udGV4dDp0aGlzLmNvbnRleHR9KSxkYy5fYWxsU29sb3MuaGFzKHRoaXMuY29udGV4dCl8fGRjLl9hbGxTb2xvcy5zZXQodGhpcy5jb250ZXh0LG5ldyBTZXQpLGRjLl9hbGxTb2xvcy5nZXQodGhpcy5jb250ZXh0KS5hZGQodGhpcyksdGhpcy5zb2xvPXQuc29sb31zdGF0aWMgZ2V0RGVmYXVsdHMoKXtyZXR1cm4gT2JqZWN0LmFzc2lnbih3by5nZXREZWZhdWx0cygpLHtzb2xvOiExfSl9Z2V0IHNvbG8oKXtyZXR1cm4gdGhpcy5faXNTb2xvZWQoKX1zZXQgc29sbyh0KXt0P3RoaXMuX2FkZFNvbG8oKTp0aGlzLl9yZW1vdmVTb2xvKCksZGMuX2FsbFNvbG9zLmdldCh0aGlzLmNvbnRleHQpLmZvckVhY2godD0+dC5fdXBkYXRlU29sbygpKX1nZXQgbXV0ZWQoKXtyZXR1cm4gMD09PXRoaXMuaW5wdXQuZ2Fpbi52YWx1ZX1fYWRkU29sbygpe2RjLl9zb2xvZWQuaGFzKHRoaXMuY29udGV4dCl8fGRjLl9zb2xvZWQuc2V0KHRoaXMuY29udGV4dCxuZXcgU2V0KSxkYy5fc29sb2VkLmdldCh0aGlzLmNvbnRleHQpLmFkZCh0aGlzKX1fcmVtb3ZlU29sbygpe2RjLl9zb2xvZWQuaGFzKHRoaXMuY29udGV4dCkmJmRjLl9zb2xvZWQuZ2V0KHRoaXMuY29udGV4dCkuZGVsZXRlKHRoaXMpfV9pc1NvbG9lZCgpe3JldHVybiBkYy5fc29sb2VkLmhhcyh0aGlzLmNvbnRleHQpJiZkYy5fc29sb2VkLmdldCh0aGlzLmNvbnRleHQpLmhhcyh0aGlzKX1fbm9Tb2xvcygpe3JldHVybiFkYy5fc29sb2VkLmhhcyh0aGlzLmNvbnRleHQpfHxkYy5fc29sb2VkLmhhcyh0aGlzLmNvbnRleHQpJiYwPT09ZGMuX3NvbG9lZC5nZXQodGhpcy5jb250ZXh0KS5zaXplfV91cGRhdGVTb2xvKCl7dGhpcy5faXNTb2xvZWQoKXx8dGhpcy5fbm9Tb2xvcygpP3RoaXMuaW5wdXQuZ2Fpbi52YWx1ZT0xOnRoaXMuaW5wdXQuZ2Fpbi52YWx1ZT0wfWRpc3Bvc2UoKXtyZXR1cm4gc3VwZXIuZGlzcG9zZSgpLGRjLl9hbGxTb2xvcy5nZXQodGhpcy5jb250ZXh0KS5kZWxldGUodGhpcyksdGhpcy5fcmVtb3ZlU29sbygpLHRoaXN9fWRjLl9hbGxTb2xvcz1uZXcgTWFwLGRjLl9zb2xvZWQ9bmV3IE1hcDtjbGFzcyBmYyBleHRlbmRzIHdve2NvbnN0cnVjdG9yKCl7c3VwZXIoRGkoZmMuZ2V0RGVmYXVsdHMoKSxhcmd1bWVudHMsW1wicGFuXCIsXCJ2b2x1bWVcIl0pKSx0aGlzLm5hbWU9XCJQYW5Wb2xcIjtjb25zdCB0PURpKGZjLmdldERlZmF1bHRzKCksYXJndW1lbnRzLFtcInBhblwiLFwidm9sdW1lXCJdKTt0aGlzLl9wYW5uZXI9dGhpcy5pbnB1dD1uZXcgQ2Eoe2NvbnRleHQ6dGhpcy5jb250ZXh0LHBhbjp0LnBhbixjaGFubmVsQ291bnQ6dC5jaGFubmVsQ291bnR9KSx0aGlzLnBhbj10aGlzLl9wYW5uZXIucGFuLHRoaXMuX3ZvbHVtZT10aGlzLm91dHB1dD1uZXcgR28oe2NvbnRleHQ6dGhpcy5jb250ZXh0LHZvbHVtZTp0LnZvbHVtZX0pLHRoaXMudm9sdW1lPXRoaXMuX3ZvbHVtZS52b2x1bWUsdGhpcy5fcGFubmVyLmNvbm5lY3QodGhpcy5fdm9sdW1lKSx0aGlzLm11dGU9dC5tdXRlLFVpKHRoaXMsW1wicGFuXCIsXCJ2b2x1bWVcIl0pfXN0YXRpYyBnZXREZWZhdWx0cygpe3JldHVybiBPYmplY3QuYXNzaWduKHdvLmdldERlZmF1bHRzKCkse211dGU6ITEscGFuOjAsdm9sdW1lOjAsY2hhbm5lbENvdW50OjF9KX1nZXQgbXV0ZSgpe3JldHVybiB0aGlzLl92b2x1bWUubXV0ZX1zZXQgbXV0ZSh0KXt0aGlzLl92b2x1bWUubXV0ZT10fWRpc3Bvc2UoKXtyZXR1cm4gc3VwZXIuZGlzcG9zZSgpLHRoaXMuX3Bhbm5lci5kaXNwb3NlKCksdGhpcy5wYW4uZGlzcG9zZSgpLHRoaXMuX3ZvbHVtZS5kaXNwb3NlKCksdGhpcy52b2x1bWUuZGlzcG9zZSgpLHRoaXN9fWNsYXNzIF9jIGV4dGVuZHMgd297Y29uc3RydWN0b3IoKXtzdXBlcihEaShfYy5nZXREZWZhdWx0cygpLGFyZ3VtZW50cyxbXCJ2b2x1bWVcIixcInBhblwiXSkpLHRoaXMubmFtZT1cIkNoYW5uZWxcIjtjb25zdCB0PURpKF9jLmdldERlZmF1bHRzKCksYXJndW1lbnRzLFtcInZvbHVtZVwiLFwicGFuXCJdKTt0aGlzLl9zb2xvPXRoaXMuaW5wdXQ9bmV3IGRjKHtzb2xvOnQuc29sbyxjb250ZXh0OnRoaXMuY29udGV4dH0pLHRoaXMuX3BhblZvbD10aGlzLm91dHB1dD1uZXcgZmMoe2NvbnRleHQ6dGhpcy5jb250ZXh0LHBhbjp0LnBhbix2b2x1bWU6dC52b2x1bWUsbXV0ZTp0Lm11dGUsY2hhbm5lbENvdW50OnQuY2hhbm5lbENvdW50fSksdGhpcy5wYW49dGhpcy5fcGFuVm9sLnBhbix0aGlzLnZvbHVtZT10aGlzLl9wYW5Wb2wudm9sdW1lLHRoaXMuX3NvbG8uY29ubmVjdCh0aGlzLl9wYW5Wb2wpLFVpKHRoaXMsW1wicGFuXCIsXCJ2b2x1bWVcIl0pfXN0YXRpYyBnZXREZWZhdWx0cygpe3JldHVybiBPYmplY3QuYXNzaWduKHdvLmdldERlZmF1bHRzKCkse3BhbjowLHZvbHVtZTowLG11dGU6ITEsc29sbzohMSxjaGFubmVsQ291bnQ6MX0pfWdldCBzb2xvKCl7cmV0dXJuIHRoaXMuX3NvbG8uc29sb31zZXQgc29sbyh0KXt0aGlzLl9zb2xvLnNvbG89dH1nZXQgbXV0ZWQoKXtyZXR1cm4gdGhpcy5fc29sby5tdXRlZHx8dGhpcy5tdXRlfWdldCBtdXRlKCl7cmV0dXJuIHRoaXMuX3BhblZvbC5tdXRlfXNldCBtdXRlKHQpe3RoaXMuX3BhblZvbC5tdXRlPXR9X2dldEJ1cyh0KXtyZXR1cm4gX2MuYnVzZXMuaGFzKHQpfHxfYy5idXNlcy5zZXQodCxuZXcga28oe2NvbnRleHQ6dGhpcy5jb250ZXh0fSkpLF9jLmJ1c2VzLmdldCh0KX1zZW5kKHQsZT0wKXtjb25zdCBzPXRoaXMuX2dldEJ1cyh0KSxuPW5ldyBrbyh7Y29udGV4dDp0aGlzLmNvbnRleHQsdW5pdHM6XCJkZWNpYmVsc1wiLGdhaW46ZX0pO3JldHVybiB0aGlzLmNvbm5lY3Qobiksbi5jb25uZWN0KHMpLG59cmVjZWl2ZSh0KXtyZXR1cm4gdGhpcy5fZ2V0QnVzKHQpLmNvbm5lY3QodGhpcyksdGhpc31kaXNwb3NlKCl7cmV0dXJuIHN1cGVyLmRpc3Bvc2UoKSx0aGlzLl9wYW5Wb2wuZGlzcG9zZSgpLHRoaXMucGFuLmRpc3Bvc2UoKSx0aGlzLnZvbHVtZS5kaXNwb3NlKCksdGhpcy5fc29sby5kaXNwb3NlKCksdGhpc319X2MuYnVzZXM9bmV3IE1hcDtjbGFzcyBtYyBleHRlbmRzIHdve2NvbnN0cnVjdG9yKCl7c3VwZXIoRGkobWMuZ2V0RGVmYXVsdHMoKSxhcmd1bWVudHMpKSx0aGlzLm5hbWU9XCJNb25vXCIsdGhpcy5pbnB1dD1uZXcga28oe2NvbnRleHQ6dGhpcy5jb250ZXh0fSksdGhpcy5fbWVyZ2U9dGhpcy5vdXRwdXQ9bmV3IEZhKHtjaGFubmVsczoyLGNvbnRleHQ6dGhpcy5jb250ZXh0fSksdGhpcy5pbnB1dC5jb25uZWN0KHRoaXMuX21lcmdlLDAsMCksdGhpcy5pbnB1dC5jb25uZWN0KHRoaXMuX21lcmdlLDAsMSl9ZGlzcG9zZSgpe3JldHVybiBzdXBlci5kaXNwb3NlKCksdGhpcy5fbWVyZ2UuZGlzcG9zZSgpLHRoaXMuaW5wdXQuZGlzcG9zZSgpLHRoaXN9fWNsYXNzIGdjIGV4dGVuZHMgd297Y29uc3RydWN0b3IoKXtzdXBlcihEaShnYy5nZXREZWZhdWx0cygpLGFyZ3VtZW50cyxbXCJsb3dGcmVxdWVuY3lcIixcImhpZ2hGcmVxdWVuY3lcIl0pKSx0aGlzLm5hbWU9XCJNdWx0aWJhbmRTcGxpdFwiLHRoaXMuaW5wdXQ9bmV3IGtvKHtjb250ZXh0OnRoaXMuY29udGV4dH0pLHRoaXMub3V0cHV0PXZvaWQgMCx0aGlzLmxvdz1uZXcgV3Ioe2NvbnRleHQ6dGhpcy5jb250ZXh0LGZyZXF1ZW5jeTowLHR5cGU6XCJsb3dwYXNzXCJ9KSx0aGlzLl9sb3dNaWRGaWx0ZXI9bmV3IFdyKHtjb250ZXh0OnRoaXMuY29udGV4dCxmcmVxdWVuY3k6MCx0eXBlOlwiaGlnaHBhc3NcIn0pLHRoaXMubWlkPW5ldyBXcih7Y29udGV4dDp0aGlzLmNvbnRleHQsZnJlcXVlbmN5OjAsdHlwZTpcImxvd3Bhc3NcIn0pLHRoaXMuaGlnaD1uZXcgV3Ioe2NvbnRleHQ6dGhpcy5jb250ZXh0LGZyZXF1ZW5jeTowLHR5cGU6XCJoaWdocGFzc1wifSksdGhpcy5faW50ZXJuYWxDaGFubmVscz1bdGhpcy5sb3csdGhpcy5taWQsdGhpcy5oaWdoXTtjb25zdCB0PURpKGdjLmdldERlZmF1bHRzKCksYXJndW1lbnRzLFtcImxvd0ZyZXF1ZW5jeVwiLFwiaGlnaEZyZXF1ZW5jeVwiXSk7dGhpcy5sb3dGcmVxdWVuY3k9bmV3IERvKHtjb250ZXh0OnRoaXMuY29udGV4dCx1bml0czpcImZyZXF1ZW5jeVwiLHZhbHVlOnQubG93RnJlcXVlbmN5fSksdGhpcy5oaWdoRnJlcXVlbmN5PW5ldyBEbyh7Y29udGV4dDp0aGlzLmNvbnRleHQsdW5pdHM6XCJmcmVxdWVuY3lcIix2YWx1ZTp0LmhpZ2hGcmVxdWVuY3l9KSx0aGlzLlE9bmV3IERvKHtjb250ZXh0OnRoaXMuY29udGV4dCx1bml0czpcInBvc2l0aXZlXCIsdmFsdWU6dC5RfSksdGhpcy5pbnB1dC5mYW4odGhpcy5sb3csdGhpcy5oaWdoKSx0aGlzLmlucHV0LmNoYWluKHRoaXMuX2xvd01pZEZpbHRlcix0aGlzLm1pZCksdGhpcy5sb3dGcmVxdWVuY3kuZmFuKHRoaXMubG93LmZyZXF1ZW5jeSx0aGlzLl9sb3dNaWRGaWx0ZXIuZnJlcXVlbmN5KSx0aGlzLmhpZ2hGcmVxdWVuY3kuZmFuKHRoaXMubWlkLmZyZXF1ZW5jeSx0aGlzLmhpZ2guZnJlcXVlbmN5KSx0aGlzLlEuY29ubmVjdCh0aGlzLmxvdy5RKSx0aGlzLlEuY29ubmVjdCh0aGlzLl9sb3dNaWRGaWx0ZXIuUSksdGhpcy5RLmNvbm5lY3QodGhpcy5taWQuUSksdGhpcy5RLmNvbm5lY3QodGhpcy5oaWdoLlEpLFVpKHRoaXMsW1wiaGlnaFwiLFwibWlkXCIsXCJsb3dcIixcImhpZ2hGcmVxdWVuY3lcIixcImxvd0ZyZXF1ZW5jeVwiXSl9c3RhdGljIGdldERlZmF1bHRzKCl7cmV0dXJuIE9iamVjdC5hc3NpZ24od28uZ2V0RGVmYXVsdHMoKSx7UToxLGhpZ2hGcmVxdWVuY3k6MjUwMCxsb3dGcmVxdWVuY3k6NDAwfSl9ZGlzcG9zZSgpe3JldHVybiBzdXBlci5kaXNwb3NlKCksUWkodGhpcyxbXCJoaWdoXCIsXCJtaWRcIixcImxvd1wiLFwiaGlnaEZyZXF1ZW5jeVwiLFwibG93RnJlcXVlbmN5XCJdKSx0aGlzLmxvdy5kaXNwb3NlKCksdGhpcy5fbG93TWlkRmlsdGVyLmRpc3Bvc2UoKSx0aGlzLm1pZC5kaXNwb3NlKCksdGhpcy5oaWdoLmRpc3Bvc2UoKSx0aGlzLmxvd0ZyZXF1ZW5jeS5kaXNwb3NlKCksdGhpcy5oaWdoRnJlcXVlbmN5LmRpc3Bvc2UoKSx0aGlzLlEuZGlzcG9zZSgpLHRoaXN9fWNsYXNzIHZjIGV4dGVuZHMgd297Y29uc3RydWN0b3IoKXtzdXBlciguLi5hcmd1bWVudHMpLHRoaXMubmFtZT1cIkxpc3RlbmVyXCIsdGhpcy5wb3NpdGlvblg9bmV3IHhvKHtjb250ZXh0OnRoaXMuY29udGV4dCxwYXJhbTp0aGlzLmNvbnRleHQucmF3Q29udGV4dC5saXN0ZW5lci5wb3NpdGlvblh9KSx0aGlzLnBvc2l0aW9uWT1uZXcgeG8oe2NvbnRleHQ6dGhpcy5jb250ZXh0LHBhcmFtOnRoaXMuY29udGV4dC5yYXdDb250ZXh0Lmxpc3RlbmVyLnBvc2l0aW9uWX0pLHRoaXMucG9zaXRpb25aPW5ldyB4byh7Y29udGV4dDp0aGlzLmNvbnRleHQscGFyYW06dGhpcy5jb250ZXh0LnJhd0NvbnRleHQubGlzdGVuZXIucG9zaXRpb25afSksdGhpcy5mb3J3YXJkWD1uZXcgeG8oe2NvbnRleHQ6dGhpcy5jb250ZXh0LHBhcmFtOnRoaXMuY29udGV4dC5yYXdDb250ZXh0Lmxpc3RlbmVyLmZvcndhcmRYfSksdGhpcy5mb3J3YXJkWT1uZXcgeG8oe2NvbnRleHQ6dGhpcy5jb250ZXh0LHBhcmFtOnRoaXMuY29udGV4dC5yYXdDb250ZXh0Lmxpc3RlbmVyLmZvcndhcmRZfSksdGhpcy5mb3J3YXJkWj1uZXcgeG8oe2NvbnRleHQ6dGhpcy5jb250ZXh0LHBhcmFtOnRoaXMuY29udGV4dC5yYXdDb250ZXh0Lmxpc3RlbmVyLmZvcndhcmRafSksdGhpcy51cFg9bmV3IHhvKHtjb250ZXh0OnRoaXMuY29udGV4dCxwYXJhbTp0aGlzLmNvbnRleHQucmF3Q29udGV4dC5saXN0ZW5lci51cFh9KSx0aGlzLnVwWT1uZXcgeG8oe2NvbnRleHQ6dGhpcy5jb250ZXh0LHBhcmFtOnRoaXMuY29udGV4dC5yYXdDb250ZXh0Lmxpc3RlbmVyLnVwWX0pLHRoaXMudXBaPW5ldyB4byh7Y29udGV4dDp0aGlzLmNvbnRleHQscGFyYW06dGhpcy5jb250ZXh0LnJhd0NvbnRleHQubGlzdGVuZXIudXBafSl9c3RhdGljIGdldERlZmF1bHRzKCl7cmV0dXJuIE9iamVjdC5hc3NpZ24od28uZ2V0RGVmYXVsdHMoKSx7cG9zaXRpb25YOjAscG9zaXRpb25ZOjAscG9zaXRpb25aOjAsZm9yd2FyZFg6MCxmb3J3YXJkWTowLGZvcndhcmRaOi0xLHVwWDowLHVwWToxLHVwWjowfSl9ZGlzcG9zZSgpe3JldHVybiBzdXBlci5kaXNwb3NlKCksdGhpcy5wb3NpdGlvblguZGlzcG9zZSgpLHRoaXMucG9zaXRpb25ZLmRpc3Bvc2UoKSx0aGlzLnBvc2l0aW9uWi5kaXNwb3NlKCksdGhpcy5mb3J3YXJkWC5kaXNwb3NlKCksdGhpcy5mb3J3YXJkWS5kaXNwb3NlKCksdGhpcy5mb3J3YXJkWi5kaXNwb3NlKCksdGhpcy51cFguZGlzcG9zZSgpLHRoaXMudXBZLmRpc3Bvc2UoKSx0aGlzLnVwWi5kaXNwb3NlKCksdGhpc319amkodD0+e3QubGlzdGVuZXI9bmV3IHZjKHtjb250ZXh0OnR9KX0pLHppKHQ9Pnt0Lmxpc3RlbmVyLmRpc3Bvc2UoKX0pO2NsYXNzIHljIGV4dGVuZHMgd297Y29uc3RydWN0b3IoKXtzdXBlcihEaSh5Yy5nZXREZWZhdWx0cygpLGFyZ3VtZW50cyxbXCJwb3NpdGlvblhcIixcInBvc2l0aW9uWVwiLFwicG9zaXRpb25aXCJdKSksdGhpcy5uYW1lPVwiUGFubmVyM0RcIjtjb25zdCB0PURpKHljLmdldERlZmF1bHRzKCksYXJndW1lbnRzLFtcInBvc2l0aW9uWFwiLFwicG9zaXRpb25ZXCIsXCJwb3NpdGlvblpcIl0pO3RoaXMuX3Bhbm5lcj10aGlzLmlucHV0PXRoaXMub3V0cHV0PXRoaXMuY29udGV4dC5jcmVhdGVQYW5uZXIoKSx0aGlzLnBhbm5pbmdNb2RlbD10LnBhbm5pbmdNb2RlbCx0aGlzLm1heERpc3RhbmNlPXQubWF4RGlzdGFuY2UsdGhpcy5kaXN0YW5jZU1vZGVsPXQuZGlzdGFuY2VNb2RlbCx0aGlzLmNvbmVPdXRlckdhaW49dC5jb25lT3V0ZXJHYWluLHRoaXMuY29uZU91dGVyQW5nbGU9dC5jb25lT3V0ZXJBbmdsZSx0aGlzLmNvbmVJbm5lckFuZ2xlPXQuY29uZUlubmVyQW5nbGUsdGhpcy5yZWZEaXN0YW5jZT10LnJlZkRpc3RhbmNlLHRoaXMucm9sbG9mZkZhY3Rvcj10LnJvbGxvZmZGYWN0b3IsdGhpcy5wb3NpdGlvblg9bmV3IHhvKHtjb250ZXh0OnRoaXMuY29udGV4dCxwYXJhbTp0aGlzLl9wYW5uZXIucG9zaXRpb25YLHZhbHVlOnQucG9zaXRpb25YfSksdGhpcy5wb3NpdGlvblk9bmV3IHhvKHtjb250ZXh0OnRoaXMuY29udGV4dCxwYXJhbTp0aGlzLl9wYW5uZXIucG9zaXRpb25ZLHZhbHVlOnQucG9zaXRpb25ZfSksdGhpcy5wb3NpdGlvblo9bmV3IHhvKHtjb250ZXh0OnRoaXMuY29udGV4dCxwYXJhbTp0aGlzLl9wYW5uZXIucG9zaXRpb25aLHZhbHVlOnQucG9zaXRpb25afSksdGhpcy5vcmllbnRhdGlvblg9bmV3IHhvKHtjb250ZXh0OnRoaXMuY29udGV4dCxwYXJhbTp0aGlzLl9wYW5uZXIub3JpZW50YXRpb25YLHZhbHVlOnQub3JpZW50YXRpb25YfSksdGhpcy5vcmllbnRhdGlvblk9bmV3IHhvKHtjb250ZXh0OnRoaXMuY29udGV4dCxwYXJhbTp0aGlzLl9wYW5uZXIub3JpZW50YXRpb25ZLHZhbHVlOnQub3JpZW50YXRpb25ZfSksdGhpcy5vcmllbnRhdGlvblo9bmV3IHhvKHtjb250ZXh0OnRoaXMuY29udGV4dCxwYXJhbTp0aGlzLl9wYW5uZXIub3JpZW50YXRpb25aLHZhbHVlOnQub3JpZW50YXRpb25afSl9c3RhdGljIGdldERlZmF1bHRzKCl7cmV0dXJuIE9iamVjdC5hc3NpZ24od28uZ2V0RGVmYXVsdHMoKSx7Y29uZUlubmVyQW5nbGU6MzYwLGNvbmVPdXRlckFuZ2xlOjM2MCxjb25lT3V0ZXJHYWluOjAsZGlzdGFuY2VNb2RlbDpcImludmVyc2VcIixtYXhEaXN0YW5jZToxZTQsb3JpZW50YXRpb25YOjAsb3JpZW50YXRpb25ZOjAsb3JpZW50YXRpb25aOjAscGFubmluZ01vZGVsOlwiZXF1YWxwb3dlclwiLHBvc2l0aW9uWDowLHBvc2l0aW9uWTowLHBvc2l0aW9uWjowLHJlZkRpc3RhbmNlOjEscm9sbG9mZkZhY3RvcjoxfSl9c2V0UG9zaXRpb24odCxlLHMpe3JldHVybiB0aGlzLnBvc2l0aW9uWC52YWx1ZT10LHRoaXMucG9zaXRpb25ZLnZhbHVlPWUsdGhpcy5wb3NpdGlvbloudmFsdWU9cyx0aGlzfXNldE9yaWVudGF0aW9uKHQsZSxzKXtyZXR1cm4gdGhpcy5vcmllbnRhdGlvblgudmFsdWU9dCx0aGlzLm9yaWVudGF0aW9uWS52YWx1ZT1lLHRoaXMub3JpZW50YXRpb25aLnZhbHVlPXMsdGhpc31nZXQgcGFubmluZ01vZGVsKCl7cmV0dXJuIHRoaXMuX3Bhbm5lci5wYW5uaW5nTW9kZWx9c2V0IHBhbm5pbmdNb2RlbCh0KXt0aGlzLl9wYW5uZXIucGFubmluZ01vZGVsPXR9Z2V0IHJlZkRpc3RhbmNlKCl7cmV0dXJuIHRoaXMuX3Bhbm5lci5yZWZEaXN0YW5jZX1zZXQgcmVmRGlzdGFuY2UodCl7dGhpcy5fcGFubmVyLnJlZkRpc3RhbmNlPXR9Z2V0IHJvbGxvZmZGYWN0b3IoKXtyZXR1cm4gdGhpcy5fcGFubmVyLnJvbGxvZmZGYWN0b3J9c2V0IHJvbGxvZmZGYWN0b3IodCl7dGhpcy5fcGFubmVyLnJvbGxvZmZGYWN0b3I9dH1nZXQgZGlzdGFuY2VNb2RlbCgpe3JldHVybiB0aGlzLl9wYW5uZXIuZGlzdGFuY2VNb2RlbH1zZXQgZGlzdGFuY2VNb2RlbCh0KXt0aGlzLl9wYW5uZXIuZGlzdGFuY2VNb2RlbD10fWdldCBjb25lSW5uZXJBbmdsZSgpe3JldHVybiB0aGlzLl9wYW5uZXIuY29uZUlubmVyQW5nbGV9c2V0IGNvbmVJbm5lckFuZ2xlKHQpe3RoaXMuX3Bhbm5lci5jb25lSW5uZXJBbmdsZT10fWdldCBjb25lT3V0ZXJBbmdsZSgpe3JldHVybiB0aGlzLl9wYW5uZXIuY29uZU91dGVyQW5nbGV9c2V0IGNvbmVPdXRlckFuZ2xlKHQpe3RoaXMuX3Bhbm5lci5jb25lT3V0ZXJBbmdsZT10fWdldCBjb25lT3V0ZXJHYWluKCl7cmV0dXJuIHRoaXMuX3Bhbm5lci5jb25lT3V0ZXJHYWlufXNldCBjb25lT3V0ZXJHYWluKHQpe3RoaXMuX3Bhbm5lci5jb25lT3V0ZXJHYWluPXR9Z2V0IG1heERpc3RhbmNlKCl7cmV0dXJuIHRoaXMuX3Bhbm5lci5tYXhEaXN0YW5jZX1zZXQgbWF4RGlzdGFuY2UodCl7dGhpcy5fcGFubmVyLm1heERpc3RhbmNlPXR9ZGlzcG9zZSgpe3JldHVybiBzdXBlci5kaXNwb3NlKCksdGhpcy5fcGFubmVyLmRpc2Nvbm5lY3QoKSx0aGlzLm9yaWVudGF0aW9uWC5kaXNwb3NlKCksdGhpcy5vcmllbnRhdGlvblkuZGlzcG9zZSgpLHRoaXMub3JpZW50YXRpb25aLmRpc3Bvc2UoKSx0aGlzLnBvc2l0aW9uWC5kaXNwb3NlKCksdGhpcy5wb3NpdGlvblkuZGlzcG9zZSgpLHRoaXMucG9zaXRpb25aLmRpc3Bvc2UoKSx0aGlzfX1jbGFzcyB4YyBleHRlbmRzIHdve2NvbnN0cnVjdG9yKCl7c3VwZXIoRGkoeGMuZ2V0RGVmYXVsdHMoKSxhcmd1bWVudHMpKSx0aGlzLm5hbWU9XCJSZWNvcmRlclwiO2NvbnN0IHQ9RGkoeGMuZ2V0RGVmYXVsdHMoKSxhcmd1bWVudHMpO3RoaXMuaW5wdXQ9bmV3IGtvKHtjb250ZXh0OnRoaXMuY29udGV4dH0pLHRpKHhjLnN1cHBvcnRlZCxcIk1lZGlhIFJlY29yZGVyIEFQSSBpcyBub3QgYXZhaWxhYmxlXCIpLHRoaXMuX3N0cmVhbT10aGlzLmNvbnRleHQuY3JlYXRlTWVkaWFTdHJlYW1EZXN0aW5hdGlvbigpLHRoaXMuaW5wdXQuY29ubmVjdCh0aGlzLl9zdHJlYW0pLHRoaXMuX3JlY29yZGVyPW5ldyBNZWRpYVJlY29yZGVyKHRoaXMuX3N0cmVhbS5zdHJlYW0se21pbWVUeXBlOnQubWltZVR5cGV9KX1zdGF0aWMgZ2V0RGVmYXVsdHMoKXtyZXR1cm4gd28uZ2V0RGVmYXVsdHMoKX1nZXQgbWltZVR5cGUoKXtyZXR1cm4gdGhpcy5fcmVjb3JkZXIubWltZVR5cGV9c3RhdGljIGdldCBzdXBwb3J0ZWQoKXtyZXR1cm4gbnVsbCE9PW1pJiZSZWZsZWN0LmhhcyhtaSxcIk1lZGlhUmVjb3JkZXJcIil9Z2V0IHN0YXRlKCl7cmV0dXJuXCJpbmFjdGl2ZVwiPT09dGhpcy5fcmVjb3JkZXIuc3RhdGU/XCJzdG9wcGVkXCI6XCJwYXVzZWRcIj09PXRoaXMuX3JlY29yZGVyLnN0YXRlP1wicGF1c2VkXCI6XCJzdGFydGVkXCJ9c3RhcnQoKXtyZXR1cm4geWkodGhpcyx2b2lkIDAsdm9pZCAwLChmdW5jdGlvbiooKXt0aShcInN0YXJ0ZWRcIiE9PXRoaXMuc3RhdGUsXCJSZWNvcmRlciBpcyBhbHJlYWR5IHN0YXJ0ZWRcIik7Y29uc3QgdD1uZXcgUHJvbWlzZSh0PT57Y29uc3QgZT0oKT0+e3RoaXMuX3JlY29yZGVyLnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJzdGFydFwiLGUsITEpLHQoKX07dGhpcy5fcmVjb3JkZXIuYWRkRXZlbnRMaXN0ZW5lcihcInN0YXJ0XCIsZSwhMSl9KTtyZXR1cm4gdGhpcy5fcmVjb3JkZXIuc3RhcnQoKSx5aWVsZCB0fSkpfXN0b3AoKXtyZXR1cm4geWkodGhpcyx2b2lkIDAsdm9pZCAwLChmdW5jdGlvbiooKXt0aShcInN0b3BwZWRcIiE9PXRoaXMuc3RhdGUsXCJSZWNvcmRlciBpcyBub3Qgc3RhcnRlZFwiKTtjb25zdCB0PW5ldyBQcm9taXNlKHQ9Pntjb25zdCBlPXM9Pnt0aGlzLl9yZWNvcmRlci5yZW1vdmVFdmVudExpc3RlbmVyKFwiZGF0YWF2YWlsYWJsZVwiLGUsITEpLHQocy5kYXRhKX07dGhpcy5fcmVjb3JkZXIuYWRkRXZlbnRMaXN0ZW5lcihcImRhdGFhdmFpbGFibGVcIixlLCExKX0pO3JldHVybiB0aGlzLl9yZWNvcmRlci5zdG9wKCkseWllbGQgdH0pKX1wYXVzZSgpe3JldHVybiB0aShcInN0YXJ0ZWRcIj09PXRoaXMuc3RhdGUsXCJSZWNvcmRlciBtdXN0IGJlIHN0YXJ0ZWRcIiksdGhpcy5fcmVjb3JkZXIucGF1c2UoKSx0aGlzfWRpc3Bvc2UoKXtyZXR1cm4gc3VwZXIuZGlzcG9zZSgpLHRoaXMuaW5wdXQuZGlzcG9zZSgpLHRoaXMuX3N0cmVhbS5kaXNjb25uZWN0KCksdGhpc319Y2xhc3Mgd2MgZXh0ZW5kcyB3b3tjb25zdHJ1Y3Rvcigpe3N1cGVyKERpKHdjLmdldERlZmF1bHRzKCksYXJndW1lbnRzLFtcInRocmVzaG9sZFwiLFwicmF0aW9cIl0pKSx0aGlzLm5hbWU9XCJDb21wcmVzc29yXCIsdGhpcy5fY29tcHJlc3Nvcj10aGlzLmNvbnRleHQuY3JlYXRlRHluYW1pY3NDb21wcmVzc29yKCksdGhpcy5pbnB1dD10aGlzLl9jb21wcmVzc29yLHRoaXMub3V0cHV0PXRoaXMuX2NvbXByZXNzb3I7Y29uc3QgdD1EaSh3Yy5nZXREZWZhdWx0cygpLGFyZ3VtZW50cyxbXCJ0aHJlc2hvbGRcIixcInJhdGlvXCJdKTt0aGlzLnRocmVzaG9sZD1uZXcgeG8oe21pblZhbHVlOnRoaXMuX2NvbXByZXNzb3IudGhyZXNob2xkLm1pblZhbHVlLG1heFZhbHVlOnRoaXMuX2NvbXByZXNzb3IudGhyZXNob2xkLm1heFZhbHVlLGNvbnRleHQ6dGhpcy5jb250ZXh0LGNvbnZlcnQ6ITEscGFyYW06dGhpcy5fY29tcHJlc3Nvci50aHJlc2hvbGQsdW5pdHM6XCJkZWNpYmVsc1wiLHZhbHVlOnQudGhyZXNob2xkfSksdGhpcy5hdHRhY2s9bmV3IHhvKHttaW5WYWx1ZTp0aGlzLl9jb21wcmVzc29yLmF0dGFjay5taW5WYWx1ZSxtYXhWYWx1ZTp0aGlzLl9jb21wcmVzc29yLmF0dGFjay5tYXhWYWx1ZSxjb250ZXh0OnRoaXMuY29udGV4dCxwYXJhbTp0aGlzLl9jb21wcmVzc29yLmF0dGFjayx1bml0czpcInRpbWVcIix2YWx1ZTp0LmF0dGFja30pLHRoaXMucmVsZWFzZT1uZXcgeG8oe21pblZhbHVlOnRoaXMuX2NvbXByZXNzb3IucmVsZWFzZS5taW5WYWx1ZSxtYXhWYWx1ZTp0aGlzLl9jb21wcmVzc29yLnJlbGVhc2UubWF4VmFsdWUsY29udGV4dDp0aGlzLmNvbnRleHQscGFyYW06dGhpcy5fY29tcHJlc3Nvci5yZWxlYXNlLHVuaXRzOlwidGltZVwiLHZhbHVlOnQucmVsZWFzZX0pLHRoaXMua25lZT1uZXcgeG8oe21pblZhbHVlOnRoaXMuX2NvbXByZXNzb3Iua25lZS5taW5WYWx1ZSxtYXhWYWx1ZTp0aGlzLl9jb21wcmVzc29yLmtuZWUubWF4VmFsdWUsY29udGV4dDp0aGlzLmNvbnRleHQsY29udmVydDohMSxwYXJhbTp0aGlzLl9jb21wcmVzc29yLmtuZWUsdW5pdHM6XCJkZWNpYmVsc1wiLHZhbHVlOnQua25lZX0pLHRoaXMucmF0aW89bmV3IHhvKHttaW5WYWx1ZTp0aGlzLl9jb21wcmVzc29yLnJhdGlvLm1pblZhbHVlLG1heFZhbHVlOnRoaXMuX2NvbXByZXNzb3IucmF0aW8ubWF4VmFsdWUsY29udGV4dDp0aGlzLmNvbnRleHQsY29udmVydDohMSxwYXJhbTp0aGlzLl9jb21wcmVzc29yLnJhdGlvLHVuaXRzOlwicG9zaXRpdmVcIix2YWx1ZTp0LnJhdGlvfSksVWkodGhpcyxbXCJrbmVlXCIsXCJyZWxlYXNlXCIsXCJhdHRhY2tcIixcInJhdGlvXCIsXCJ0aHJlc2hvbGRcIl0pfXN0YXRpYyBnZXREZWZhdWx0cygpe3JldHVybiBPYmplY3QuYXNzaWduKHdvLmdldERlZmF1bHRzKCkse2F0dGFjazouMDAzLGtuZWU6MzAscmF0aW86MTIscmVsZWFzZTouMjUsdGhyZXNob2xkOi0yNH0pfWdldCByZWR1Y3Rpb24oKXtyZXR1cm4gdGhpcy5fY29tcHJlc3Nvci5yZWR1Y3Rpb259ZGlzcG9zZSgpe3JldHVybiBzdXBlci5kaXNwb3NlKCksdGhpcy5fY29tcHJlc3Nvci5kaXNjb25uZWN0KCksdGhpcy5hdHRhY2suZGlzcG9zZSgpLHRoaXMucmVsZWFzZS5kaXNwb3NlKCksdGhpcy50aHJlc2hvbGQuZGlzcG9zZSgpLHRoaXMucmF0aW8uZGlzcG9zZSgpLHRoaXMua25lZS5kaXNwb3NlKCksdGhpc319Y2xhc3MgYmMgZXh0ZW5kcyB3b3tjb25zdHJ1Y3Rvcigpe3N1cGVyKE9iamVjdC5hc3NpZ24oRGkoYmMuZ2V0RGVmYXVsdHMoKSxhcmd1bWVudHMsW1widGhyZXNob2xkXCIsXCJzbW9vdGhpbmdcIl0pKSksdGhpcy5uYW1lPVwiR2F0ZVwiO2NvbnN0IHQ9RGkoYmMuZ2V0RGVmYXVsdHMoKSxhcmd1bWVudHMsW1widGhyZXNob2xkXCIsXCJzbW9vdGhpbmdcIl0pO3RoaXMuX2ZvbGxvd2VyPW5ldyBEYSh7Y29udGV4dDp0aGlzLmNvbnRleHQsc21vb3RoaW5nOnQuc21vb3RoaW5nfSksdGhpcy5fZ3Q9bmV3IE1yKHtjb250ZXh0OnRoaXMuY29udGV4dCx2YWx1ZTplbyh0LnRocmVzaG9sZCl9KSx0aGlzLmlucHV0PW5ldyBrbyh7Y29udGV4dDp0aGlzLmNvbnRleHR9KSx0aGlzLl9nYXRlPXRoaXMub3V0cHV0PW5ldyBrbyh7Y29udGV4dDp0aGlzLmNvbnRleHR9KSx0aGlzLmlucHV0LmNvbm5lY3QodGhpcy5fZ2F0ZSksdGhpcy5pbnB1dC5jaGFpbih0aGlzLl9mb2xsb3dlcix0aGlzLl9ndCx0aGlzLl9nYXRlLmdhaW4pfXN0YXRpYyBnZXREZWZhdWx0cygpe3JldHVybiBPYmplY3QuYXNzaWduKHdvLmdldERlZmF1bHRzKCkse3Ntb290aGluZzouMSx0aHJlc2hvbGQ6LTQwfSl9Z2V0IHRocmVzaG9sZCgpe3JldHVybiBzbyh0aGlzLl9ndC52YWx1ZSl9c2V0IHRocmVzaG9sZCh0KXt0aGlzLl9ndC52YWx1ZT1lbyh0KX1nZXQgc21vb3RoaW5nKCl7cmV0dXJuIHRoaXMuX2ZvbGxvd2VyLnNtb290aGluZ31zZXQgc21vb3RoaW5nKHQpe3RoaXMuX2ZvbGxvd2VyLnNtb290aGluZz10fWRpc3Bvc2UoKXtyZXR1cm4gc3VwZXIuZGlzcG9zZSgpLHRoaXMuaW5wdXQuZGlzcG9zZSgpLHRoaXMuX2ZvbGxvd2VyLmRpc3Bvc2UoKSx0aGlzLl9ndC5kaXNwb3NlKCksdGhpcy5fZ2F0ZS5kaXNwb3NlKCksdGhpc319Y2xhc3MgVGMgZXh0ZW5kcyB3b3tjb25zdHJ1Y3Rvcigpe3N1cGVyKE9iamVjdC5hc3NpZ24oRGkoVGMuZ2V0RGVmYXVsdHMoKSxhcmd1bWVudHMsW1widGhyZXNob2xkXCJdKSkpLHRoaXMubmFtZT1cIkxpbWl0ZXJcIjtjb25zdCB0PURpKFRjLmdldERlZmF1bHRzKCksYXJndW1lbnRzLFtcInRocmVzaG9sZFwiXSk7dGhpcy5fY29tcHJlc3Nvcj10aGlzLmlucHV0PXRoaXMub3V0cHV0PW5ldyB3Yyh7Y29udGV4dDp0aGlzLmNvbnRleHQscmF0aW86MjAsYXR0YWNrOi4wMDMscmVsZWFzZTouMDEsdGhyZXNob2xkOnQudGhyZXNob2xkfSksdGhpcy50aHJlc2hvbGQ9dGhpcy5fY29tcHJlc3Nvci50aHJlc2hvbGQsVWkodGhpcyxcInRocmVzaG9sZFwiKX1zdGF0aWMgZ2V0RGVmYXVsdHMoKXtyZXR1cm4gT2JqZWN0LmFzc2lnbih3by5nZXREZWZhdWx0cygpLHt0aHJlc2hvbGQ6LTEyfSl9Z2V0IHJlZHVjdGlvbigpe3JldHVybiB0aGlzLl9jb21wcmVzc29yLnJlZHVjdGlvbn1kaXNwb3NlKCl7cmV0dXJuIHN1cGVyLmRpc3Bvc2UoKSx0aGlzLl9jb21wcmVzc29yLmRpc3Bvc2UoKSx0aGlzLnRocmVzaG9sZC5kaXNwb3NlKCksdGhpc319Y2xhc3MgU2MgZXh0ZW5kcyB3b3tjb25zdHJ1Y3Rvcigpe3N1cGVyKE9iamVjdC5hc3NpZ24oRGkoU2MuZ2V0RGVmYXVsdHMoKSxhcmd1bWVudHMpKSksdGhpcy5uYW1lPVwiTWlkU2lkZUNvbXByZXNzb3JcIjtjb25zdCB0PURpKFNjLmdldERlZmF1bHRzKCksYXJndW1lbnRzKTt0aGlzLl9taWRTaWRlU3BsaXQ9dGhpcy5pbnB1dD1uZXcgZWMoe2NvbnRleHQ6dGhpcy5jb250ZXh0fSksdGhpcy5fbWlkU2lkZU1lcmdlPXRoaXMub3V0cHV0PW5ldyBzYyh7Y29udGV4dDp0aGlzLmNvbnRleHR9KSx0aGlzLm1pZD1uZXcgd2MoT2JqZWN0LmFzc2lnbih0Lm1pZCx7Y29udGV4dDp0aGlzLmNvbnRleHR9KSksdGhpcy5zaWRlPW5ldyB3YyhPYmplY3QuYXNzaWduKHQuc2lkZSx7Y29udGV4dDp0aGlzLmNvbnRleHR9KSksdGhpcy5fbWlkU2lkZVNwbGl0Lm1pZC5jaGFpbih0aGlzLm1pZCx0aGlzLl9taWRTaWRlTWVyZ2UubWlkKSx0aGlzLl9taWRTaWRlU3BsaXQuc2lkZS5jaGFpbih0aGlzLnNpZGUsdGhpcy5fbWlkU2lkZU1lcmdlLnNpZGUpLFVpKHRoaXMsW1wibWlkXCIsXCJzaWRlXCJdKX1zdGF0aWMgZ2V0RGVmYXVsdHMoKXtyZXR1cm4gT2JqZWN0LmFzc2lnbih3by5nZXREZWZhdWx0cygpLHttaWQ6e3JhdGlvOjMsdGhyZXNob2xkOi0yNCxyZWxlYXNlOi4wMyxhdHRhY2s6LjAyLGtuZWU6MTZ9LHNpZGU6e3JhdGlvOjYsdGhyZXNob2xkOi0zMCxyZWxlYXNlOi4yNSxhdHRhY2s6LjAzLGtuZWU6MTB9fSl9ZGlzcG9zZSgpe3JldHVybiBzdXBlci5kaXNwb3NlKCksdGhpcy5taWQuZGlzcG9zZSgpLHRoaXMuc2lkZS5kaXNwb3NlKCksdGhpcy5fbWlkU2lkZVNwbGl0LmRpc3Bvc2UoKSx0aGlzLl9taWRTaWRlTWVyZ2UuZGlzcG9zZSgpLHRoaXN9fWNsYXNzIGtjIGV4dGVuZHMgd297Y29uc3RydWN0b3IoKXtzdXBlcihPYmplY3QuYXNzaWduKERpKGtjLmdldERlZmF1bHRzKCksYXJndW1lbnRzKSkpLHRoaXMubmFtZT1cIk11bHRpYmFuZENvbXByZXNzb3JcIjtjb25zdCB0PURpKGtjLmdldERlZmF1bHRzKCksYXJndW1lbnRzKTt0aGlzLl9zcGxpdHRlcj10aGlzLmlucHV0PW5ldyBnYyh7Y29udGV4dDp0aGlzLmNvbnRleHQsbG93RnJlcXVlbmN5OnQubG93RnJlcXVlbmN5LGhpZ2hGcmVxdWVuY3k6dC5oaWdoRnJlcXVlbmN5fSksdGhpcy5sb3dGcmVxdWVuY3k9dGhpcy5fc3BsaXR0ZXIubG93RnJlcXVlbmN5LHRoaXMuaGlnaEZyZXF1ZW5jeT10aGlzLl9zcGxpdHRlci5oaWdoRnJlcXVlbmN5LHRoaXMub3V0cHV0PW5ldyBrbyh7Y29udGV4dDp0aGlzLmNvbnRleHR9KSx0aGlzLmxvdz1uZXcgd2MoT2JqZWN0LmFzc2lnbih0Lmxvdyx7Y29udGV4dDp0aGlzLmNvbnRleHR9KSksdGhpcy5taWQ9bmV3IHdjKE9iamVjdC5hc3NpZ24odC5taWQse2NvbnRleHQ6dGhpcy5jb250ZXh0fSkpLHRoaXMuaGlnaD1uZXcgd2MoT2JqZWN0LmFzc2lnbih0LmhpZ2gse2NvbnRleHQ6dGhpcy5jb250ZXh0fSkpLHRoaXMuX3NwbGl0dGVyLmxvdy5jaGFpbih0aGlzLmxvdyx0aGlzLm91dHB1dCksdGhpcy5fc3BsaXR0ZXIubWlkLmNoYWluKHRoaXMubWlkLHRoaXMub3V0cHV0KSx0aGlzLl9zcGxpdHRlci5oaWdoLmNoYWluKHRoaXMuaGlnaCx0aGlzLm91dHB1dCksVWkodGhpcyxbXCJoaWdoXCIsXCJtaWRcIixcImxvd1wiLFwiaGlnaEZyZXF1ZW5jeVwiLFwibG93RnJlcXVlbmN5XCJdKX1zdGF0aWMgZ2V0RGVmYXVsdHMoKXtyZXR1cm4gT2JqZWN0LmFzc2lnbih3by5nZXREZWZhdWx0cygpLHtsb3dGcmVxdWVuY3k6MjUwLGhpZ2hGcmVxdWVuY3k6MmUzLGxvdzp7cmF0aW86Nix0aHJlc2hvbGQ6LTMwLHJlbGVhc2U6LjI1LGF0dGFjazouMDMsa25lZToxMH0sbWlkOntyYXRpbzozLHRocmVzaG9sZDotMjQscmVsZWFzZTouMDMsYXR0YWNrOi4wMixrbmVlOjE2fSxoaWdoOntyYXRpbzozLHRocmVzaG9sZDotMjQscmVsZWFzZTouMDMsYXR0YWNrOi4wMixrbmVlOjE2fX0pfWRpc3Bvc2UoKXtyZXR1cm4gc3VwZXIuZGlzcG9zZSgpLHRoaXMuX3NwbGl0dGVyLmRpc3Bvc2UoKSx0aGlzLmxvdy5kaXNwb3NlKCksdGhpcy5taWQuZGlzcG9zZSgpLHRoaXMuaGlnaC5kaXNwb3NlKCksdGhpcy5vdXRwdXQuZGlzcG9zZSgpLHRoaXN9fWNsYXNzIENjIGV4dGVuZHMgd297Y29uc3RydWN0b3IoKXtzdXBlcihEaShDYy5nZXREZWZhdWx0cygpLGFyZ3VtZW50cyxbXCJsb3dcIixcIm1pZFwiLFwiaGlnaFwiXSkpLHRoaXMubmFtZT1cIkVRM1wiLHRoaXMub3V0cHV0PW5ldyBrbyh7Y29udGV4dDp0aGlzLmNvbnRleHR9KSx0aGlzLl9pbnRlcm5hbENoYW5uZWxzPVtdO2NvbnN0IHQ9RGkoQ2MuZ2V0RGVmYXVsdHMoKSxhcmd1bWVudHMsW1wibG93XCIsXCJtaWRcIixcImhpZ2hcIl0pO3RoaXMuaW5wdXQ9dGhpcy5fbXVsdGliYW5kU3BsaXQ9bmV3IGdjKHtjb250ZXh0OnRoaXMuY29udGV4dCxoaWdoRnJlcXVlbmN5OnQuaGlnaEZyZXF1ZW5jeSxsb3dGcmVxdWVuY3k6dC5sb3dGcmVxdWVuY3l9KSx0aGlzLl9sb3dHYWluPW5ldyBrbyh7Y29udGV4dDp0aGlzLmNvbnRleHQsZ2Fpbjp0Lmxvdyx1bml0czpcImRlY2liZWxzXCJ9KSx0aGlzLl9taWRHYWluPW5ldyBrbyh7Y29udGV4dDp0aGlzLmNvbnRleHQsZ2Fpbjp0Lm1pZCx1bml0czpcImRlY2liZWxzXCJ9KSx0aGlzLl9oaWdoR2Fpbj1uZXcga28oe2NvbnRleHQ6dGhpcy5jb250ZXh0LGdhaW46dC5oaWdoLHVuaXRzOlwiZGVjaWJlbHNcIn0pLHRoaXMubG93PXRoaXMuX2xvd0dhaW4uZ2Fpbix0aGlzLm1pZD10aGlzLl9taWRHYWluLmdhaW4sdGhpcy5oaWdoPXRoaXMuX2hpZ2hHYWluLmdhaW4sdGhpcy5RPXRoaXMuX211bHRpYmFuZFNwbGl0LlEsdGhpcy5sb3dGcmVxdWVuY3k9dGhpcy5fbXVsdGliYW5kU3BsaXQubG93RnJlcXVlbmN5LHRoaXMuaGlnaEZyZXF1ZW5jeT10aGlzLl9tdWx0aWJhbmRTcGxpdC5oaWdoRnJlcXVlbmN5LHRoaXMuX211bHRpYmFuZFNwbGl0Lmxvdy5jaGFpbih0aGlzLl9sb3dHYWluLHRoaXMub3V0cHV0KSx0aGlzLl9tdWx0aWJhbmRTcGxpdC5taWQuY2hhaW4odGhpcy5fbWlkR2Fpbix0aGlzLm91dHB1dCksdGhpcy5fbXVsdGliYW5kU3BsaXQuaGlnaC5jaGFpbih0aGlzLl9oaWdoR2Fpbix0aGlzLm91dHB1dCksVWkodGhpcyxbXCJsb3dcIixcIm1pZFwiLFwiaGlnaFwiLFwibG93RnJlcXVlbmN5XCIsXCJoaWdoRnJlcXVlbmN5XCJdKSx0aGlzLl9pbnRlcm5hbENoYW5uZWxzPVt0aGlzLl9tdWx0aWJhbmRTcGxpdF19c3RhdGljIGdldERlZmF1bHRzKCl7cmV0dXJuIE9iamVjdC5hc3NpZ24od28uZ2V0RGVmYXVsdHMoKSx7aGlnaDowLGhpZ2hGcmVxdWVuY3k6MjUwMCxsb3c6MCxsb3dGcmVxdWVuY3k6NDAwLG1pZDowfSl9ZGlzcG9zZSgpe3JldHVybiBzdXBlci5kaXNwb3NlKCksUWkodGhpcyxbXCJsb3dcIixcIm1pZFwiLFwiaGlnaFwiLFwibG93RnJlcXVlbmN5XCIsXCJoaWdoRnJlcXVlbmN5XCJdKSx0aGlzLl9tdWx0aWJhbmRTcGxpdC5kaXNwb3NlKCksdGhpcy5sb3dGcmVxdWVuY3kuZGlzcG9zZSgpLHRoaXMuaGlnaEZyZXF1ZW5jeS5kaXNwb3NlKCksdGhpcy5fbG93R2Fpbi5kaXNwb3NlKCksdGhpcy5fbWlkR2Fpbi5kaXNwb3NlKCksdGhpcy5faGlnaEdhaW4uZGlzcG9zZSgpLHRoaXMubG93LmRpc3Bvc2UoKSx0aGlzLm1pZC5kaXNwb3NlKCksdGhpcy5oaWdoLmRpc3Bvc2UoKSx0aGlzLlEuZGlzcG9zZSgpLHRoaXN9fWNsYXNzIEFjIGV4dGVuZHMgd297Y29uc3RydWN0b3IoKXtzdXBlcihEaShBYy5nZXREZWZhdWx0cygpLGFyZ3VtZW50cyxbXCJ1cmxcIixcIm9ubG9hZFwiXSkpLHRoaXMubmFtZT1cIkNvbnZvbHZlclwiLHRoaXMuX2NvbnZvbHZlcj10aGlzLmNvbnRleHQuY3JlYXRlQ29udm9sdmVyKCk7Y29uc3QgdD1EaShBYy5nZXREZWZhdWx0cygpLGFyZ3VtZW50cyxbXCJ1cmxcIixcIm9ubG9hZFwiXSk7dGhpcy5fYnVmZmVyPW5ldyBYaSh0LnVybCxlPT57dGhpcy5idWZmZXI9ZSx0Lm9ubG9hZCgpfSksdGhpcy5pbnB1dD1uZXcga28oe2NvbnRleHQ6dGhpcy5jb250ZXh0fSksdGhpcy5vdXRwdXQ9bmV3IGtvKHtjb250ZXh0OnRoaXMuY29udGV4dH0pLHRoaXMuX2J1ZmZlci5sb2FkZWQmJih0aGlzLmJ1ZmZlcj10aGlzLl9idWZmZXIpLHRoaXMubm9ybWFsaXplPXQubm9ybWFsaXplLHRoaXMuaW5wdXQuY2hhaW4odGhpcy5fY29udm9sdmVyLHRoaXMub3V0cHV0KX1zdGF0aWMgZ2V0RGVmYXVsdHMoKXtyZXR1cm4gT2JqZWN0LmFzc2lnbih3by5nZXREZWZhdWx0cygpLHtub3JtYWxpemU6ITAsb25sb2FkOlppfSl9bG9hZCh0KXtyZXR1cm4geWkodGhpcyx2b2lkIDAsdm9pZCAwLChmdW5jdGlvbiooKXt0aGlzLmJ1ZmZlcj15aWVsZCB0aGlzLl9idWZmZXIubG9hZCh0KX0pKX1nZXQgYnVmZmVyKCl7cmV0dXJuIHRoaXMuX2J1ZmZlci5sZW5ndGg/dGhpcy5fYnVmZmVyOm51bGx9c2V0IGJ1ZmZlcih0KXt0JiZ0aGlzLl9idWZmZXIuc2V0KHQpLHRoaXMuX2NvbnZvbHZlci5idWZmZXImJih0aGlzLmlucHV0LmRpc2Nvbm5lY3QoKSx0aGlzLl9jb252b2x2ZXIuZGlzY29ubmVjdCgpLHRoaXMuX2NvbnZvbHZlcj10aGlzLmNvbnRleHQuY3JlYXRlQ29udm9sdmVyKCksdGhpcy5pbnB1dC5jaGFpbih0aGlzLl9jb252b2x2ZXIsdGhpcy5vdXRwdXQpKTtjb25zdCBlPXRoaXMuX2J1ZmZlci5nZXQoKTt0aGlzLl9jb252b2x2ZXIuYnVmZmVyPWV8fG51bGx9Z2V0IG5vcm1hbGl6ZSgpe3JldHVybiB0aGlzLl9jb252b2x2ZXIubm9ybWFsaXplfXNldCBub3JtYWxpemUodCl7dGhpcy5fY29udm9sdmVyLm5vcm1hbGl6ZT10fWRpc3Bvc2UoKXtyZXR1cm4gc3VwZXIuZGlzcG9zZSgpLHRoaXMuX2J1ZmZlci5kaXNwb3NlKCksdGhpcy5fY29udm9sdmVyLmRpc2Nvbm5lY3QoKSx0aGlzfX1mdW5jdGlvbiBEYygpe3JldHVybiBKaSgpLm5vdygpfWZ1bmN0aW9uIE9jKCl7cmV0dXJuIEppKCkuaW1tZWRpYXRlKCl9Y29uc3QgTWM9SmkoKS50cmFuc3BvcnQ7ZnVuY3Rpb24gRWMoKXtyZXR1cm4gSmkoKS50cmFuc3BvcnR9Y29uc3QgUmM9SmkoKS5kZXN0aW5hdGlvbixxYz1KaSgpLmRlc3RpbmF0aW9uO2Z1bmN0aW9uIEZjKCl7cmV0dXJuIEppKCkuZGVzdGluYXRpb259Y29uc3QgSWM9SmkoKS5saXN0ZW5lcjtmdW5jdGlvbiBWYygpe3JldHVybiBKaSgpLmxpc3RlbmVyfWNvbnN0IE5jPUppKCkuZHJhdztmdW5jdGlvbiBQYygpe3JldHVybiBKaSgpLmRyYXd9Y29uc3QgamM9SmkoKTtmdW5jdGlvbiBMYygpe3JldHVybiBYaS5sb2FkZWQoKX1jb25zdCB6Yz1YaSxCYz1WbyxXYz0kb31dKX0pKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPVRvbmUuanMubWFwIl19
